var bP=Object.create;var uv=Object.defineProperty,CP=Object.defineProperties,EP=Object.getOwnPropertyDescriptor,wP=Object.getOwnPropertyDescriptors,SP=Object.getOwnPropertyNames,HC=Object.getOwnPropertySymbols,MP=Object.getPrototypeOf,jC=Object.prototype.hasOwnProperty,AP=Object.prototype.propertyIsEnumerable;var zC=(n,t,e)=>t in n?uv(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,Oe=(n,t)=>{for(var e in t||={})jC.call(t,e)&&zC(n,e,t[e]);if(HC)for(var e of HC(t))AP.call(t,e)&&zC(n,e,t[e]);return n},St=(n,t)=>CP(n,wP(t));var WC=(n=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(n,{get:(t,e)=>(typeof require<"u"?require:t)[e]}):n)(function(n){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+n+'" is not supported')});var TP=(n,t)=>()=>(n&&(t=n(n=0)),t);var GC=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports);var DP=(n,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of SP(t))!jC.call(n,r)&&r!==e&&uv(n,r,{get:()=>t[r],enumerable:!(i=EP(t,r))||i.enumerable});return n};var ya=(n,t,e)=>(e=n!=null?bP(MP(n)):{},DP(t||!n||!n.__esModule?uv(e,"default",{value:n,enumerable:!0}):e,n));var wt=(n,t,e)=>new Promise((i,r)=>{var o=f=>{try{c(e.next(f))}catch(p){r(p)}},l=f=>{try{c(e.throw(f))}catch(p){r(p)}},c=f=>f.done?i(f.value):Promise.resolve(f.value).then(o,l);c((e=e.apply(n,t)).next())});var $=TP(()=>{});var Na=GC((hs,nb)=>{"use strict";$();(function(n,t){typeof hs=="object"&&typeof nb<"u"?nb.exports=t():typeof define=="function"&&define.amd?define(t):(n=typeof globalThis<"u"?globalThis:n||self,n.Sweetalert2=t())})(hs,function(){"use strict";function n(v,y,P){if(typeof v=="function"?v===y:v.has(y))return arguments.length<3?y:P;throw new TypeError("Private element is not present on this object")}function t(v,y){if(y.has(v))throw new TypeError("Cannot initialize the same private elements twice on an object")}function e(v,y){return v.get(n(v,y))}function i(v,y,P){t(v,y),y.set(v,P)}function r(v,y,P){return v.set(n(v,y),P),P}let o=100,l={},c=()=>{l.previousActiveElement instanceof HTMLElement?(l.previousActiveElement.focus(),l.previousActiveElement=null):document.body&&document.body.focus()},f=v=>new Promise(y=>{if(!v)return y();let P=window.scrollX,V=window.scrollY;l.restoreFocusTimeout=setTimeout(()=>{c(),y()},o),window.scrollTo(P,V)}),p="swal2-",m=["container","shown","height-auto","iosfix","popup","modal","no-backdrop","no-transition","toast","toast-shown","show","hide","close","title","html-container","actions","confirm","deny","cancel","footer","icon","icon-content","image","input","file","range","select","radio","checkbox","label","textarea","inputerror","input-label","validation-message","progress-steps","active-progress-step","progress-step","progress-step-line","loader","loading","styled","top","top-start","top-end","top-left","top-right","center","center-start","center-end","center-left","center-right","bottom","bottom-start","bottom-end","bottom-left","bottom-right","grow-row","grow-column","grow-fullscreen","rtl","timer-progress-bar","timer-progress-bar-container","scrollbar-measure","icon-success","icon-warning","icon-info","icon-question","icon-error","draggable","dragging"].reduce((v,y)=>(v[y]=p+y,v),{}),C=["success","warning","info","question","error"].reduce((v,y)=>(v[y]=p+y,v),{}),A="SweetAlert2:",O=v=>v.charAt(0).toUpperCase()+v.slice(1),T=v=>{console.warn(`${A} ${typeof v=="object"?v.join(" "):v}`)},M=v=>{console.error(`${A} ${v}`)},G=[],Y=v=>{G.includes(v)||(G.push(v),T(v))},q=(v,y=null)=>{Y(`"${v}" is deprecated and will be removed in the next major release.${y?` Use "${y}" instead.`:""}`)},X=v=>typeof v=="function"?v():v,Z=v=>v&&typeof v.toPromise=="function",J=v=>Z(v)?v.toPromise():Promise.resolve(v),oe=v=>v&&Promise.resolve(v)===v,L=()=>document.body.querySelector(`.${m.container}`),z=v=>{let y=L();return y?y.querySelector(v):null},K=v=>z(`.${v}`),re=()=>K(m.popup),ce=()=>K(m.icon),we=()=>K(m["icon-content"]),Ee=()=>K(m.title),xe=()=>K(m["html-container"]),me=()=>K(m.image),Me=()=>K(m["progress-steps"]),qe=()=>K(m["validation-message"]),Be=()=>z(`.${m.actions} .${m.confirm}`),Xe=()=>z(`.${m.actions} .${m.cancel}`),Et=()=>z(`.${m.actions} .${m.deny}`),Re=()=>K(m["input-label"]),wn=()=>z(`.${m.loader}`),xn=()=>K(m.actions),Se=()=>K(m.footer),De=()=>K(m["timer-progress-bar"]),rt=()=>K(m.close),Pt=`
  a[href],
  area[href],
  input:not([disabled]),
  select:not([disabled]),
  textarea:not([disabled]),
  button:not([disabled]),
  iframe,
  object,
  embed,
  [tabindex="0"],
  [contenteditable],
  audio[controls],
  video[controls],
  summary
`,ft=()=>{let v=re();if(!v)return[];let y=v.querySelectorAll('[tabindex]:not([tabindex="-1"]):not([tabindex="0"])'),P=Array.from(y).sort((Ve,Ot)=>{let ln=parseInt(Ve.getAttribute("tabindex")||"0"),On=parseInt(Ot.getAttribute("tabindex")||"0");return ln>On?1:ln<On?-1:0}),V=v.querySelectorAll(Pt),se=Array.from(V).filter(Ve=>Ve.getAttribute("tabindex")!=="-1");return[...new Set(P.concat(se))].filter(Ve=>ke(Ve))},tn=()=>Kt(document.body,m.shown)&&!Kt(document.body,m["toast-shown"])&&!Kt(document.body,m["no-backdrop"]),Xn=()=>{let v=re();return v?Kt(v,m.toast):!1},sn=()=>{let v=re();return v?v.hasAttribute("data-loading"):!1},It=(v,y)=>{if(v.textContent="",y){let V=new DOMParser().parseFromString(y,"text/html"),se=V.querySelector("head");se&&Array.from(se.childNodes).forEach(Ot=>{v.appendChild(Ot)});let Ve=V.querySelector("body");Ve&&Array.from(Ve.childNodes).forEach(Ot=>{Ot instanceof HTMLVideoElement||Ot instanceof HTMLAudioElement?v.appendChild(Ot.cloneNode(!0)):v.appendChild(Ot)})}},Kt=(v,y)=>{if(!y)return!1;let P=y.split(/\s+/);for(let V=0;V<P.length;V++)if(!v.classList.contains(P[V]))return!1;return!0},Nt=(v,y)=>{Array.from(v.classList).forEach(P=>{!Object.values(m).includes(P)&&!Object.values(C).includes(P)&&!Object.values(y.showClass||{}).includes(P)&&v.classList.remove(P)})},un=(v,y,P)=>{if(Nt(v,y),!y.customClass)return;let V=y.customClass[P];if(V){if(typeof V!="string"&&!V.forEach){T(`Invalid type of customClass.${P}! Expected string or iterable object, got "${typeof V}"`);return}gt(v,V)}},Q=(v,y)=>{if(!y)return null;switch(y){case"select":case"textarea":case"file":return v.querySelector(`.${m.popup} > .${m[y]}`);case"checkbox":return v.querySelector(`.${m.popup} > .${m.checkbox} input`);case"radio":return v.querySelector(`.${m.popup} > .${m.radio} input:checked`)||v.querySelector(`.${m.popup} > .${m.radio} input:first-child`);case"range":return v.querySelector(`.${m.popup} > .${m.range} input`);default:return v.querySelector(`.${m.popup} > .${m.input}`)}},cn=v=>{if(v.focus(),v.type!=="file"){let y=v.value;v.value="",v.value=y}},an=(v,y,P)=>{!v||!y||(typeof y=="string"&&(y=y.split(/\s+/).filter(Boolean)),y.forEach(V=>{Array.isArray(v)?v.forEach(se=>{P?se.classList.add(V):se.classList.remove(V)}):P?v.classList.add(V):v.classList.remove(V)}))},gt=(v,y)=>{an(v,y,!0)},Qe=(v,y)=>{an(v,y,!1)},W=(v,y)=>{let P=Array.from(v.children);for(let V=0;V<P.length;V++){let se=P[V];if(se instanceof HTMLElement&&Kt(se,y))return se}},k=(v,y,P)=>{P===`${parseInt(`${P}`)}`&&(P=parseInt(P)),P||parseInt(`${P}`)===0?v.style.setProperty(y,typeof P=="number"?`${P}px`:P):v.style.removeProperty(y)},te=(v,y="flex")=>{v&&(v.style.display=y)},ge=v=>{v&&(v.style.display="none")},Ae=(v,y="block")=>{v&&new MutationObserver(()=>{ct(v,v.innerHTML,y)}).observe(v,{childList:!0,subtree:!0})},de=(v,y,P,V)=>{let se=v.querySelector(y);se&&se.style.setProperty(P,V)},ct=(v,y,P="flex")=>{y?te(v,P):ge(v)},ke=v=>!!(v&&(v.offsetWidth||v.offsetHeight||v.getClientRects().length)),dt=()=>!ke(Be())&&!ke(Et())&&!ke(Xe()),xt=v=>v.scrollHeight>v.clientHeight,Fe=(v,y)=>{let P=v;for(;P&&P!==y;){if(xt(P))return!0;P=P.parentElement}return!1},He=v=>{let y=window.getComputedStyle(v),P=parseFloat(y.getPropertyValue("animation-duration")||"0"),V=parseFloat(y.getPropertyValue("transition-duration")||"0");return P>0||V>0},tt=(v,y=!1)=>{let P=De();P&&ke(P)&&(y&&(P.style.transition="none",P.style.width="100%"),setTimeout(()=>{P.style.transition=`width ${v/1e3}s linear`,P.style.width="0%"},10))},ht=()=>{let v=De();if(!v)return;let y=parseInt(window.getComputedStyle(v).width);v.style.removeProperty("transition"),v.style.width="100%";let P=parseInt(window.getComputedStyle(v).width),V=y/P*100;v.style.width=`${V}%`},je=()=>typeof window>"u"||typeof document>"u",Ut=`
 <div aria-labelledby="${m.title}" aria-describedby="${m["html-container"]}" class="${m.popup}" tabindex="-1">
   <button type="button" class="${m.close}"></button>
   <ul class="${m["progress-steps"]}"></ul>
   <div class="${m.icon}"></div>
   <img class="${m.image}" />
   <h2 class="${m.title}" id="${m.title}"></h2>
   <div class="${m["html-container"]}" id="${m["html-container"]}"></div>
   <input class="${m.input}" id="${m.input}" />
   <input type="file" class="${m.file}" />
   <div class="${m.range}">
     <input type="range" />
     <output></output>
   </div>
   <select class="${m.select}" id="${m.select}"></select>
   <div class="${m.radio}"></div>
   <label class="${m.checkbox}">
     <input type="checkbox" id="${m.checkbox}" />
     <span class="${m.label}"></span>
   </label>
   <textarea class="${m.textarea}" id="${m.textarea}"></textarea>
   <div class="${m["validation-message"]}" id="${m["validation-message"]}"></div>
   <div class="${m.actions}">
     <div class="${m.loader}"></div>
     <button type="button" class="${m.confirm}"></button>
     <button type="button" class="${m.deny}"></button>
     <button type="button" class="${m.cancel}"></button>
   </div>
   <div class="${m.footer}"></div>
   <div class="${m["timer-progress-bar-container"]}">
     <div class="${m["timer-progress-bar"]}"></div>
   </div>
 </div>
`.replace(/(^|\n)\s*/g,""),ne=()=>{let v=L();return v?(v.remove(),Qe([document.documentElement,document.body],[m["no-backdrop"],m["toast-shown"],m["has-column"]]),!0):!1},ze=()=>{l.currentInstance&&l.currentInstance.resetValidationMessage()},Ue=()=>{let v=re();if(!v)return;let y=W(v,m.input),P=W(v,m.file),V=v.querySelector(`.${m.range} input`),se=v.querySelector(`.${m.range} output`),Ve=W(v,m.select),Ot=v.querySelector(`.${m.checkbox} input`),ln=W(v,m.textarea);y&&(y.oninput=ze),P&&(P.onchange=ze),Ve&&(Ve.onchange=ze),Ot&&(Ot.onchange=ze),ln&&(ln.oninput=ze),V&&se&&(V.oninput=()=>{ze(),se.value=V.value},V.onchange=()=>{ze(),se.value=V.value})},Je=v=>{if(typeof v=="string"){let y=document.querySelector(v);if(!y)throw new Error(`Target element "${v}" not found`);return y}return v},ue=v=>{let y=re();y&&(y.setAttribute("role",v.toast?"alert":"dialog"),y.setAttribute("aria-live",v.toast?"polite":"assertive"),v.toast||y.setAttribute("aria-modal","true"))},Te=v=>{window.getComputedStyle(v).direction==="rtl"&&(gt(L(),m.rtl),l.isRTL=!0)},Ge=v=>{let y=ne();if(je()){M("SweetAlert2 requires document to initialize");return}let P=document.createElement("div");P.className=m.container,y&&gt(P,m["no-transition"]),It(P,Ut),P.dataset.swal2Theme=v.theme;let V=Je(v.target||"body");V.appendChild(P),v.topLayer&&(P.setAttribute("popover",""),P.showPopover()),ue(v),Te(V),Ue()},vt=(v,y)=>{v instanceof HTMLElement?y.appendChild(v):typeof v=="object"?Wt(v,y):v&&It(y,v)},Wt=(v,y)=>{"jquery"in v?st(y,v):It(y,v.toString())},st=(v,y)=>{if(v.textContent="",0 in y)for(let P=0;P in y;P++)v.appendChild(y[P].cloneNode(!0));else v.appendChild(y.cloneNode(!0))},Xi=(v,y)=>{let P=xn(),V=wn();!P||!V||(!y.showConfirmButton&&!y.showDenyButton&&!y.showCancelButton?ge(P):te(P),un(P,y,"actions"),$t(P,V,y),It(V,y.loaderHtml||""),un(V,y,"loader"))};function $t(v,y,P){let V=Be(),se=Et(),Ve=Xe();!V||!se||!Ve||(ao(V,"confirm",P),ao(se,"deny",P),ao(Ve,"cancel",P),Es(V,se,Ve,P),P.reverseButtons&&(P.toast?(v.insertBefore(Ve,V),v.insertBefore(se,V)):(v.insertBefore(Ve,y),v.insertBefore(se,y),v.insertBefore(V,y))))}function Es(v,y,P,V){if(!V.buttonsStyling){Qe([v,y,P],m.styled);return}gt([v,y,P],m.styled),V.confirmButtonColor&&v.style.setProperty("--swal2-confirm-button-background-color",V.confirmButtonColor),V.denyButtonColor&&y.style.setProperty("--swal2-deny-button-background-color",V.denyButtonColor),V.cancelButtonColor&&P.style.setProperty("--swal2-cancel-button-background-color",V.cancelButtonColor),sa(v),sa(y),sa(P)}function sa(v){let y=window.getComputedStyle(v);if(y.getPropertyValue("--swal2-action-button-focus-box-shadow"))return;let P=y.backgroundColor.replace(/rgba?\((\d+), (\d+), (\d+).*/,"rgba($1, $2, $3, 0.5)");v.style.setProperty("--swal2-action-button-focus-box-shadow",y.getPropertyValue("--swal2-outline").replace(/ rgba\(.*/,` ${P}`))}function ao(v,y,P){let V=O(y);ct(v,P[`show${V}Button`],"inline-block"),It(v,P[`${y}ButtonText`]||""),v.setAttribute("aria-label",P[`${y}ButtonAriaLabel`]||""),v.className=m[y],un(v,P,`${y}Button`)}let vi=(v,y)=>{let P=rt();P&&(It(P,y.closeButtonHtml||""),un(P,y,"closeButton"),ct(P,y.showCloseButton),P.setAttribute("aria-label",y.closeButtonAriaLabel||""))},xr=(v,y)=>{let P=L();P&&(or(P,y.backdrop),In(P,y.position),ji(P,y.grow),un(P,y,"container"))};function or(v,y){typeof y=="string"?v.style.background=y:y||gt([document.documentElement,document.body],m["no-backdrop"])}function In(v,y){y&&(y in m?gt(v,m[y]):(T('The "position" parameter is not valid, defaulting to "center"'),gt(v,m.center)))}function ji(v,y){y&&gt(v,m[`grow-${y}`])}var Qt={innerParams:new WeakMap,domCache:new WeakMap};let lo=["input","file","range","select","radio","checkbox","textarea"],aa=(v,y)=>{let P=re();if(!P)return;let V=Qt.innerParams.get(v),se=!V||y.input!==V.input;lo.forEach(Ve=>{let Ot=W(P,m[Ve]);Ot&&(sl(Ve,y.inputAttributes),Ot.className=m[Ve],se&&ge(Ot))}),y.input&&(se&&xu(y),bu(y))},xu=v=>{if(!v.input)return;if(!Zn[v.input]){M(`Unexpected type of input! Expected ${Object.keys(Zn).join(" | ")}, got "${v.input}"`);return}let y=al(v.input);if(!y)return;let P=Zn[v.input](y,v);te(y),v.inputAutoFocus&&setTimeout(()=>{cn(P)})},uo=v=>{for(let y=0;y<v.attributes.length;y++){let P=v.attributes[y].name;["id","type","value","style"].includes(P)||v.removeAttribute(P)}},sl=(v,y)=>{let P=re();if(!P)return;let V=Q(P,v);if(V){uo(V);for(let se in y)V.setAttribute(se,y[se])}},bu=v=>{if(!v.input)return;let y=al(v.input);y&&un(y,v,"input")},co=(v,y)=>{!v.placeholder&&y.inputPlaceholder&&(v.placeholder=y.inputPlaceholder)},Hr=(v,y,P)=>{if(P.inputLabel){let V=document.createElement("label"),se=m["input-label"];V.setAttribute("for",v.id),V.className=se,typeof P.customClass=="object"&&gt(V,P.customClass.inputLabel),V.innerText=P.inputLabel,y.insertAdjacentElement("beforebegin",V)}},al=v=>{let y=re();if(y)return W(y,m[v]||m.input)},la=(v,y)=>{["string","number"].includes(typeof y)?v.value=`${y}`:oe(y)||T(`Unexpected type of inputValue! Expected "string", "number" or "Promise", got "${typeof y}"`)},Zn={};Zn.text=Zn.email=Zn.password=Zn.number=Zn.tel=Zn.url=Zn.search=Zn.date=Zn["datetime-local"]=Zn.time=Zn.week=Zn.month=(v,y)=>{let P=v;return la(P,y.inputValue),Hr(P,P,y),co(P,y),P.type=y.input,P},Zn.file=(v,y)=>{let P=v;return Hr(P,P,y),co(P,y),P},Zn.range=(v,y)=>{let P=v,V=P.querySelector("input"),se=P.querySelector("output");return V&&(la(V,y.inputValue),V.type=y.input,Hr(V,v,y)),se&&la(se,y.inputValue),v},Zn.select=(v,y)=>{let P=v;if(P.textContent="",y.inputPlaceholder){let V=document.createElement("option");It(V,y.inputPlaceholder),V.value="",V.disabled=!0,V.selected=!0,P.appendChild(V)}return Hr(P,P,y),P},Zn.radio=v=>{let y=v;return y.textContent="",v},Zn.checkbox=(v,y)=>{let P=re();if(!P)throw new Error("Popup not found");let V=Q(P,"checkbox");if(!V)throw new Error("Checkbox input not found");V.value="1",V.checked=!!y.inputValue;let Ve=v.querySelector("span");if(Ve){let Ot=y.inputPlaceholder||y.inputLabel;Ot&&It(Ve,Ot)}return V},Zn.textarea=(v,y)=>{let P=v;la(P,y.inputValue),co(P,y),Hr(P,P,y);let V=se=>parseInt(window.getComputedStyle(se).marginLeft)+parseInt(window.getComputedStyle(se).marginRight);return setTimeout(()=>{if("MutationObserver"in window){let se=re();if(!se)return;let Ve=parseInt(window.getComputedStyle(se).width),Ot=()=>{if(!document.body.contains(P))return;let ln=P.offsetWidth+V(P),On=re();On&&(ln>Ve?On.style.width=`${ln}px`:k(On,"width",y.width))};new MutationObserver(Ot).observe(P,{attributes:!0,attributeFilter:["style"]})}}),P};let Ed=(v,y)=>{let P=xe();P&&(Ae(P),un(P,y,"htmlContainer"),y.html?(vt(y.html,P),te(P,"block")):y.text?(P.textContent=y.text,te(P,"block")):ge(P),aa(v,y))},N=(v,y)=>{let P=Se();P&&(Ae(P),ct(P,!!y.footer,"block"),y.footer&&vt(y.footer,P),un(P,y,"footer"))},ie=(v,y)=>{let P=Qt.innerParams.get(v),V=ce();if(!V)return;if(P&&y.icon===P.icon){nt(V,y),pe(V,y);return}if(!y.icon&&!y.iconHtml){ge(V);return}if(y.icon&&Object.keys(C).indexOf(y.icon)===-1){M(`Unknown icon! Expected "success", "error", "warning", "info" or "question", got "${y.icon}"`),ge(V);return}te(V),nt(V,y),pe(V,y),gt(V,y.showClass&&y.showClass.icon),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",fe)},pe=(v,y)=>{for(let[P,V]of Object.entries(C))y.icon!==P&&Qe(v,V);gt(v,y.icon&&C[y.icon]),Ze(v,y),fe(),un(v,y,"icon")},fe=()=>{let v=re();if(!v)return;let y=window.getComputedStyle(v).getPropertyValue("background-color"),P=v.querySelectorAll("[class^=swal2-success-circular-line], .swal2-success-fix");for(let V=0;V<P.length;V++)P[V].style.backgroundColor=y},le=v=>`
  ${v.animation?'<div class="swal2-success-circular-line-left"></div>':""}
  <span class="swal2-success-line-tip"></span> <span class="swal2-success-line-long"></span>
  <div class="swal2-success-ring"></div>
  ${v.animation?'<div class="swal2-success-fix"></div>':""}
  ${v.animation?'<div class="swal2-success-circular-line-right"></div>':""}
`,Ye=`
  <span class="swal2-x-mark">
    <span class="swal2-x-mark-line-left"></span>
    <span class="swal2-x-mark-line-right"></span>
  </span>
`,nt=(v,y)=>{if(!y.icon&&!y.iconHtml)return;let P=v.innerHTML,V="";y.iconHtml?V=at(y.iconHtml):y.icon==="success"?(V=le(y),P=P.replace(/ style=".*?"/g,"")):y.icon==="error"?V=Ye:y.icon&&(V=at({question:"?",warning:"!",info:"i"}[y.icon])),P.trim()!==V.trim()&&It(v,V)},Ze=(v,y)=>{if(y.iconColor){v.style.color=y.iconColor,v.style.borderColor=y.iconColor;for(let P of[".swal2-success-line-tip",".swal2-success-line-long",".swal2-x-mark-line-left",".swal2-x-mark-line-right"])de(v,P,"background-color",y.iconColor);de(v,".swal2-success-ring","border-color",y.iconColor)}},at=v=>`<div class="${m["icon-content"]}">${v}</div>`,mt=(v,y)=>{let P=me();if(P){if(!y.imageUrl){ge(P);return}te(P,""),P.setAttribute("src",y.imageUrl),P.setAttribute("alt",y.imageAlt||""),k(P,"width",y.imageWidth),k(P,"height",y.imageHeight),P.className=m.image,un(P,y,"image")}},Ct=!1,yt=0,Rt=0,bn=0,Bn=0,zn=v=>{v.addEventListener("mousedown",_t),document.body.addEventListener("mousemove",Yt),v.addEventListener("mouseup",Vt),v.addEventListener("touchstart",_t),document.body.addEventListener("touchmove",Yt),v.addEventListener("touchend",Vt)},Sn=v=>{v.removeEventListener("mousedown",_t),document.body.removeEventListener("mousemove",Yt),v.removeEventListener("mouseup",Vt),v.removeEventListener("touchstart",_t),document.body.removeEventListener("touchmove",Yt),v.removeEventListener("touchend",Vt)},_t=v=>{let y=re();if(!y)return;let P=ce();if(v.target===y||P&&P.contains(v.target)){Ct=!0;let V=Oi(v);yt=V.clientX,Rt=V.clientY,bn=parseInt(y.style.insetInlineStart)||0,Bn=parseInt(y.style.insetBlockStart)||0,gt(y,"swal2-dragging")}},Yt=v=>{let y=re();if(y&&Ct){let{clientX:P,clientY:V}=Oi(v),se=P-yt;y.style.insetInlineStart=`${bn+(l.isRTL?-se:se)}px`,y.style.insetBlockStart=`${Bn+(V-Rt)}px`}},Vt=()=>{let v=re();Ct=!1,Qe(v,"swal2-dragging")},Oi=v=>{let y=0,P=0;return v.type.startsWith("mouse")?(y=v.clientX,P=v.clientY):v.type.startsWith("touch")&&(y=v.touches[0].clientX,P=v.touches[0].clientY),{clientX:y,clientY:P}},br=(v,y)=>{let P=L(),V=re();if(!(!P||!V)){if(y.toast){k(P,"width",y.width),V.style.width="100%";let se=wn();se&&V.insertBefore(se,ce())}else k(V,"width",y.width);k(V,"padding",y.padding),y.color&&(V.style.color=y.color),y.background&&(V.style.background=y.background),ge(qe()),Jn(V,y),y.draggable&&!y.toast?(gt(V,m.draggable),zn(V)):(Qe(V,m.draggable),Sn(V))}},Jn=(v,y)=>{let P=y.showClass||{};v.className=`${m.popup} ${ke(v)?P.popup:""}`,y.toast?(gt([document.documentElement,document.body],m["toast-shown"]),gt(v,m.toast)):gt(v,m.modal),un(v,y,"popup"),typeof y.customClass=="string"&&gt(v,y.customClass),y.icon&&gt(v,m[`icon-${y.icon}`])},ws=(v,y)=>{let P=Me();if(!P)return;let{progressSteps:V,currentProgressStep:se}=y;if(!V||V.length===0||se===void 0){ge(P);return}te(P),P.textContent="",se>=V.length&&T("Invalid currentProgressStep parameter, it should be less than progressSteps.length (currentProgressStep like JS arrays starts from 0)"),V.forEach((Ve,Ot)=>{let ln=Dn(Ve);if(P.appendChild(ln),Ot===se&&gt(ln,m["active-progress-step"]),Ot!==V.length-1){let On=Bi(y);P.appendChild(On)}})},Dn=v=>{let y=document.createElement("li");return gt(y,m["progress-step"]),It(y,v),y},Bi=v=>{let y=document.createElement("li");return gt(y,m["progress-step-line"]),v.progressStepsDistance&&k(y,"width",v.progressStepsDistance),y},Zi=(v,y)=>{let P=Ee();P&&(Ae(P),ct(P,!!(y.title||y.titleText),"block"),y.title&&vt(y.title,P),y.titleText&&(P.innerText=y.titleText),un(P,y,"title"))},yi=(v,y)=>{var P;br(v,y),xr(v,y),ws(v,y),ie(v,y),mt(v,y),Zi(v,y),vi(v,y),Ed(v,y),Xi(v,y),N(v,y);let V=re();typeof y.didRender=="function"&&V&&y.didRender(V),(P=l.eventEmitter)===null||P===void 0||P.emit("didRender",V)},Vi=()=>ke(re()),ua=()=>{var v;return(v=Be())===null||v===void 0?void 0:v.click()},Ao=()=>{var v;return(v=Et())===null||v===void 0?void 0:v.click()},wd=()=>{var v;return(v=Xe())===null||v===void 0?void 0:v.click()},ca=Object.freeze({cancel:"cancel",backdrop:"backdrop",close:"close",esc:"esc",timer:"timer"}),Sd=v=>{if(v.keydownTarget&&v.keydownHandlerAdded&&v.keydownHandler){let y=v.keydownHandler;v.keydownTarget.removeEventListener("keydown",y,{capture:v.keydownListenerCapture}),v.keydownHandlerAdded=!1}},Q1=(v,y,P)=>{if(Sd(v),!y.toast){let V=Ve=>t6(y,Ve,P);v.keydownHandler=V;let se=y.keydownListenerCapture?window:re();if(se){v.keydownTarget=se,v.keydownListenerCapture=y.keydownListenerCapture;let Ve=V;v.keydownTarget.addEventListener("keydown",Ve,{capture:v.keydownListenerCapture}),v.keydownHandlerAdded=!0}}},Md=(v,y)=>{var P;let V=ft();if(V.length){v=v+y,v===-2&&(v=V.length-1),v===V.length?v=0:v===-1&&(v=V.length-1),V[v].focus();return}(P=re())===null||P===void 0||P.focus()},th=["ArrowRight","ArrowDown"],e6=["ArrowLeft","ArrowUp"],t6=(v,y,P)=>{v&&(y.isComposing||y.keyCode===229||(v.stopKeydownPropagation&&y.stopPropagation(),y.key==="Enter"?n6(y,v):y.key==="Tab"?i6(y):[...th,...e6].includes(y.key)?r6(y.key):y.key==="Escape"&&o6(y,v,P)))},n6=(v,y)=>{if(!X(y.allowEnterKey))return;let P=re();if(!P||!y.input)return;let V=Q(P,y.input);if(v.target&&V&&v.target instanceof HTMLElement&&v.target.outerHTML===V.outerHTML){if(["textarea","file"].includes(y.input))return;ua(),v.preventDefault()}},i6=v=>{let y=v.target,P=ft(),V=-1;for(let se=0;se<P.length;se++)if(y===P[se]){V=se;break}v.shiftKey?Md(V,-1):Md(V,1),v.stopPropagation(),v.preventDefault()},r6=v=>{let y=xn(),P=Be(),V=Et(),se=Xe();if(!y||!P||!V||!se)return;let Ve=[P,V,se];if(document.activeElement instanceof HTMLElement&&!Ve.includes(document.activeElement))return;let Ot=th.includes(v)?"nextElementSibling":"previousElementSibling",ln=document.activeElement;if(ln){for(let On=0;On<y.children.length;On++){if(ln=ln[Ot],!ln)return;if(ln instanceof HTMLButtonElement&&ke(ln))break}ln instanceof HTMLButtonElement&&ln.focus()}},o6=(v,y,P)=>{v.preventDefault(),X(y.allowEscapeKey)&&P(ca.esc)};var da={swalPromiseResolve:new WeakMap,swalPromiseReject:new WeakMap};let s6=()=>{let v=L();Array.from(document.body.children).forEach(P=>{P.contains(v)||(P.hasAttribute("aria-hidden")&&P.setAttribute("data-previous-aria-hidden",P.getAttribute("aria-hidden")||""),P.setAttribute("aria-hidden","true"))})},nh=()=>{Array.from(document.body.children).forEach(y=>{y.hasAttribute("data-previous-aria-hidden")?(y.setAttribute("aria-hidden",y.getAttribute("data-previous-aria-hidden")||""),y.removeAttribute("data-previous-aria-hidden")):y.removeAttribute("aria-hidden")})},ih=typeof window<"u"&&!!window.GestureEvent,a6=()=>{if(ih&&!Kt(document.body,m.iosfix)){let v=document.body.scrollTop;document.body.style.top=`${v*-1}px`,gt(document.body,m.iosfix),l6()}},l6=()=>{let v=L();if(!v)return;let y;v.ontouchstart=P=>{y=Ad(P)},v.ontouchmove=P=>{y&&(P.preventDefault(),P.stopPropagation())}},Ad=v=>{let y=v.target,P=L(),V=xe();return!P||!V||Td(v)||u6(v)?!1:y===P||!xt(P)&&y instanceof HTMLElement&&!Fe(y,V)&&y.tagName!=="INPUT"&&y.tagName!=="TEXTAREA"&&!(xt(V)&&V.contains(y))},Td=v=>!!(v.touches&&v.touches.length&&v.touches[0].touchType==="stylus"),u6=v=>v.touches&&v.touches.length>1,rh=()=>{if(Kt(document.body,m.iosfix)){let v=parseInt(document.body.style.top,10);Qe(document.body,m.iosfix),document.body.style.top="",document.body.scrollTop=v*-1}},oh=()=>{let v=document.createElement("div");v.className=m["scrollbar-measure"],document.body.appendChild(v);let y=v.getBoundingClientRect().width-v.clientWidth;return document.body.removeChild(v),y},fa=null,c6=v=>{fa===null&&(document.body.scrollHeight>window.innerHeight||v==="scroll")&&(fa=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right")),document.body.style.paddingRight=`${fa+oh()}px`)},d6=()=>{fa!==null&&(document.body.style.paddingRight=`${fa}px`,fa=null)};function sh(v,y,P,V){Xn()?cl(v,V):(f(P).then(()=>cl(v,V)),Sd(l)),ih?(y.setAttribute("style","display:none !important"),y.removeAttribute("class"),y.innerHTML=""):y.remove(),tn()&&(d6(),rh(),nh()),ah()}function ah(){Qe([document.documentElement,document.body],[m.shown,m["height-auto"],m["no-backdrop"],m["toast-shown"]])}function Cn(v){v=lh(v);let y=da.swalPromiseResolve.get(this),P=ll(this);this.isAwaitingPromise?v.isDismissed||(ul(this),y(v)):P&&y(v)}let ll=v=>{let y=re();if(!y)return!1;let P=Qt.innerParams.get(v);if(!P||Kt(y,P.hideClass.popup))return!1;Qe(y,P.showClass.popup),gt(y,P.hideClass.popup);let V=L();return Qe(V,P.showClass.backdrop),gt(V,P.hideClass.backdrop),f6(v,y,P),!0};function ha(v){let y=da.swalPromiseReject.get(this);ul(this),y&&y(v)}let ul=v=>{v.isAwaitingPromise&&(delete v.isAwaitingPromise,Qt.innerParams.get(v)||v._destroy())},lh=v=>typeof v>"u"?{isConfirmed:!1,isDenied:!1,isDismissed:!0}:Object.assign({isConfirmed:!1,isDenied:!1,isDismissed:!1},v),f6=(v,y,P)=>{var V;let se=L(),Ve=He(y);typeof P.willClose=="function"&&P.willClose(y),(V=l.eventEmitter)===null||V===void 0||V.emit("willClose",y),Ve&&se?h6(v,y,se,!!P.returnFocus,P.didClose):se&&sh(v,se,!!P.returnFocus,P.didClose)},h6=(v,y,P,V,se)=>{l.swalCloseEventFinishedCallback=sh.bind(null,v,P,V,se);let Ve=function(Ot){if(Ot.target===y){var ln;(ln=l.swalCloseEventFinishedCallback)===null||ln===void 0||ln.call(l),delete l.swalCloseEventFinishedCallback,y.removeEventListener("animationend",Ve),y.removeEventListener("transitionend",Ve)}};y.addEventListener("animationend",Ve),y.addEventListener("transitionend",Ve)},cl=(v,y)=>{setTimeout(()=>{var P;typeof y=="function"&&y.bind(v.params)(),(P=l.eventEmitter)===null||P===void 0||P.emit("didClose"),v._destroy&&v._destroy()})},sr=v=>{let y=re();if(y||new Iu,y=re(),!y)return;let P=wn();Xn()?ge(ce()):Dd(y,v),te(P),y.setAttribute("data-loading","true"),y.setAttribute("aria-busy","true"),y.focus()},Dd=(v,y)=>{let P=xn(),V=wn();!P||!V||(!y&&ke(Be())&&(y=Be()),te(P),y&&(ge(y),V.setAttribute("data-button-to-replace",y.className),P.insertBefore(V,y)),gt([v,P],m.loading))},p6=(v,y)=>{y.input==="select"||y.input==="radio"?_6(v,y):["text","email","number","tel","textarea"].some(P=>P===y.input)&&(Z(y.inputValue)||oe(y.inputValue))&&(sr(Be()),v6(v,y))},To=(v,y)=>{let P=v.getInput();if(!P)return null;switch(y.input){case"checkbox":return m6(P);case"radio":return Pd(P);case"file":return g6(P);default:return y.inputAutoTrim?P.value.trim():P.value}},m6=v=>v.checked?1:0,Pd=v=>v.checked?v.value:null,g6=v=>v.files&&v.files.length?v.getAttribute("multiple")!==null?v.files:v.files[0]:null,_6=(v,y)=>{let P=re();if(!P)return;let V=se=>{y.input==="select"?Cu(P,Eu(se),y):y.input==="radio"&&Id(P,Eu(se),y)};Z(y.inputOptions)||oe(y.inputOptions)?(sr(Be()),J(y.inputOptions).then(se=>{v.hideLoading(),V(se)})):typeof y.inputOptions=="object"?V(y.inputOptions):M(`Unexpected type of inputOptions! Expected object, Map or Promise, got ${typeof y.inputOptions}`)},v6=(v,y)=>{let P=v.getInput();P&&(ge(P),J(y.inputValue).then(V=>{P.value=y.input==="number"?`${parseFloat(V)||0}`:`${V}`,te(P),P.focus(),v.hideLoading()}).catch(V=>{M(`Error in inputValue promise: ${V}`),P.value="",te(P),P.focus(),v.hideLoading()}))};function Cu(v,y,P){let V=W(v,m.select);if(!V)return;let se=(Ve,Ot,ln)=>{let On=document.createElement("option");On.value=ln,It(On,Ot),On.selected=uh(ln,P.inputValue),Ve.appendChild(On)};y.forEach(Ve=>{let Ot=Ve[0],ln=Ve[1];if(Array.isArray(ln)){let On=document.createElement("optgroup");On.label=Ot,On.disabled=!1,V.appendChild(On),ln.forEach(ga=>se(On,ga[1],ga[0]))}else se(V,ln,Ot)}),V.focus()}function Id(v,y,P){let V=W(v,m.radio);if(!V)return;y.forEach(Ve=>{let Ot=Ve[0],ln=Ve[1],On=document.createElement("input"),ga=document.createElement("label");On.type="radio",On.name=m.radio,On.value=Ot,uh(Ot,P.inputValue)&&(On.checked=!0);let Wd=document.createElement("span");It(Wd,ln),Wd.className=m.label,ga.appendChild(On),ga.appendChild(Wd),V.appendChild(ga)});let se=V.querySelectorAll("input");se.length&&se[0].focus()}let Eu=v=>{let y=[];return v instanceof Map?v.forEach((P,V)=>{let se=P;typeof se=="object"&&(se=Eu(se)),y.push([V,se])}):Object.keys(v).forEach(P=>{let V=v[P];typeof V=="object"&&(V=Eu(V)),y.push([P,V])}),y},uh=(v,y)=>!!y&&y!==null&&y!==void 0&&y.toString()===v.toString(),y6=v=>{let y=Qt.innerParams.get(v);v.disableButtons(),y.input?dh(v,"confirm"):Rd(v,!0)},ch=v=>{let y=Qt.innerParams.get(v);v.disableButtons(),y.returnInputValueOnDeny?dh(v,"deny"):Od(v,!1)},x6=(v,y)=>{v.disableButtons(),y(ca.cancel)},dh=(v,y)=>{let P=Qt.innerParams.get(v);if(!P.input){M(`The "input" parameter is needed to be set when using returnInputValueOn${O(y)}`);return}let V=v.getInput(),se=To(v,P);P.inputValidator?b6(v,se,y):V&&!V.checkValidity()?(v.enableButtons(),v.showValidationMessage(P.validationMessage||V.validationMessage)):y==="deny"?Od(v,se):Rd(v,se)},b6=(v,y,P)=>{let V=Qt.innerParams.get(v);v.disableInput(),Promise.resolve().then(()=>J(V.inputValidator(y,V.validationMessage))).then(Ve=>{v.enableButtons(),v.enableInput(),Ve?v.showValidationMessage(Ve):P==="deny"?Od(v,y):Rd(v,y)})},Od=(v,y)=>{let P=Qt.innerParams.get(v);P.showLoaderOnDeny&&sr(Et()),P.preDeny?(v.isAwaitingPromise=!0,Promise.resolve().then(()=>J(P.preDeny(y,P.validationMessage))).then(se=>{se===!1?(v.hideLoading(),ul(v)):v.close({isDenied:!0,value:typeof se>"u"?y:se})}).catch(se=>Fd(v,se))):v.close({isDenied:!0,value:y})},fh=(v,y)=>{v.close({isConfirmed:!0,value:y})},Fd=(v,y)=>{v.rejectPromise(y)},Rd=(v,y)=>{let P=Qt.innerParams.get(v);P.showLoaderOnConfirm&&sr(),P.preConfirm?(v.resetValidationMessage(),v.isAwaitingPromise=!0,Promise.resolve().then(()=>J(P.preConfirm(y,P.validationMessage))).then(se=>{ke(qe())||se===!1?(v.hideLoading(),ul(v)):fh(v,typeof se>"u"?y:se)}).catch(se=>Fd(v,se))):fh(v,y)};function Do(){let v=Qt.innerParams.get(this);if(!v)return;let y=Qt.domCache.get(this);ge(y.loader),Xn()?v.icon&&te(ce()):C6(y),Qe([y.popup,y.actions],m.loading),y.popup.removeAttribute("aria-busy"),y.popup.removeAttribute("data-loading"),y.confirmButton.disabled=!1,y.denyButton.disabled=!1,y.cancelButton.disabled=!1}let C6=v=>{let y=v.loader.getAttribute("data-button-to-replace"),P=y?v.popup.getElementsByClassName(y):[];P.length?te(P[0],"inline-block"):dt()&&ge(v.actions)};function wu(){let v=Qt.innerParams.get(this),y=Qt.domCache.get(this);return y?Q(y.popup,v.input):null}function hh(v,y,P){let V=Qt.domCache.get(v);y.forEach(se=>{V[se].disabled=P})}function Su(v,y){let P=re();if(!(!P||!v))if(v.type==="radio"){let V=P.querySelectorAll(`[name="${m.radio}"]`);for(let se=0;se<V.length;se++)V[se].disabled=y}else v.disabled=y}function ph(){hh(this,["confirmButton","denyButton","cancelButton"],!1)}function mh(){hh(this,["confirmButton","denyButton","cancelButton"],!0)}function gh(){Su(this.getInput(),!1)}function _h(){Su(this.getInput(),!0)}function kd(v){let y=Qt.domCache.get(this),P=Qt.innerParams.get(this);It(y.validationMessage,v),y.validationMessage.className=m["validation-message"],P.customClass&&P.customClass.validationMessage&&gt(y.validationMessage,P.customClass.validationMessage),te(y.validationMessage);let V=this.getInput();V&&(V.setAttribute("aria-invalid","true"),V.setAttribute("aria-describedby",m["validation-message"]),cn(V),gt(V,m.inputerror))}function vh(){let v=Qt.domCache.get(this);v.validationMessage&&ge(v.validationMessage);let y=this.getInput();y&&(y.removeAttribute("aria-invalid"),y.removeAttribute("aria-describedby"),Qe(y,m.inputerror))}let Po={title:"",titleText:"",text:"",html:"",footer:"",icon:void 0,iconColor:void 0,iconHtml:void 0,template:void 0,toast:!1,draggable:!1,animation:!0,theme:"light",showClass:{popup:"swal2-show",backdrop:"swal2-backdrop-show",icon:"swal2-icon-show"},hideClass:{popup:"swal2-hide",backdrop:"swal2-backdrop-hide",icon:"swal2-icon-hide"},customClass:{},target:"body",color:void 0,backdrop:!0,heightAuto:!0,allowOutsideClick:!0,allowEscapeKey:!0,allowEnterKey:!0,stopKeydownPropagation:!0,keydownListenerCapture:!1,showConfirmButton:!0,showDenyButton:!1,showCancelButton:!1,preConfirm:void 0,preDeny:void 0,confirmButtonText:"OK",confirmButtonAriaLabel:"",confirmButtonColor:void 0,denyButtonText:"No",denyButtonAriaLabel:"",denyButtonColor:void 0,cancelButtonText:"Cancel",cancelButtonAriaLabel:"",cancelButtonColor:void 0,buttonsStyling:!0,reverseButtons:!1,focusConfirm:!0,focusDeny:!1,focusCancel:!1,returnFocus:!0,showCloseButton:!1,closeButtonHtml:"&times;",closeButtonAriaLabel:"Close this dialog",loaderHtml:"",showLoaderOnConfirm:!1,showLoaderOnDeny:!1,imageUrl:void 0,imageWidth:void 0,imageHeight:void 0,imageAlt:"",timer:void 0,timerProgressBar:!1,width:void 0,padding:void 0,background:void 0,input:void 0,inputPlaceholder:"",inputLabel:"",inputValue:"",inputOptions:{},inputAutoFocus:!0,inputAutoTrim:!0,inputAttributes:{},inputValidator:void 0,returnInputValueOnDeny:!1,validationMessage:void 0,grow:!1,position:"center",progressSteps:[],currentProgressStep:void 0,progressStepsDistance:void 0,willOpen:void 0,didOpen:void 0,didRender:void 0,willClose:void 0,didClose:void 0,didDestroy:void 0,scrollbarPadding:!0,topLayer:!1},Vn=["allowEscapeKey","allowOutsideClick","background","buttonsStyling","cancelButtonAriaLabel","cancelButtonColor","cancelButtonText","closeButtonAriaLabel","closeButtonHtml","color","confirmButtonAriaLabel","confirmButtonColor","confirmButtonText","currentProgressStep","customClass","denyButtonAriaLabel","denyButtonColor","denyButtonText","didClose","didDestroy","draggable","footer","hideClass","html","icon","iconColor","iconHtml","imageAlt","imageHeight","imageUrl","imageWidth","preConfirm","preDeny","progressSteps","returnFocus","reverseButtons","showCancelButton","showCloseButton","showConfirmButton","showDenyButton","text","title","titleText","theme","willClose"],E6={allowEnterKey:void 0},w6=["allowOutsideClick","allowEnterKey","backdrop","draggable","focusConfirm","focusDeny","focusCancel","returnFocus","heightAuto","keydownListenerCapture"],Nd=v=>Object.prototype.hasOwnProperty.call(Po,v),yh=v=>Vn.indexOf(v)!==-1,xh=v=>E6[v],S6=v=>{Nd(v)||T(`Unknown parameter "${v}"`)},dl=v=>{w6.includes(v)&&T(`The parameter "${v}" is incompatible with toasts`)},M6=v=>{let y=xh(v);y&&q(v,y)},bh=v=>{v.backdrop===!1&&v.allowOutsideClick&&T('"allowOutsideClick" parameter requires `backdrop` parameter to be set to `true`'),v.theme&&!["light","dark","auto","minimal","borderless","bootstrap-4","bootstrap-4-light","bootstrap-4-dark","bootstrap-5","bootstrap-5-light","bootstrap-5-dark","material-ui","material-ui-light","material-ui-dark","embed-iframe","bulma","bulma-light","bulma-dark"].includes(v.theme)&&T(`Invalid theme "${v.theme}"`);for(let y in v)S6(y),v.toast&&dl(y),M6(y)};function Ch(v){let y=L(),P=re(),V=Qt.innerParams.get(this);if(!P||Kt(P,V.hideClass.popup)){T("You're trying to update the closed or closing popup, that won't work. Use the update() method in preConfirm parameter or show a new popup.");return}let se=Mu(v),Ve=Object.assign({},V,se);bh(Ve),y&&(y.dataset.swal2Theme=Ve.theme),yi(this,Ve),Qt.innerParams.set(this,Ve),Object.defineProperties(this,{params:{value:Object.assign({},this.params,v),writable:!1,enumerable:!0}})}let Mu=v=>{let y={};return Object.keys(v).forEach(P=>{if(yh(P)){let V=v;y[P]=V[P]}else T(`Invalid parameter to update: ${P}`)}),y};function fl(){var v;let y=Qt.domCache.get(this),P=Qt.innerParams.get(this);if(!P){Eh(this);return}y.popup&&l.swalCloseEventFinishedCallback&&(l.swalCloseEventFinishedCallback(),delete l.swalCloseEventFinishedCallback),typeof P.didDestroy=="function"&&P.didDestroy(),(v=l.eventEmitter)===null||v===void 0||v.emit("didDestroy"),Ud(this)}let Ud=v=>{Eh(v),delete v.params,delete l.keydownHandler,delete l.keydownTarget,delete l.currentInstance},Eh=v=>{v.isAwaitingPromise?(Au(Qt,v),v.isAwaitingPromise=!0):(Au(da,v),Au(Qt,v),delete v.isAwaitingPromise,delete v.disableButtons,delete v.enableButtons,delete v.getInput,delete v.disableInput,delete v.enableInput,delete v.hideLoading,delete v.disableLoading,delete v.showValidationMessage,delete v.resetValidationMessage,delete v.close,delete v.closePopup,delete v.closeModal,delete v.closeToast,delete v.rejectPromise,delete v.update,delete v._destroy)},Au=(v,y)=>{for(let P in v)v[P].delete(y)};var A6=Object.freeze({__proto__:null,_destroy:fl,close:Cn,closeModal:Cn,closePopup:Cn,closeToast:Cn,disableButtons:mh,disableInput:_h,disableLoading:Do,enableButtons:ph,enableInput:gh,getInput:wu,handleAwaitingPromise:ul,hideLoading:Do,rejectPromise:ha,resetValidationMessage:vh,showValidationMessage:kd,update:Ch});let Ld=(v,y,P)=>{v.toast?Bd(v,y,P):(T6(y),D6(y),P6(v,y,P))},Bd=(v,y,P)=>{y.popup.onclick=()=>{v&&(Vd(v)||v.timer||v.input)||P(ca.close)}},Vd=v=>!!(v.showConfirmButton||v.showDenyButton||v.showCancelButton||v.showCloseButton),Tu=!1,T6=v=>{v.popup.onmousedown=()=>{v.container.onmouseup=function(y){v.container.onmouseup=()=>{},y.target===v.container&&(Tu=!0)}}},D6=v=>{v.container.onmousedown=y=>{y.target===v.container&&y.preventDefault(),v.popup.onmouseup=function(P){v.popup.onmouseup=()=>{},(P.target===v.popup||P.target instanceof HTMLElement&&v.popup.contains(P.target))&&(Tu=!0)}}},P6=(v,y,P)=>{y.container.onclick=V=>{if(Tu){Tu=!1;return}V.target===y.container&&X(v.allowOutsideClick)&&P(ca.backdrop)}},I6=v=>typeof v=="object"&&v.jquery,wh=v=>v instanceof Element||I6(v),O6=v=>{let y={};return typeof v[0]=="object"&&!wh(v[0])?Object.assign(y,v[0]):["title","html","icon"].forEach((P,V)=>{let se=v[V];typeof se=="string"||wh(se)?y[P]=se:se!==void 0&&M(`Unexpected type of ${P}! Expected "string" or "Element", got ${typeof se}`)}),y};function F6(...v){return new this(...v)}function R6(v){class y extends this{_main(V,se){return super._main(V,Object.assign({},v,se))}}return y}let k6=()=>l.timeout&&l.timeout.getTimerLeft(),Hd=()=>{if(l.timeout)return ht(),l.timeout.stop()},Sh=()=>{if(l.timeout){let v=l.timeout.start();return tt(v),v}},N6=()=>{let v=l.timeout;return v&&(v.running?Hd():Sh())},zr=v=>{if(l.timeout){let y=l.timeout.increase(v);return tt(y,!0),y}},Ss=()=>!!(l.timeout&&l.timeout.isRunning()),zd=!1,jd={};function Mh(v="data-swal-template"){jd[v]=this,zd||(document.body.addEventListener("click",Ah),zd=!0)}let Ah=v=>{for(let y=v.target;y&&y!==document;y=y.parentNode)for(let P in jd){let V=y.getAttribute&&y.getAttribute(P);if(V){jd[P].fire({template:V});return}}};class U6{constructor(){this.events={}}_getHandlersByEventName(y){return typeof this.events[y]>"u"&&(this.events[y]=[]),this.events[y]}on(y,P){let V=this._getHandlersByEventName(y);V.includes(P)||V.push(P)}once(y,P){let V=(...se)=>{this.removeListener(y,V),P.apply(this,se)};this.on(y,V)}emit(y,...P){this._getHandlersByEventName(y).forEach(V=>{try{V.apply(this,P)}catch(se){console.error(se)}})}removeListener(y,P){let V=this._getHandlersByEventName(y),se=V.indexOf(P);se>-1&&V.splice(se,1)}removeAllListeners(y){this.events[y]!==void 0&&(this.events[y].length=0)}reset(){this.events={}}}l.eventEmitter=new U6;var B6=Object.freeze({__proto__:null,argsToParams:O6,bindClickHandler:Mh,clickCancel:wd,clickConfirm:ua,clickDeny:Ao,enableLoading:sr,fire:F6,getActions:xn,getCancelButton:Xe,getCloseButton:rt,getConfirmButton:Be,getContainer:L,getDenyButton:Et,getFocusableElements:ft,getFooter:Se,getHtmlContainer:xe,getIcon:ce,getIconContent:we,getImage:me,getInputLabel:Re,getLoader:wn,getPopup:re,getProgressSteps:Me,getTimerLeft:k6,getTimerProgressBar:De,getTitle:Ee,getValidationMessage:qe,increaseTimer:zr,isDeprecatedParameter:xh,isLoading:sn,isTimerRunning:Ss,isUpdatableParameter:yh,isValidParameter:Nd,isVisible:Vi,mixin:R6,off:(v,y)=>{if(l.eventEmitter){if(!v){l.eventEmitter.reset();return}y?l.eventEmitter.removeListener(v,y):l.eventEmitter.removeAllListeners(v)}},on:(v,y)=>{l.eventEmitter&&l.eventEmitter.on(v,y)},once:(v,y)=>{l.eventEmitter&&l.eventEmitter.once(v,y)},resumeTimer:Sh,showLoading:sr,stopTimer:Hd,toggleTimer:N6});class V6{constructor(y,P){this.callback=y,this.remaining=P,this.running=!1,this.start()}start(){return this.running||(this.running=!0,this.started=new Date,this.id=setTimeout(this.callback,this.remaining)),this.remaining}stop(){return this.started&&this.running&&(this.running=!1,clearTimeout(this.id),this.remaining-=new Date().getTime()-this.started.getTime()),this.remaining}increase(y){let P=this.running;return P&&this.stop(),this.remaining+=y,P&&this.start(),this.remaining}getTimerLeft(){return this.running&&(this.stop(),this.start()),this.remaining}isRunning(){return this.running}}let Th=["swal-title","swal-html","swal-footer"],H6=v=>{let y=typeof v.template=="string"?document.querySelector(v.template):v.template;if(!y)return{};let P=y.content;return X6(P),Object.assign(z6(P),j6(P),W6(P),G6(P),$6(P),Y6(P),q6(P,Th))},z6=v=>{let y={};return Array.from(v.querySelectorAll("swal-param")).forEach(V=>{Ms(V,["name","value"]);let se=V.getAttribute("name"),Ve=V.getAttribute("value");!se||!Ve||(se in Po&&typeof Po[se]=="boolean"?y[se]=Ve!=="false":se in Po&&typeof Po[se]=="object"?y[se]=JSON.parse(Ve):y[se]=Ve)}),y},j6=v=>{let y={};return Array.from(v.querySelectorAll("swal-function-param")).forEach(V=>{let se=V.getAttribute("name"),Ve=V.getAttribute("value");!se||!Ve||(y[se]=new Function(`return ${Ve}`)())}),y},W6=v=>{let y={};return Array.from(v.querySelectorAll("swal-button")).forEach(V=>{Ms(V,["type","color","aria-label"]);let se=V.getAttribute("type");if(!(!se||!["confirm","cancel","deny"].includes(se))){if(y[`${se}ButtonText`]=V.innerHTML,y[`show${O(se)}Button`]=!0,V.hasAttribute("color")){let Ve=V.getAttribute("color");Ve!==null&&(y[`${se}ButtonColor`]=Ve)}if(V.hasAttribute("aria-label")){let Ve=V.getAttribute("aria-label");Ve!==null&&(y[`${se}ButtonAriaLabel`]=Ve)}}}),y},G6=v=>{let y={},P=v.querySelector("swal-image");return P&&(Ms(P,["src","width","height","alt"]),P.hasAttribute("src")&&(y.imageUrl=P.getAttribute("src")||void 0),P.hasAttribute("width")&&(y.imageWidth=P.getAttribute("width")||void 0),P.hasAttribute("height")&&(y.imageHeight=P.getAttribute("height")||void 0),P.hasAttribute("alt")&&(y.imageAlt=P.getAttribute("alt")||void 0)),y},$6=v=>{let y={},P=v.querySelector("swal-icon");return P&&(Ms(P,["type","color"]),P.hasAttribute("type")&&(y.icon=P.getAttribute("type")),P.hasAttribute("color")&&(y.iconColor=P.getAttribute("color")),y.iconHtml=P.innerHTML),y},Y6=v=>{let y={},P=v.querySelector("swal-input");P&&(Ms(P,["type","label","placeholder","value"]),y.input=P.getAttribute("type")||"text",P.hasAttribute("label")&&(y.inputLabel=P.getAttribute("label")),P.hasAttribute("placeholder")&&(y.inputPlaceholder=P.getAttribute("placeholder")),P.hasAttribute("value")&&(y.inputValue=P.getAttribute("value")));let V=Array.from(v.querySelectorAll("swal-input-option"));return V.length&&(y.inputOptions={},V.forEach(se=>{Ms(se,["value"]);let Ve=se.getAttribute("value");if(!Ve)return;let Ot=se.innerHTML;y.inputOptions[Ve]=Ot})),y},q6=(v,y)=>{let P={};for(let V in y){let se=y[V],Ve=v.querySelector(se);Ve&&(Ms(Ve,[]),P[se.replace(/^swal-/,"")]=Ve.innerHTML.trim())}return P},X6=v=>{let y=Th.concat(["swal-param","swal-function-param","swal-button","swal-image","swal-icon","swal-input","swal-input-option"]);Array.from(v.children).forEach(P=>{let V=P.tagName.toLowerCase();y.includes(V)||T(`Unrecognized element <${V}>`)})},Ms=(v,y)=>{Array.from(v.attributes).forEach(P=>{y.indexOf(P.name)===-1&&T([`Unrecognized attribute "${P.name}" on <${v.tagName.toLowerCase()}>.`,`${y.length?`Allowed attributes are: ${y.join(", ")}`:"To set the value, use HTML within the element."}`])})},hl=10,Z6=v=>{var y,P;let V=L(),se=re();if(!V||!se)return;typeof v.willOpen=="function"&&v.willOpen(se),(y=l.eventEmitter)===null||y===void 0||y.emit("willOpen",se);let Ot=window.getComputedStyle(document.body).overflowY;if(Q6(V,se,v),setTimeout(()=>{J6(V,se)},hl),tn()&&(K6(V,v.scrollbarPadding!==void 0?v.scrollbarPadding:!1,Ot),s6()),!Xn()&&!l.previousActiveElement&&(l.previousActiveElement=document.activeElement),typeof v.didOpen=="function"){let ln=v.didOpen;setTimeout(()=>ln(se))}(P=l.eventEmitter)===null||P===void 0||P.emit("didOpen",se)},Du=v=>{let y=re();if(!y||v.target!==y)return;let P=L();P&&(y.removeEventListener("animationend",Du),y.removeEventListener("transitionend",Du),P.style.overflowY="auto",Qe(P,m["no-transition"]))},J6=(v,y)=>{He(y)?(v.style.overflowY="hidden",y.addEventListener("animationend",Du),y.addEventListener("transitionend",Du)):v.style.overflowY="auto"},K6=(v,y,P)=>{a6(),y&&P!=="hidden"&&c6(P),setTimeout(()=>{v.scrollTop=0})},Q6=(v,y,P)=>{var V;(V=P.showClass)!==null&&V!==void 0&&V.backdrop&&gt(v,P.showClass.backdrop),P.animation?(y.style.setProperty("opacity","0","important"),te(y,"grid"),setTimeout(()=>{var se;(se=P.showClass)!==null&&se!==void 0&&se.popup&&gt(y,P.showClass.popup),y.style.removeProperty("opacity")},hl)):te(y,"grid"),gt([document.documentElement,document.body],m.shown),P.heightAuto&&P.backdrop&&!P.toast&&gt([document.documentElement,document.body],m["height-auto"])};var Dh={email:(v,y)=>/^[a-zA-Z0-9.+_'-]+@[a-zA-Z0-9.-]+\.[a-zA-Z0-9-]+$/.test(v)?Promise.resolve():Promise.resolve(y||"Invalid email address"),url:(v,y)=>/^https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-z]{2,63}\b([-a-zA-Z0-9@:%_+.~#?&/=]*)$/.test(v)?Promise.resolve():Promise.resolve(y||"Invalid URL")};function ev(v){v.inputValidator||(v.input==="email"&&(v.inputValidator=Dh.email),v.input==="url"&&(v.inputValidator=Dh.url))}function tv(v){(!v.target||typeof v.target=="string"&&!document.querySelector(v.target)||typeof v.target!="string"&&!v.target.appendChild)&&(T('Target parameter is not valid, defaulting to "body"'),v.target="body")}function Ph(v){ev(v),v.showLoaderOnConfirm&&!v.preConfirm&&T(`showLoaderOnConfirm is set to true, but preConfirm is not defined.
showLoaderOnConfirm should be used together with preConfirm, see usage example:
https://sweetalert2.github.io/#ajax-request`),tv(v),typeof v.title=="string"&&(v.title=v.title.split(`
`).join("<br />")),Ge(v)}let jr;var pl=new WeakMap;class jn{constructor(...y){if(i(this,pl,Promise.resolve({isConfirmed:!1,isDenied:!1,isDismissed:!0})),typeof window>"u")return;jr=this;let P=Object.freeze(this.constructor.argsToParams(y));this.params=P,this.isAwaitingPromise=!1,r(pl,this,this._main(jr.params))}_main(y,P={}){if(bh(Object.assign({},P,y)),l.currentInstance){let Ve=da.swalPromiseResolve.get(l.currentInstance),{isAwaitingPromise:Ot}=l.currentInstance;l.currentInstance._destroy(),Ot||Ve({isDismissed:!0}),tn()&&nh()}l.currentInstance=jr;let V=Pu(y,P);Ph(V),Object.freeze(V),l.timeout&&(l.timeout.stop(),delete l.timeout),clearTimeout(l.restoreFocusTimeout);let se=Ih(jr);return yi(jr,V),Qt.innerParams.set(jr,V),pa(jr,se,V)}then(y){return e(pl,this).then(y)}finally(y){return e(pl,this).finally(y)}}let pa=(v,y,P)=>new Promise((V,se)=>{let Ve=Ot=>{v.close({isDismissed:!0,dismiss:Ot,isConfirmed:!1,isDenied:!1})};da.swalPromiseResolve.set(v,V),da.swalPromiseReject.set(v,se),y.confirmButton.onclick=()=>{y6(v)},y.denyButton.onclick=()=>{ch(v)},y.cancelButton.onclick=()=>{x6(v,Ve)},y.closeButton.onclick=()=>{Ve(ca.close)},Ld(P,y,Ve),Q1(l,P,Ve),p6(v,P),Z6(P),ma(l,P,Ve),Oh(y,P),setTimeout(()=>{y.container.scrollTop=0})}),Pu=(v,y)=>{let P=H6(v),V=Object.assign({},Po,y,P,v);return V.showClass=Object.assign({},Po.showClass,V.showClass),V.hideClass=Object.assign({},Po.hideClass,V.hideClass),V.animation===!1&&(V.showClass={backdrop:"swal2-noanimation"},V.hideClass={}),V},Ih=v=>{let y={popup:re(),container:L(),actions:xn(),confirmButton:Be(),denyButton:Et(),cancelButton:Xe(),loader:wn(),closeButton:rt(),validationMessage:qe(),progressSteps:Me()};return Qt.domCache.set(v,y),y},ma=(v,y,P)=>{let V=De();ge(V),y.timer&&(v.timeout=new V6(()=>{P("timer"),delete v.timeout},y.timer),y.timerProgressBar&&V&&(te(V),un(V,y,"timerProgressBar"),setTimeout(()=>{v.timeout&&v.timeout.running&&tt(y.timer)})))},Oh=(v,y)=>{if(!y.toast){if(!X(y.allowEnterKey)){q("allowEnterKey"),iv();return}Fh(v)||nv(v,y)||Md(-1,1)}},Fh=v=>{let y=Array.from(v.popup.querySelectorAll("[autofocus]"));for(let P of y)if(P instanceof HTMLElement&&ke(P))return P.focus(),!0;return!1},nv=(v,y)=>y.focusDeny&&ke(v.denyButton)?(v.denyButton.focus(),!0):y.focusCancel&&ke(v.cancelButton)?(v.cancelButton.focus(),!0):y.focusConfirm&&ke(v.confirmButton)?(v.confirmButton.focus(),!0):!1,iv=()=>{document.activeElement instanceof HTMLElement&&typeof document.activeElement.blur=="function"&&document.activeElement.blur()};jn.prototype.disableButtons=mh,jn.prototype.enableButtons=ph,jn.prototype.getInput=wu,jn.prototype.disableInput=_h,jn.prototype.enableInput=gh,jn.prototype.hideLoading=Do,jn.prototype.disableLoading=Do,jn.prototype.showValidationMessage=kd,jn.prototype.resetValidationMessage=vh,jn.prototype.close=Cn,jn.prototype.closePopup=Cn,jn.prototype.closeModal=Cn,jn.prototype.closeToast=Cn,jn.prototype.rejectPromise=ha,jn.prototype.update=Ch,jn.prototype._destroy=fl,Object.assign(jn,B6),Object.keys(A6).forEach(v=>{jn[v]=function(...y){if(jr&&jr[v])return jr[v](...y)}}),jn.DismissReason=ca,jn.version="11.26.17";let Iu=jn;return Iu.default=Iu,Iu});typeof hs<"u"&&hs.Sweetalert2&&(hs.swal=hs.sweetAlert=hs.Swal=hs.SweetAlert=hs.Sweetalert2);typeof document<"u"&&function(n,t){var e=n.createElement("style");if(n.getElementsByTagName("head")[0].appendChild(e),e.styleSheet)e.styleSheet.disabled||(e.styleSheet.cssText=t);else try{e.innerHTML=t}catch{e.innerText=t}}(document,':root{--swal2-outline: 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-container-padding: 0.625em;--swal2-backdrop: rgba(0, 0, 0, 0.4);--swal2-backdrop-transition: background-color 0.15s;--swal2-width: 32em;--swal2-padding: 0 0 1.25em;--swal2-border: none;--swal2-border-radius: 0.3125rem;--swal2-background: white;--swal2-color: #545454;--swal2-show-animation: swal2-show 0.3s;--swal2-hide-animation: swal2-hide 0.15s forwards;--swal2-icon-zoom: 1;--swal2-icon-animations: true;--swal2-title-padding: 0.8em 1em 0;--swal2-html-container-padding: 1em 1.6em 0.3em;--swal2-input-border: 1px solid #d9d9d9;--swal2-input-border-radius: 0.1875em;--swal2-input-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-background: transparent;--swal2-input-transition: border-color 0.2s, box-shadow 0.2s;--swal2-input-hover-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px transparent;--swal2-input-focus-border: 1px solid #b4dbed;--swal2-input-focus-box-shadow: inset 0 1px 1px rgba(0, 0, 0, 0.06), 0 0 0 3px rgba(100, 150, 200, 0.5);--swal2-progress-step-background: #add8e6;--swal2-validation-message-background: #f0f0f0;--swal2-validation-message-color: #666;--swal2-footer-border-color: #eee;--swal2-footer-background: transparent;--swal2-footer-color: inherit;--swal2-timer-progress-bar-background: rgba(0, 0, 0, 0.3);--swal2-close-button-position: initial;--swal2-close-button-inset: auto;--swal2-close-button-font-size: 2.5em;--swal2-close-button-color: #ccc;--swal2-close-button-transition: color 0.2s, box-shadow 0.2s;--swal2-close-button-outline: initial;--swal2-close-button-box-shadow: inset 0 0 0 3px transparent;--swal2-close-button-focus-box-shadow: inset var(--swal2-outline);--swal2-close-button-hover-transform: none;--swal2-actions-justify-content: center;--swal2-actions-width: auto;--swal2-actions-margin: 1.25em auto 0;--swal2-actions-padding: 0;--swal2-actions-border-radius: 0;--swal2-actions-background: transparent;--swal2-action-button-transition: background-color 0.2s, box-shadow 0.2s;--swal2-action-button-hover: black 10%;--swal2-action-button-active: black 10%;--swal2-confirm-button-box-shadow: none;--swal2-confirm-button-border-radius: 0.25em;--swal2-confirm-button-background-color: #7066e0;--swal2-confirm-button-color: #fff;--swal2-deny-button-box-shadow: none;--swal2-deny-button-border-radius: 0.25em;--swal2-deny-button-background-color: #dc3741;--swal2-deny-button-color: #fff;--swal2-cancel-button-box-shadow: none;--swal2-cancel-button-border-radius: 0.25em;--swal2-cancel-button-background-color: #6e7881;--swal2-cancel-button-color: #fff;--swal2-toast-show-animation: swal2-toast-show 0.5s;--swal2-toast-hide-animation: swal2-toast-hide 0.1s forwards;--swal2-toast-border: none;--swal2-toast-box-shadow: 0 0 1px hsl(0deg 0% 0% / 0.075), 0 1px 2px hsl(0deg 0% 0% / 0.075), 1px 2px 4px hsl(0deg 0% 0% / 0.075), 1px 3px 8px hsl(0deg 0% 0% / 0.075), 2px 4px 16px hsl(0deg 0% 0% / 0.075)}[data-swal2-theme=dark]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}@media(prefers-color-scheme: dark){[data-swal2-theme=auto]{--swal2-dark-theme-black: #19191a;--swal2-dark-theme-white: #e1e1e1;--swal2-background: var(--swal2-dark-theme-black);--swal2-color: var(--swal2-dark-theme-white);--swal2-footer-border-color: #555;--swal2-input-background: color-mix(in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10%);--swal2-validation-message-background: color-mix( in srgb, var(--swal2-dark-theme-black), var(--swal2-dark-theme-white) 10% );--swal2-validation-message-color: var(--swal2-dark-theme-white);--swal2-timer-progress-bar-background: rgba(255, 255, 255, 0.7)}}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow:hidden}body.swal2-height-auto{height:auto !important}body.swal2-no-backdrop .swal2-container{background-color:rgba(0,0,0,0) !important;pointer-events:none}body.swal2-no-backdrop .swal2-container .swal2-popup{pointer-events:all}body.swal2-no-backdrop .swal2-container .swal2-modal{box-shadow:0 0 10px var(--swal2-backdrop)}body.swal2-toast-shown .swal2-container{box-sizing:border-box;width:360px;max-width:100%;background-color:rgba(0,0,0,0);pointer-events:none}body.swal2-toast-shown .swal2-container.swal2-top{inset:0 auto auto 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-top-end,body.swal2-toast-shown .swal2-container.swal2-top-right{inset:0 0 auto auto}body.swal2-toast-shown .swal2-container.swal2-top-start,body.swal2-toast-shown .swal2-container.swal2-top-left{inset:0 auto auto 0}body.swal2-toast-shown .swal2-container.swal2-center-start,body.swal2-toast-shown .swal2-container.swal2-center-left{inset:50% auto auto 0;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-center{inset:50% auto auto 50%;transform:translate(-50%, -50%)}body.swal2-toast-shown .swal2-container.swal2-center-end,body.swal2-toast-shown .swal2-container.swal2-center-right{inset:50% 0 auto auto;transform:translateY(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-start,body.swal2-toast-shown .swal2-container.swal2-bottom-left{inset:auto auto 0 0}body.swal2-toast-shown .swal2-container.swal2-bottom{inset:auto auto 0 50%;transform:translateX(-50%)}body.swal2-toast-shown .swal2-container.swal2-bottom-end,body.swal2-toast-shown .swal2-container.swal2-bottom-right{inset:auto 0 0 auto}@media print{body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown){overflow-y:scroll !important}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown)>[aria-hidden=true]{display:none}body.swal2-shown:not(.swal2-no-backdrop,.swal2-toast-shown) .swal2-container{position:static !important}}div:where(.swal2-container){display:grid;position:fixed;z-index:1060;inset:0;box-sizing:border-box;grid-template-areas:"top-start     top            top-end" "center-start  center         center-end" "bottom-start  bottom-center  bottom-end";grid-template-rows:minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);height:100%;padding:var(--swal2-container-padding);overflow-x:hidden;transition:var(--swal2-backdrop-transition);-webkit-overflow-scrolling:touch}div:where(.swal2-container).swal2-backdrop-show,div:where(.swal2-container).swal2-noanimation{background:var(--swal2-backdrop)}div:where(.swal2-container).swal2-backdrop-hide{background:rgba(0,0,0,0) !important}div:where(.swal2-container).swal2-top-start,div:where(.swal2-container).swal2-center-start,div:where(.swal2-container).swal2-bottom-start{grid-template-columns:minmax(0, 1fr) auto auto}div:where(.swal2-container).swal2-top,div:where(.swal2-container).swal2-center,div:where(.swal2-container).swal2-bottom{grid-template-columns:auto minmax(0, 1fr) auto}div:where(.swal2-container).swal2-top-end,div:where(.swal2-container).swal2-center-end,div:where(.swal2-container).swal2-bottom-end{grid-template-columns:auto auto minmax(0, 1fr)}div:where(.swal2-container).swal2-top-start>.swal2-popup{align-self:start}div:where(.swal2-container).swal2-top>.swal2-popup{grid-column:2;place-self:start center}div:where(.swal2-container).swal2-top-end>.swal2-popup,div:where(.swal2-container).swal2-top-right>.swal2-popup{grid-column:3;place-self:start end}div:where(.swal2-container).swal2-center-start>.swal2-popup,div:where(.swal2-container).swal2-center-left>.swal2-popup{grid-row:2;align-self:center}div:where(.swal2-container).swal2-center>.swal2-popup{grid-column:2;grid-row:2;place-self:center center}div:where(.swal2-container).swal2-center-end>.swal2-popup,div:where(.swal2-container).swal2-center-right>.swal2-popup{grid-column:3;grid-row:2;place-self:center end}div:where(.swal2-container).swal2-bottom-start>.swal2-popup,div:where(.swal2-container).swal2-bottom-left>.swal2-popup{grid-column:1;grid-row:3;align-self:end}div:where(.swal2-container).swal2-bottom>.swal2-popup{grid-column:2;grid-row:3;place-self:end center}div:where(.swal2-container).swal2-bottom-end>.swal2-popup,div:where(.swal2-container).swal2-bottom-right>.swal2-popup{grid-column:3;grid-row:3;place-self:end end}div:where(.swal2-container).swal2-grow-row>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-column:1/4;width:100%}div:where(.swal2-container).swal2-grow-column>.swal2-popup,div:where(.swal2-container).swal2-grow-fullscreen>.swal2-popup{grid-row:1/4;align-self:stretch}div:where(.swal2-container).swal2-no-transition{transition:none !important}div:where(.swal2-container)[popover]{width:auto;border:0}div:where(.swal2-container) div:where(.swal2-popup){display:none;position:relative;box-sizing:border-box;grid-template-columns:minmax(0, 100%);width:var(--swal2-width);max-width:100%;padding:var(--swal2-padding);border:var(--swal2-border);border-radius:var(--swal2-border-radius);background:var(--swal2-background);color:var(--swal2-color);font-family:inherit;font-size:1rem;container-name:swal2-popup}div:where(.swal2-container) div:where(.swal2-popup):focus{outline:none}div:where(.swal2-container) div:where(.swal2-popup).swal2-loading{overflow-y:hidden}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable{cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-draggable div:where(.swal2-icon){cursor:grab}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging{cursor:grabbing}div:where(.swal2-container) div:where(.swal2-popup).swal2-dragging div:where(.swal2-icon){cursor:grabbing}div:where(.swal2-container) h2:where(.swal2-title){position:relative;max-width:100%;margin:0;padding:var(--swal2-title-padding);color:inherit;font-size:1.875em;font-weight:600;text-align:center;text-transform:none;overflow-wrap:break-word;cursor:initial}div:where(.swal2-container) div:where(.swal2-actions){display:flex;z-index:1;box-sizing:border-box;flex-wrap:wrap;align-items:center;justify-content:var(--swal2-actions-justify-content);width:var(--swal2-actions-width);margin:var(--swal2-actions-margin);padding:var(--swal2-actions-padding);border-radius:var(--swal2-actions-border-radius);background:var(--swal2-actions-background)}div:where(.swal2-container) div:where(.swal2-loader){display:none;align-items:center;justify-content:center;width:2.2em;height:2.2em;margin:0 1.875em;animation:swal2-rotate-loading 1.5s linear 0s infinite normal;border-width:.25em;border-style:solid;border-radius:100%;border-color:#2778c4 rgba(0,0,0,0) #2778c4 rgba(0,0,0,0)}div:where(.swal2-container) button:where(.swal2-styled){margin:.3125em;padding:.625em 1.1em;transition:var(--swal2-action-button-transition);border:none;box-shadow:0 0 0 3px rgba(0,0,0,0);font-weight:500}div:where(.swal2-container) button:where(.swal2-styled):not([disabled]){cursor:pointer}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm){border-radius:var(--swal2-confirm-button-border-radius);background:initial;background-color:var(--swal2-confirm-button-background-color);box-shadow:var(--swal2-confirm-button-box-shadow);color:var(--swal2-confirm-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):hover{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-confirm):active{background-color:color-mix(in srgb, var(--swal2-confirm-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny){border-radius:var(--swal2-deny-button-border-radius);background:initial;background-color:var(--swal2-deny-button-background-color);box-shadow:var(--swal2-deny-button-box-shadow);color:var(--swal2-deny-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):hover{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-deny):active{background-color:color-mix(in srgb, var(--swal2-deny-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel){border-radius:var(--swal2-cancel-button-border-radius);background:initial;background-color:var(--swal2-cancel-button-background-color);box-shadow:var(--swal2-cancel-button-box-shadow);color:var(--swal2-cancel-button-color);font-size:1em}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):hover{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-hover))}div:where(.swal2-container) button:where(.swal2-styled):where(.swal2-cancel):active{background-color:color-mix(in srgb, var(--swal2-cancel-button-background-color), var(--swal2-action-button-active))}div:where(.swal2-container) button:where(.swal2-styled):focus-visible{outline:none;box-shadow:var(--swal2-action-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-styled)[disabled]:not(.swal2-loading){opacity:.4}div:where(.swal2-container) button:where(.swal2-styled)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-footer){margin:1em 0 0;padding:1em 1em 0;border-top:1px solid var(--swal2-footer-border-color);background:var(--swal2-footer-background);color:var(--swal2-footer-color);font-size:1em;text-align:center;cursor:initial}div:where(.swal2-container) .swal2-timer-progress-bar-container{position:absolute;right:0;bottom:0;left:0;grid-column:auto !important;overflow:hidden;border-bottom-right-radius:var(--swal2-border-radius);border-bottom-left-radius:var(--swal2-border-radius)}div:where(.swal2-container) div:where(.swal2-timer-progress-bar){width:100%;height:.25em;background:var(--swal2-timer-progress-bar-background)}div:where(.swal2-container) img:where(.swal2-image){max-width:100%;margin:2em auto 1em;cursor:initial}div:where(.swal2-container) button:where(.swal2-close){position:var(--swal2-close-button-position);inset:var(--swal2-close-button-inset);z-index:2;align-items:center;justify-content:center;width:1.2em;height:1.2em;margin-top:0;margin-right:0;margin-bottom:-1.2em;padding:0;overflow:hidden;transition:var(--swal2-close-button-transition);border:none;border-radius:var(--swal2-border-radius);outline:var(--swal2-close-button-outline);background:rgba(0,0,0,0);color:var(--swal2-close-button-color);font-family:monospace;font-size:var(--swal2-close-button-font-size);cursor:pointer;justify-self:end}div:where(.swal2-container) button:where(.swal2-close):hover{transform:var(--swal2-close-button-hover-transform);background:rgba(0,0,0,0);color:#f27474}div:where(.swal2-container) button:where(.swal2-close):focus-visible{outline:none;box-shadow:var(--swal2-close-button-focus-box-shadow)}div:where(.swal2-container) button:where(.swal2-close)::-moz-focus-inner{border:0}div:where(.swal2-container) div:where(.swal2-html-container){z-index:1;justify-content:center;margin:0;padding:var(--swal2-html-container-padding);overflow:auto;color:inherit;font-size:1.125em;font-weight:normal;line-height:normal;text-align:center;overflow-wrap:break-word;word-break:break-word;cursor:initial}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea),div:where(.swal2-container) select:where(.swal2-select),div:where(.swal2-container) div:where(.swal2-radio),div:where(.swal2-container) label:where(.swal2-checkbox){margin:1em 2em 3px}div:where(.swal2-container) input:where(.swal2-input),div:where(.swal2-container) input:where(.swal2-file),div:where(.swal2-container) textarea:where(.swal2-textarea){box-sizing:border-box;width:auto;transition:var(--swal2-input-transition);border:var(--swal2-input-border);border-radius:var(--swal2-input-border-radius);background:var(--swal2-input-background);box-shadow:var(--swal2-input-box-shadow);color:inherit;font-size:1.125em}div:where(.swal2-container) input:where(.swal2-input).swal2-inputerror,div:where(.swal2-container) input:where(.swal2-file).swal2-inputerror,div:where(.swal2-container) textarea:where(.swal2-textarea).swal2-inputerror{border-color:#f27474 !important;box-shadow:0 0 2px #f27474 !important}div:where(.swal2-container) input:where(.swal2-input):hover,div:where(.swal2-container) input:where(.swal2-file):hover,div:where(.swal2-container) textarea:where(.swal2-textarea):hover{box-shadow:var(--swal2-input-hover-box-shadow)}div:where(.swal2-container) input:where(.swal2-input):focus,div:where(.swal2-container) input:where(.swal2-file):focus,div:where(.swal2-container) textarea:where(.swal2-textarea):focus{border:var(--swal2-input-focus-border);outline:none;box-shadow:var(--swal2-input-focus-box-shadow)}div:where(.swal2-container) input:where(.swal2-input)::placeholder,div:where(.swal2-container) input:where(.swal2-file)::placeholder,div:where(.swal2-container) textarea:where(.swal2-textarea)::placeholder{color:#ccc}div:where(.swal2-container) .swal2-range{margin:1em 2em 3px;background:var(--swal2-background)}div:where(.swal2-container) .swal2-range input{width:80%}div:where(.swal2-container) .swal2-range output{width:20%;color:inherit;font-weight:600;text-align:center}div:where(.swal2-container) .swal2-range input,div:where(.swal2-container) .swal2-range output{height:2.625em;padding:0;font-size:1.125em;line-height:2.625em}div:where(.swal2-container) .swal2-input{height:2.625em;padding:0 .75em}div:where(.swal2-container) .swal2-file{width:75%;margin-right:auto;margin-left:auto;background:var(--swal2-input-background);font-size:1.125em}div:where(.swal2-container) .swal2-textarea{height:6.75em;padding:.75em}div:where(.swal2-container) .swal2-select{min-width:50%;max-width:100%;padding:.375em .625em;background:var(--swal2-input-background);color:inherit;font-size:1.125em}div:where(.swal2-container) .swal2-radio,div:where(.swal2-container) .swal2-checkbox{align-items:center;justify-content:center;background:var(--swal2-background);color:inherit}div:where(.swal2-container) .swal2-radio label,div:where(.swal2-container) .swal2-checkbox label{margin:0 .6em;font-size:1.125em}div:where(.swal2-container) .swal2-radio input,div:where(.swal2-container) .swal2-checkbox input{flex-shrink:0;margin:0 .4em}div:where(.swal2-container) label:where(.swal2-input-label){display:flex;justify-content:center;margin:1em auto 0}div:where(.swal2-container) div:where(.swal2-validation-message){align-items:center;justify-content:center;margin:1em 0 0;padding:.625em;overflow:hidden;background:var(--swal2-validation-message-background);color:var(--swal2-validation-message-color);font-size:1em;font-weight:300}div:where(.swal2-container) div:where(.swal2-validation-message)::before{content:"!";display:inline-block;width:1.5em;min-width:1.5em;height:1.5em;margin:0 .625em;border-radius:50%;background-color:#f27474;color:#fff;font-weight:600;line-height:1.5em;text-align:center}div:where(.swal2-container) .swal2-progress-steps{flex-wrap:wrap;align-items:center;max-width:100%;margin:1.25em auto;padding:0;background:rgba(0,0,0,0);font-weight:600}div:where(.swal2-container) .swal2-progress-steps li{display:inline-block;position:relative}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step{z-index:20;flex-shrink:0;width:2em;height:2em;border-radius:2em;background:#2778c4;color:#fff;line-height:2em;text-align:center}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step{background:#2778c4}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step{background:var(--swal2-progress-step-background);color:#fff}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step.swal2-active-progress-step~.swal2-progress-step-line{background:var(--swal2-progress-step-background)}div:where(.swal2-container) .swal2-progress-steps .swal2-progress-step-line{z-index:10;flex-shrink:0;width:2.5em;height:.4em;margin:0 -1px;background:#2778c4}div:where(.swal2-icon){position:relative;box-sizing:content-box;justify-content:center;width:5em;height:5em;margin:2.5em auto .6em;zoom:var(--swal2-icon-zoom);border:.25em solid rgba(0,0,0,0);border-radius:50%;border-color:#000;font-family:inherit;line-height:5em;cursor:default;user-select:none}div:where(.swal2-icon) .swal2-icon-content{display:flex;align-items:center;font-size:3.75em}div:where(.swal2-icon).swal2-error{border-color:#f27474;color:#f27474}div:where(.swal2-icon).swal2-error .swal2-x-mark{position:relative;flex-grow:1}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line]{display:block;position:absolute;top:2.3125em;width:2.9375em;height:.3125em;border-radius:.125em;background-color:#f27474}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=left]{left:1.0625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-error [class^=swal2-x-mark-line][class$=right]{right:1em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-error.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-error.swal2-icon-show .swal2-x-mark{animation:swal2-animate-error-x-mark .5s}}div:where(.swal2-icon).swal2-warning{border-color:#f8bb86;color:#f8bb86}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-warning.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-warning.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .5s}}div:where(.swal2-icon).swal2-info{border-color:#3fc3ee;color:#3fc3ee}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-info.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-info.swal2-icon-show .swal2-icon-content{animation:swal2-animate-i-mark .8s}}div:where(.swal2-icon).swal2-question{border-color:#87adbd;color:#87adbd}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-question.swal2-icon-show{animation:swal2-animate-error-icon .5s}div:where(.swal2-icon).swal2-question.swal2-icon-show .swal2-icon-content{animation:swal2-animate-question-mark .8s}}div:where(.swal2-icon).swal2-success{border-color:#a5dc86;color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line]{position:absolute;width:3.75em;height:7.5em;border-radius:50%}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.4375em;left:-2.0635em;transform:rotate(-45deg);transform-origin:3.75em 3.75em;border-radius:7.5em 0 0 7.5em}div:where(.swal2-icon).swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.6875em;left:1.875em;transform:rotate(-45deg);transform-origin:0 3.75em;border-radius:0 7.5em 7.5em 0}div:where(.swal2-icon).swal2-success .swal2-success-ring{position:absolute;z-index:2;top:-0.25em;left:-0.25em;box-sizing:content-box;width:100%;height:100%;border:.25em solid rgba(165,220,134,.3);border-radius:50%}div:where(.swal2-icon).swal2-success .swal2-success-fix{position:absolute;z-index:1;top:.5em;left:1.625em;width:.4375em;height:5.625em;transform:rotate(-45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line]{display:block;position:absolute;z-index:2;height:.3125em;border-radius:.125em;background-color:#a5dc86}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=tip]{top:2.875em;left:.8125em;width:1.5625em;transform:rotate(45deg)}div:where(.swal2-icon).swal2-success [class^=swal2-success-line][class$=long]{top:2.375em;right:.5em;width:2.9375em;transform:rotate(-45deg)}@container swal2-popup style(--swal2-icon-animations:true){div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-animate-success-line-tip .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-animate-success-line-long .75s}div:where(.swal2-icon).swal2-success.swal2-icon-show .swal2-success-circular-line-right{animation:swal2-rotate-success-circular-line 4.25s ease-in}}[class^=swal2]{-webkit-tap-highlight-color:rgba(0,0,0,0)}.swal2-show{animation:var(--swal2-show-animation)}.swal2-hide{animation:var(--swal2-hide-animation)}.swal2-noanimation{transition:none}.swal2-scrollbar-measure{position:absolute;top:-9999px;width:50px;height:50px;overflow:scroll}.swal2-rtl .swal2-close{margin-right:initial;margin-left:0}.swal2-rtl .swal2-timer-progress-bar{right:0;left:auto}.swal2-toast{box-sizing:border-box;grid-column:1/4 !important;grid-row:1/4 !important;grid-template-columns:min-content auto min-content;padding:1em;overflow-y:hidden;border:var(--swal2-toast-border);background:var(--swal2-background);box-shadow:var(--swal2-toast-box-shadow);pointer-events:all}.swal2-toast>*{grid-column:2}.swal2-toast h2:where(.swal2-title){margin:.5em 1em;padding:0;font-size:1em;text-align:initial}.swal2-toast .swal2-loading{justify-content:center}.swal2-toast input:where(.swal2-input){height:2em;margin:.5em;font-size:1em}.swal2-toast .swal2-validation-message{font-size:1em}.swal2-toast div:where(.swal2-footer){margin:.5em 0 0;padding:.5em 0 0;font-size:.8em}.swal2-toast button:where(.swal2-close){grid-column:3/3;grid-row:1/99;align-self:center;width:.8em;height:.8em;margin:0;font-size:2em}.swal2-toast div:where(.swal2-html-container){margin:.5em 1em;padding:0;overflow:initial;font-size:1em;text-align:initial}.swal2-toast div:where(.swal2-html-container):empty{padding:0}.swal2-toast .swal2-loader{grid-column:1;grid-row:1/99;align-self:center;width:2em;height:2em;margin:.25em}.swal2-toast .swal2-icon{grid-column:1;grid-row:1/99;align-self:center;width:2em;min-width:2em;height:2em;margin:0 .5em 0 0}.swal2-toast .swal2-icon .swal2-icon-content{display:flex;align-items:center;font-size:1.8em;font-weight:bold}.swal2-toast .swal2-icon.swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line]{top:.875em;width:1.375em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=left]{left:.3125em}.swal2-toast .swal2-icon.swal2-error [class^=swal2-x-mark-line][class$=right]{right:.3125em}.swal2-toast div:where(.swal2-actions){justify-content:flex-start;height:auto;margin:0;margin-top:.5em;padding:0 .5em}.swal2-toast button:where(.swal2-styled){margin:.25em .5em;padding:.4em .6em;font-size:1em}.swal2-toast .swal2-success{border-color:#a5dc86}.swal2-toast .swal2-success [class^=swal2-success-circular-line]{position:absolute;width:1.6em;height:3em;border-radius:50%}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=left]{top:-0.8em;left:-0.5em;transform:rotate(-45deg);transform-origin:2em 2em;border-radius:4em 0 0 4em}.swal2-toast .swal2-success [class^=swal2-success-circular-line][class$=right]{top:-0.25em;left:.9375em;transform-origin:0 1.5em;border-radius:0 4em 4em 0}.swal2-toast .swal2-success .swal2-success-ring{width:2em;height:2em}.swal2-toast .swal2-success .swal2-success-fix{top:0;left:.4375em;width:.4375em;height:2.6875em}.swal2-toast .swal2-success [class^=swal2-success-line]{height:.3125em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=tip]{top:1.125em;left:.1875em;width:.75em}.swal2-toast .swal2-success [class^=swal2-success-line][class$=long]{top:.9375em;right:.1875em;width:1.375em}@container swal2-popup style(--swal2-icon-animations:true){.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-tip{animation:swal2-toast-animate-success-line-tip .75s}.swal2-toast .swal2-success.swal2-icon-show .swal2-success-line-long{animation:swal2-toast-animate-success-line-long .75s}}.swal2-toast.swal2-show{animation:var(--swal2-toast-show-animation)}.swal2-toast.swal2-hide{animation:var(--swal2-toast-hide-animation)}@keyframes swal2-show{0%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}100%{transform:translate3d(0, 0, 0) scale(1);opacity:1}}@keyframes swal2-hide{0%{transform:translate3d(0, 0, 0) scale(1);opacity:1}100%{transform:translate3d(0, -50px, 0) scale(0.9);opacity:0}}@keyframes swal2-animate-success-line-tip{0%{top:1.1875em;left:.0625em;width:0}54%{top:1.0625em;left:.125em;width:0}70%{top:2.1875em;left:-0.375em;width:3.125em}84%{top:3em;left:1.3125em;width:1.0625em}100%{top:2.8125em;left:.8125em;width:1.5625em}}@keyframes swal2-animate-success-line-long{0%{top:3.375em;right:2.875em;width:0}65%{top:3.375em;right:2.875em;width:0}84%{top:2.1875em;right:0;width:3.4375em}100%{top:2.375em;right:.5em;width:2.9375em}}@keyframes swal2-rotate-success-circular-line{0%{transform:rotate(-45deg)}5%{transform:rotate(-45deg)}12%{transform:rotate(-405deg)}100%{transform:rotate(-405deg)}}@keyframes swal2-animate-error-x-mark{0%{margin-top:1.625em;transform:scale(0.4);opacity:0}50%{margin-top:1.625em;transform:scale(0.4);opacity:0}80%{margin-top:-0.375em;transform:scale(1.15)}100%{margin-top:0;transform:scale(1);opacity:1}}@keyframes swal2-animate-error-icon{0%{transform:rotateX(100deg);opacity:0}100%{transform:rotateX(0deg);opacity:1}}@keyframes swal2-rotate-loading{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}@keyframes swal2-animate-question-mark{0%{transform:rotateY(-360deg)}100%{transform:rotateY(0)}}@keyframes swal2-animate-i-mark{0%{transform:rotateZ(45deg);opacity:0}25%{transform:rotateZ(-25deg);opacity:.4}50%{transform:rotateZ(15deg);opacity:.8}75%{transform:rotateZ(-5deg);opacity:1}100%{transform:rotateX(0);opacity:1}}@keyframes swal2-toast-show{0%{transform:translateY(-0.625em) rotateZ(2deg)}33%{transform:translateY(0) rotateZ(-2deg)}66%{transform:translateY(0.3125em) rotateZ(2deg)}100%{transform:translateY(0) rotateZ(0deg)}}@keyframes swal2-toast-hide{100%{transform:rotateZ(1deg);opacity:0}}@keyframes swal2-toast-animate-success-line-tip{0%{top:.5625em;left:.0625em;width:0}54%{top:.125em;left:.125em;width:0}70%{top:.625em;left:-0.25em;width:1.625em}84%{top:1.0625em;left:.75em;width:.5em}100%{top:1.125em;left:.1875em;width:.75em}}@keyframes swal2-toast-animate-success-line-long{0%{top:1.625em;right:1.375em;width:0}65%{top:1.25em;right:.9375em;width:0}84%{top:.9375em;right:0;width:1.125em}100%{top:.9375em;right:.1875em;width:1.375em}}')});var dD=GC((DC,bd)=>{"use strict";$();(function(n,t){typeof DC=="object"&&typeof bd<"u"?bd.exports=t():typeof define=="function"&&define.amd?define(t):n.moment=t()})(DC,function(){"use strict";var n;function t(){return n.apply(null,arguments)}function e(h){n=h}function i(h){return h instanceof Array||Object.prototype.toString.call(h)==="[object Array]"}function r(h){return h!=null&&Object.prototype.toString.call(h)==="[object Object]"}function o(h,_){return Object.prototype.hasOwnProperty.call(h,_)}function l(h){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(h).length===0;var _;for(_ in h)if(o(h,_))return!1;return!0}function c(h){return h===void 0}function f(h){return typeof h=="number"||Object.prototype.toString.call(h)==="[object Number]"}function p(h){return h instanceof Date||Object.prototype.toString.call(h)==="[object Date]"}function g(h,_){var S=[],D,U=h.length;for(D=0;D<U;++D)S.push(_(h[D],D));return S}function m(h,_){for(var S in _)o(_,S)&&(h[S]=_[S]);return o(_,"toString")&&(h.toString=_.toString),o(_,"valueOf")&&(h.valueOf=_.valueOf),h}function x(h,_,S,D){return Po(h,_,S,D,!0).utc()}function C(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function A(h){return h._pf==null&&(h._pf=C()),h._pf}var O;Array.prototype.some?O=Array.prototype.some:O=function(h){var _=Object(this),S=_.length>>>0,D;for(D=0;D<S;D++)if(D in _&&h.call(this,_[D],D,_))return!0;return!1};function T(h){var _=null,S=!1,D=h._d&&!isNaN(h._d.getTime());if(D&&(_=A(h),S=O.call(_.parsedDateParts,function(U){return U!=null}),D=_.overflow<0&&!_.empty&&!_.invalidEra&&!_.invalidMonth&&!_.invalidWeekday&&!_.weekdayMismatch&&!_.nullInput&&!_.invalidFormat&&!_.userInvalidated&&(!_.meridiem||_.meridiem&&S),h._strict&&(D=D&&_.charsLeftOver===0&&_.unusedTokens.length===0&&_.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(h))h._isValid=D;else return D;return h._isValid}function M(h){var _=x(NaN);return h!=null?m(A(_),h):A(_).userInvalidated=!0,_}var G=t.momentProperties=[],Y=!1;function q(h,_){var S,D,U,ee=G.length;if(c(_._isAMomentObject)||(h._isAMomentObject=_._isAMomentObject),c(_._i)||(h._i=_._i),c(_._f)||(h._f=_._f),c(_._l)||(h._l=_._l),c(_._strict)||(h._strict=_._strict),c(_._tzm)||(h._tzm=_._tzm),c(_._isUTC)||(h._isUTC=_._isUTC),c(_._offset)||(h._offset=_._offset),c(_._pf)||(h._pf=A(_)),c(_._locale)||(h._locale=_._locale),ee>0)for(S=0;S<ee;S++)D=G[S],U=_[D],c(U)||(h[D]=U);return h}function X(h){q(this,h),this._d=new Date(h._d!=null?h._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),Y===!1&&(Y=!0,t.updateOffset(this),Y=!1)}function Z(h){return h instanceof X||h!=null&&h._isAMomentObject!=null}function J(h){t.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+h)}function oe(h,_){var S=!0;return m(function(){if(t.deprecationHandler!=null&&t.deprecationHandler(null,h),S){var D=[],U,ee,be,lt=arguments.length;for(ee=0;ee<lt;ee++){if(U="",typeof arguments[ee]=="object"){U+=`
[`+ee+"] ";for(be in arguments[0])o(arguments[0],be)&&(U+=be+": "+arguments[0][be]+", ");U=U.slice(0,-2)}else U=arguments[ee];D.push(U)}J(h+`
Arguments: `+Array.prototype.slice.call(D).join("")+`
`+new Error().stack),S=!1}return _.apply(this,arguments)},_)}var L={};function z(h,_){t.deprecationHandler!=null&&t.deprecationHandler(h,_),L[h]||(J(_),L[h]=!0)}t.suppressDeprecationWarnings=!1,t.deprecationHandler=null;function K(h){return typeof Function<"u"&&h instanceof Function||Object.prototype.toString.call(h)==="[object Function]"}function re(h){var _,S;for(S in h)o(h,S)&&(_=h[S],K(_)?this[S]=_:this["_"+S]=_);this._config=h,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ce(h,_){var S=m({},h),D;for(D in _)o(_,D)&&(r(h[D])&&r(_[D])?(S[D]={},m(S[D],h[D]),m(S[D],_[D])):_[D]!=null?S[D]=_[D]:delete S[D]);for(D in h)o(h,D)&&!o(_,D)&&r(h[D])&&(S[D]=m({},S[D]));return S}function we(h){h!=null&&this.set(h)}var Ee;Object.keys?Ee=Object.keys:Ee=function(h){var _,S=[];for(_ in h)o(h,_)&&S.push(_);return S};var xe={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function me(h,_,S){var D=this._calendar[h]||this._calendar.sameElse;return K(D)?D.call(_,S):D}function Me(h,_,S){var D=""+Math.abs(h),U=_-D.length,ee=h>=0;return(ee?S?"+":"":"-")+Math.pow(10,Math.max(0,U)).toString().substr(1)+D}var qe=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Be=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Xe={},Et={};function Re(h,_,S,D){var U=D;typeof D=="string"&&(U=function(){return this[D]()}),h&&(Et[h]=U),_&&(Et[_[0]]=function(){return Me(U.apply(this,arguments),_[1],_[2])}),S&&(Et[S]=function(){return this.localeData().ordinal(U.apply(this,arguments),h)})}function wn(h){return h.match(/\[[\s\S]/)?h.replace(/^\[|\]$/g,""):h.replace(/\\/g,"")}function xn(h){var _=h.match(qe),S,D;for(S=0,D=_.length;S<D;S++)Et[_[S]]?_[S]=Et[_[S]]:_[S]=wn(_[S]);return function(U){var ee="",be;for(be=0;be<D;be++)ee+=K(_[be])?_[be].call(U,h):_[be];return ee}}function Se(h,_){return h.isValid()?(_=De(_,h.localeData()),Xe[_]=Xe[_]||xn(_),Xe[_](h)):h.localeData().invalidDate()}function De(h,_){var S=5;function D(U){return _.longDateFormat(U)||U}for(Be.lastIndex=0;S>=0&&Be.test(h);)h=h.replace(Be,D),Be.lastIndex=0,S-=1;return h}var rt={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function Pt(h){var _=this._longDateFormat[h],S=this._longDateFormat[h.toUpperCase()];return _||!S?_:(this._longDateFormat[h]=S.match(qe).map(function(D){return D==="MMMM"||D==="MM"||D==="DD"||D==="dddd"?D.slice(1):D}).join(""),this._longDateFormat[h])}var ft="Invalid date";function tn(){return this._invalidDate}var Xn="%d",sn=/\d{1,2}/;function It(h){return this._ordinal.replace("%d",h)}var Kt={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Nt(h,_,S,D){var U=this._relativeTime[S];return K(U)?U(h,_,S,D):U.replace(/%d/i,h)}function un(h,_){var S=this._relativeTime[h>0?"future":"past"];return K(S)?S(_):S.replace(/%s/i,_)}var Q={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function cn(h){return typeof h=="string"?Q[h]||Q[h.toLowerCase()]:void 0}function an(h){var _={},S,D;for(D in h)o(h,D)&&(S=cn(D),S&&(_[S]=h[D]));return _}var gt={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function Qe(h){var _=[],S;for(S in h)o(h,S)&&_.push({unit:S,priority:gt[S]});return _.sort(function(D,U){return D.priority-U.priority}),_}var W=/\d/,k=/\d\d/,te=/\d{3}/,ge=/\d{4}/,Ae=/[+-]?\d{6}/,de=/\d\d?/,ct=/\d\d\d\d?/,ke=/\d\d\d\d\d\d?/,dt=/\d{1,3}/,xt=/\d{1,4}/,Fe=/[+-]?\d{1,6}/,He=/\d+/,tt=/[+-]?\d+/,ht=/Z|[+-]\d\d:?\d\d/gi,je=/Z|[+-]\d\d(?::?\d\d)?/gi,Ut=/[+-]?\d+(\.\d{1,3})?/,ne=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ze=/^[1-9]\d?/,Ue=/^([1-9]\d|\d)/,Je;Je={};function ue(h,_,S){Je[h]=K(_)?_:function(D,U){return D&&S?S:_}}function Te(h,_){return o(Je,h)?Je[h](_._strict,_._locale):new RegExp(Ge(h))}function Ge(h){return vt(h.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(_,S,D,U,ee){return S||D||U||ee}))}function vt(h){return h.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Wt(h){return h<0?Math.ceil(h)||0:Math.floor(h)}function st(h){var _=+h,S=0;return _!==0&&isFinite(_)&&(S=Wt(_)),S}var Xi={};function $t(h,_){var S,D=_,U;for(typeof h=="string"&&(h=[h]),f(_)&&(D=function(ee,be){be[_]=st(ee)}),U=h.length,S=0;S<U;S++)Xi[h[S]]=D}function Es(h,_){$t(h,function(S,D,U,ee){U._w=U._w||{},_(S,U._w,U,ee)})}function sa(h,_,S){_!=null&&o(Xi,h)&&Xi[h](_,S._a,S,h)}function ao(h){return h%4===0&&h%100!==0||h%400===0}var vi=0,xr=1,or=2,In=3,ji=4,Qt=5,lo=6,aa=7,xu=8;Re("Y",0,0,function(){var h=this.year();return h<=9999?Me(h,4):"+"+h}),Re(0,["YY",2],0,function(){return this.year()%100}),Re(0,["YYYY",4],0,"year"),Re(0,["YYYYY",5],0,"year"),Re(0,["YYYYYY",6,!0],0,"year"),ue("Y",tt),ue("YY",de,k),ue("YYYY",xt,ge),ue("YYYYY",Fe,Ae),ue("YYYYYY",Fe,Ae),$t(["YYYYY","YYYYYY"],vi),$t("YYYY",function(h,_){_[vi]=h.length===2?t.parseTwoDigitYear(h):st(h)}),$t("YY",function(h,_){_[vi]=t.parseTwoDigitYear(h)}),$t("Y",function(h,_){_[vi]=parseInt(h,10)});function uo(h){return ao(h)?366:365}t.parseTwoDigitYear=function(h){return st(h)+(st(h)>68?1900:2e3)};var sl=co("FullYear",!0);function bu(){return ao(this.year())}function co(h,_){return function(S){return S!=null?(al(this,h,S),t.updateOffset(this,_),this):Hr(this,h)}}function Hr(h,_){if(!h.isValid())return NaN;var S=h._d,D=h._isUTC;switch(_){case"Milliseconds":return D?S.getUTCMilliseconds():S.getMilliseconds();case"Seconds":return D?S.getUTCSeconds():S.getSeconds();case"Minutes":return D?S.getUTCMinutes():S.getMinutes();case"Hours":return D?S.getUTCHours():S.getHours();case"Date":return D?S.getUTCDate():S.getDate();case"Day":return D?S.getUTCDay():S.getDay();case"Month":return D?S.getUTCMonth():S.getMonth();case"FullYear":return D?S.getUTCFullYear():S.getFullYear();default:return NaN}}function al(h,_,S){var D,U,ee,be,lt;if(!(!h.isValid()||isNaN(S))){switch(D=h._d,U=h._isUTC,_){case"Milliseconds":return void(U?D.setUTCMilliseconds(S):D.setMilliseconds(S));case"Seconds":return void(U?D.setUTCSeconds(S):D.setSeconds(S));case"Minutes":return void(U?D.setUTCMinutes(S):D.setMinutes(S));case"Hours":return void(U?D.setUTCHours(S):D.setHours(S));case"Date":return void(U?D.setUTCDate(S):D.setDate(S));case"FullYear":break;default:return}ee=S,be=h.month(),lt=h.date(),lt=lt===29&&be===1&&!ao(ee)?28:lt,U?D.setUTCFullYear(ee,be,lt):D.setFullYear(ee,be,lt)}}function la(h){return h=cn(h),K(this[h])?this[h]():this}function Zn(h,_){if(typeof h=="object"){h=an(h);var S=Qe(h),D,U=S.length;for(D=0;D<U;D++)this[S[D].unit](h[S[D].unit])}else if(h=cn(h),K(this[h]))return this[h](_);return this}function Ed(h,_){return(h%_+_)%_}var N;Array.prototype.indexOf?N=Array.prototype.indexOf:N=function(h){var _;for(_=0;_<this.length;++_)if(this[_]===h)return _;return-1};function ie(h,_){if(isNaN(h)||isNaN(_))return NaN;var S=Ed(_,12);return h+=(_-S)/12,S===1?ao(h)?29:28:31-S%7%2}Re("M",["MM",2],"Mo",function(){return this.month()+1}),Re("MMM",0,0,function(h){return this.localeData().monthsShort(this,h)}),Re("MMMM",0,0,function(h){return this.localeData().months(this,h)}),ue("M",de,ze),ue("MM",de,k),ue("MMM",function(h,_){return _.monthsShortRegex(h)}),ue("MMMM",function(h,_){return _.monthsRegex(h)}),$t(["M","MM"],function(h,_){_[xr]=st(h)-1}),$t(["MMM","MMMM"],function(h,_,S,D){var U=S._locale.monthsParse(h,D,S._strict);U!=null?_[xr]=U:A(S).invalidMonth=h});var pe="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),fe="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),le=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,Ye=ne,nt=ne;function Ze(h,_){return h?i(this._months)?this._months[h.month()]:this._months[(this._months.isFormat||le).test(_)?"format":"standalone"][h.month()]:i(this._months)?this._months:this._months.standalone}function at(h,_){return h?i(this._monthsShort)?this._monthsShort[h.month()]:this._monthsShort[le.test(_)?"format":"standalone"][h.month()]:i(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function mt(h,_,S){var D,U,ee,be=h.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],D=0;D<12;++D)ee=x([2e3,D]),this._shortMonthsParse[D]=this.monthsShort(ee,"").toLocaleLowerCase(),this._longMonthsParse[D]=this.months(ee,"").toLocaleLowerCase();return S?_==="MMM"?(U=N.call(this._shortMonthsParse,be),U!==-1?U:null):(U=N.call(this._longMonthsParse,be),U!==-1?U:null):_==="MMM"?(U=N.call(this._shortMonthsParse,be),U!==-1?U:(U=N.call(this._longMonthsParse,be),U!==-1?U:null)):(U=N.call(this._longMonthsParse,be),U!==-1?U:(U=N.call(this._shortMonthsParse,be),U!==-1?U:null))}function Ct(h,_,S){var D,U,ee;if(this._monthsParseExact)return mt.call(this,h,_,S);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),D=0;D<12;D++){if(U=x([2e3,D]),S&&!this._longMonthsParse[D]&&(this._longMonthsParse[D]=new RegExp("^"+this.months(U,"").replace(".","")+"$","i"),this._shortMonthsParse[D]=new RegExp("^"+this.monthsShort(U,"").replace(".","")+"$","i")),!S&&!this._monthsParse[D]&&(ee="^"+this.months(U,"")+"|^"+this.monthsShort(U,""),this._monthsParse[D]=new RegExp(ee.replace(".",""),"i")),S&&_==="MMMM"&&this._longMonthsParse[D].test(h))return D;if(S&&_==="MMM"&&this._shortMonthsParse[D].test(h))return D;if(!S&&this._monthsParse[D].test(h))return D}}function yt(h,_){if(!h.isValid())return h;if(typeof _=="string"){if(/^\d+$/.test(_))_=st(_);else if(_=h.localeData().monthsParse(_),!f(_))return h}var S=_,D=h.date();return D=D<29?D:Math.min(D,ie(h.year(),S)),h._isUTC?h._d.setUTCMonth(S,D):h._d.setMonth(S,D),h}function Rt(h){return h!=null?(yt(this,h),t.updateOffset(this,!0),this):Hr(this,"Month")}function bn(){return ie(this.year(),this.month())}function Bn(h){return this._monthsParseExact?(o(this,"_monthsRegex")||Sn.call(this),h?this._monthsShortStrictRegex:this._monthsShortRegex):(o(this,"_monthsShortRegex")||(this._monthsShortRegex=Ye),this._monthsShortStrictRegex&&h?this._monthsShortStrictRegex:this._monthsShortRegex)}function zn(h){return this._monthsParseExact?(o(this,"_monthsRegex")||Sn.call(this),h?this._monthsStrictRegex:this._monthsRegex):(o(this,"_monthsRegex")||(this._monthsRegex=nt),this._monthsStrictRegex&&h?this._monthsStrictRegex:this._monthsRegex)}function Sn(){function h(Dt,mn){return mn.length-Dt.length}var _=[],S=[],D=[],U,ee,be,lt;for(U=0;U<12;U++)ee=x([2e3,U]),be=vt(this.monthsShort(ee,"")),lt=vt(this.months(ee,"")),_.push(be),S.push(lt),D.push(lt),D.push(be);_.sort(h),S.sort(h),D.sort(h),this._monthsRegex=new RegExp("^("+D.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+S.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+_.join("|")+")","i")}function _t(h,_,S,D,U,ee,be){var lt;return h<100&&h>=0?(lt=new Date(h+400,_,S,D,U,ee,be),isFinite(lt.getFullYear())&&lt.setFullYear(h)):lt=new Date(h,_,S,D,U,ee,be),lt}function Yt(h){var _,S;return h<100&&h>=0?(S=Array.prototype.slice.call(arguments),S[0]=h+400,_=new Date(Date.UTC.apply(null,S)),isFinite(_.getUTCFullYear())&&_.setUTCFullYear(h)):_=new Date(Date.UTC.apply(null,arguments)),_}function Vt(h,_,S){var D=7+_-S,U=(7+Yt(h,0,D).getUTCDay()-_)%7;return-U+D-1}function Oi(h,_,S,D,U){var ee=(7+S-D)%7,be=Vt(h,D,U),lt=1+7*(_-1)+ee+be,Dt,mn;return lt<=0?(Dt=h-1,mn=uo(Dt)+lt):lt>uo(h)?(Dt=h+1,mn=lt-uo(h)):(Dt=h,mn=lt),{year:Dt,dayOfYear:mn}}function br(h,_,S){var D=Vt(h.year(),_,S),U=Math.floor((h.dayOfYear()-D-1)/7)+1,ee,be;return U<1?(be=h.year()-1,ee=U+Jn(be,_,S)):U>Jn(h.year(),_,S)?(ee=U-Jn(h.year(),_,S),be=h.year()+1):(be=h.year(),ee=U),{week:ee,year:be}}function Jn(h,_,S){var D=Vt(h,_,S),U=Vt(h+1,_,S);return(uo(h)-D+U)/7}Re("w",["ww",2],"wo","week"),Re("W",["WW",2],"Wo","isoWeek"),ue("w",de,ze),ue("ww",de,k),ue("W",de,ze),ue("WW",de,k),Es(["w","ww","W","WW"],function(h,_,S,D){_[D.substr(0,1)]=st(h)});function ws(h){return br(h,this._week.dow,this._week.doy).week}var Dn={dow:0,doy:6};function Bi(){return this._week.dow}function Zi(){return this._week.doy}function yi(h){var _=this.localeData().week(this);return h==null?_:this.add((h-_)*7,"d")}function Vi(h){var _=br(this,1,4).week;return h==null?_:this.add((h-_)*7,"d")}Re("d",0,"do","day"),Re("dd",0,0,function(h){return this.localeData().weekdaysMin(this,h)}),Re("ddd",0,0,function(h){return this.localeData().weekdaysShort(this,h)}),Re("dddd",0,0,function(h){return this.localeData().weekdays(this,h)}),Re("e",0,0,"weekday"),Re("E",0,0,"isoWeekday"),ue("d",de),ue("e",de),ue("E",de),ue("dd",function(h,_){return _.weekdaysMinRegex(h)}),ue("ddd",function(h,_){return _.weekdaysShortRegex(h)}),ue("dddd",function(h,_){return _.weekdaysRegex(h)}),Es(["dd","ddd","dddd"],function(h,_,S,D){var U=S._locale.weekdaysParse(h,D,S._strict);U!=null?_.d=U:A(S).invalidWeekday=h}),Es(["d","e","E"],function(h,_,S,D){_[D]=st(h)});function ua(h,_){return typeof h!="string"?h:isNaN(h)?(h=_.weekdaysParse(h),typeof h=="number"?h:null):parseInt(h,10)}function Ao(h,_){return typeof h=="string"?_.weekdaysParse(h)%7||7:isNaN(h)?null:h}function wd(h,_){return h.slice(_,7).concat(h.slice(0,_))}var ca="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Sd="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Q1="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Md=ne,th=ne,e6=ne;function t6(h,_){var S=i(this._weekdays)?this._weekdays:this._weekdays[h&&h!==!0&&this._weekdays.isFormat.test(_)?"format":"standalone"];return h===!0?wd(S,this._week.dow):h?S[h.day()]:S}function n6(h){return h===!0?wd(this._weekdaysShort,this._week.dow):h?this._weekdaysShort[h.day()]:this._weekdaysShort}function i6(h){return h===!0?wd(this._weekdaysMin,this._week.dow):h?this._weekdaysMin[h.day()]:this._weekdaysMin}function r6(h,_,S){var D,U,ee,be=h.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],D=0;D<7;++D)ee=x([2e3,1]).day(D),this._minWeekdaysParse[D]=this.weekdaysMin(ee,"").toLocaleLowerCase(),this._shortWeekdaysParse[D]=this.weekdaysShort(ee,"").toLocaleLowerCase(),this._weekdaysParse[D]=this.weekdays(ee,"").toLocaleLowerCase();return S?_==="dddd"?(U=N.call(this._weekdaysParse,be),U!==-1?U:null):_==="ddd"?(U=N.call(this._shortWeekdaysParse,be),U!==-1?U:null):(U=N.call(this._minWeekdaysParse,be),U!==-1?U:null):_==="dddd"?(U=N.call(this._weekdaysParse,be),U!==-1||(U=N.call(this._shortWeekdaysParse,be),U!==-1)?U:(U=N.call(this._minWeekdaysParse,be),U!==-1?U:null)):_==="ddd"?(U=N.call(this._shortWeekdaysParse,be),U!==-1||(U=N.call(this._weekdaysParse,be),U!==-1)?U:(U=N.call(this._minWeekdaysParse,be),U!==-1?U:null)):(U=N.call(this._minWeekdaysParse,be),U!==-1||(U=N.call(this._weekdaysParse,be),U!==-1)?U:(U=N.call(this._shortWeekdaysParse,be),U!==-1?U:null))}function o6(h,_,S){var D,U,ee;if(this._weekdaysParseExact)return r6.call(this,h,_,S);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),D=0;D<7;D++){if(U=x([2e3,1]).day(D),S&&!this._fullWeekdaysParse[D]&&(this._fullWeekdaysParse[D]=new RegExp("^"+this.weekdays(U,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[D]=new RegExp("^"+this.weekdaysShort(U,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[D]=new RegExp("^"+this.weekdaysMin(U,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[D]||(ee="^"+this.weekdays(U,"")+"|^"+this.weekdaysShort(U,"")+"|^"+this.weekdaysMin(U,""),this._weekdaysParse[D]=new RegExp(ee.replace(".",""),"i")),S&&_==="dddd"&&this._fullWeekdaysParse[D].test(h))return D;if(S&&_==="ddd"&&this._shortWeekdaysParse[D].test(h))return D;if(S&&_==="dd"&&this._minWeekdaysParse[D].test(h))return D;if(!S&&this._weekdaysParse[D].test(h))return D}}function da(h){if(!this.isValid())return h!=null?this:NaN;var _=Hr(this,"Day");return h!=null?(h=ua(h,this.localeData()),this.add(h-_,"d")):_}function s6(h){if(!this.isValid())return h!=null?this:NaN;var _=(this.day()+7-this.localeData()._week.dow)%7;return h==null?_:this.add(h-_,"d")}function nh(h){if(!this.isValid())return h!=null?this:NaN;if(h!=null){var _=Ao(h,this.localeData());return this.day(this.day()%7?_:_-7)}else return this.day()||7}function ih(h){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Ad.call(this),h?this._weekdaysStrictRegex:this._weekdaysRegex):(o(this,"_weekdaysRegex")||(this._weekdaysRegex=Md),this._weekdaysStrictRegex&&h?this._weekdaysStrictRegex:this._weekdaysRegex)}function a6(h){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Ad.call(this),h?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(o(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=th),this._weekdaysShortStrictRegex&&h?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function l6(h){return this._weekdaysParseExact?(o(this,"_weekdaysRegex")||Ad.call(this),h?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(o(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=e6),this._weekdaysMinStrictRegex&&h?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Ad(){function h(ar,Ps){return Ps.length-ar.length}var _=[],S=[],D=[],U=[],ee,be,lt,Dt,mn;for(ee=0;ee<7;ee++)be=x([2e3,1]).day(ee),lt=vt(this.weekdaysMin(be,"")),Dt=vt(this.weekdaysShort(be,"")),mn=vt(this.weekdays(be,"")),_.push(lt),S.push(Dt),D.push(mn),U.push(lt),U.push(Dt),U.push(mn);_.sort(h),S.sort(h),D.sort(h),U.sort(h),this._weekdaysRegex=new RegExp("^("+U.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+D.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+S.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+_.join("|")+")","i")}function Td(){return this.hours()%12||12}function u6(){return this.hours()||24}Re("H",["HH",2],0,"hour"),Re("h",["hh",2],0,Td),Re("k",["kk",2],0,u6),Re("hmm",0,0,function(){return""+Td.apply(this)+Me(this.minutes(),2)}),Re("hmmss",0,0,function(){return""+Td.apply(this)+Me(this.minutes(),2)+Me(this.seconds(),2)}),Re("Hmm",0,0,function(){return""+this.hours()+Me(this.minutes(),2)}),Re("Hmmss",0,0,function(){return""+this.hours()+Me(this.minutes(),2)+Me(this.seconds(),2)});function rh(h,_){Re(h,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),_)})}rh("a",!0),rh("A",!1);function oh(h,_){return _._meridiemParse}ue("a",oh),ue("A",oh),ue("H",de,Ue),ue("h",de,ze),ue("k",de,ze),ue("HH",de,k),ue("hh",de,k),ue("kk",de,k),ue("hmm",ct),ue("hmmss",ke),ue("Hmm",ct),ue("Hmmss",ke),$t(["H","HH"],In),$t(["k","kk"],function(h,_,S){var D=st(h);_[In]=D===24?0:D}),$t(["a","A"],function(h,_,S){S._isPm=S._locale.isPM(h),S._meridiem=h}),$t(["h","hh"],function(h,_,S){_[In]=st(h),A(S).bigHour=!0}),$t("hmm",function(h,_,S){var D=h.length-2;_[In]=st(h.substr(0,D)),_[ji]=st(h.substr(D)),A(S).bigHour=!0}),$t("hmmss",function(h,_,S){var D=h.length-4,U=h.length-2;_[In]=st(h.substr(0,D)),_[ji]=st(h.substr(D,2)),_[Qt]=st(h.substr(U)),A(S).bigHour=!0}),$t("Hmm",function(h,_,S){var D=h.length-2;_[In]=st(h.substr(0,D)),_[ji]=st(h.substr(D))}),$t("Hmmss",function(h,_,S){var D=h.length-4,U=h.length-2;_[In]=st(h.substr(0,D)),_[ji]=st(h.substr(D,2)),_[Qt]=st(h.substr(U))});function fa(h){return(h+"").toLowerCase().charAt(0)==="p"}var c6=/[ap]\.?m?\.?/i,d6=co("Hours",!0);function sh(h,_,S){return h>11?S?"pm":"PM":S?"am":"AM"}var ah={calendar:xe,longDateFormat:rt,invalidDate:ft,ordinal:Xn,dayOfMonthOrdinalParse:sn,relativeTime:Kt,months:pe,monthsShort:fe,week:Dn,weekdays:ca,weekdaysMin:Q1,weekdaysShort:Sd,meridiemParse:c6},Cn={},ll={},ha;function ul(h,_){var S,D=Math.min(h.length,_.length);for(S=0;S<D;S+=1)if(h[S]!==_[S])return S;return D}function lh(h){return h&&h.toLowerCase().replace("_","-")}function f6(h){for(var _=0,S,D,U,ee;_<h.length;){for(ee=lh(h[_]).split("-"),S=ee.length,D=lh(h[_+1]),D=D?D.split("-"):null;S>0;){if(U=cl(ee.slice(0,S).join("-")),U)return U;if(D&&D.length>=S&&ul(ee,D)>=S-1)break;S--}_++}return ha}function h6(h){return!!(h&&h.match("^[^/\\\\]*$"))}function cl(h){var _=null,S;if(Cn[h]===void 0&&typeof bd<"u"&&bd&&bd.exports&&h6(h))try{_=ha._abbr,S=WC,S("./locale/"+h),sr(_)}catch{Cn[h]=null}return Cn[h]}function sr(h,_){var S;return h&&(c(_)?S=To(h):S=Dd(h,_),S?ha=S:typeof console<"u"&&console.warn&&console.warn("Locale "+h+" not found. Did you forget to load it?")),ha._abbr}function Dd(h,_){if(_!==null){var S,D=ah;if(_.abbr=h,Cn[h]!=null)z("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),D=Cn[h]._config;else if(_.parentLocale!=null)if(Cn[_.parentLocale]!=null)D=Cn[_.parentLocale]._config;else if(S=cl(_.parentLocale),S!=null)D=S._config;else return ll[_.parentLocale]||(ll[_.parentLocale]=[]),ll[_.parentLocale].push({name:h,config:_}),null;return Cn[h]=new we(ce(D,_)),ll[h]&&ll[h].forEach(function(U){Dd(U.name,U.config)}),sr(h),Cn[h]}else return delete Cn[h],null}function p6(h,_){if(_!=null){var S,D,U=ah;Cn[h]!=null&&Cn[h].parentLocale!=null?Cn[h].set(ce(Cn[h]._config,_)):(D=cl(h),D!=null&&(U=D._config),_=ce(U,_),D==null&&(_.abbr=h),S=new we(_),S.parentLocale=Cn[h],Cn[h]=S),sr(h)}else Cn[h]!=null&&(Cn[h].parentLocale!=null?(Cn[h]=Cn[h].parentLocale,h===sr()&&sr(h)):Cn[h]!=null&&delete Cn[h]);return Cn[h]}function To(h){var _;if(h&&h._locale&&h._locale._abbr&&(h=h._locale._abbr),!h)return ha;if(!i(h)){if(_=cl(h),_)return _;h=[h]}return f6(h)}function m6(){return Ee(Cn)}function Pd(h){var _,S=h._a;return S&&A(h).overflow===-2&&(_=S[xr]<0||S[xr]>11?xr:S[or]<1||S[or]>ie(S[vi],S[xr])?or:S[In]<0||S[In]>24||S[In]===24&&(S[ji]!==0||S[Qt]!==0||S[lo]!==0)?In:S[ji]<0||S[ji]>59?ji:S[Qt]<0||S[Qt]>59?Qt:S[lo]<0||S[lo]>999?lo:-1,A(h)._overflowDayOfYear&&(_<vi||_>or)&&(_=or),A(h)._overflowWeeks&&_===-1&&(_=aa),A(h)._overflowWeekday&&_===-1&&(_=xu),A(h).overflow=_),h}var g6=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,_6=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,v6=/Z|[+-]\d\d(?::?\d\d)?/,Cu=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],Id=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Eu=/^\/?Date\((-?\d+)/i,uh=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,y6={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function ch(h){var _,S,D=h._i,U=g6.exec(D)||_6.exec(D),ee,be,lt,Dt,mn=Cu.length,ar=Id.length;if(U){for(A(h).iso=!0,_=0,S=mn;_<S;_++)if(Cu[_][1].exec(U[1])){be=Cu[_][0],ee=Cu[_][2]!==!1;break}if(be==null){h._isValid=!1;return}if(U[3]){for(_=0,S=ar;_<S;_++)if(Id[_][1].exec(U[3])){lt=(U[2]||" ")+Id[_][0];break}if(lt==null){h._isValid=!1;return}}if(!ee&&lt!=null){h._isValid=!1;return}if(U[4])if(v6.exec(U[4]))Dt="Z";else{h._isValid=!1;return}h._f=be+(lt||"")+(Dt||""),Su(h)}else h._isValid=!1}function x6(h,_,S,D,U,ee){var be=[dh(h),fe.indexOf(_),parseInt(S,10),parseInt(D,10),parseInt(U,10)];return ee&&be.push(parseInt(ee,10)),be}function dh(h){var _=parseInt(h,10);return _<=49?2e3+_:_<=999?1900+_:_}function b6(h){return h.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function Od(h,_,S){if(h){var D=Sd.indexOf(h),U=new Date(_[0],_[1],_[2]).getDay();if(D!==U)return A(S).weekdayMismatch=!0,S._isValid=!1,!1}return!0}function fh(h,_,S){if(h)return y6[h];if(_)return 0;var D=parseInt(S,10),U=D%100,ee=(D-U)/100;return ee*60+U}function Fd(h){var _=uh.exec(b6(h._i)),S;if(_){if(S=x6(_[4],_[3],_[2],_[5],_[6],_[7]),!Od(_[1],S,h))return;h._a=S,h._tzm=fh(_[8],_[9],_[10]),h._d=Yt.apply(null,h._a),h._d.setUTCMinutes(h._d.getUTCMinutes()-h._tzm),A(h).rfc2822=!0}else h._isValid=!1}function Rd(h){var _=Eu.exec(h._i);if(_!==null){h._d=new Date(+_[1]);return}if(ch(h),h._isValid===!1)delete h._isValid;else return;if(Fd(h),h._isValid===!1)delete h._isValid;else return;h._strict?h._isValid=!1:t.createFromInputFallback(h)}t.createFromInputFallback=oe("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(h){h._d=new Date(h._i+(h._useUTC?" UTC":""))});function Do(h,_,S){return h??_??S}function C6(h){var _=new Date(t.now());return h._useUTC?[_.getUTCFullYear(),_.getUTCMonth(),_.getUTCDate()]:[_.getFullYear(),_.getMonth(),_.getDate()]}function wu(h){var _,S,D=[],U,ee,be;if(!h._d){for(U=C6(h),h._w&&h._a[or]==null&&h._a[xr]==null&&hh(h),h._dayOfYear!=null&&(be=Do(h._a[vi],U[vi]),(h._dayOfYear>uo(be)||h._dayOfYear===0)&&(A(h)._overflowDayOfYear=!0),S=Yt(be,0,h._dayOfYear),h._a[xr]=S.getUTCMonth(),h._a[or]=S.getUTCDate()),_=0;_<3&&h._a[_]==null;++_)h._a[_]=D[_]=U[_];for(;_<7;_++)h._a[_]=D[_]=h._a[_]==null?_===2?1:0:h._a[_];h._a[In]===24&&h._a[ji]===0&&h._a[Qt]===0&&h._a[lo]===0&&(h._nextDay=!0,h._a[In]=0),h._d=(h._useUTC?Yt:_t).apply(null,D),ee=h._useUTC?h._d.getUTCDay():h._d.getDay(),h._tzm!=null&&h._d.setUTCMinutes(h._d.getUTCMinutes()-h._tzm),h._nextDay&&(h._a[In]=24),h._w&&typeof h._w.d<"u"&&h._w.d!==ee&&(A(h).weekdayMismatch=!0)}}function hh(h){var _,S,D,U,ee,be,lt,Dt,mn;_=h._w,_.GG!=null||_.W!=null||_.E!=null?(ee=1,be=4,S=Do(_.GG,h._a[vi],br(Vn(),1,4).year),D=Do(_.W,1),U=Do(_.E,1),(U<1||U>7)&&(Dt=!0)):(ee=h._locale._week.dow,be=h._locale._week.doy,mn=br(Vn(),ee,be),S=Do(_.gg,h._a[vi],mn.year),D=Do(_.w,mn.week),_.d!=null?(U=_.d,(U<0||U>6)&&(Dt=!0)):_.e!=null?(U=_.e+ee,(_.e<0||_.e>6)&&(Dt=!0)):U=ee),D<1||D>Jn(S,ee,be)?A(h)._overflowWeeks=!0:Dt!=null?A(h)._overflowWeekday=!0:(lt=Oi(S,D,U,ee,be),h._a[vi]=lt.year,h._dayOfYear=lt.dayOfYear)}t.ISO_8601=function(){},t.RFC_2822=function(){};function Su(h){if(h._f===t.ISO_8601){ch(h);return}if(h._f===t.RFC_2822){Fd(h);return}h._a=[],A(h).empty=!0;var _=""+h._i,S,D,U,ee,be,lt=_.length,Dt=0,mn,ar;for(U=De(h._f,h._locale).match(qe)||[],ar=U.length,S=0;S<ar;S++)ee=U[S],D=(_.match(Te(ee,h))||[])[0],D&&(be=_.substr(0,_.indexOf(D)),be.length>0&&A(h).unusedInput.push(be),_=_.slice(_.indexOf(D)+D.length),Dt+=D.length),Et[ee]?(D?A(h).empty=!1:A(h).unusedTokens.push(ee),sa(ee,D,h)):h._strict&&!D&&A(h).unusedTokens.push(ee);A(h).charsLeftOver=lt-Dt,_.length>0&&A(h).unusedInput.push(_),h._a[In]<=12&&A(h).bigHour===!0&&h._a[In]>0&&(A(h).bigHour=void 0),A(h).parsedDateParts=h._a.slice(0),A(h).meridiem=h._meridiem,h._a[In]=ph(h._locale,h._a[In],h._meridiem),mn=A(h).era,mn!==null&&(h._a[vi]=h._locale.erasConvertYear(mn,h._a[vi])),wu(h),Pd(h)}function ph(h,_,S){var D;return S==null?_:h.meridiemHour!=null?h.meridiemHour(_,S):(h.isPM!=null&&(D=h.isPM(S),D&&_<12&&(_+=12),!D&&_===12&&(_=0)),_)}function mh(h){var _,S,D,U,ee,be,lt=!1,Dt=h._f.length;if(Dt===0){A(h).invalidFormat=!0,h._d=new Date(NaN);return}for(U=0;U<Dt;U++)ee=0,be=!1,_=q({},h),h._useUTC!=null&&(_._useUTC=h._useUTC),_._f=h._f[U],Su(_),T(_)&&(be=!0),ee+=A(_).charsLeftOver,ee+=A(_).unusedTokens.length*10,A(_).score=ee,lt?ee<D&&(D=ee,S=_):(D==null||ee<D||be)&&(D=ee,S=_,be&&(lt=!0));m(h,S||_)}function gh(h){if(!h._d){var _=an(h._i),S=_.day===void 0?_.date:_.day;h._a=g([_.year,_.month,S,_.hour,_.minute,_.second,_.millisecond],function(D){return D&&parseInt(D,10)}),wu(h)}}function _h(h){var _=new X(Pd(kd(h)));return _._nextDay&&(_.add(1,"d"),_._nextDay=void 0),_}function kd(h){var _=h._i,S=h._f;return h._locale=h._locale||To(h._l),_===null||S===void 0&&_===""?M({nullInput:!0}):(typeof _=="string"&&(h._i=_=h._locale.preparse(_)),Z(_)?new X(Pd(_)):(p(_)?h._d=_:i(S)?mh(h):S?Su(h):vh(h),T(h)||(h._d=null),h))}function vh(h){var _=h._i;c(_)?h._d=new Date(t.now()):p(_)?h._d=new Date(_.valueOf()):typeof _=="string"?Rd(h):i(_)?(h._a=g(_.slice(0),function(S){return parseInt(S,10)}),wu(h)):r(_)?gh(h):f(_)?h._d=new Date(_):t.createFromInputFallback(h)}function Po(h,_,S,D,U){var ee={};return(_===!0||_===!1)&&(D=_,_=void 0),(S===!0||S===!1)&&(D=S,S=void 0),(r(h)&&l(h)||i(h)&&h.length===0)&&(h=void 0),ee._isAMomentObject=!0,ee._useUTC=ee._isUTC=U,ee._l=S,ee._i=h,ee._f=_,ee._strict=D,_h(ee)}function Vn(h,_,S,D){return Po(h,_,S,D,!1)}var E6=oe("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var h=Vn.apply(null,arguments);return this.isValid()&&h.isValid()?h<this?this:h:M()}),w6=oe("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var h=Vn.apply(null,arguments);return this.isValid()&&h.isValid()?h>this?this:h:M()});function Nd(h,_){var S,D;if(_.length===1&&i(_[0])&&(_=_[0]),!_.length)return Vn();for(S=_[0],D=1;D<_.length;++D)(!_[D].isValid()||_[D][h](S))&&(S=_[D]);return S}function yh(){var h=[].slice.call(arguments,0);return Nd("isBefore",h)}function xh(){var h=[].slice.call(arguments,0);return Nd("isAfter",h)}var S6=function(){return Date.now?Date.now():+new Date},dl=["year","quarter","month","week","day","hour","minute","second","millisecond"];function M6(h){var _,S=!1,D,U=dl.length;for(_ in h)if(o(h,_)&&!(N.call(dl,_)!==-1&&(h[_]==null||!isNaN(h[_]))))return!1;for(D=0;D<U;++D)if(h[dl[D]]){if(S)return!1;parseFloat(h[dl[D]])!==st(h[dl[D]])&&(S=!0)}return!0}function bh(){return this._isValid}function Ch(){return zr(NaN)}function Mu(h){var _=an(h),S=_.year||0,D=_.quarter||0,U=_.month||0,ee=_.week||_.isoWeek||0,be=_.day||0,lt=_.hour||0,Dt=_.minute||0,mn=_.second||0,ar=_.millisecond||0;this._isValid=M6(_),this._milliseconds=+ar+mn*1e3+Dt*6e4+lt*1e3*60*60,this._days=+be+ee*7,this._months=+U+D*3+S*12,this._data={},this._locale=To(),this._bubble()}function fl(h){return h instanceof Mu}function Ud(h){return h<0?Math.round(-1*h)*-1:Math.round(h)}function Eh(h,_,S){var D=Math.min(h.length,_.length),U=Math.abs(h.length-_.length),ee=0,be;for(be=0;be<D;be++)(S&&h[be]!==_[be]||!S&&st(h[be])!==st(_[be]))&&ee++;return ee+U}function Au(h,_){Re(h,0,0,function(){var S=this.utcOffset(),D="+";return S<0&&(S=-S,D="-"),D+Me(~~(S/60),2)+_+Me(~~S%60,2)})}Au("Z",":"),Au("ZZ",""),ue("Z",je),ue("ZZ",je),$t(["Z","ZZ"],function(h,_,S){S._useUTC=!0,S._tzm=Ld(je,h)});var A6=/([\+\-]|\d\d)/gi;function Ld(h,_){var S=(_||"").match(h),D,U,ee;return S===null?null:(D=S[S.length-1]||[],U=(D+"").match(A6)||["-",0,0],ee=+(U[1]*60)+st(U[2]),ee===0?0:U[0]==="+"?ee:-ee)}function Bd(h,_){var S,D;return _._isUTC?(S=_.clone(),D=(Z(h)||p(h)?h.valueOf():Vn(h).valueOf())-S.valueOf(),S._d.setTime(S._d.valueOf()+D),t.updateOffset(S,!1),S):Vn(h).local()}function Vd(h){return-Math.round(h._d.getTimezoneOffset())}t.updateOffset=function(){};function Tu(h,_,S){var D=this._offset||0,U;if(!this.isValid())return h!=null?this:NaN;if(h!=null){if(typeof h=="string"){if(h=Ld(je,h),h===null)return this}else Math.abs(h)<16&&!S&&(h=h*60);return!this._isUTC&&_&&(U=Vd(this)),this._offset=h,this._isUTC=!0,U!=null&&this.add(U,"m"),D!==h&&(!_||this._changeInProgress?Ah(this,zr(h-D,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?D:Vd(this)}function T6(h,_){return h!=null?(typeof h!="string"&&(h=-h),this.utcOffset(h,_),this):-this.utcOffset()}function D6(h){return this.utcOffset(0,h)}function P6(h){return this._isUTC&&(this.utcOffset(0,h),this._isUTC=!1,h&&this.subtract(Vd(this),"m")),this}function I6(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var h=Ld(ht,this._i);h!=null?this.utcOffset(h):this.utcOffset(0,!0)}return this}function wh(h){return this.isValid()?(h=h?Vn(h).utcOffset():0,(this.utcOffset()-h)%60===0):!1}function O6(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function F6(){if(!c(this._isDSTShifted))return this._isDSTShifted;var h={},_;return q(h,this),h=kd(h),h._a?(_=h._isUTC?x(h._a):Vn(h._a),this._isDSTShifted=this.isValid()&&Eh(h._a,_.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function R6(){return this.isValid()?!this._isUTC:!1}function k6(){return this.isValid()?this._isUTC:!1}function Hd(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Sh=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,N6=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function zr(h,_){var S=h,D=null,U,ee,be;return fl(h)?S={ms:h._milliseconds,d:h._days,M:h._months}:f(h)||!isNaN(+h)?(S={},_?S[_]=+h:S.milliseconds=+h):(D=Sh.exec(h))?(U=D[1]==="-"?-1:1,S={y:0,d:st(D[or])*U,h:st(D[In])*U,m:st(D[ji])*U,s:st(D[Qt])*U,ms:st(Ud(D[lo]*1e3))*U}):(D=N6.exec(h))?(U=D[1]==="-"?-1:1,S={y:Ss(D[2],U),M:Ss(D[3],U),w:Ss(D[4],U),d:Ss(D[5],U),h:Ss(D[6],U),m:Ss(D[7],U),s:Ss(D[8],U)}):S==null?S={}:typeof S=="object"&&("from"in S||"to"in S)&&(be=jd(Vn(S.from),Vn(S.to)),S={},S.ms=be.milliseconds,S.M=be.months),ee=new Mu(S),fl(h)&&o(h,"_locale")&&(ee._locale=h._locale),fl(h)&&o(h,"_isValid")&&(ee._isValid=h._isValid),ee}zr.fn=Mu.prototype,zr.invalid=Ch;function Ss(h,_){var S=h&&parseFloat(h.replace(",","."));return(isNaN(S)?0:S)*_}function zd(h,_){var S={};return S.months=_.month()-h.month()+(_.year()-h.year())*12,h.clone().add(S.months,"M").isAfter(_)&&--S.months,S.milliseconds=+_-+h.clone().add(S.months,"M"),S}function jd(h,_){var S;return h.isValid()&&_.isValid()?(_=Bd(_,h),h.isBefore(_)?S=zd(h,_):(S=zd(_,h),S.milliseconds=-S.milliseconds,S.months=-S.months),S):{milliseconds:0,months:0}}function Mh(h,_){return function(S,D){var U,ee;return D!==null&&!isNaN(+D)&&(z(_,"moment()."+_+"(period, number) is deprecated. Please use moment()."+_+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),ee=S,S=D,D=ee),U=zr(S,D),Ah(this,U,h),this}}function Ah(h,_,S,D){var U=_._milliseconds,ee=Ud(_._days),be=Ud(_._months);h.isValid()&&(D=D??!0,be&&yt(h,Hr(h,"Month")+be*S),ee&&al(h,"Date",Hr(h,"Date")+ee*S),U&&h._d.setTime(h._d.valueOf()+U*S),D&&t.updateOffset(h,ee||be))}var U6=Mh(1,"add"),PC=Mh(-1,"subtract");function L6(h){return typeof h=="string"||h instanceof String}function IC(h){return Z(h)||p(h)||L6(h)||f(h)||V6(h)||B6(h)||h===null||h===void 0}function B6(h){var _=r(h)&&!l(h),S=!1,D=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],U,ee,be=D.length;for(U=0;U<be;U+=1)ee=D[U],S=S||o(h,ee);return _&&S}function V6(h){var _=i(h),S=!1;return _&&(S=h.filter(function(D){return!f(D)&&L6(h)}).length===0),_&&S}function Th(h){var _=r(h)&&!l(h),S=!1,D=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],U,ee;for(U=0;U<D.length;U+=1)ee=D[U],S=S||o(h,ee);return _&&S}function H6(h,_){var S=h.diff(_,"days",!0);return S<-6?"sameElse":S<-1?"lastWeek":S<0?"lastDay":S<1?"sameDay":S<2?"nextDay":S<7?"nextWeek":"sameElse"}function z6(h,_){arguments.length===1&&(arguments[0]?IC(arguments[0])?(h=arguments[0],_=void 0):Th(arguments[0])&&(_=arguments[0],h=void 0):(h=void 0,_=void 0));var S=h||Vn(),D=Bd(S,this).startOf("day"),U=t.calendarFormat(this,D)||"sameElse",ee=_&&(K(_[U])?_[U].call(this,S):_[U]);return this.format(ee||this.localeData().calendar(U,this,Vn(S)))}function j6(){return new X(this)}function W6(h,_){var S=Z(h)?h:Vn(h);return this.isValid()&&S.isValid()?(_=cn(_)||"millisecond",_==="millisecond"?this.valueOf()>S.valueOf():S.valueOf()<this.clone().startOf(_).valueOf()):!1}function G6(h,_){var S=Z(h)?h:Vn(h);return this.isValid()&&S.isValid()?(_=cn(_)||"millisecond",_==="millisecond"?this.valueOf()<S.valueOf():this.clone().endOf(_).valueOf()<S.valueOf()):!1}function $6(h,_,S,D){var U=Z(h)?h:Vn(h),ee=Z(_)?_:Vn(_);return this.isValid()&&U.isValid()&&ee.isValid()?(D=D||"()",(D[0]==="("?this.isAfter(U,S):!this.isBefore(U,S))&&(D[1]===")"?this.isBefore(ee,S):!this.isAfter(ee,S))):!1}function Y6(h,_){var S=Z(h)?h:Vn(h),D;return this.isValid()&&S.isValid()?(_=cn(_)||"millisecond",_==="millisecond"?this.valueOf()===S.valueOf():(D=S.valueOf(),this.clone().startOf(_).valueOf()<=D&&D<=this.clone().endOf(_).valueOf())):!1}function q6(h,_){return this.isSame(h,_)||this.isAfter(h,_)}function X6(h,_){return this.isSame(h,_)||this.isBefore(h,_)}function Ms(h,_,S){var D,U,ee;if(!this.isValid())return NaN;if(D=Bd(h,this),!D.isValid())return NaN;switch(U=(D.utcOffset()-this.utcOffset())*6e4,_=cn(_),_){case"year":ee=hl(this,D)/12;break;case"month":ee=hl(this,D);break;case"quarter":ee=hl(this,D)/3;break;case"second":ee=(this-D)/1e3;break;case"minute":ee=(this-D)/6e4;break;case"hour":ee=(this-D)/36e5;break;case"day":ee=(this-D-U)/864e5;break;case"week":ee=(this-D-U)/6048e5;break;default:ee=this-D}return S?ee:Wt(ee)}function hl(h,_){if(h.date()<_.date())return-hl(_,h);var S=(_.year()-h.year())*12+(_.month()-h.month()),D=h.clone().add(S,"months"),U,ee;return _-D<0?(U=h.clone().add(S-1,"months"),ee=(_-D)/(D-U)):(U=h.clone().add(S+1,"months"),ee=(_-D)/(U-D)),-(S+ee)||0}t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",t.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function Z6(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function Du(h){if(!this.isValid())return null;var _=h!==!0,S=_?this.clone().utc():this;return S.year()<0||S.year()>9999?Se(S,_?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):K(Date.prototype.toISOString)?_?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Se(S,"Z")):Se(S,_?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function J6(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var h="moment",_="",S,D,U,ee;return this.isLocal()||(h=this.utcOffset()===0?"moment.utc":"moment.parseZone",_="Z"),S="["+h+'("]',D=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",U="-MM-DD[T]HH:mm:ss.SSS",ee=_+'[")]',this.format(S+D+U+ee)}function K6(h){h||(h=this.isUtc()?t.defaultFormatUtc:t.defaultFormat);var _=Se(this,h);return this.localeData().postformat(_)}function Q6(h,_){return this.isValid()&&(Z(h)&&h.isValid()||Vn(h).isValid())?zr({to:this,from:h}).locale(this.locale()).humanize(!_):this.localeData().invalidDate()}function Dh(h){return this.from(Vn(),h)}function ev(h,_){return this.isValid()&&(Z(h)&&h.isValid()||Vn(h).isValid())?zr({from:this,to:h}).locale(this.locale()).humanize(!_):this.localeData().invalidDate()}function tv(h){return this.to(Vn(),h)}function Ph(h){var _;return h===void 0?this._locale._abbr:(_=To(h),_!=null&&(this._locale=_),this)}var jr=oe("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(h){return h===void 0?this.localeData():this.locale(h)});function pl(){return this._locale}var jn=1e3,pa=60*jn,Pu=60*pa,Ih=(365*400+97)*24*Pu;function ma(h,_){return(h%_+_)%_}function Oh(h,_,S){return h<100&&h>=0?new Date(h+400,_,S)-Ih:new Date(h,_,S).valueOf()}function Fh(h,_,S){return h<100&&h>=0?Date.UTC(h+400,_,S)-Ih:Date.UTC(h,_,S)}function nv(h){var _,S;if(h=cn(h),h===void 0||h==="millisecond"||!this.isValid())return this;switch(S=this._isUTC?Fh:Oh,h){case"year":_=S(this.year(),0,1);break;case"quarter":_=S(this.year(),this.month()-this.month()%3,1);break;case"month":_=S(this.year(),this.month(),1);break;case"week":_=S(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":_=S(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":_=S(this.year(),this.month(),this.date());break;case"hour":_=this._d.valueOf(),_-=ma(_+(this._isUTC?0:this.utcOffset()*pa),Pu);break;case"minute":_=this._d.valueOf(),_-=ma(_,pa);break;case"second":_=this._d.valueOf(),_-=ma(_,jn);break}return this._d.setTime(_),t.updateOffset(this,!0),this}function iv(h){var _,S;if(h=cn(h),h===void 0||h==="millisecond"||!this.isValid())return this;switch(S=this._isUTC?Fh:Oh,h){case"year":_=S(this.year()+1,0,1)-1;break;case"quarter":_=S(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":_=S(this.year(),this.month()+1,1)-1;break;case"week":_=S(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":_=S(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":_=S(this.year(),this.month(),this.date()+1)-1;break;case"hour":_=this._d.valueOf(),_+=Pu-ma(_+(this._isUTC?0:this.utcOffset()*pa),Pu)-1;break;case"minute":_=this._d.valueOf(),_+=pa-ma(_,pa)-1;break;case"second":_=this._d.valueOf(),_+=jn-ma(_,jn)-1;break}return this._d.setTime(_),t.updateOffset(this,!0),this}function Iu(){return this._d.valueOf()-(this._offset||0)*6e4}function v(){return Math.floor(this.valueOf()/1e3)}function y(){return new Date(this.valueOf())}function P(){var h=this;return[h.year(),h.month(),h.date(),h.hour(),h.minute(),h.second(),h.millisecond()]}function V(){var h=this;return{years:h.year(),months:h.month(),date:h.date(),hours:h.hours(),minutes:h.minutes(),seconds:h.seconds(),milliseconds:h.milliseconds()}}function se(){return this.isValid()?this.toISOString():null}function Ve(){return T(this)}function Ot(){return m({},A(this))}function ln(){return A(this).overflow}function On(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Re("N",0,0,"eraAbbr"),Re("NN",0,0,"eraAbbr"),Re("NNN",0,0,"eraAbbr"),Re("NNNN",0,0,"eraName"),Re("NNNNN",0,0,"eraNarrow"),Re("y",["y",1],"yo","eraYear"),Re("y",["yy",2],0,"eraYear"),Re("y",["yyy",3],0,"eraYear"),Re("y",["yyyy",4],0,"eraYear"),ue("N",rv),ue("NN",rv),ue("NNN",rv),ue("NNNN",CD),ue("NNNNN",ED),$t(["N","NN","NNN","NNNN","NNNNN"],function(h,_,S,D){var U=S._locale.erasParse(h,D,S._strict);U?A(S).era=U:A(S).invalidEra=h}),ue("y",He),ue("yy",He),ue("yyy",He),ue("yyyy",He),ue("yo",wD),$t(["y","yy","yyy","yyyy"],vi),$t(["yo"],function(h,_,S,D){var U;S._locale._eraYearOrdinalRegex&&(U=h.match(S._locale._eraYearOrdinalRegex)),S._locale.eraYearOrdinalParse?_[vi]=S._locale.eraYearOrdinalParse(h,U):_[vi]=parseInt(h,10)});function ga(h,_){var S,D,U,ee=this._eras||To("en")._eras;for(S=0,D=ee.length;S<D;++S){switch(typeof ee[S].since){case"string":U=t(ee[S].since).startOf("day"),ee[S].since=U.valueOf();break}switch(typeof ee[S].until){case"undefined":ee[S].until=1/0;break;case"string":U=t(ee[S].until).startOf("day").valueOf(),ee[S].until=U.valueOf();break}}return ee}function Wd(h,_,S){var D,U,ee=this.eras(),be,lt,Dt;for(h=h.toUpperCase(),D=0,U=ee.length;D<U;++D)if(be=ee[D].name.toUpperCase(),lt=ee[D].abbr.toUpperCase(),Dt=ee[D].narrow.toUpperCase(),S)switch(_){case"N":case"NN":case"NNN":if(lt===h)return ee[D];break;case"NNNN":if(be===h)return ee[D];break;case"NNNNN":if(Dt===h)return ee[D];break}else if([be,lt,Dt].indexOf(h)>=0)return ee[D]}function pD(h,_){var S=h.since<=h.until?1:-1;return _===void 0?t(h.since).year():t(h.since).year()+(_-h.offset)*S}function mD(){var h,_,S,D=this.localeData().eras();for(h=0,_=D.length;h<_;++h)if(S=this.clone().startOf("day").valueOf(),D[h].since<=S&&S<=D[h].until||D[h].until<=S&&S<=D[h].since)return D[h].name;return""}function gD(){var h,_,S,D=this.localeData().eras();for(h=0,_=D.length;h<_;++h)if(S=this.clone().startOf("day").valueOf(),D[h].since<=S&&S<=D[h].until||D[h].until<=S&&S<=D[h].since)return D[h].narrow;return""}function _D(){var h,_,S,D=this.localeData().eras();for(h=0,_=D.length;h<_;++h)if(S=this.clone().startOf("day").valueOf(),D[h].since<=S&&S<=D[h].until||D[h].until<=S&&S<=D[h].since)return D[h].abbr;return""}function vD(){var h,_,S,D,U=this.localeData().eras();for(h=0,_=U.length;h<_;++h)if(S=U[h].since<=U[h].until?1:-1,D=this.clone().startOf("day").valueOf(),U[h].since<=D&&D<=U[h].until||U[h].until<=D&&D<=U[h].since)return(this.year()-t(U[h].since).year())*S+U[h].offset;return this.year()}function yD(h){return o(this,"_erasNameRegex")||ov.call(this),h?this._erasNameRegex:this._erasRegex}function xD(h){return o(this,"_erasAbbrRegex")||ov.call(this),h?this._erasAbbrRegex:this._erasRegex}function bD(h){return o(this,"_erasNarrowRegex")||ov.call(this),h?this._erasNarrowRegex:this._erasRegex}function rv(h,_){return _.erasAbbrRegex(h)}function CD(h,_){return _.erasNameRegex(h)}function ED(h,_){return _.erasNarrowRegex(h)}function wD(h,_){return _._eraYearOrdinalRegex||He}function ov(){var h=[],_=[],S=[],D=[],U,ee,be,lt,Dt,mn=this.eras();for(U=0,ee=mn.length;U<ee;++U)be=vt(mn[U].name),lt=vt(mn[U].abbr),Dt=vt(mn[U].narrow),_.push(be),h.push(lt),S.push(Dt),D.push(be),D.push(lt),D.push(Dt);this._erasRegex=new RegExp("^("+D.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+_.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+h.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+S.join("|")+")","i")}Re(0,["gg",2],0,function(){return this.weekYear()%100}),Re(0,["GG",2],0,function(){return this.isoWeekYear()%100});function Rh(h,_){Re(0,[h,h.length],0,_)}Rh("gggg","weekYear"),Rh("ggggg","weekYear"),Rh("GGGG","isoWeekYear"),Rh("GGGGG","isoWeekYear"),ue("G",tt),ue("g",tt),ue("GG",de,k),ue("gg",de,k),ue("GGGG",xt,ge),ue("gggg",xt,ge),ue("GGGGG",Fe,Ae),ue("ggggg",Fe,Ae),Es(["gggg","ggggg","GGGG","GGGGG"],function(h,_,S,D){_[D.substr(0,2)]=st(h)}),Es(["gg","GG"],function(h,_,S,D){_[D]=t.parseTwoDigitYear(h)});function SD(h){return OC.call(this,h,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function MD(h){return OC.call(this,h,this.isoWeek(),this.isoWeekday(),1,4)}function AD(){return Jn(this.year(),1,4)}function TD(){return Jn(this.isoWeekYear(),1,4)}function DD(){var h=this.localeData()._week;return Jn(this.year(),h.dow,h.doy)}function PD(){var h=this.localeData()._week;return Jn(this.weekYear(),h.dow,h.doy)}function OC(h,_,S,D,U){var ee;return h==null?br(this,D,U).year:(ee=Jn(h,D,U),_>ee&&(_=ee),ID.call(this,h,_,S,D,U))}function ID(h,_,S,D,U){var ee=Oi(h,_,S,D,U),be=Yt(ee.year,0,ee.dayOfYear);return this.year(be.getUTCFullYear()),this.month(be.getUTCMonth()),this.date(be.getUTCDate()),this}Re("Q",0,"Qo","quarter"),ue("Q",W),$t("Q",function(h,_){_[xr]=(st(h)-1)*3});function OD(h){return h==null?Math.ceil((this.month()+1)/3):this.month((h-1)*3+this.month()%3)}Re("D",["DD",2],"Do","date"),ue("D",de,ze),ue("DD",de,k),ue("Do",function(h,_){return h?_._dayOfMonthOrdinalParse||_._ordinalParse:_._dayOfMonthOrdinalParseLenient}),$t(["D","DD"],or),$t("Do",function(h,_){_[or]=st(h.match(de)[0])});var FC=co("Date",!0);Re("DDD",["DDDD",3],"DDDo","dayOfYear"),ue("DDD",dt),ue("DDDD",te),$t(["DDD","DDDD"],function(h,_,S){S._dayOfYear=st(h)});function FD(h){var _=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return h==null?_:this.add(h-_,"d")}Re("m",["mm",2],0,"minute"),ue("m",de,Ue),ue("mm",de,k),$t(["m","mm"],ji);var RD=co("Minutes",!1);Re("s",["ss",2],0,"second"),ue("s",de,Ue),ue("ss",de,k),$t(["s","ss"],Qt);var kD=co("Seconds",!1);Re("S",0,0,function(){return~~(this.millisecond()/100)}),Re(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),Re(0,["SSS",3],0,"millisecond"),Re(0,["SSSS",4],0,function(){return this.millisecond()*10}),Re(0,["SSSSS",5],0,function(){return this.millisecond()*100}),Re(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),Re(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),Re(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),Re(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),ue("S",dt,W),ue("SS",dt,k),ue("SSS",dt,te);var _a,RC;for(_a="SSSS";_a.length<=9;_a+="S")ue(_a,He);function ND(h,_){_[lo]=st(("0."+h)*1e3)}for(_a="S";_a.length<=9;_a+="S")$t(_a,ND);RC=co("Milliseconds",!1),Re("z",0,0,"zoneAbbr"),Re("zz",0,0,"zoneName");function UD(){return this._isUTC?"UTC":""}function LD(){return this._isUTC?"Coordinated Universal Time":""}var Le=X.prototype;Le.add=U6,Le.calendar=z6,Le.clone=j6,Le.diff=Ms,Le.endOf=iv,Le.format=K6,Le.from=Q6,Le.fromNow=Dh,Le.to=ev,Le.toNow=tv,Le.get=la,Le.invalidAt=ln,Le.isAfter=W6,Le.isBefore=G6,Le.isBetween=$6,Le.isSame=Y6,Le.isSameOrAfter=q6,Le.isSameOrBefore=X6,Le.isValid=Ve,Le.lang=jr,Le.locale=Ph,Le.localeData=pl,Le.max=w6,Le.min=E6,Le.parsingFlags=Ot,Le.set=Zn,Le.startOf=nv,Le.subtract=PC,Le.toArray=P,Le.toObject=V,Le.toDate=y,Le.toISOString=Du,Le.inspect=J6,typeof Symbol<"u"&&Symbol.for!=null&&(Le[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),Le.toJSON=se,Le.toString=Z6,Le.unix=v,Le.valueOf=Iu,Le.creationData=On,Le.eraName=mD,Le.eraNarrow=gD,Le.eraAbbr=_D,Le.eraYear=vD,Le.year=sl,Le.isLeapYear=bu,Le.weekYear=SD,Le.isoWeekYear=MD,Le.quarter=Le.quarters=OD,Le.month=Rt,Le.daysInMonth=bn,Le.week=Le.weeks=yi,Le.isoWeek=Le.isoWeeks=Vi,Le.weeksInYear=DD,Le.weeksInWeekYear=PD,Le.isoWeeksInYear=AD,Le.isoWeeksInISOWeekYear=TD,Le.date=FC,Le.day=Le.days=da,Le.weekday=s6,Le.isoWeekday=nh,Le.dayOfYear=FD,Le.hour=Le.hours=d6,Le.minute=Le.minutes=RD,Le.second=Le.seconds=kD,Le.millisecond=Le.milliseconds=RC,Le.utcOffset=Tu,Le.utc=D6,Le.local=P6,Le.parseZone=I6,Le.hasAlignedHourOffset=wh,Le.isDST=O6,Le.isLocal=R6,Le.isUtcOffset=k6,Le.isUtc=Hd,Le.isUTC=Hd,Le.zoneAbbr=UD,Le.zoneName=LD,Le.dates=oe("dates accessor is deprecated. Use date instead.",FC),Le.months=oe("months accessor is deprecated. Use month instead",Rt),Le.years=oe("years accessor is deprecated. Use year instead",sl),Le.zone=oe("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",T6),Le.isDSTShifted=oe("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",F6);function BD(h){return Vn(h*1e3)}function VD(){return Vn.apply(null,arguments).parseZone()}function kC(h){return h}var Mn=we.prototype;Mn.calendar=me,Mn.longDateFormat=Pt,Mn.invalidDate=tn,Mn.ordinal=It,Mn.preparse=kC,Mn.postformat=kC,Mn.relativeTime=Nt,Mn.pastFuture=un,Mn.set=re,Mn.eras=ga,Mn.erasParse=Wd,Mn.erasConvertYear=pD,Mn.erasAbbrRegex=xD,Mn.erasNameRegex=yD,Mn.erasNarrowRegex=bD,Mn.months=Ze,Mn.monthsShort=at,Mn.monthsParse=Ct,Mn.monthsRegex=zn,Mn.monthsShortRegex=Bn,Mn.week=ws,Mn.firstDayOfYear=Zi,Mn.firstDayOfWeek=Bi,Mn.weekdays=t6,Mn.weekdaysMin=i6,Mn.weekdaysShort=n6,Mn.weekdaysParse=o6,Mn.weekdaysRegex=ih,Mn.weekdaysShortRegex=a6,Mn.weekdaysMinRegex=l6,Mn.isPM=fa,Mn.meridiem=sh;function kh(h,_,S,D){var U=To(),ee=x().set(D,_);return U[S](ee,h)}function NC(h,_,S){if(f(h)&&(_=h,h=void 0),h=h||"",_!=null)return kh(h,_,S,"month");var D,U=[];for(D=0;D<12;D++)U[D]=kh(h,D,S,"month");return U}function sv(h,_,S,D){typeof h=="boolean"?(f(_)&&(S=_,_=void 0),_=_||""):(_=h,S=_,h=!1,f(_)&&(S=_,_=void 0),_=_||"");var U=To(),ee=h?U._week.dow:0,be,lt=[];if(S!=null)return kh(_,(S+ee)%7,D,"day");for(be=0;be<7;be++)lt[be]=kh(_,(be+ee)%7,D,"day");return lt}function HD(h,_){return NC(h,_,"months")}function zD(h,_){return NC(h,_,"monthsShort")}function jD(h,_,S){return sv(h,_,S,"weekdays")}function WD(h,_,S){return sv(h,_,S,"weekdaysShort")}function GD(h,_,S){return sv(h,_,S,"weekdaysMin")}sr("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(h){var _=h%10,S=st(h%100/10)===1?"th":_===1?"st":_===2?"nd":_===3?"rd":"th";return h+S}}),t.lang=oe("moment.lang is deprecated. Use moment.locale instead.",sr),t.langData=oe("moment.langData is deprecated. Use moment.localeData instead.",To);var As=Math.abs;function $D(){var h=this._data;return this._milliseconds=As(this._milliseconds),this._days=As(this._days),this._months=As(this._months),h.milliseconds=As(h.milliseconds),h.seconds=As(h.seconds),h.minutes=As(h.minutes),h.hours=As(h.hours),h.months=As(h.months),h.years=As(h.years),this}function UC(h,_,S,D){var U=zr(_,S);return h._milliseconds+=D*U._milliseconds,h._days+=D*U._days,h._months+=D*U._months,h._bubble()}function YD(h,_){return UC(this,h,_,1)}function qD(h,_){return UC(this,h,_,-1)}function LC(h){return h<0?Math.floor(h):Math.ceil(h)}function XD(){var h=this._milliseconds,_=this._days,S=this._months,D=this._data,U,ee,be,lt,Dt;return h>=0&&_>=0&&S>=0||h<=0&&_<=0&&S<=0||(h+=LC(av(S)+_)*864e5,_=0,S=0),D.milliseconds=h%1e3,U=Wt(h/1e3),D.seconds=U%60,ee=Wt(U/60),D.minutes=ee%60,be=Wt(ee/60),D.hours=be%24,_+=Wt(be/24),Dt=Wt(BC(_)),S+=Dt,_-=LC(av(Dt)),lt=Wt(S/12),S%=12,D.days=_,D.months=S,D.years=lt,this}function BC(h){return h*4800/146097}function av(h){return h*146097/4800}function ZD(h){if(!this.isValid())return NaN;var _,S,D=this._milliseconds;if(h=cn(h),h==="month"||h==="quarter"||h==="year")switch(_=this._days+D/864e5,S=this._months+BC(_),h){case"month":return S;case"quarter":return S/3;case"year":return S/12}else switch(_=this._days+Math.round(av(this._months)),h){case"week":return _/7+D/6048e5;case"day":return _+D/864e5;case"hour":return _*24+D/36e5;case"minute":return _*1440+D/6e4;case"second":return _*86400+D/1e3;case"millisecond":return Math.floor(_*864e5)+D;default:throw new Error("Unknown unit "+h)}}function Ts(h){return function(){return this.as(h)}}var VC=Ts("ms"),JD=Ts("s"),KD=Ts("m"),QD=Ts("h"),eP=Ts("d"),tP=Ts("w"),nP=Ts("M"),iP=Ts("Q"),rP=Ts("y"),oP=VC;function sP(){return zr(this)}function aP(h){return h=cn(h),this.isValid()?this[h+"s"]():NaN}function ml(h){return function(){return this.isValid()?this._data[h]:NaN}}var lP=ml("milliseconds"),uP=ml("seconds"),cP=ml("minutes"),dP=ml("hours"),fP=ml("days"),hP=ml("months"),pP=ml("years");function mP(){return Wt(this.days()/7)}var Ds=Math.round,Ou={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function gP(h,_,S,D,U){return U.relativeTime(_||1,!!S,h,D)}function _P(h,_,S,D){var U=zr(h).abs(),ee=Ds(U.as("s")),be=Ds(U.as("m")),lt=Ds(U.as("h")),Dt=Ds(U.as("d")),mn=Ds(U.as("M")),ar=Ds(U.as("w")),Ps=Ds(U.as("y")),va=ee<=S.ss&&["s",ee]||ee<S.s&&["ss",ee]||be<=1&&["m"]||be<S.m&&["mm",be]||lt<=1&&["h"]||lt<S.h&&["hh",lt]||Dt<=1&&["d"]||Dt<S.d&&["dd",Dt];return S.w!=null&&(va=va||ar<=1&&["w"]||ar<S.w&&["ww",ar]),va=va||mn<=1&&["M"]||mn<S.M&&["MM",mn]||Ps<=1&&["y"]||["yy",Ps],va[2]=_,va[3]=+h>0,va[4]=D,gP.apply(null,va)}function vP(h){return h===void 0?Ds:typeof h=="function"?(Ds=h,!0):!1}function yP(h,_){return Ou[h]===void 0?!1:_===void 0?Ou[h]:(Ou[h]=_,h==="s"&&(Ou.ss=_-1),!0)}function xP(h,_){if(!this.isValid())return this.localeData().invalidDate();var S=!1,D=Ou,U,ee;return typeof h=="object"&&(_=h,h=!1),typeof h=="boolean"&&(S=h),typeof _=="object"&&(D=Object.assign({},Ou,_),_.s!=null&&_.ss==null&&(D.ss=_.s-1)),U=this.localeData(),ee=_P(this,!S,D,U),S&&(ee=U.pastFuture(+this,ee)),U.postformat(ee)}var lv=Math.abs;function Fu(h){return(h>0)-(h<0)||+h}function Nh(){if(!this.isValid())return this.localeData().invalidDate();var h=lv(this._milliseconds)/1e3,_=lv(this._days),S=lv(this._months),D,U,ee,be,lt=this.asSeconds(),Dt,mn,ar,Ps;return lt?(D=Wt(h/60),U=Wt(D/60),h%=60,D%=60,ee=Wt(S/12),S%=12,be=h?h.toFixed(3).replace(/\.?0+$/,""):"",Dt=lt<0?"-":"",mn=Fu(this._months)!==Fu(lt)?"-":"",ar=Fu(this._days)!==Fu(lt)?"-":"",Ps=Fu(this._milliseconds)!==Fu(lt)?"-":"",Dt+"P"+(ee?mn+ee+"Y":"")+(S?mn+S+"M":"")+(_?ar+_+"D":"")+(U||D||h?"T":"")+(U?Ps+U+"H":"")+(D?Ps+D+"M":"")+(h?Ps+be+"S":"")):"P0D"}var _n=Mu.prototype;_n.isValid=bh,_n.abs=$D,_n.add=YD,_n.subtract=qD,_n.as=ZD,_n.asMilliseconds=VC,_n.asSeconds=JD,_n.asMinutes=KD,_n.asHours=QD,_n.asDays=eP,_n.asWeeks=tP,_n.asMonths=nP,_n.asQuarters=iP,_n.asYears=rP,_n.valueOf=oP,_n._bubble=XD,_n.clone=sP,_n.get=aP,_n.milliseconds=lP,_n.seconds=uP,_n.minutes=cP,_n.hours=dP,_n.days=fP,_n.weeks=mP,_n.months=hP,_n.years=pP,_n.humanize=xP,_n.toISOString=Nh,_n.toString=Nh,_n.toJSON=Nh,_n.locale=Ph,_n.localeData=pl,_n.toIsoString=oe("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Nh),_n.lang=jr,Re("X",0,0,"unix"),Re("x",0,0,"valueOf"),ue("x",tt),ue("X",Ut),$t("X",function(h,_,S){S._d=new Date(parseFloat(h)*1e3)}),$t("x",function(h,_,S){S._d=new Date(st(h))});return t.version="2.30.1",e(Vn),t.fn=Le,t.min=yh,t.max=xh,t.now=S6,t.utc=x,t.unix=BD,t.months=HD,t.isDate=p,t.locale=sr,t.invalid=M,t.duration=zr,t.isMoment=Z,t.weekdays=jD,t.parseZone=VD,t.localeData=To,t.isDuration=fl,t.monthsShort=zD,t.weekdaysMin=GD,t.defineLocale=Dd,t.updateLocale=p6,t.locales=m6,t.weekdaysShort=WD,t.normalizeUnits=cn,t.relativeTimeRounding=vP,t.relativeTimeThreshold=yP,t.calendarFormat=H6,t.prototype=Le,t.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"},t})});$();$();$();$();$();$();$();function hv(n,t){return Object.is(n,t)}var Fi=null,Uh=!1,pv=1,fo=Symbol("SIGNAL");function dn(n){let t=Fi;return Fi=n,t}function mv(){return Fi}var $d={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function Yd(n){if(Uh)throw new Error("");if(Fi===null)return;Fi.consumerOnSignalRead(n);let t=Fi.nextProducerIndex++;if(Hh(Fi),t<Fi.producerNode.length&&Fi.producerNode[t]!==n&&Gd(Fi)){let e=Fi.producerNode[t];Vh(e,Fi.producerIndexOfThis[t])}Fi.producerNode[t]!==n&&(Fi.producerNode[t]=n,Fi.producerIndexOfThis[t]=Gd(Fi)?YC(n,Fi,t):0),Fi.producerLastReadVersion[t]=n.version}function $C(){pv++}function gv(n){if(!(Gd(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===pv)){if(!n.producerMustRecompute(n)&&!xv(n)){fv(n);return}n.producerRecomputeValue(n),fv(n)}}function _v(n){if(n.liveConsumerNode===void 0)return;let t=Uh;Uh=!0;try{for(let e of n.liveConsumerNode)e.dirty||PP(e)}finally{Uh=t}}function vv(){return Fi?.consumerAllowSignalWrites!==!1}function PP(n){n.dirty=!0,_v(n),n.consumerMarkedDirty?.(n)}function fv(n){n.dirty=!1,n.lastCleanEpoch=pv}function Bh(n){return n&&(n.nextProducerIndex=0),dn(n)}function yv(n,t){if(dn(t),!(!n||n.producerNode===void 0||n.producerIndexOfThis===void 0||n.producerLastReadVersion===void 0)){if(Gd(n))for(let e=n.nextProducerIndex;e<n.producerNode.length;e++)Vh(n.producerNode[e],n.producerIndexOfThis[e]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function xv(n){Hh(n);for(let t=0;t<n.producerNode.length;t++){let e=n.producerNode[t],i=n.producerLastReadVersion[t];if(i!==e.version||(gv(e),i!==e.version))return!0}return!1}function bv(n){if(Hh(n),Gd(n))for(let t=0;t<n.producerNode.length;t++)Vh(n.producerNode[t],n.producerIndexOfThis[t]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function YC(n,t,e){if(qC(n),n.liveConsumerNode.length===0&&XC(n))for(let i=0;i<n.producerNode.length;i++)n.producerIndexOfThis[i]=YC(n.producerNode[i],n,i);return n.liveConsumerIndexOfThis.push(e),n.liveConsumerNode.push(t)-1}function Vh(n,t){if(qC(n),n.liveConsumerNode.length===1&&XC(n))for(let i=0;i<n.producerNode.length;i++)Vh(n.producerNode[i],n.producerIndexOfThis[i]);let e=n.liveConsumerNode.length-1;if(n.liveConsumerNode[t]=n.liveConsumerNode[e],n.liveConsumerIndexOfThis[t]=n.liveConsumerIndexOfThis[e],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,t<n.liveConsumerNode.length){let i=n.liveConsumerIndexOfThis[t],r=n.liveConsumerNode[t];Hh(r),r.producerIndexOfThis[i]=t}}function Gd(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function Hh(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}function qC(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}function XC(n){return n.producerNode!==void 0}function Cv(n,t){let e=Object.create(IP);e.computation=n,t!==void 0&&(e.equal=t);let i=()=>{if(gv(e),Yd(e),e.value===Lh)throw e.error;return e.value};return i[fo]=e,i}var cv=Symbol("UNSET"),dv=Symbol("COMPUTING"),Lh=Symbol("ERRORED"),IP=St(Oe({},$d),{value:cv,dirty:!0,error:null,equal:hv,kind:"computed",producerMustRecompute(n){return n.value===cv||n.value===dv},producerRecomputeValue(n){if(n.value===dv)throw new Error("Detected cycle in computations.");let t=n.value;n.value=dv;let e=Bh(n),i,r=!1;try{i=n.computation(),dn(null),r=t!==cv&&t!==Lh&&i!==Lh&&n.equal(t,i)}catch(o){i=Lh,n.error=o}finally{yv(n,e)}if(r){n.value=t;return}n.value=i,n.version++}});function OP(){throw new Error}var ZC=OP;function JC(n){ZC(n)}function Ev(n){ZC=n}var FP=null;function wv(n,t){let e=Object.create(zh);e.value=n,t!==void 0&&(e.equal=t);let i=()=>(Yd(e),e.value);return i[fo]=e,i}function qd(n,t){vv()||JC(n),n.equal(n.value,t)||(n.value=t,RP(n))}function Sv(n,t){vv()||JC(n),qd(n,t(n.value))}var zh=St(Oe({},$d),{equal:hv,value:void 0,kind:"signal"});function RP(n){n.version++,$C(),_v(n),FP?.()}function Mv(n){let t=dn(null);try{return n()}finally{dn(t)}}$();var Av;function Xd(){return Av}function Is(n){let t=Av;return Av=n,t}var jh=Symbol("NotFound");$();$();$();$();$();function Lt(n){return typeof n=="function"}$();$();$();function Ru(n){let e=n(i=>{Error.call(i),i.stack=new Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var Wh=Ru(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:
${e.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=e});$();function Zd(n,t){if(n){let e=n.indexOf(t);0<=e&&n.splice(e,1)}}var xi=class n{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;let{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(let o of e)o.remove(this);else e.remove(this);let{initialTeardown:i}=this;if(Lt(i))try{i()}catch(o){t=o instanceof Wh?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{KC(o)}catch(l){t=t??[],l instanceof Wh?t=[...t,...l.errors]:t.push(l)}}if(t)throw new Wh(t)}}add(t){var e;if(t&&t!==this)if(this.closed)KC(t);else{if(t instanceof n){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(t)}}_hasParent(t){let{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){let{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){let{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&Zd(e,t)}remove(t){let{_finalizers:e}=this;e&&Zd(e,t),t instanceof n&&t._removeParent(this)}};xi.EMPTY=(()=>{let n=new xi;return n.closed=!0,n})();var Tv=xi.EMPTY;function Gh(n){return n instanceof xi||n&&"closed"in n&&Lt(n.remove)&&Lt(n.add)&&Lt(n.unsubscribe)}function KC(n){Lt(n)?n():n.unsubscribe()}$();var Io={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};$();$();var ku={setTimeout(n,t,...e){let{delegate:i}=ku;return i?.setTimeout?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){let{delegate:t}=ku;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function $h(n){ku.setTimeout(()=>{let{onUnhandledError:t}=Io;if(t)t(n);else throw n})}$();function Jd(){}$();var QC=Dv("C",void 0,void 0);function eE(n){return Dv("E",void 0,n)}function tE(n){return Dv("N",n,void 0)}function Dv(n,t,e){return{kind:n,value:t,error:e}}$();var gl=null;function Nu(n){if(Io.useDeprecatedSynchronousErrorHandling){let t=!gl;if(t&&(gl={errorThrown:!1,error:null}),n(),t){let{errorThrown:e,error:i}=gl;if(gl=null,e)throw i}}else n()}function nE(n){Io.useDeprecatedSynchronousErrorHandling&&gl&&(gl.errorThrown=!0,gl.error=n)}var _l=class extends xi{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,Gh(t)&&t.add(this)):this.destination=VP}static create(t,e,i){return new Uu(t,e,i)}next(t){this.isStopped?Iv(tE(t),this):this._next(t)}error(t){this.isStopped?Iv(eE(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Iv(QC,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},LP=Function.prototype.bind;function Pv(n,t){return LP.call(n,t)}var Ov=class{constructor(t){this.partialObserver=t}next(t){let{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){Yh(i)}}error(t){let{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){Yh(i)}else Yh(t)}complete(){let{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){Yh(e)}}},Uu=class extends _l{constructor(t,e,i){super();let r;if(Lt(t)||!t)r={next:t??void 0,error:e??void 0,complete:i??void 0};else{let o;this&&Io.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&Pv(t.next,o),error:t.error&&Pv(t.error,o),complete:t.complete&&Pv(t.complete,o)}):r=t}this.destination=new Ov(r)}};function Yh(n){Io.useDeprecatedSynchronousErrorHandling?nE(n):$h(n)}function BP(n){throw n}function Iv(n,t){let{onStoppedNotification:e}=Io;e&&ku.setTimeout(()=>e(n,t))}var VP={closed:!0,next:Jd,error:BP,complete:Jd};$();var Lu=typeof Symbol=="function"&&Symbol.observable||"@@observable";$();$();function Wr(n){return n}function Fv(...n){return Rv(n)}function Rv(n){return n.length===0?Wr:n.length===1?n[0]:function(e){return n.reduce((i,r)=>r(i),e)}}var En=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){let i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,r){let o=zP(e)?e:new Uu(e,i,r);return Nu(()=>{let{operator:l,source:c}=this;o.add(l?l.call(o,c):c?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return i=iE(i),new i((r,o)=>{let l=new Uu({next:c=>{try{e(c)}catch(f){o(f),l.unsubscribe()}},error:o,complete:r});this.subscribe(l)})}_subscribe(e){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(e)}[Lu](){return this}pipe(...e){return Rv(e)(this)}toPromise(e){return e=iE(e),new e((i,r)=>{let o;this.subscribe(l=>o=l,l=>r(l),()=>i(o))})}}return n.create=t=>new n(t),n})();function iE(n){var t;return(t=n??Io.Promise)!==null&&t!==void 0?t:Promise}function HP(n){return n&&Lt(n.next)&&Lt(n.error)&&Lt(n.complete)}function zP(n){return n&&n instanceof _l||HP(n)&&Gh(n)}$();$();$();function kv(n){return Lt(n?.lift)}function vn(n){return t=>{if(kv(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}$();function fn(n,t,e,i,r){return new Nv(n,t,e,i,r)}var Nv=class extends _l{constructor(t,e,i,r,o,l){super(t),this.onFinalize=o,this.shouldUnsubscribe=l,this._next=e?function(c){try{e(c)}catch(f){t.error(f)}}:super._next,this._error=r?function(c){try{r(c)}catch(f){t.error(f)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:e}=this;super.unsubscribe(),!e&&((t=this.onFinalize)===null||t===void 0||t.call(this))}}};function Bu(){return vn((n,t)=>{let e=null;n._refCount++;let i=fn(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){e=null;return}let r=n._connection,o=e;e=null,r&&(!o||r===o)&&r.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}var Vu=class extends En{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,kv(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){let t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new xi;let e=this.getSubject();t.add(this.source.subscribe(fn(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=xi.EMPTY)}return t}refCount(){return Bu()(this)}};$();$();var rE=Ru(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var bi=(()=>{class n extends En{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let i=new qh(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new rE}next(e){Nu(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(e)}})}error(e){Nu(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){Nu(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:i,isStopped:r,observers:o}=this;return i||r?Tv:(this.currentObservers=null,o.push(e),new xi(()=>{this.currentObservers=null,Zd(o,e)}))}_checkFinalizedStatuses(e){let{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){let e=new En;return e.source=this,e}}return n.create=(t,e)=>new qh(t,e),n})(),qh=class extends bi{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;(i=(e=this.destination)===null||e===void 0?void 0:e.next)===null||i===void 0||i.call(e,t)}error(t){var e,i;(i=(e=this.destination)===null||e===void 0?void 0:e.error)===null||i===void 0||i.call(e,t)}complete(){var t,e;(e=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||e===void 0||e.call(t)}_subscribe(t){var e,i;return(i=(e=this.source)===null||e===void 0?void 0:e.subscribe(t))!==null&&i!==void 0?i:Tv}};$();var Ri=class extends bi{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){let e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){let{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}};$();var Cr=new En(n=>n.complete());$();$();$();function oE(n){return n&&Lt(n.schedule)}function sE(n){return n[n.length-1]}function Xh(n){return Lt(sE(n))?n.pop():void 0}function xa(n){return oE(sE(n))?n.pop():void 0}$();$();$();$();$();function lE(n,t,e,i){function r(o){return o instanceof e?o:new e(function(l){l(o)})}return new(e||(e=Promise))(function(o,l){function c(g){try{p(i.next(g))}catch(m){l(m)}}function f(g){try{p(i.throw(g))}catch(m){l(m)}}function p(g){g.done?o(g.value):r(g.value).then(c,f)}p((i=i.apply(n,t||[])).next())})}function aE(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function vl(n){return this instanceof vl?(this.v=n,this):new vl(n)}function uE(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e.apply(n,t||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),c("next"),c("throw"),c("return",l),r[Symbol.asyncIterator]=function(){return this},r;function l(C){return function(A){return Promise.resolve(A).then(C,m)}}function c(C,A){i[C]&&(r[C]=function(O){return new Promise(function(T,M){o.push([C,O,T,M])>1||f(C,O)})},A&&(r[C]=A(r[C])))}function f(C,A){try{p(i[C](A))}catch(O){x(o[0][3],O)}}function p(C){C.value instanceof vl?Promise.resolve(C.value.v).then(g,m):x(o[0][2],C)}function g(C){f("next",C)}function m(C){f("throw",C)}function x(C,A){C(A),o.shift(),o.length&&f(o[0][0],o[0][1])}}function cE(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=n[Symbol.asyncIterator],e;return t?t.call(n):(n=typeof aE=="function"?aE(n):n[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=n[o]&&function(l){return new Promise(function(c,f){l=n[o](l),r(c,f,l.done,l.value)})}}function r(o,l,c,f){Promise.resolve(f).then(function(p){o({value:p,done:c})},l)}}$();var Zh=n=>n&&typeof n.length=="number"&&typeof n!="function";$();function Jh(n){return Lt(n?.then)}$();function Kh(n){return Lt(n[Lu])}$();function Qh(n){return Symbol.asyncIterator&&Lt(n?.[Symbol.asyncIterator])}$();function ep(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}$();$();function jP(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var tp=jP();function np(n){return Lt(n?.[tp])}$();function ip(n){return uE(this,arguments,function*(){let e=n.getReader();try{for(;;){let{value:i,done:r}=yield vl(e.read());if(r)return yield vl(void 0);yield yield vl(i)}}finally{e.releaseLock()}})}function rp(n){return Lt(n?.getReader)}function Ci(n){if(n instanceof En)return n;if(n!=null){if(Kh(n))return WP(n);if(Zh(n))return GP(n);if(Jh(n))return $P(n);if(Qh(n))return dE(n);if(np(n))return YP(n);if(rp(n))return qP(n)}throw ep(n)}function WP(n){return new En(t=>{let e=n[Lu]();if(Lt(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function GP(n){return new En(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}function $P(n){return new En(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,$h)})}function YP(n){return new En(t=>{for(let e of n)if(t.next(e),t.closed)return;t.complete()})}function dE(n){return new En(t=>{XP(n,t).catch(e=>t.error(e))})}function qP(n){return dE(ip(n))}function XP(n,t){var e,i,r,o;return lE(this,void 0,void 0,function*(){try{for(e=cE(n);i=yield e.next(),!i.done;){let l=i.value;if(t.next(l),t.closed)return}}catch(l){r={error:l}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}t.complete()})}$();$();function Er(n,t,e,i=0,r=!1){let o=t.schedule(function(){e(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function op(n,t=0){return vn((e,i)=>{e.subscribe(fn(i,r=>Er(i,n,()=>i.next(r),t),()=>Er(i,n,()=>i.complete(),t),r=>Er(i,n,()=>i.error(r),t)))})}$();function sp(n,t=0){return vn((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function fE(n,t){return Ci(n).pipe(sp(t),op(t))}$();function hE(n,t){return Ci(n).pipe(sp(t),op(t))}$();function pE(n,t){return new En(e=>{let i=0;return t.schedule(function(){i===n.length?e.complete():(e.next(n[i++]),e.closed||this.schedule())})})}$();function mE(n,t){return new En(e=>{let i;return Er(e,t,()=>{i=n[tp](),Er(e,t,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(l){e.error(l);return}o?e.complete():e.next(r)},0,!0)}),()=>Lt(i?.return)&&i.return()})}$();function ap(n,t){if(!n)throw new Error("Iterable cannot be null");return new En(e=>{Er(e,t,()=>{let i=n[Symbol.asyncIterator]();Er(e,t,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}$();function gE(n,t){return ap(ip(n),t)}function _E(n,t){if(n!=null){if(Kh(n))return fE(n,t);if(Zh(n))return pE(n,t);if(Jh(n))return hE(n,t);if(Qh(n))return ap(n,t);if(np(n))return mE(n,t);if(rp(n))return gE(n,t)}throw ep(n)}function Wn(n,t){return t?_E(n,t):Ci(n)}function bt(...n){let t=xa(n);return Wn(n,t)}$();function wr(n,t){let e=Lt(n)?n:()=>n,i=r=>r.error(e());return new En(t?r=>t.schedule(i,0,r):i)}$();function Uv(n){return!!n&&(n instanceof En||Lt(n.lift)&&Lt(n.subscribe))}$();var Os=Ru(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});$();$();function qt(n,t){return vn((e,i)=>{let r=0;e.subscribe(fn(i,o=>{i.next(n.call(t,o,r++))}))})}var{isArray:ZP}=Array;function JP(n,t){return ZP(t)?n(...t):n(t)}function lp(n){return qt(t=>JP(n,t))}$();$();var{isArray:KP}=Array,{getPrototypeOf:QP,prototype:eI,keys:tI}=Object;function up(n){if(n.length===1){let t=n[0];if(KP(t))return{args:t,keys:null};if(nI(t)){let e=tI(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}function nI(n){return n&&typeof n=="object"&&QP(n)===eI}$();function cp(n,t){return n.reduce((e,i,r)=>(e[i]=t[r],e),{})}function Kd(...n){let t=xa(n),e=Xh(n),{args:i,keys:r}=up(n);if(i.length===0)return Wn([],t);let o=new En(iI(i,t,r?l=>cp(r,l):Wr));return e?o.pipe(lp(e)):o}function iI(n,t,e=Wr){return i=>{vE(t,()=>{let{length:r}=n,o=new Array(r),l=r,c=r;for(let f=0;f<r;f++)vE(t,()=>{let p=Wn(n[f],t),g=!1;p.subscribe(fn(i,m=>{o[f]=m,g||(g=!0,c--),c||i.next(e(o.slice()))},()=>{--l||i.complete()}))},i)},i)}}function vE(n,t,e){n?Er(e,n,t):t()}$();$();$();$();$();function yE(n,t,e,i,r,o,l,c){let f=[],p=0,g=0,m=!1,x=()=>{m&&!f.length&&!p&&t.complete()},C=O=>p<i?A(O):f.push(O),A=O=>{o&&t.next(O),p++;let T=!1;Ci(e(O,g++)).subscribe(fn(t,M=>{r?.(M),o?C(M):t.next(M)},()=>{T=!0},void 0,()=>{if(T)try{for(p--;f.length&&p<i;){let M=f.shift();l?Er(t,l,()=>A(M)):A(M)}x()}catch(M){t.error(M)}}))};return n.subscribe(fn(t,C,()=>{m=!0,x()})),()=>{c?.()}}function mi(n,t,e=1/0){return Lt(t)?mi((i,r)=>qt((o,l)=>t(i,o,r,l))(Ci(n(i,r))),e):(typeof t=="number"&&(e=t),vn((i,r)=>yE(i,r,n,e)))}function Hu(n=1/0){return mi(Wr,n)}function xE(){return Hu(1)}function zu(...n){return xE()(Wn(n,xa(n)))}$();function dp(n){return new En(t=>{Ci(n()).subscribe(t)})}$();function Fs(...n){let t=Xh(n),{args:e,keys:i}=up(n),r=new En(o=>{let{length:l}=e;if(!l){o.complete();return}let c=new Array(l),f=l,p=l;for(let g=0;g<l;g++){let m=!1;Ci(e[g]).subscribe(fn(o,x=>{m||(m=!0,p--),c[g]=x},()=>f--,void 0,()=>{(!f||!m)&&(p||o.next(i?cp(i,c):c),o.complete())}))}});return t?r.pipe(lp(t)):r}$();function lr(n,t){return vn((e,i)=>{let r=0;e.subscribe(fn(i,o=>n.call(t,o,r++)&&i.next(o)))})}$();function gi(n){return vn((t,e)=>{let i=null,r=!1,o;i=t.subscribe(fn(e,void 0,void 0,l=>{o=Ci(n(l,gi(n)(t))),i?(i.unsubscribe(),i=null,o.subscribe(e)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(e))})}$();function bE(n,t,e,i,r){return(o,l)=>{let c=e,f=t,p=0;o.subscribe(fn(l,g=>{let m=p++;f=c?n(f,g,m):(c=!0,g),i&&l.next(f)},r&&(()=>{c&&l.next(f),l.complete()})))}}$();function Jo(n,t){return Lt(t)?mi(n,t,1):mi(n,1)}$();function ba(n){return vn((t,e)=>{let i=!1;t.subscribe(fn(e,r=>{i=!0,e.next(r)},()=>{i||e.next(n),e.complete()}))})}$();function Rs(n){return n<=0?()=>Cr:vn((t,e)=>{let i=0;t.subscribe(fn(e,r=>{++i<=n&&(e.next(r),n<=i&&e.complete())}))})}$();function fp(n=rI){return vn((t,e)=>{let i=!1;t.subscribe(fn(e,r=>{i=!0,e.next(r)},()=>i?e.complete():e.error(n())))})}function rI(){return new Os}$();function Ca(n){return vn((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}$();function ks(n,t){let e=arguments.length>=2;return i=>i.pipe(n?lr((r,o)=>n(r,o,i)):Wr,Rs(1),e?ba(t):fp(()=>new Os))}$();$();function ju(n){return n<=0?()=>Cr:vn((t,e)=>{let i=[];t.subscribe(fn(e,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)e.next(r);e.complete()},void 0,()=>{i=null}))})}function Lv(n,t){let e=arguments.length>=2;return i=>i.pipe(n?lr((r,o)=>n(r,o,i)):Wr,ju(1),e?ba(t):fp(()=>new Os))}$();function Bv(n,t){return vn(bE(n,t,arguments.length>=2,!0))}$();function Vv(...n){let t=xa(n);return vn((e,i)=>{(t?zu(n,e,t):zu(n,e)).subscribe(i)})}$();function Sr(n,t){return vn((e,i)=>{let r=null,o=0,l=!1,c=()=>l&&!r&&i.complete();e.subscribe(fn(i,f=>{r?.unsubscribe();let p=0,g=o++;Ci(n(f,g)).subscribe(r=fn(i,m=>i.next(t?t(f,m,g,p++):m),()=>{r=null,c()}))},()=>{l=!0,c()}))})}$();function Hv(n){return vn((t,e)=>{Ci(n).subscribe(fn(e,()=>e.complete(),Jd)),!e.closed&&t.subscribe(e)})}$();function Ei(n,t,e){let i=Lt(n)||t||e?{next:n,error:t,complete:e}:n;return i?vn((r,o)=>{var l;(l=i.subscribe)===null||l===void 0||l.call(i);let c=!0;r.subscribe(fn(o,f=>{var p;(p=i.next)===null||p===void 0||p.call(i,f),o.next(f)},()=>{var f;c=!1,(f=i.complete)===null||f===void 0||f.call(i),o.complete()},f=>{var p;c=!1,(p=i.error)===null||p===void 0||p.call(i,f),o.error(f)},()=>{var f,p;c&&((f=i.unsubscribe)===null||f===void 0||f.call(i)),(p=i.finalize)===null||p===void 0||p.call(i)}))}):Wr}$();var a4="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",ot=class extends Error{code;constructor(t,e){super(l4(t,e)),this.code=t}};function oI(n){return`NG0${Math.abs(n)}`}function l4(n,t){return`${oI(n)}${t?": "+t:""}`}var u4=Symbol("InputSignalNode#UNSET"),sI=St(Oe({},zh),{transformFn:void 0,applyValueToInputSignal(n,t){qd(n,t)}});function c4(n,t){let e=Object.create(sI);e.value=n,e.transformFn=t?.transform;function i(){if(Yd(e),e.value===u4){let r=null;throw new ot(-950,r)}return e.value}return i[fo]=e,i}function d0(n){return{toString:n}.toString()}var hp="__parameters__";function aI(n){return function(...e){if(n){let i=n(...e);for(let r in i)this[r]=i[r]}}}function d4(n,t,e){return d0(()=>{let i=aI(t);function r(...o){if(this instanceof r)return i.apply(this,o),this;let l=new r(...o);return c.annotation=l,c;function c(f,p,g){let m=f.hasOwnProperty(hp)?f[hp]:Object.defineProperty(f,hp,{value:[]})[hp];for(;m.length<=g;)m.push(null);return(m[g]=m[g]||[]).push(l),f}}return r.prototype.ngMetadataName=n,r.annotationCls=r,r})}var e0=globalThis;function Hn(n){for(let t in n)if(n[t]===Hn)return t;throw Error("Could not find renamed property on target object.")}function lI(n,t){for(let e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function Tr(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Tr).join(", ")}]`;if(n==null)return""+n;let t=n.overriddenName||n.name;if(t)return`${t}`;let e=n.toString();if(e==null)return""+e;let i=e.indexOf(`
`);return i>=0?e.slice(0,i):e}function n2(n,t){return n?t?`${n} ${t}`:n:t||""}var uI=Hn({__forward_ref__:Hn});function cr(n){return n.__forward_ref__=cr,n.toString=function(){return Tr(this())},n}function ur(n){return f4(n)?n():n}function f4(n){return typeof n=="function"&&n.hasOwnProperty(uI)&&n.__forward_ref__===cr}function $e(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function mo(n){return{providers:n.providers||[],imports:n.imports||[]}}function Gp(n){return CE(n,p4)||CE(n,m4)}function h4(n){return Gp(n)!==null}function CE(n,t){return n.hasOwnProperty(t)?n[t]:null}function cI(n){let t=n&&(n[p4]||n[m4]);return t||null}function EE(n){return n&&(n.hasOwnProperty(wE)||n.hasOwnProperty(dI))?n[wE]:null}var p4=Hn({\u0275prov:Hn}),wE=Hn({\u0275inj:Hn}),m4=Hn({ngInjectableDef:Hn}),dI=Hn({ngInjectorDef:Hn}),it=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(t,e){this._desc=t,this.\u0275prov=void 0,typeof e=="number"?this.__NG_ELEMENT_ID__=e:e!==void 0&&(this.\u0275prov=$e({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function g4(n){return n&&!!n.\u0275providers}var fI=Hn({\u0275cmp:Hn}),hI=Hn({\u0275dir:Hn}),pI=Hn({\u0275pipe:Hn}),mI=Hn({\u0275mod:Hn}),bp=Hn({\u0275fac:Hn}),i0=Hn({__NG_ELEMENT_ID__:Hn}),SE=Hn({__NG_ENV_ID__:Hn});function Ns(n){return typeof n=="string"?n:n==null?"":String(n)}function gI(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Ns(n)}function _4(n,t){throw new ot(-200,n)}function Q2(n,t){throw new ot(-201,!1)}var Gt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(Gt||{}),i2;function v4(){return i2}function Mr(n){let t=i2;return i2=n,t}function y4(n,t,e){let i=Gp(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(e&Gt.Optional)return null;if(t!==void 0)return t;Q2(n,"Injector")}var _I={},xl=_I,r2="__NG_DI_FLAG__",Cp=class{injector;constructor(t){this.injector=t}retrieve(t,e){let i=e;return this.injector.get(t,i.optional?jh:xl,i)}},Ep="ngTempTokenPath",vI="ngTokenPath",yI=/\n/gm,xI="\u0275",ME="__source";function bI(n,t=Gt.Default){if(Xd()===void 0)throw new ot(-203,!1);if(Xd()===null)return y4(n,void 0,t);{let e=Xd(),i;return e instanceof Cp?i=e.injector:i=e,i.get(n,t&Gt.Optional?null:void 0,t)}}function We(n,t=Gt.Default){return(v4()||bI)(ur(n),t)}function Pe(n,t=Gt.Default){return We(n,$p(t))}function $p(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function o2(n){let t=[];for(let e=0;e<n.length;e++){let i=ur(n[e]);if(Array.isArray(i)){if(i.length===0)throw new ot(900,!1);let r,o=Gt.Default;for(let l=0;l<i.length;l++){let c=i[l],f=CI(c);typeof f=="number"?f===-1?r=c.token:o|=f:r=c}t.push(We(r,o))}else t.push(We(i))}return t}function x4(n,t){return n[r2]=t,n.prototype[r2]=t,n}function CI(n){return n[r2]}function EI(n,t,e,i){let r=n[Ep];throw t[ME]&&r.unshift(t[ME]),n.message=wI(`
`+n.message,r,e,i),n[vI]=r,n[Ep]=null,n}function wI(n,t,e,i=null){n=n&&n.charAt(0)===`
`&&n.charAt(1)==xI?n.slice(2):n;let r=Tr(t);if(Array.isArray(t))r=t.map(Tr).join(" -> ");else if(typeof t=="object"){let o=[];for(let l in t)if(t.hasOwnProperty(l)){let c=t[l];o.push(l+":"+(typeof c=="string"?JSON.stringify(c):Tr(c)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${n.replace(yI,`
  `)}`}var SI=x4(d4("Optional"),8);var MI=x4(d4("SkipSelf"),4);function Cl(n,t){let e=n.hasOwnProperty(bp);return e?n[bp]:null}function AI(n,t,e){if(n.length!==t.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=t[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}function TI(n){return n.flat(Number.POSITIVE_INFINITY)}function ey(n,t){n.forEach(e=>Array.isArray(e)?ey(e,t):t(e))}function b4(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function wp(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function DI(n,t,e,i){let r=n.length;if(r==t)n.push(e,i);else if(r===1)n.push(i,n[0]),n[0]=e;else{for(r--,n.push(n[r-1],n[r]);r>t;){let o=r-2;n[r]=n[o],r--}n[t]=e,n[t+1]=i}}function Yp(n,t,e){let i=f0(n,t);return i>=0?n[i|1]=e:(i=~i,DI(n,i,t,e)),i}function zv(n,t){let e=f0(n,t);if(e>=0)return n[e|1]}function f0(n,t){return PI(n,t,1)}function PI(n,t,e){let i=0,r=n.length>>e;for(;r!==i;){let o=i+(r-i>>1),l=n[o<<e];if(t===l)return o<<e;l>t?r=o:i=o+1}return~(r<<e)}var El={},Ar=[],r0=new it(""),C4=new it("",-1),E4=new it(""),Sp=class{get(t,e=xl){if(e===xl){let i=new Error(`NullInjectorError: No provider for ${Tr(t)}!`);throw i.name="NullInjectorError",i}return e}};function w4(n,t){let e=n[mI]||null;if(!e&&t===!0)throw new Error(`Type ${Tr(n)} does not have '\u0275mod' property.`);return e}function wl(n){return n[fI]||null}function II(n){return n[hI]||null}function OI(n){return n[pI]||null}function h0(n){return{\u0275providers:n}}function FI(...n){return{\u0275providers:S4(!0,n),\u0275fromNgModule:!0}}function S4(n,...t){let e=[],i=new Set,r,o=l=>{e.push(l)};return ey(t,l=>{let c=l;s2(c,o,[],i)&&(r||=[],r.push(c))}),r!==void 0&&M4(r,o),e}function M4(n,t){for(let e=0;e<n.length;e++){let{ngModule:i,providers:r}=n[e];ty(r,o=>{t(o,i)})}}function s2(n,t,e,i){if(n=ur(n),!n)return!1;let r=null,o=EE(n),l=!o&&wl(n);if(!o&&!l){let f=n.ngModule;if(o=EE(f),o)r=f;else return!1}else{if(l&&!l.standalone)return!1;r=n}let c=i.has(r);if(l){if(c)return!1;if(i.add(r),l.dependencies){let f=typeof l.dependencies=="function"?l.dependencies():l.dependencies;for(let p of f)s2(p,t,e,i)}}else if(o){if(o.imports!=null&&!c){i.add(r);let p;try{ey(o.imports,g=>{s2(g,t,e,i)&&(p||=[],p.push(g))})}finally{}p!==void 0&&M4(p,t)}if(!c){let p=Cl(r)||(()=>new r);t({provide:r,useFactory:p,deps:Ar},r),t({provide:E4,useValue:r,multi:!0},r),t({provide:r0,useValue:()=>We(r),multi:!0},r)}let f=o.providers;if(f!=null&&!c){let p=n;ty(f,g=>{t(g,p)})}}else return!1;return r!==n&&n.providers!==void 0}function ty(n,t){for(let e of n)g4(e)&&(e=e.\u0275providers),Array.isArray(e)?ty(e,t):t(e)}var RI=Hn({provide:String,useValue:Hn});function A4(n){return n!==null&&typeof n=="object"&&RI in n}function kI(n){return!!(n&&n.useExisting)}function NI(n){return!!(n&&n.useFactory)}function Zu(n){return typeof n=="function"}function UI(n){return!!n.useClass}var qp=new it(""),mp={},AE={},jv;function ny(){return jv===void 0&&(jv=new Sp),jv}var Ji=class{},o0=class extends Ji{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(t,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,l2(t,l=>this.processProvider(l)),this.records.set(C4,Wu(void 0,this)),r.has("environment")&&this.records.set(Ji,Wu(void 0,this));let o=this.records.get(qp);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(E4,Ar,Gt.Self))}retrieve(t,e){let i=e;return this.get(t,i.optional?jh:xl,i)}destroy(){t0(this),this._destroyed=!0;let t=dn(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of e)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),dn(t)}}onDestroy(t){return t0(this),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){t0(this);let e=Is(this),i=Mr(void 0),r;try{return t()}finally{Is(e),Mr(i)}}get(t,e=xl,i=Gt.Default){if(t0(this),t.hasOwnProperty(SE))return t[SE](this);i=$p(i);let r,o=Is(this),l=Mr(void 0);try{if(!(i&Gt.SkipSelf)){let f=this.records.get(t);if(f===void 0){let p=zI(t)&&Gp(t);p&&this.injectableDefInScope(p)?f=Wu(a2(t),mp):f=null,this.records.set(t,f)}if(f!=null)return this.hydrate(t,f,i)}let c=i&Gt.Self?ny():this.parent;return e=i&Gt.Optional&&e===xl?null:e,c.get(t,e)}catch(c){if(c.name==="NullInjectorError"){if((c[Ep]=c[Ep]||[]).unshift(Tr(t)),o)throw c;return EI(c,t,"R3InjectorError",this.source)}else throw c}finally{Mr(l),Is(o)}}resolveInjectorInitializers(){let t=dn(null),e=Is(this),i=Mr(void 0),r;try{let o=this.get(r0,Ar,Gt.Self);for(let l of o)l()}finally{Is(e),Mr(i),dn(t)}}toString(){let t=[],e=this.records;for(let i of e.keys())t.push(Tr(i));return`R3Injector[${t.join(", ")}]`}processProvider(t){t=ur(t);let e=Zu(t)?t:ur(t&&t.provide),i=BI(t);if(!Zu(t)&&t.multi===!0){let r=this.records.get(e);r||(r=Wu(void 0,mp,!0),r.factory=()=>o2(r.multi),this.records.set(e,r)),e=t,r.multi.push(t)}this.records.set(e,i)}hydrate(t,e,i){let r=dn(null);try{return e.value===AE?_4(Tr(t)):e.value===mp&&(e.value=AE,e.value=e.factory(void 0,i)),typeof e.value=="object"&&e.value&&HI(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{dn(r)}}injectableDefInScope(t){if(!t.providedIn)return!1;let e=ur(t.providedIn);return typeof e=="string"?e==="any"||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){let e=this._onDestroyHooks.indexOf(t);e!==-1&&this._onDestroyHooks.splice(e,1)}};function a2(n){let t=Gp(n),e=t!==null?t.factory:Cl(n);if(e!==null)return e;if(n instanceof it)throw new ot(204,!1);if(n instanceof Function)return LI(n);throw new ot(204,!1)}function LI(n){if(n.length>0)throw new ot(204,!1);let e=cI(n);return e!==null?()=>e.factory(n):()=>new n}function BI(n){if(A4(n))return Wu(void 0,n.useValue);{let t=T4(n);return Wu(t,mp)}}function T4(n,t,e){let i;if(Zu(n)){let r=ur(n);return Cl(r)||a2(r)}else if(A4(n))i=()=>ur(n.useValue);else if(NI(n))i=()=>n.useFactory(...o2(n.deps||[]));else if(kI(n))i=(r,o)=>We(ur(n.useExisting),o!==void 0&&o&Gt.Optional?Gt.Optional:void 0);else{let r=ur(n&&(n.useClass||n.provide));if(VI(n))i=()=>new r(...o2(n.deps));else return Cl(r)||a2(r)}return i}function t0(n){if(n.destroyed)throw new ot(205,!1)}function Wu(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function VI(n){return!!n.deps}function HI(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function zI(n){return typeof n=="function"||typeof n=="object"&&n instanceof it}function l2(n,t){for(let e of n)Array.isArray(e)?l2(e,t):e&&g4(e)?l2(e.\u0275providers,t):t(e)}function Ir(n,t){let e;n instanceof o0?(t0(n),e=n):e=new Cp(n);let i,r=Is(e),o=Mr(void 0);try{return t()}finally{Is(r),Mr(o)}}function D4(){return v4()!==void 0||Xd()!=null}function jI(n){if(!D4())throw new ot(-203,!1)}function WI(n){return typeof n=="function"}var Vs=0,en=1,kt=2,Ki=3,Ro=4,ko=5,Mp=6,Ap=7,Dr=8,Ju=9,Us=10,ci=11,s0=12,TE=13,sc=14,Qo=15,Sl=16,Gu=17,Ls=18,Xp=19,P4=20,Ea=21,Wv=22,Tp=23,ho=24,qu=25,Pr=26,I4=1;var Ml=7,Dp=8,Ku=9,Gr=10;function wa(n){return Array.isArray(n)&&typeof n[I4]=="object"}function Hs(n){return Array.isArray(n)&&n[I4]===!0}function iy(n){return(n.flags&4)!==0}function ac(n){return n.componentOffset>-1}function Zp(n){return(n.flags&1)===1}function es(n){return!!n.template}function Pp(n){return(n[kt]&512)!==0}function lc(n){return(n[kt]&256)===256}var u2=class{previousValue;currentValue;firstChange;constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}};function O4(n,t,e,i){t!==null?t.applyValueToInputSignal(t,i):n[e]=i}var zs=(()=>{let n=()=>F4;return n.ngInherit=!0,n})();function F4(n){return n.type.prototype.ngOnChanges&&(n.setInput=$I),GI}function GI(){let n=k4(this),t=n?.current;if(t){let e=n.previous;if(e===El)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function $I(n,t,e,i,r){let o=this.declaredInputs[i],l=k4(n)||YI(n,{previous:El,current:null}),c=l.current||(l.current={}),f=l.previous,p=f[o];c[o]=new u2(p&&p.currentValue,e,f===El),O4(n,t,r,e)}var R4="__ngSimpleChanges__";function k4(n){return n[R4]||null}function YI(n,t){return n[R4]=t}var DE=null;var Fn=function(n,t=null,e){DE?.(n,t,e)},qI="svg",XI="math";function ts(n){for(;Array.isArray(n);)n=n[Vs];return n}function N4(n,t){return ts(t[n])}function ss(n,t){return ts(t[n.index])}function U4(n,t){return n.data[t]}function ry(n,t){return n[t]}function ZI(n,t,e,i){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=i}function ns(n,t){let e=t[n];return wa(e)?e:e[Vs]}function JI(n){return(n[kt]&4)===4}function oy(n){return(n[kt]&128)===128}function KI(n){return Hs(n[Ki])}function Qu(n,t){return t==null?null:n[t]}function L4(n){n[Gu]=0}function B4(n){n[kt]&1024||(n[kt]|=1024,oy(n)&&p0(n))}function QI(n,t){for(;n>0;)t=t[sc],n--;return t}function Jp(n){return!!(n[kt]&9216||n[ho]?.dirty)}function c2(n){n[Us].changeDetectionScheduler?.notify(8),n[kt]&64&&(n[kt]|=1024),Jp(n)&&p0(n)}function p0(n){n[Us].changeDetectionScheduler?.notify(0);let t=Al(n);for(;t!==null&&!(t[kt]&8192||(t[kt]|=8192,!oy(t)));)t=Al(t)}function V4(n,t){if(lc(n))throw new ot(911,!1);n[Ea]===null&&(n[Ea]=[]),n[Ea].push(t)}function eO(n,t){if(n[Ea]===null)return;let e=n[Ea].indexOf(t);e!==-1&&n[Ea].splice(e,1)}function Al(n){let t=n[Ki];return Hs(t)?t[Ki]:t}function sy(n){return n[Ap]??=[]}function ay(n){return n.cleanup??=[]}function tO(n,t,e,i){let r=sy(t);r.push(e),n.firstCreatePass&&ay(n).push(i,r.length-1)}var Xt={lFrame:q4(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var d2=!1;function nO(){return Xt.lFrame.elementDepthCount}function iO(){Xt.lFrame.elementDepthCount++}function rO(){Xt.lFrame.elementDepthCount--}function ly(){return Xt.bindingsEnabled}function oO(){return Xt.skipHydrationRootTNode!==null}function sO(n){return Xt.skipHydrationRootTNode===n}function aO(){Xt.skipHydrationRootTNode=null}function Ht(){return Xt.lFrame.lView}function wi(){return Xt.lFrame.tView}function F(n){return Xt.lFrame.contextLView=n,n[Dr]}function R(n){return Xt.lFrame.contextLView=null,n}function Or(){let n=H4();for(;n!==null&&n.type===64;)n=n.parent;return n}function H4(){return Xt.lFrame.currentTNode}function lO(){let n=Xt.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}function Fl(n,t){let e=Xt.lFrame;e.currentTNode=n,e.isParent=t}function uy(){return Xt.lFrame.isParent}function z4(){Xt.lFrame.isParent=!1}function uO(){return Xt.lFrame.contextLView}function j4(){return d2}function PE(n){let t=d2;return d2=n,t}function Rl(){let n=Xt.lFrame,t=n.bindingRootIndex;return t===-1&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function W4(){return Xt.lFrame.bindingIndex}function cO(n){return Xt.lFrame.bindingIndex=n}function Kp(){return Xt.lFrame.bindingIndex++}function Qp(n){let t=Xt.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function dO(){return Xt.lFrame.inI18n}function fO(n,t){let e=Xt.lFrame;e.bindingIndex=e.bindingRootIndex=n,f2(t)}function hO(){return Xt.lFrame.currentDirectiveIndex}function f2(n){Xt.lFrame.currentDirectiveIndex=n}function pO(n){let t=Xt.lFrame.currentDirectiveIndex;return t===-1?null:n[t]}function G4(){return Xt.lFrame.currentQueryIndex}function cy(n){Xt.lFrame.currentQueryIndex=n}function mO(n){let t=n[en];return t.type===2?t.declTNode:t.type===1?n[ko]:null}function $4(n,t,e){if(e&Gt.SkipSelf){let r=t,o=n;for(;r=r.parent,r===null&&!(e&Gt.Host);)if(r=mO(o),r===null||(o=o[sc],r.type&10))break;if(r===null)return!1;t=r,n=o}let i=Xt.lFrame=Y4();return i.currentTNode=t,i.lView=n,!0}function dy(n){let t=Y4(),e=n[en];Xt.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function Y4(){let n=Xt.lFrame,t=n===null?null:n.child;return t===null?q4(n):t}function q4(n){let t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=t),t}function X4(){let n=Xt.lFrame;return Xt.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Z4=X4;function fy(){let n=X4();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function gO(n){return(Xt.lFrame.contextLView=QI(n,Xt.lFrame.contextLView))[Dr]}function js(){return Xt.lFrame.selectedIndex}function Tl(n){Xt.lFrame.selectedIndex=n}function em(){let n=Xt.lFrame;return U4(n.tView,n.selectedIndex)}function _O(){return Xt.lFrame.currentNamespace}var J4=!0;function tm(){return J4}function nm(n){J4=n}function vO(n,t,e){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=t.type.prototype;if(i){let l=F4(t);(e.preOrderHooks??=[]).push(n,l),(e.preOrderCheckHooks??=[]).push(n,l)}r&&(e.preOrderHooks??=[]).push(0-n,r),o&&((e.preOrderHooks??=[]).push(n,o),(e.preOrderCheckHooks??=[]).push(n,o))}function hy(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){let o=n.data[e].type.prototype,{ngAfterContentInit:l,ngAfterContentChecked:c,ngAfterViewInit:f,ngAfterViewChecked:p,ngOnDestroy:g}=o;l&&(n.contentHooks??=[]).push(-e,l),c&&((n.contentHooks??=[]).push(e,c),(n.contentCheckHooks??=[]).push(e,c)),f&&(n.viewHooks??=[]).push(-e,f),p&&((n.viewHooks??=[]).push(e,p),(n.viewCheckHooks??=[]).push(e,p)),g!=null&&(n.destroyHooks??=[]).push(e,g)}}function gp(n,t,e){K4(n,t,3,e)}function _p(n,t,e,i){(n[kt]&3)===e&&K4(n,t,e,i)}function Gv(n,t){let e=n[kt];(e&3)===t&&(e&=16383,e+=1,n[kt]=e)}function K4(n,t,e,i){let r=i!==void 0?n[Gu]&65535:0,o=i??-1,l=t.length-1,c=0;for(let f=r;f<l;f++)if(typeof t[f+1]=="number"){if(c=t[f],i!=null&&c>=i)break}else t[f]<0&&(n[Gu]+=65536),(c<o||o==-1)&&(yO(n,e,t,f),n[Gu]=(n[Gu]&4294901760)+f+2),f++}function IE(n,t){Fn(4,n,t);let e=dn(null);try{t.call(n)}finally{dn(e),Fn(5,n,t)}}function yO(n,t,e,i){let r=e[i]<0,o=e[i+1],l=r?-e[i]:e[i],c=n[l];r?n[kt]>>14<n[Gu]>>16&&(n[kt]&3)===t&&(n[kt]+=16384,IE(c,o)):IE(c,o)}var Xu=-1,Dl=class{factory;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(t,e,i){this.factory=t,this.canSeeViewProviders=e,this.injectImpl=i}};function xO(n){return(n.flags&8)!==0}function bO(n){return(n.flags&16)!==0}function CO(n,t,e){let i=0;for(;i<e.length;){let r=e[i];if(typeof r=="number"){if(r!==0)break;i++;let o=e[i++],l=e[i++],c=e[i++];n.setAttribute(t,l,c,o)}else{let o=r,l=e[++i];wO(o)?n.setProperty(t,o,l):n.setAttribute(t,o,l),i++}}return i}function EO(n){return n===3||n===4||n===6}function wO(n){return n.charCodeAt(0)===64}function ec(n,t){if(!(t===null||t.length===0))if(n===null||n.length===0)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){let r=t[i];typeof r=="number"?e=r:e===0||(e===-1||e===2?OE(n,e,r,null,t[++i]):OE(n,e,r,null,null))}}return n}function OE(n,t,e,i,r){let o=0,l=n.length;if(t===-1)l=-1;else for(;o<n.length;){let c=n[o++];if(typeof c=="number"){if(c===t){l=-1;break}else if(c>t){l=o-1;break}}}for(;o<n.length;){let c=n[o];if(typeof c=="number")break;if(c===e){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}l!==-1&&(n.splice(l,0,t),o=l+1),n.splice(o++,0,e),r!==null&&n.splice(o++,0,r)}function Q4(n){return n!==Xu}function Ip(n){return n&32767}function SO(n){return n>>16}function Op(n,t){let e=SO(n),i=t;for(;e>0;)i=i[sc],e--;return i}var h2=!0;function Fp(n){let t=h2;return h2=n,t}var MO=256,ew=MO-1,tw=5,AO=0,Ko={};function TO(n,t,e){let i;typeof e=="string"?i=e.charCodeAt(0)||0:e.hasOwnProperty(i0)&&(i=e[i0]),i==null&&(i=e[i0]=AO++);let r=i&ew,o=1<<r;t.data[n+(r>>tw)]|=o}function Rp(n,t){let e=nw(n,t);if(e!==-1)return e;let i=t[en];i.firstCreatePass&&(n.injectorIndex=t.length,$v(i.data,n),$v(t,null),$v(i.blueprint,null));let r=py(n,t),o=n.injectorIndex;if(Q4(r)){let l=Ip(r),c=Op(r,t),f=c[en].data;for(let p=0;p<8;p++)t[o+p]=c[l+p]|f[l+p]}return t[o+8]=r,o}function $v(n,t){n.push(0,0,0,0,0,0,0,0,t)}function nw(n,t){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||t[n.injectorIndex+8]===null?-1:n.injectorIndex}function py(n,t){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let e=0,i=null,r=t;for(;r!==null;){if(i=aw(r),i===null)return Xu;if(e++,r=r[sc],i.injectorIndex!==-1)return i.injectorIndex|e<<16}return Xu}function p2(n,t,e){TO(n,t,e)}function iw(n,t,e){if(e&Gt.Optional||n!==void 0)return n;Q2(t,"NodeInjector")}function rw(n,t,e,i){if(e&Gt.Optional&&i===void 0&&(i=null),(e&(Gt.Self|Gt.Host))===0){let r=n[Ju],o=Mr(void 0);try{return r?r.get(t,i,e&Gt.Optional):y4(t,i,e&Gt.Optional)}finally{Mr(o)}}return iw(i,t,e)}function ow(n,t,e,i=Gt.Default,r){if(n!==null){if(t[kt]&2048&&!(i&Gt.Self)){let l=OO(n,t,e,i,Ko);if(l!==Ko)return l}let o=sw(n,t,e,i,Ko);if(o!==Ko)return o}return rw(t,e,i,r)}function sw(n,t,e,i,r){let o=PO(e);if(typeof o=="function"){if(!$4(t,n,i))return i&Gt.Host?iw(r,e,i):rw(t,e,i,r);try{let l;if(l=o(i),l==null&&!(i&Gt.Optional))Q2(e);else return l}finally{Z4()}}else if(typeof o=="number"){let l=null,c=nw(n,t),f=Xu,p=i&Gt.Host?t[Qo][ko]:null;for((c===-1||i&Gt.SkipSelf)&&(f=c===-1?py(n,t):t[c+8],f===Xu||!RE(i,!1)?c=-1:(l=t[en],c=Ip(f),t=Op(f,t)));c!==-1;){let g=t[en];if(FE(o,c,g.data)){let m=DO(c,t,e,l,i,p);if(m!==Ko)return m}f=t[c+8],f!==Xu&&RE(i,t[en].data[c+8]===p)&&FE(o,c,t)?(l=g,c=Ip(f),t=Op(f,t)):c=-1}}return r}function DO(n,t,e,i,r,o){let l=t[en],c=l.data[n+8],f=i==null?ac(c)&&h2:i!=l&&(c.type&3)!==0,p=r&Gt.Host&&o===c,g=vp(c,l,e,f,p);return g!==null?a0(t,l,g,c,r):Ko}function vp(n,t,e,i,r){let o=n.providerIndexes,l=t.data,c=o&1048575,f=n.directiveStart,p=n.directiveEnd,g=o>>20,m=i?c:c+g,x=r?c+g:p;for(let C=m;C<x;C++){let A=l[C];if(C<f&&e===A||C>=f&&A.type===e)return C}if(r){let C=l[f];if(C&&es(C)&&C.type===e)return f}return null}function a0(n,t,e,i,r){let o=n[e],l=t.data;if(o instanceof Dl){let c=o;c.resolving&&_4(gI(l[e]));let f=Fp(c.canSeeViewProviders);c.resolving=!0;let p,g=c.injectImpl?Mr(c.injectImpl):null,m=$4(n,i,Gt.Default);try{o=n[e]=c.factory(void 0,r,l,n,i),t.firstCreatePass&&e>=i.directiveStart&&vO(e,l[e],t)}finally{g!==null&&Mr(g),Fp(f),c.resolving=!1,Z4()}}return o}function PO(n){if(typeof n=="string")return n.charCodeAt(0)||0;let t=n.hasOwnProperty(i0)?n[i0]:void 0;return typeof t=="number"?t>=0?t&ew:IO:t}function FE(n,t,e){let i=1<<n;return!!(e[t+(n>>tw)]&i)}function RE(n,t){return!(n&Gt.Self)&&!(n&Gt.Host&&t)}var bl=class{_tNode;_lView;constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return ow(this._tNode,this._lView,t,$p(i),e)}};function IO(){return new bl(Or(),Ht())}function go(n){return d0(()=>{let t=n.prototype.constructor,e=t[bp]||m2(t),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[bp]||m2(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function m2(n){return f4(n)?()=>{let t=m2(ur(n));return t&&t()}:Cl(n)}function OO(n,t,e,i,r){let o=n,l=t;for(;o!==null&&l!==null&&l[kt]&2048&&!Pp(l);){let c=sw(o,l,e,i|Gt.Self,Ko);if(c!==Ko)return c;let f=o.parent;if(!f){let p=l[P4];if(p){let g=p.get(e,Ko,i);if(g!==Ko)return g}f=aw(l),l=l[sc]}o=f}return r}function aw(n){let t=n[en],e=t.type;return e===2?t.declTNode:e===1?n[ko]:null}function kE(n,t=null,e=null,i){let r=lw(n,t,e,i);return r.resolveInjectorInitializers(),r}function lw(n,t=null,e=null,i,r=new Set){let o=[e||Ar,FI(n)];return i=i||(typeof n=="object"?void 0:Tr(n)),new o0(o,t||ny(),i||null,r)}var po=class n{static THROW_IF_NOT_FOUND=xl;static NULL=new Sp;static create(t,e){if(Array.isArray(t))return kE({name:""},e,t,"");{let i=t.name??"";return kE({name:i},t.parent,t.providers,i)}}static \u0275prov=$e({token:n,providedIn:"any",factory:()=>We(C4)});static __NG_ELEMENT_ID__=-1};var FO=new it("");FO.__NG_ELEMENT_ID__=n=>{let t=Or();if(t===null)throw new ot(204,!1);if(t.type&2)return t.value;if(n&Gt.Optional)return null;throw new ot(204,!1)};var uw=!1,uc=(()=>{class n{static __NG_ELEMENT_ID__=RO;static __NG_ENV_ID__=e=>e}return n})(),g2=class extends uc{_lView;constructor(t){super(),this._lView=t}onDestroy(t){let e=this._lView;return lc(e)?(t(),()=>{}):(V4(e,t),()=>eO(e,t))}};function RO(){return new g2(Ht())}var tc=class{},cw=new it("",{providedIn:"root",factory:()=>!1});var dw=new it(""),fw=new it(""),Ws=(()=>{class n{taskId=0;pendingTasks=new Set;get _hasPendingTasks(){return this.hasPendingTasks.value}hasPendingTasks=new Ri(!1);add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);let e=this.taskId++;return this.pendingTasks.add(e),e}has(e){return this.pendingTasks.has(e)}remove(e){this.pendingTasks.delete(e),this.pendingTasks.size===0&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static \u0275prov=$e({token:n,providedIn:"root",factory:()=>new n})}return n})();var _2=class extends bi{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(t=!1){super(),this.__isAsync=t,D4()&&(this.destroyRef=Pe(uc,{optional:!0})??void 0,this.pendingTasks=Pe(Ws,{optional:!0})??void 0)}emit(t){let e=dn(null);try{super.next(t)}finally{dn(e)}}subscribe(t,e,i){let r=t,o=e||(()=>null),l=i;if(t&&typeof t=="object"){let f=t;r=f.next?.bind(f),o=f.error?.bind(f),l=f.complete?.bind(f)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),l&&(l=this.wrapInTimeout(l)));let c=super.subscribe({next:r,error:o,complete:l});return t instanceof xi&&t.add(c),c}wrapInTimeout(t){return e=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{t(e)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},oi=_2;function kp(...n){}function hw(n){let t,e;function i(){n=kp;try{e!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(e),t!==void 0&&clearTimeout(t)}catch{}}return t=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(e=requestAnimationFrame(()=>{n(),i()})),()=>i()}function NE(n){return queueMicrotask(()=>n()),()=>{n=kp}}var my="isAngularZone",Np=my+"_ID",kO=0,si=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new oi(!1);onMicrotaskEmpty=new oi(!1);onStable=new oi(!1);onError=new oi(!1);constructor(t){let{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=uw}=t;if(typeof Zone>"u")throw new ot(908,!1);Zone.assertZonePatched();let l=this;l._nesting=0,l._outer=l._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(l._inner=l._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(l._inner=l._inner.fork(Zone.longStackTraceZoneSpec)),l.shouldCoalesceEventChangeDetection=!r&&i,l.shouldCoalesceRunChangeDetection=r,l.callbackScheduled=!1,l.scheduleInRootZone=o,LO(l)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(my)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new ot(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new ot(909,!1)}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,r){let o=this._inner,l=o.scheduleEventTask("NgZoneEvent: "+r,t,NO,kp,kp);try{return o.runTask(l,e,i)}finally{o.cancelTask(l)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}},NO={};function gy(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function UO(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function t(){hw(()=>{n.callbackScheduled=!1,v2(n),n.isCheckStableRunning=!0,gy(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{t()}):n._outer.run(()=>{t()}),v2(n)}function LO(n){let t=()=>{UO(n)},e=kO++;n._inner=n._inner.fork({name:"angular",properties:{[my]:!0,[Np]:e,[Np+e]:!0},onInvokeTask:(i,r,o,l,c,f)=>{if(BO(f))return i.invokeTask(o,l,c,f);try{return UE(n),i.invokeTask(o,l,c,f)}finally{(n.shouldCoalesceEventChangeDetection&&l.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&t(),LE(n)}},onInvoke:(i,r,o,l,c,f,p)=>{try{return UE(n),i.invoke(o,l,c,f,p)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!VO(f)&&t(),LE(n)}},onHasTask:(i,r,o,l)=>{i.hasTask(o,l),r===o&&(l.change=="microTask"?(n._hasPendingMicrotasks=l.microTask,v2(n),gy(n)):l.change=="macroTask"&&(n.hasPendingMacrotasks=l.macroTask))},onHandleError:(i,r,o,l)=>(i.handleError(o,l),n.runOutsideAngular(()=>n.onError.emit(l)),!1)})}function v2(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function UE(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function LE(n){n._nesting--,gy(n)}var y2=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new oi;onMicrotaskEmpty=new oi;onStable=new oi;onError=new oi;run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,r){return t.apply(e,i)}};function BO(n){return pw(n,"__ignore_ng_zone__")}function VO(n){return pw(n,"__scheduler_tick__")}function pw(n,t){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[t]===!0}var is=class{_console=console;handleError(t){this._console.error("ERROR",t)}},HO=new it("",{providedIn:"root",factory:()=>{let n=Pe(si),t=Pe(is);return e=>n.runOutsideAngular(()=>t.handleError(e))}});function BE(n,t){return c4(n,t)}function zO(n){return c4(u4,n)}var mw=(BE.required=zO,BE);function jO(){return cc(Or(),Ht())}function cc(n,t){return new $r(ss(n,t))}var $r=(()=>{class n{nativeElement;constructor(e){this.nativeElement=e}static __NG_ELEMENT_ID__=jO}return n})();function WO(n){return n instanceof $r?n.nativeElement:n}function GO(n){return typeof n=="function"&&n[fo]!==void 0}function dc(n,t){let e=wv(n,t?.equal),i=e[fo];return e.set=r=>qd(i,r),e.update=r=>Sv(i,r),e.asReadonly=$O.bind(e),e}function $O(){let n=this[fo];if(n.readonlyFn===void 0){let t=()=>this();t[fo]=n,n.readonlyFn=t}return n.readonlyFn}function gw(n){return GO(n)&&typeof n.set=="function"}function YO(){return this._results[Symbol.iterator]()}var x2=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new bi}constructor(t=!1){this._emitDistinctChangesOnly=t}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){this.dirty=!1;let i=TI(t);(this._changesDetected=!AI(this._results,i,e))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(t){this._onDirty=t}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=YO};function _w(n){return(n.flags&128)===128}var vw=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(vw||{}),yw=new Map,qO=0;function XO(){return qO++}function ZO(n){yw.set(n[Xp],n)}function b2(n){yw.delete(n[Xp])}var VE="__ngContext__";function fc(n,t){wa(t)?(n[VE]=t[Xp],ZO(t)):n[VE]=t}function xw(n){return Cw(n[s0])}function bw(n){return Cw(n[Ro])}function Cw(n){for(;n!==null&&!Hs(n);)n=n[Ro];return n}var C2;function Ew(n){C2=n}function JO(){if(C2!==void 0)return C2;if(typeof document<"u")return document;throw new ot(210,!1)}var _y=new it("",{providedIn:"root",factory:()=>KO}),KO="ng",vy=new it(""),hc=new it("",{providedIn:"platform",factory:()=>"unknown"});var yy=new it("",{providedIn:"root",factory:()=>JO().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var QO="h",e5="b";var ww=!1,t5=new it("",{providedIn:"root",factory:()=>ww});var xy=function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n}(xy||{}),pc=new it(""),HE=new Set;function m0(n){HE.has(n)||(HE.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var Sw=(()=>{class n{view;node;constructor(e,i){this.view=e,this.node=i}static __NG_ELEMENT_ID__=n5}return n})();function n5(){return new Sw(Ht(),Or())}var $u=function(n){return n[n.EarlyRead=0]="EarlyRead",n[n.Write=1]="Write",n[n.MixedReadWrite=2]="MixedReadWrite",n[n.Read=3]="Read",n}($u||{}),Mw=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=$e({token:n,providedIn:"root",factory:()=>new n})}return n})(),i5=[$u.EarlyRead,$u.Write,$u.MixedReadWrite,$u.Read],r5=(()=>{class n{ngZone=Pe(si);scheduler=Pe(tc);errorHandler=Pe(is,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){Pe(pc,{optional:!0})}execute(){let e=this.sequences.size>0;e&&Fn(16),this.executing=!0;for(let i of i5)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),e&&Fn(17)}register(e){let{view:i}=e;i!==void 0?((i[qu]??=[]).push(e),p0(i),i[kt]|=8192):this.executing?this.deferredRegistrations.add(e):this.addSequence(e)}addSequence(e){this.sequences.add(e),this.scheduler.notify(7)}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}maybeTrace(e,i){return i?i.run(xy.AFTER_NEXT_RENDER,e):e()}static \u0275prov=$e({token:n,providedIn:"root",factory:()=>new n})}return n})(),E2=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(t,e,i,r,o,l=null){this.impl=t,this.hooks=e,this.view=i,this.once=r,this.snapshot=l,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let t=this.view?.[qu];t&&(this.view[qu]=t.filter(e=>e!==this))}};function by(n,t){!t?.injector&&jI(by);let e=t?.injector??Pe(po);return m0("NgAfterNextRender"),s5(n,e,t,!0)}function o5(n,t){if(n instanceof Function){let e=[void 0,void 0,void 0,void 0];return e[t]=n,e}else return[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function s5(n,t,e,i){let r=t.get(Mw);r.impl??=t.get(r5);let o=t.get(pc,null,{optional:!0}),l=e?.phase??$u.MixedReadWrite,c=e?.manualCleanup!==!0?t.get(uc):null,f=t.get(Sw,null,{optional:!0}),p=new E2(r.impl,o5(n,l),f?.view,i,c,o?.snapshot(null));return r.impl.register(p),p}var a5=(n,t,e,i)=>{};function l5(n,t,e,i){a5(n,t,e,i)}var u5=()=>null;function Aw(n,t,e=!1){return u5(n,t,e)}function Tw(n,t){let e=n.contentQueries;if(e!==null){let i=dn(null);try{for(let r=0;r<e.length;r+=2){let o=e[r],l=e[r+1];if(l!==-1){let c=n.data[l];cy(o),c.contentQueries(2,t[l],l)}}}finally{dn(i)}}}function w2(n,t,e){cy(0);let i=dn(null);try{t(n,e)}finally{dn(i)}}function Cy(n,t,e){if(iy(t)){let i=dn(null);try{let r=t.directiveStart,o=t.directiveEnd;for(let l=r;l<o;l++){let c=n.data[l];if(c.contentQueries){let f=e[l];c.contentQueries(1,f,l)}}}finally{dn(i)}}}var rs=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(rs||{});var Up=class{changingThisBreaksApplicationSecurity;constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${a4})`}};function im(n){return n instanceof Up?n.changingThisBreaksApplicationSecurity:n}function c5(n,t){let e=d5(n);if(e!=null&&e!==t){if(e==="ResourceURL"&&t==="URL")return!0;throw new Error(`Required a safe ${t}, got a ${e} (see ${a4})`)}return e===t}function d5(n){return n instanceof Up&&n.getTypeName()||null}var f5=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function h5(n){return n=String(n),n.match(f5)?n:"unsafe:"+n}var p5=/^>|^->|<!--|-->|--!>|<!-$/g,m5=/(<|>)/g,g5="\u200B$1\u200B";function _5(n){return n.replace(p5,t=>t.replace(m5,g5))}function v5(n,t){return n.createText(t)}function y5(n,t,e){n.setValue(t,e)}function x5(n,t){return n.createComment(_5(t))}function Dw(n,t,e){return n.createElement(t,e)}function Lp(n,t,e,i,r){n.insertBefore(t,e,i,r)}function Pw(n,t,e){n.appendChild(t,e)}function zE(n,t,e,i,r){i!==null?Lp(n,t,e,i,r):Pw(n,t,e)}function b5(n,t,e){n.removeChild(null,t,e)}function C5(n,t,e){n.setAttribute(t,"style",e)}function E5(n,t,e){e===""?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function Iw(n,t,e){let{mergedAttrs:i,classes:r,styles:o}=e;i!==null&&CO(n,t,i),r!==null&&E5(n,t,r),o!==null&&C5(n,t,o)}var Ow=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(Ow||{});function rm(n){let t=w5();return t?t.sanitize(Ow.URL,n)||"":c5(n,"URL")?im(n):h5(Ns(n))}function w5(){let n=Ht();return n&&n[Us].sanitizer}function as(n){return n.ownerDocument.defaultView}function om(n){return n.ownerDocument}function Fw(n){return n instanceof Function?n():n}function S5(n,t,e){let i=n.length;for(;;){let r=n.indexOf(t,e);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=t.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}e=r+1}}var Rw="ng-template";function M5(n,t,e,i){let r=0;if(i){for(;r<t.length&&typeof t[r]=="string";r+=2)if(t[r]==="class"&&S5(t[r+1].toLowerCase(),e,0)!==-1)return!0}else if(Ey(n))return!1;if(r=t.indexOf(1,r),r>-1){let o;for(;++r<t.length&&typeof(o=t[r])=="string";)if(o.toLowerCase()===e)return!0}return!1}function Ey(n){return n.type===4&&n.value!==Rw}function A5(n,t,e){let i=n.type===4&&!e?Rw:n.value;return t===i}function T5(n,t,e){let i=4,r=n.attrs,o=r!==null?I5(r):0,l=!1;for(let c=0;c<t.length;c++){let f=t[c];if(typeof f=="number"){if(!l&&!Oo(i)&&!Oo(f))return!1;if(l&&Oo(f))continue;l=!1,i=f|i&1;continue}if(!l)if(i&4){if(i=2|i&1,f!==""&&!A5(n,f,e)||f===""&&t.length===1){if(Oo(i))return!1;l=!0}}else if(i&8){if(r===null||!M5(n,r,f,e)){if(Oo(i))return!1;l=!0}}else{let p=t[++c],g=D5(f,r,Ey(n),e);if(g===-1){if(Oo(i))return!1;l=!0;continue}if(p!==""){let m;if(g>o?m="":m=r[g+1].toLowerCase(),i&2&&p!==m){if(Oo(i))return!1;l=!0}}}}return Oo(i)||l}function Oo(n){return(n&1)===0}function D5(n,t,e,i){if(t===null)return-1;let r=0;if(i||!e){let o=!1;for(;r<t.length;){let l=t[r];if(l===n)return r;if(l===3||l===6)o=!0;else if(l===1||l===2){let c=t[++r];for(;typeof c=="string";)c=t[++r];continue}else{if(l===4)break;if(l===0){r+=4;continue}}r+=o?1:2}return-1}else return O5(t,n)}function P5(n,t,e=!1){for(let i=0;i<t.length;i++)if(T5(n,t[i],e))return!0;return!1}function I5(n){for(let t=0;t<n.length;t++){let e=n[t];if(EO(e))return t}return n.length}function O5(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){let i=n[e];if(typeof i=="number")return-1;if(i===t)return e;e++}return-1}function jE(n,t){return n?":not("+t.trim()+")":t}function F5(n){let t=n[0],e=1,i=2,r="",o=!1;for(;e<n.length;){let l=n[e];if(typeof l=="string")if(i&2){let c=n[++e];r+="["+l+(c.length>0?'="'+c+'"':"")+"]"}else i&8?r+="."+l:i&4&&(r+=" "+l);else r!==""&&!Oo(l)&&(t+=jE(o,r),r=""),i=l,o=o||!Oo(i);e++}return r!==""&&(t+=jE(o,r)),t}function R5(n){return n.map(F5).join(",")}function k5(n){let t=[],e=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&t.push(o,n[++i]):r===8&&e.push(o);else{if(!Oo(r))break;r=o}i++}return e.length&&t.push(1,...e),t}var dr={};function wy(n,t,e,i,r,o,l,c,f,p,g){let m=Pr+i,x=m+r,C=N5(m,x),A=typeof p=="function"?p():p;return C[en]={type:n,blueprint:C,template:e,queries:null,viewQuery:c,declTNode:t,data:C.slice().fill(null,m),bindingStartIndex:m,expandoStartIndex:x,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof l=="function"?l():l,firstChild:null,schemas:f,consts:A,incompleteFirstPass:!1,ssrId:g}}function N5(n,t){let e=[];for(let i=0;i<t;i++)e.push(i<n?null:dr);return e}function U5(n){let t=n.tView;return t===null||t.incompleteFirstPass?n.tView=wy(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):t}function Sy(n,t,e,i,r,o,l,c,f,p,g){let m=t.blueprint.slice();return m[Vs]=r,m[kt]=i|4|128|8|64|1024,(p!==null||n&&n[kt]&2048)&&(m[kt]|=2048),L4(m),m[Ki]=m[sc]=n,m[Dr]=e,m[Us]=l||n&&n[Us],m[ci]=c||n&&n[ci],m[Ju]=f||n&&n[Ju]||null,m[ko]=o,m[Xp]=XO(),m[Mp]=g,m[P4]=p,m[Qo]=t.type==2?n[Qo]:m,m}function L5(n,t,e){let i=ss(t,n),r=U5(e),o=n[Us].rendererFactory,l=My(n,Sy(n,r,null,kw(e),i,t,null,o.createRenderer(i,e),null,null,null));return n[t.index]=l}function kw(n){let t=16;return n.signals?t=4096:n.onPush&&(t=64),t}function Nw(n,t,e,i){if(e===0)return-1;let r=t.length;for(let o=0;o<e;o++)t.push(i),n.blueprint.push(i),n.data.push(null);return r}function My(n,t){return n[s0]?n[TE][Ro]=t:n[s0]=t,n[TE]=t,t}function d(n=1){Uw(wi(),Ht(),js()+n,!1)}function Uw(n,t,e,i){if(!i)if((t[kt]&3)===3){let o=n.preOrderCheckHooks;o!==null&&gp(t,o,e)}else{let o=n.preOrderHooks;o!==null&&_p(t,o,0,e)}Tl(e)}var sm=function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n}(sm||{});function S2(n,t,e,i){let r=dn(null);try{let[o,l,c]=n.inputs[e],f=null;(l&sm.SignalBased)!==0&&(f=t[o][fo]),f!==null&&f.transformFn!==void 0?i=f.transformFn(i):c!==null&&(i=c.call(t,i)),n.setInput!==null?n.setInput(t,f,i,e,o):O4(t,f,o,i)}finally{dn(r)}}function Lw(n,t,e,i,r){let o=js(),l=i&2;try{Tl(-1),l&&t.length>Pr&&Uw(n,t,Pr,!1),Fn(l?2:0,r),e(i,r)}finally{Tl(o),Fn(l?3:1,r)}}function am(n,t,e){W5(n,t,e),(e.flags&64)===64&&G5(n,t,e)}function Ay(n,t,e=ss){let i=t.localNames;if(i!==null){let r=t.index+1;for(let o=0;o<i.length;o+=2){let l=i[o+1],c=l===-1?e(t,n):n[l];n[r++]=c}}}function B5(n,t,e,i){let o=i.get(t5,ww)||e===rs.ShadowDom,l=n.selectRootElement(t,o);return V5(l),l}function V5(n){H5(n)}var H5=()=>null;function z5(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function Ty(n,t,e,i,r,o,l,c){if(!c&&Py(t,n,e,i,r)){ac(t)&&j5(e,t.index);return}if(t.type&3){let f=ss(t,e);i=z5(i),r=l!=null?l(r,t.value||"",i):r,o.setProperty(f,i,r)}else t.type&12}function j5(n,t){let e=ns(t,n);e[kt]&16||(e[kt]|=64)}function W5(n,t,e){let i=e.directiveStart,r=e.directiveEnd;ac(e)&&L5(t,e,n.data[i+e.componentOffset]),n.firstCreatePass||Rp(e,t);let o=e.initialInputs;for(let l=i;l<r;l++){let c=n.data[l],f=a0(t,n,l,e);if(fc(f,t),o!==null&&X5(t,l-i,f,c,e,o),es(c)){let p=ns(e.index,t);p[Dr]=a0(t,n,l,e)}}}function G5(n,t,e){let i=e.directiveStart,r=e.directiveEnd,o=e.index,l=hO();try{Tl(o);for(let c=i;c<r;c++){let f=n.data[c],p=t[c];f2(c),(f.hostBindings!==null||f.hostVars!==0||f.hostAttrs!==null)&&$5(f,p)}}finally{Tl(-1),f2(l)}}function $5(n,t){n.hostBindings!==null&&n.hostBindings(1,t)}function Dy(n,t){let e=n.directiveRegistry,i=null;if(e)for(let r=0;r<e.length;r++){let o=e[r];P5(t,o.selectors,!1)&&(i??=[],es(o)?i.unshift(o):i.push(o))}return i}function Y5(n,t,e,i,r,o){let l=ss(n,t);q5(t[ci],l,o,n.value,e,i,r)}function q5(n,t,e,i,r,o,l){if(o==null)n.removeAttribute(t,r,e);else{let c=l==null?Ns(o):l(o,i||"",r);n.setAttribute(t,r,c,e)}}function X5(n,t,e,i,r,o){let l=o[t];if(l!==null)for(let c=0;c<l.length;c+=2){let f=l[c],p=l[c+1];S2(i,e,f,p)}}function Z5(n,t){let e=n[Ju],i=e?e.get(is,null):null;i&&i.handleError(t)}function Py(n,t,e,i,r){let o=n.inputs?.[i],l=n.hostDirectiveInputs?.[i],c=!1;if(l)for(let f=0;f<l.length;f+=2){let p=l[f],g=l[f+1],m=t.data[p];S2(m,e[p],g,r),c=!0}if(o)for(let f of o){let p=e[f],g=t.data[f];S2(g,p,i,r),c=!0}return c}function J5(n,t){let e=ns(t,n),i=e[en];K5(i,e);let r=e[Vs];r!==null&&e[Mp]===null&&(e[Mp]=Aw(r,e[Ju])),Fn(18),Iy(i,e,e[Dr]),Fn(19,e[Dr])}function K5(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])}function Iy(n,t,e){dy(t);try{let i=n.viewQuery;i!==null&&w2(1,i,e);let r=n.template;r!==null&&Lw(n,t,r,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),t[Ls]?.finishViewCreation(n),n.staticContentQueries&&Tw(n,t),n.staticViewQueries&&w2(2,n.viewQuery,e);let o=n.components;o!==null&&Q5(t,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[kt]&=-5,fy()}}function Q5(n,t){for(let e=0;e<t.length;e++)J5(n,t[e])}function eF(n,t,e,i){let r=dn(null);try{let o=t.tView,c=n[kt]&4096?4096:16,f=Sy(n,o,e,c,null,t,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),p=n[t.index];f[Sl]=p;let g=n[Ls];return g!==null&&(f[Ls]=g.createEmbeddedView(o)),Iy(o,f,e),f}finally{dn(r)}}function WE(n,t){return!t||t.firstChild===null||_w(n)}var tF;function Oy(n,t){return tF(n,t)}var Bs=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(Bs||{});function Bw(n){return(n.flags&32)===32}function Yu(n,t,e,i,r){if(i!=null){let o,l=!1;Hs(i)?o=i:wa(i)&&(l=!0,i=i[Vs]);let c=ts(i);n===0&&e!==null?r==null?Pw(t,e,c):Lp(t,e,c,r||null,!0):n===1&&e!==null?Lp(t,e,c,r||null,!0):n===2?b5(t,c,l):n===3&&t.destroyNode(c),o!=null&&hF(t,n,o,e,r)}}function nF(n,t){Vw(n,t),t[Vs]=null,t[ko]=null}function iF(n,t,e,i,r,o){i[Vs]=r,i[ko]=t,um(n,i,e,1,r,o)}function Vw(n,t){t[Us].changeDetectionScheduler?.notify(9),um(n,t,t[ci],2,null,null)}function rF(n){let t=n[s0];if(!t)return Yv(n[en],n);for(;t;){let e=null;if(wa(t))e=t[s0];else{let i=t[Gr];i&&(e=i)}if(!e){for(;t&&!t[Ro]&&t!==n;)wa(t)&&Yv(t[en],t),t=t[Ki];t===null&&(t=n),wa(t)&&Yv(t[en],t),e=t&&t[Ro]}t=e}}function Fy(n,t){let e=n[Ku],i=e.indexOf(t);e.splice(i,1)}function Hw(n,t){if(lc(t))return;let e=t[ci];e.destroyNode&&um(n,t,e,3,null,null),rF(t)}function Yv(n,t){if(lc(t))return;let e=dn(null);try{t[kt]&=-129,t[kt]|=256,t[ho]&&bv(t[ho]),sF(n,t),oF(n,t),t[en].type===1&&t[ci].destroy();let i=t[Sl];if(i!==null&&Hs(t[Ki])){i!==t[Ki]&&Fy(i,t);let r=t[Ls];r!==null&&r.detachView(n)}b2(t)}finally{dn(e)}}function oF(n,t){let e=n.cleanup,i=t[Ap];if(e!==null)for(let l=0;l<e.length-1;l+=2)if(typeof e[l]=="string"){let c=e[l+3];c>=0?i[c]():i[-c].unsubscribe(),l+=2}else{let c=i[e[l+1]];e[l].call(c)}i!==null&&(t[Ap]=null);let r=t[Ea];if(r!==null){t[Ea]=null;for(let l=0;l<r.length;l++){let c=r[l];c()}}let o=t[Tp];if(o!==null){t[Tp]=null;for(let l of o)l.destroy()}}function sF(n,t){let e;if(n!=null&&(e=n.destroyHooks)!=null)for(let i=0;i<e.length;i+=2){let r=t[e[i]];if(!(r instanceof Dl)){let o=e[i+1];if(Array.isArray(o))for(let l=0;l<o.length;l+=2){let c=r[o[l]],f=o[l+1];Fn(4,c,f);try{f.call(c)}finally{Fn(5,c,f)}}else{Fn(4,r,o);try{o.call(r)}finally{Fn(5,r,o)}}}}}function aF(n,t,e){return lF(n,t.parent,e)}function lF(n,t,e){let i=t;for(;i!==null&&i.type&168;)t=i,i=t.parent;if(i===null)return e[Vs];if(ac(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===rs.None||r===rs.Emulated)return null}return ss(i,e)}function uF(n,t,e){return dF(n,t,e)}function cF(n,t,e){return n.type&40?ss(n,e):null}var dF=cF,GE;function lm(n,t,e,i){let r=aF(n,i,t),o=t[ci],l=i.parent||t[ko],c=uF(l,i,t);if(r!=null)if(Array.isArray(e))for(let f=0;f<e.length;f++)zE(o,r,e[f],c,!1);else zE(o,r,e,c,!1);GE!==void 0&&GE(o,i,t,e,r)}function n0(n,t){if(t!==null){let e=t.type;if(e&3)return ss(t,n);if(e&4)return M2(-1,n[t.index]);if(e&8){let i=t.child;if(i!==null)return n0(n,i);{let r=n[t.index];return Hs(r)?M2(-1,r):ts(r)}}else{if(e&128)return n0(n,t.next);if(e&32)return Oy(t,n)()||ts(n[t.index]);{let i=zw(n,t);if(i!==null){if(Array.isArray(i))return i[0];let r=Al(n[Qo]);return n0(r,i)}else return n0(n,t.next)}}}return null}function zw(n,t){if(t!==null){let i=n[Qo][ko],r=t.projection;return i.projection[r]}return null}function M2(n,t){let e=Gr+n+1;if(e<t.length){let i=t[e],r=i[en].firstChild;if(r!==null)return n0(i,r)}return t[Ml]}function Ry(n,t,e,i,r,o,l){for(;e!=null;){if(e.type===128){e=e.next;continue}let c=i[e.index],f=e.type;if(l&&t===0&&(c&&fc(ts(c),i),e.flags|=2),!Bw(e))if(f&8)Ry(n,t,e.child,i,r,o,!1),Yu(t,n,r,c,o);else if(f&32){let p=Oy(e,i),g;for(;g=p();)Yu(t,n,r,g,o);Yu(t,n,r,c,o)}else f&16?fF(n,t,i,e,r,o):Yu(t,n,r,c,o);e=l?e.projectionNext:e.next}}function um(n,t,e,i,r,o){Ry(e,i,n.firstChild,t,r,o,!1)}function fF(n,t,e,i,r,o){let l=e[Qo],f=l[ko].projection[i.projection];if(Array.isArray(f))for(let p=0;p<f.length;p++){let g=f[p];Yu(t,n,r,g,o)}else{let p=f,g=l[Ki];_w(i)&&(p.flags|=128),Ry(n,t,p,g,r,o,!0)}}function hF(n,t,e,i,r){let o=e[Ml],l=ts(e);o!==l&&Yu(t,n,i,o,r);for(let c=Gr;c<e.length;c++){let f=e[c];um(f[en],f,n,t,i,o)}}function pF(n,t,e,i,r){if(t)r?n.addClass(e,i):n.removeClass(e,i);else{let o=i.indexOf("-")===-1?void 0:Bs.DashCase;r==null?n.removeStyle(e,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Bs.Important),n.setStyle(e,i,r,o))}}function Bp(n,t,e,i,r=!1){for(;e!==null;){if(e.type===128){e=r?e.projectionNext:e.next;continue}let o=t[e.index];o!==null&&i.push(ts(o)),Hs(o)&&mF(o,i);let l=e.type;if(l&8)Bp(n,t,e.child,i);else if(l&32){let c=Oy(e,t),f;for(;f=c();)i.push(f)}else if(l&16){let c=zw(t,e);if(Array.isArray(c))i.push(...c);else{let f=Al(t[Qo]);Bp(f[en],f,c,i,!0)}}e=r?e.projectionNext:e.next}return i}function mF(n,t){for(let e=Gr;e<n.length;e++){let i=n[e],r=i[en].firstChild;r!==null&&Bp(i[en],i,r,t)}n[Ml]!==n[Vs]&&t.push(n[Ml])}function jw(n){if(n[qu]!==null){for(let t of n[qu])t.impl.addSequence(t);n[qu].length=0}}var Ww=[];function gF(n){return n[ho]??_F(n)}function _F(n){let t=Ww.pop()??Object.create(yF);return t.lView=n,t}function vF(n){n.lView[ho]!==n&&(n.lView=null,Ww.push(n))}var yF=St(Oe({},$d),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{p0(n.lView)},consumerOnSignalRead(){this.lView[ho]=this}});function xF(n){let t=n[ho]??Object.create(bF);return t.lView=n,t}var bF=St(Oe({},$d),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let t=Al(n.lView);for(;t&&!Gw(t[en]);)t=Al(t);t&&B4(t)},consumerOnSignalRead(){this.lView[ho]=this}});function Gw(n){return n.type!==2}function $w(n){if(n[Tp]===null)return;let t=!0;for(;t;){let e=!1;for(let i of n[Tp])i.dirty&&(e=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));t=e&&!!(n[kt]&8192)}}var CF=100;function Yw(n,t=!0,e=0){let r=n[Us].rendererFactory,o=!1;o||r.begin?.();try{EF(n,e)}catch(l){throw t&&Z5(n,l),l}finally{o||r.end?.()}}function EF(n,t){let e=j4();try{PE(!0),A2(n,t);let i=0;for(;Jp(n);){if(i===CF)throw new ot(103,!1);i++,A2(n,1)}}finally{PE(e)}}function wF(n,t,e,i){if(lc(t))return;let r=t[kt],o=!1,l=!1;dy(t);let c=!0,f=null,p=null;o||(Gw(n)?(p=gF(t),f=Bh(p)):mv()===null?(c=!1,p=xF(t),f=Bh(p)):t[ho]&&(bv(t[ho]),t[ho]=null));try{L4(t),cO(n.bindingStartIndex),e!==null&&Lw(n,t,e,2,i);let g=(r&3)===3;if(!o)if(g){let C=n.preOrderCheckHooks;C!==null&&gp(t,C,null)}else{let C=n.preOrderHooks;C!==null&&_p(t,C,0,null),Gv(t,0)}if(l||SF(t),$w(t),qw(t,0),n.contentQueries!==null&&Tw(n,t),!o)if(g){let C=n.contentCheckHooks;C!==null&&gp(t,C)}else{let C=n.contentHooks;C!==null&&_p(t,C,1),Gv(t,1)}AF(n,t);let m=n.components;m!==null&&Zw(t,m,0);let x=n.viewQuery;if(x!==null&&w2(2,x,i),!o)if(g){let C=n.viewCheckHooks;C!==null&&gp(t,C)}else{let C=n.viewHooks;C!==null&&_p(t,C,2),Gv(t,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),t[Wv]){for(let C of t[Wv])C();t[Wv]=null}o||(jw(t),t[kt]&=-73)}catch(g){throw o||p0(t),g}finally{p!==null&&(yv(p,f),c&&vF(p)),fy()}}function qw(n,t){for(let e=xw(n);e!==null;e=bw(e))for(let i=Gr;i<e.length;i++){let r=e[i];Xw(r,t)}}function SF(n){for(let t=xw(n);t!==null;t=bw(t)){if(!(t[kt]&2))continue;let e=t[Ku];for(let i=0;i<e.length;i++){let r=e[i];B4(r)}}}function MF(n,t,e){Fn(18);let i=ns(t,n);Xw(i,e),Fn(19,i[Dr])}function Xw(n,t){oy(n)&&A2(n,t)}function A2(n,t){let i=n[en],r=n[kt],o=n[ho],l=!!(t===0&&r&16);if(l||=!!(r&64&&t===0),l||=!!(r&1024),l||=!!(o?.dirty&&xv(o)),l||=!1,o&&(o.dirty=!1),n[kt]&=-9217,l)wF(i,n,i.template,n[Dr]);else if(r&8192){$w(n),qw(n,1);let c=i.components;c!==null&&Zw(n,c,1),jw(n)}}function Zw(n,t,e){for(let i=0;i<t.length;i++)MF(n,t[i],e)}function AF(n,t){let e=n.hostBindingOpCodes;if(e!==null)try{for(let i=0;i<e.length;i++){let r=e[i];if(r<0)Tl(~r);else{let o=r,l=e[++i],c=e[++i];fO(l,o);let f=t[o];Fn(24,f),c(2,f),Fn(25,f)}}}finally{Tl(-1)}}function ky(n,t){let e=j4()?64:1088;for(n[Us].changeDetectionScheduler?.notify(t);n;){n[kt]|=e;let i=Al(n);if(Pp(n)&&!i)return n;n=i}return null}function Jw(n,t,e,i){return[n,!0,0,t,null,i,null,e,null,null]}function TF(n,t,e,i=!0){let r=t[en];if(DF(r,t,n,e),i){let l=M2(e,n),c=t[ci],f=c.parentNode(n[Ml]);f!==null&&iF(r,n[ko],c,t,f,l)}let o=t[Mp];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function T2(n,t){if(n.length<=Gr)return;let e=Gr+t,i=n[e];if(i){let r=i[Sl];r!==null&&r!==n&&Fy(r,i),t>0&&(n[e-1][Ro]=i[Ro]);let o=wp(n,Gr+t);nF(i[en],i);let l=o[Ls];l!==null&&l.detachView(o[en]),i[Ki]=null,i[Ro]=null,i[kt]&=-129}return i}function DF(n,t,e,i){let r=Gr+i,o=e.length;i>0&&(e[r-1][Ro]=t),i<o-Gr?(t[Ro]=e[r],b4(e,Gr+i,t)):(e.push(t),t[Ro]=null),t[Ki]=e;let l=t[Sl];l!==null&&e!==l&&Kw(l,t);let c=t[Ls];c!==null&&c.insertView(n),c2(t),t[kt]|=128}function Kw(n,t){let e=n[Ku],i=t[Ki];if(wa(i))n[kt]|=2;else{let r=i[Ki][Qo];t[Qo]!==r&&(n[kt]|=2)}e===null?n[Ku]=[t]:e.push(t)}var l0=class{_lView;_cdRefInjectingView;notifyErrorHandler;_appRef=null;_attachedToViewContainer=!1;get rootNodes(){let t=this._lView,e=t[en];return Bp(e,t,e.firstChild,[])}constructor(t,e,i=!0){this._lView=t,this._cdRefInjectingView=e,this.notifyErrorHandler=i}get context(){return this._lView[Dr]}set context(t){this._lView[Dr]=t}get destroyed(){return lc(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let t=this._lView[Ki];if(Hs(t)){let e=t[Dp],i=e?e.indexOf(this):-1;i>-1&&(T2(t,i),wp(e,i))}this._attachedToViewContainer=!1}Hw(this._lView[en],this._lView)}onDestroy(t){V4(this._lView,t)}markForCheck(){ky(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[kt]&=-129}reattach(){c2(this._lView),this._lView[kt]|=128}detectChanges(){this._lView[kt]|=1024,Yw(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ot(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let t=Pp(this._lView),e=this._lView[Sl];e!==null&&!t&&Fy(e,this._lView),Vw(this._lView[en],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new ot(902,!1);this._appRef=t;let e=Pp(this._lView),i=this._lView[Sl];i!==null&&!e&&Kw(i,this._lView),c2(this._lView)}};var Pl=(()=>{class n{static __NG_ELEMENT_ID__=OF}return n})(),PF=Pl,IF=class extends PF{_declarationLView;_declarationTContainer;elementRef;constructor(t,e,i){super(),this._declarationLView=t,this._declarationTContainer=e,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(t,e){return this.createEmbeddedViewImpl(t,e)}createEmbeddedViewImpl(t,e,i){let r=eF(this._declarationLView,this._declarationTContainer,t,{embeddedViewInjector:e,dehydratedView:i});return new l0(r)}};function OF(){return cm(Or(),Ht())}function cm(n,t){return n.type&4?new IF(t,n,cc(n,t)):null}function dm(n,t,e,i,r){let o=n.data[t];if(o===null)o=FF(n,t,e,i,r),dO()&&(o.flags|=32);else if(o.type&64){o.type=e,o.value=i,o.attrs=r;let l=lO();o.injectorIndex=l===null?-1:l.injectorIndex}return Fl(o,!0),o}function FF(n,t,e,i,r){let o=H4(),l=uy(),c=l?o:o&&o.parent,f=n.data[t]=kF(n,c,e,t,i,r);return RF(n,f,o,l),f}function RF(n,t,e,i){n.firstChild===null&&(n.firstChild=t),e!==null&&(i?e.child==null&&t.parent!==null&&(e.child=t):e.next===null&&(e.next=t,t.prev=e))}function kF(n,t,e,i,r,o){let l=t?t.injectorIndex:-1,c=0;return oO()&&(c|=128),{type:e,index:i,insertBeforeIndex:null,injectorIndex:l,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:c,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var Vie=new RegExp(`^(\\d+)*(${e5}|${QO})*(.*)`);var NF=()=>null;function $E(n,t){return NF(n,t)}var UF=class{},Qw=class{},D2=class{resolveComponentFactory(t){throw Error(`No component factory found for ${Tr(t)}.`)}},fm=class{static NULL=new D2},nc=class{},Gs=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>LF()}return n})();function LF(){let n=Ht(),t=Or(),e=ns(t.index,n);return(wa(e)?e:n)[ci]}var BF=(()=>{class n{static \u0275prov=$e({token:n,providedIn:"root",factory:()=>null})}return n})();var qv={},P2=class{injector;parentInjector;constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,i){i=$p(i);let r=this.injector.get(t,qv,i);return r!==qv||e===qv?r:this.parentInjector.get(t,e,i)}};function I2(n,t,e){let i=e?n.styles:null,r=e?n.classes:null,o=0;if(t!==null)for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="number")o=c;else if(o==1)r=n2(r,c);else if(o==2){let f=c,p=t[++l];i=n2(i,f+": "+p+";")}}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=r:n.classesWithoutHost=r}function Ne(n,t=Gt.Default){let e=Ht();if(e===null)return We(n,t);let i=Or();return ow(i,e,ur(n),t)}function eS(){let n="invalid";throw new Error(n)}function Ny(n,t,e,i,r){let o=i===null?null:{"":-1},l=r(n,e);if(l!==null){let c,f=null,p=null,g=HF(l);g===null?c=l:[c,f,p]=g,WF(n,t,e,c,o,f,p)}o!==null&&i!==null&&VF(e,i,o)}function VF(n,t,e){let i=n.localNames=[];for(let r=0;r<t.length;r+=2){let o=e[t[r+1]];if(o==null)throw new ot(-301,!1);i.push(t[r],o)}}function HF(n){let t=null,e=!1;for(let l=0;l<n.length;l++){let c=n[l];if(l===0&&es(c)&&(t=c),c.findHostDirectiveDefs!==null){e=!0;break}}if(!e)return null;let i=null,r=null,o=null;for(let l of n)l.findHostDirectiveDefs!==null&&(i??=[],r??=new Map,o??=new Map,zF(l,i,o,r)),l===t&&(i??=[],i.push(l));return i!==null?(i.push(...t===null?n:n.slice(1)),[i,r,o]):null}function zF(n,t,e,i){let r=t.length;n.findHostDirectiveDefs(n,t,i),e.set(n,[r,t.length-1])}function jF(n,t,e){t.componentOffset=e,(n.components??=[]).push(t.index)}function WF(n,t,e,i,r,o,l){let c=i.length,f=!1;for(let x=0;x<c;x++){let C=i[x];!f&&es(C)&&(f=!0,jF(n,e,x)),p2(Rp(e,t),n,C.type)}ZF(e,n.data.length,c);for(let x=0;x<c;x++){let C=i[x];C.providersResolver&&C.providersResolver(C)}let p=!1,g=!1,m=Nw(n,t,c,null);c>0&&(e.directiveToIndex=new Map);for(let x=0;x<c;x++){let C=i[x];if(e.mergedAttrs=ec(e.mergedAttrs,C.hostAttrs),$F(n,e,t,m,C),XF(m,C,r),l!==null&&l.has(C)){let[O,T]=l.get(C);e.directiveToIndex.set(C.type,[m,O+e.directiveStart,T+e.directiveStart])}else(o===null||!o.has(C))&&e.directiveToIndex.set(C.type,m);C.contentQueries!==null&&(e.flags|=4),(C.hostBindings!==null||C.hostAttrs!==null||C.hostVars!==0)&&(e.flags|=64);let A=C.type.prototype;!p&&(A.ngOnChanges||A.ngOnInit||A.ngDoCheck)&&((n.preOrderHooks??=[]).push(e.index),p=!0),!g&&(A.ngOnChanges||A.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(e.index),g=!0),m++}GF(n,e,o)}function GF(n,t,e){for(let i=t.directiveStart;i<t.directiveEnd;i++){let r=n.data[i];if(e===null||!e.has(r))YE(0,t,r,i),YE(1,t,r,i),XE(t,i,!1);else{let o=e.get(r);qE(0,t,o,i),qE(1,t,o,i),XE(t,i,!0)}}}function YE(n,t,e,i){let r=n===0?e.inputs:e.outputs;for(let o in r)if(r.hasOwnProperty(o)){let l;n===0?l=t.inputs??={}:l=t.outputs??={},l[o]??=[],l[o].push(i),tS(t,o)}}function qE(n,t,e,i){let r=n===0?e.inputs:e.outputs;for(let o in r)if(r.hasOwnProperty(o)){let l=r[o],c;n===0?c=t.hostDirectiveInputs??={}:c=t.hostDirectiveOutputs??={},c[l]??=[],c[l].push(i,o),tS(t,l)}}function tS(n,t){t==="class"?n.flags|=8:t==="style"&&(n.flags|=16)}function XE(n,t,e){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!e&&r===null||e&&o===null||Ey(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let l=null,c=0;for(;c<i.length;){let f=i[c];if(f===0){c+=4;continue}else if(f===5){c+=2;continue}else if(typeof f=="number")break;if(!e&&r.hasOwnProperty(f)){let p=r[f];for(let g of p)if(g===t){l??=[],l.push(f,i[c+1]);break}}else if(e&&o.hasOwnProperty(f)){let p=o[f];for(let g=0;g<p.length;g+=2)if(p[g]===t){l??=[],l.push(p[g+1],i[c+1]);break}}c+=2}n.initialInputs??=[],n.initialInputs.push(l)}function $F(n,t,e,i,r){n.data[i]=r;let o=r.factory||(r.factory=Cl(r.type,!0)),l=new Dl(o,es(r),Ne);n.blueprint[i]=l,e[i]=l,YF(n,t,i,Nw(n,e,r.hostVars,dr),r)}function YF(n,t,e,i,r){let o=r.hostBindings;if(o){let l=n.hostBindingOpCodes;l===null&&(l=n.hostBindingOpCodes=[]);let c=~t.index;qF(l)!=c&&l.push(c),l.push(e,i,o)}}function qF(n){let t=n.length;for(;t>0;){let e=n[--t];if(typeof e=="number"&&e<0)return e}return 0}function XF(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;es(t)&&(e[""]=n)}}function ZF(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function nS(n,t,e,i,r,o,l,c){let f=t.consts,p=Qu(f,l),g=dm(t,n,2,i,p);return o&&Ny(t,e,g,Qu(f,c),r),g.mergedAttrs=ec(g.mergedAttrs,g.attrs),g.attrs!==null&&I2(g,g.attrs,!1),g.mergedAttrs!==null&&I2(g,g.mergedAttrs,!0),t.queries!==null&&t.queries.elementStart(t,g),g}function iS(n,t){hy(n,t),iy(t)&&n.queries.elementEnd(t)}var Vp=class extends fm{ngModule;constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){let e=wl(t);return new ic(e,this.ngModule)}};function JF(n){return Object.keys(n).map(t=>{let[e,i,r]=n[t],o={propName:e,templateName:t,isSignal:(i&sm.SignalBased)!==0};return r&&(o.transform=r),o})}function KF(n){return Object.keys(n).map(t=>({propName:n[t],templateName:t}))}function QF(n,t,e){let i=t instanceof Ji?t:t?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new P2(e,i):e}function eR(n){let t=n.get(nc,null);if(t===null)throw new ot(407,!1);let e=n.get(BF,null),i=n.get(tc,null);return{rendererFactory:t,sanitizer:e,changeDetectionScheduler:i}}function tR(n,t){let e=(n.selectors[0][0]||"div").toLowerCase();return Dw(t,e,e==="svg"?qI:e==="math"?XI:null)}var ic=class extends Qw{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=JF(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=KF(this.componentDef.outputs),this.cachedOutputs}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=R5(t.selectors),this.ngContentSelectors=t.ngContentSelectors??[],this.isBoundToModule=!!e}create(t,e,i,r){Fn(22);let o=dn(null);try{let l=this.componentDef,c=i?["ng-version","19.2.17"]:k5(this.componentDef.selectors[0]),f=wy(0,null,null,1,0,null,null,null,null,[c],null),p=QF(l,r||this.ngModule,t),g=eR(p),m=g.rendererFactory.createRenderer(null,l),x=i?B5(m,i,l.encapsulation,p):tR(l,m),C=Sy(null,f,null,512|kw(l),null,null,g,m,p,null,Aw(x,p,!0));C[Pr]=x,dy(C);let A=null;try{let O=nS(Pr,f,C,"#host",()=>[this.componentDef],!0,0);x&&(Iw(m,x,O),fc(x,C)),am(f,C,O),Cy(f,O,C),iS(f,O),e!==void 0&&nR(O,this.ngContentSelectors,e),A=ns(O.index,C),C[Dr]=A[Dr],Iy(f,C,null)}catch(O){throw A!==null&&b2(A),b2(C),O}finally{Fn(23),fy()}return new O2(this.componentType,C)}finally{dn(o)}}},O2=class extends UF{_rootLView;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(t,e){super(),this._rootLView=e,this._tNode=U4(e[en],Pr),this.location=cc(this._tNode,e),this.instance=ns(this._tNode.index,e)[Dr],this.hostView=this.changeDetectorRef=new l0(e,void 0,!1),this.componentType=t}setInput(t,e){let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;let r=this._rootLView,o=Py(i,r[en],r,t,e);this.previousInputValues.set(t,e);let l=ns(i.index,r);ky(l,1)}get injector(){return new bl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}};function nR(n,t,e){let i=n.projection=[];for(let r=0;r<t.length;r++){let o=e[r];i.push(o!=null&&o.length?Array.from(o):null)}}var Sa=(()=>{class n{static __NG_ELEMENT_ID__=iR}return n})();function iR(){let n=Or();return oS(n,Ht())}var rR=Sa,rS=class extends rR{_lContainer;_hostTNode;_hostLView;constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return cc(this._hostTNode,this._hostLView)}get injector(){return new bl(this._hostTNode,this._hostLView)}get parentInjector(){let t=py(this._hostTNode,this._hostLView);if(Q4(t)){let e=Op(t,this._hostLView),i=Ip(t),r=e[en].data[i+8];return new bl(r,e)}else return new bl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){let e=ZE(this._lContainer);return e!==null&&e[t]||null}get length(){return this._lContainer.length-Gr}createEmbeddedView(t,e,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let l=$E(this._lContainer,t.ssrId),c=t.createEmbeddedViewImpl(e||{},o,l);return this.insertImpl(c,r,WE(this._hostTNode,l)),c}createComponent(t,e,i,r,o){let l=t&&!WI(t),c;if(l)c=e;else{let A=e||{};c=A.index,i=A.injector,r=A.projectableNodes,o=A.environmentInjector||A.ngModuleRef}let f=l?t:new ic(wl(t)),p=i||this.parentInjector;if(!o&&f.ngModule==null){let O=(l?p:this.parentInjector).get(Ji,null);O&&(o=O)}let g=wl(f.componentType??{}),m=$E(this._lContainer,g?.id??null),x=m?.firstChild??null,C=f.create(p,r,x,o);return this.insertImpl(C.hostView,c,WE(this._hostTNode,m)),C}insert(t,e){return this.insertImpl(t,e,!0)}insertImpl(t,e,i){let r=t._lView;if(KI(r)){let c=this.indexOf(t);if(c!==-1)this.detach(c);else{let f=r[Ki],p=new rS(f,f[ko],f[Ki]);p.detach(p.indexOf(t))}}let o=this._adjustIndex(e),l=this._lContainer;return TF(l,r,o,i),t.attachToViewContainerRef(),b4(Xv(l),o,t),t}move(t,e){return this.insert(t,e)}indexOf(t){let e=ZE(this._lContainer);return e!==null?e.indexOf(t):-1}remove(t){let e=this._adjustIndex(t,-1),i=T2(this._lContainer,e);i&&(wp(Xv(this._lContainer),e),Hw(i[en],i))}detach(t){let e=this._adjustIndex(t,-1),i=T2(this._lContainer,e);return i&&wp(Xv(this._lContainer),e)!=null?new l0(i):null}_adjustIndex(t,e=0){return t??this.length+e}};function ZE(n){return n[Dp]}function Xv(n){return n[Dp]||(n[Dp]=[])}function oS(n,t){let e,i=t[n.index];return Hs(i)?e=i:(e=Jw(i,t,null,n),t[n.index]=e,My(t,e)),sR(e,t,n,i),new rS(e,n,t)}function oR(n,t){let e=n[ci],i=e.createComment(""),r=ss(t,n),o=e.parentNode(r);return Lp(e,o,i,e.nextSibling(r),!1),i}var sR=uR,aR=()=>!1;function lR(n,t,e){return aR(n,t,e)}function uR(n,t,e,i){if(n[Ml])return;let r;e.type&8?r=ts(i):r=oR(t,e),n[Ml]=r}var F2=class n{queryList;matches=null;constructor(t){this.queryList=t}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},R2=class n{queries;constructor(t=[]){this.queries=t}createEmbeddedView(t){let e=t.queries;if(e!==null){let i=t.contentQueries!==null?t.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){let l=e.getByIndex(o),c=this.queries[l.indexInDeclarationView];r.push(c.clone())}return new n(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}finishViewCreation(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)Uy(t,e).matches!==null&&this.queries[e].setDirty()}},k2=class{flags;read;predicate;constructor(t,e,i=null){this.flags=e,this.read=i,typeof t=="string"?this.predicate=_R(t):this.predicate=t}},N2=class n{queries;constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){let r=e!==null?e.length:0,o=this.getByIndex(i).embeddedTView(t,r);o&&(o.indexInDeclarationView=i,e!==null?e.push(o):e=[o])}return e!==null?new n(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}},U2=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(t,e=-1){this.metadata=t,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new n(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let e=this._declarationNodeIndex,i=t.parent;for(;i!==null&&i.type&8&&i.index!==e;)i=i.parent;return e===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(t,e,cR(e,o)),this.matchTNodeWithReadOption(t,e,vp(e,t,o,!1,!1))}else i===Pl?e.type&4&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,vp(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===$r||r===Sa||r===Pl&&e.type&4)this.addMatch(e.index,-2);else{let o=vp(e,t,r,!1,!1);o!==null&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(t,e){this.matches===null?this.matches=[t,e]:this.matches.push(t,e)}};function cR(n,t){let e=n.localNames;if(e!==null){for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1]}return null}function dR(n,t){return n.type&11?cc(n,t):n.type&4?cm(n,t):null}function fR(n,t,e,i){return e===-1?dR(t,n):e===-2?hR(n,t,i):a0(n,n[en],e,t)}function hR(n,t,e){if(e===$r)return cc(t,n);if(e===Pl)return cm(t,n);if(e===Sa)return oS(t,n)}function sS(n,t,e,i){let r=t[Ls].queries[i];if(r.matches===null){let o=n.data,l=e.matches,c=[];for(let f=0;l!==null&&f<l.length;f+=2){let p=l[f];if(p<0)c.push(null);else{let g=o[p];c.push(fR(t,g,l[f+1],e.metadata.read))}}r.matches=c}return r.matches}function L2(n,t,e,i){let r=n.queries.getByIndex(e),o=r.matches;if(o!==null){let l=sS(n,t,r,e);for(let c=0;c<o.length;c+=2){let f=o[c];if(f>0)i.push(l[c/2]);else{let p=o[c+1],g=t[-f];for(let m=Gr;m<g.length;m++){let x=g[m];x[Sl]===x[Ki]&&L2(x[en],x,p,i)}if(g[Ku]!==null){let m=g[Ku];for(let x=0;x<m.length;x++){let C=m[x];L2(C[en],C,p,i)}}}}}return i}function pR(n,t){return n[Ls].queries[t].queryList}function mR(n,t,e){let i=new x2((e&4)===4);return tO(n,t,i,i.destroy),(t[Ls]??=new R2).queries.push(new F2(i))-1}function gR(n,t,e){let i=wi();return i.firstCreatePass&&(vR(i,new k2(n,t,e),-1),(t&2)===2&&(i.staticViewQueries=!0)),mR(i,Ht(),t)}function _R(n){return n.split(",").map(t=>t.trim())}function vR(n,t,e){n.queries===null&&(n.queries=new N2),n.queries.track(new U2(t,e))}function Uy(n,t){return n.queries.getByIndex(t)}function yR(n,t){let e=n[en],i=Uy(e,t);return i.crossesNgTemplate?L2(e,n,t,[]):sS(e,n,i,t)}var rc=class{},Ly=class{};var B2=class extends rc{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Vp(this);constructor(t,e,i,r=!0){super(),this.ngModuleType=t,this._parent=e;let o=w4(t);this._bootstrapComponents=Fw(o.bootstrap),this._r3Injector=lw(t,e,[{provide:rc,useValue:this},{provide:fm,useValue:this.componentFactoryResolver},...i],Tr(t),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}},V2=class extends Ly{moduleType;constructor(t){super(),this.moduleType=t}create(t){return new B2(this.moduleType,t,[])}};var Hp=class extends rc{injector;componentFactoryResolver=new Vp(this);instance=null;constructor(t){super();let e=new o0([...t.providers,{provide:rc,useValue:this},{provide:fm,useValue:this.componentFactoryResolver}],t.parent||ny(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}};function g0(n,t,e=null){return new Hp({providers:n,parent:t,debugName:e,runEnvironmentInitializers:!0}).injector}var xR=(()=>{class n{_injector;cachedInjectors=new Map;constructor(e){this._injector=e}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){let i=S4(!1,e.type),r=i.length>0?g0([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,r)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(let e of this.cachedInjectors.values())e!==null&&e.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=$e({token:n,providedIn:"environment",factory:()=>new n(We(Ji))})}return n})();function nn(n){return d0(()=>{let t=aS(n),e=St(Oe({},t),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===vw.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&n.dependencies||null,getStandaloneInjector:t.standalone?r=>r.get(xR).getOrCreateStandaloneInjector(e):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||rs.Emulated,styles:n.styles||Ar,_:null,schemas:n.schemas||null,tView:null,id:""});t.standalone&&m0("NgStandalone"),lS(e);let i=n.dependencies;return e.directiveDefs=JE(i,!1),e.pipeDefs=JE(i,!0),e.id=SR(e),e})}function bR(n){return wl(n)||II(n)}function CR(n){return n!==null}function _o(n){return d0(()=>({type:n.type,bootstrap:n.bootstrap||Ar,declarations:n.declarations||Ar,imports:n.imports||Ar,exports:n.exports||Ar,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function ER(n,t){if(n==null)return El;let e={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,l,c,f;Array.isArray(r)?(c=r[0],o=r[1],l=r[2]??o,f=r[3]||null):(o=r,l=r,c=sm.None,f=null),e[o]=[i,c,f],t[o]=l}return e}function wR(n){if(n==null)return El;let t={};for(let e in n)n.hasOwnProperty(e)&&(t[n[e]]=e);return t}function Rn(n){return d0(()=>{let t=aS(n);return lS(t),t})}function hm(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function aS(n){let t={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputConfig:n.inputs||El,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Ar,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ER(n.inputs,t),outputs:wR(n.outputs),debugInfo:null}}function lS(n){n.features?.forEach(t=>t(n))}function JE(n,t){if(!n)return null;let e=t?OI:bR;return()=>(typeof n=="function"?n():n).map(i=>e(i)).filter(CR)}function SR(n){let t=0,e=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,e,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))t=Math.imul(31,t)+o.charCodeAt(0)<<0;return t+=2147483648,"c"+t}function MR(n){return Object.getPrototypeOf(n.prototype).constructor}function Wi(n){let t=MR(n.type),e=!0,i=[n];for(;t;){let r;if(es(n))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new ot(903,!1);r=t.\u0275dir}if(r){if(e){i.push(r);let l=n;l.inputs=Zv(n.inputs),l.declaredInputs=Zv(n.declaredInputs),l.outputs=Zv(n.outputs);let c=r.hostBindings;c&&IR(n,c);let f=r.viewQuery,p=r.contentQueries;if(f&&DR(n,f),p&&PR(n,p),AR(n,r),lI(n.outputs,r.outputs),es(r)&&r.data.animation){let g=n.data;g.animation=(g.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let l=0;l<o.length;l++){let c=o[l];c&&c.ngInherit&&c(n),c===Wi&&(e=!1)}}t=Object.getPrototypeOf(t)}TR(i)}function AR(n,t){for(let e in t.inputs){if(!t.inputs.hasOwnProperty(e)||n.inputs.hasOwnProperty(e))continue;let i=t.inputs[e];i!==void 0&&(n.inputs[e]=i,n.declaredInputs[e]=t.declaredInputs[e])}}function TR(n){let t=0,e=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=t+=r.hostVars,r.hostAttrs=ec(r.hostAttrs,e=ec(e,r.hostAttrs))}}function Zv(n){return n===El?{}:n===Ar?[]:n}function DR(n,t){let e=n.viewQuery;e?n.viewQuery=(i,r)=>{t(i,r),e(i,r)}:n.viewQuery=t}function PR(n,t){let e=n.contentQueries;e?n.contentQueries=(i,r,o)=>{t(i,r,o),e(i,r,o)}:n.contentQueries=t}function IR(n,t){let e=n.hostBindings;e?n.hostBindings=(i,r)=>{t(i,r),e(i,r)}:n.hostBindings=t}function uS(n){return FR(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function OR(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{let e=n[Symbol.iterator](),i;for(;!(i=e.next()).done;)t(i.value)}}function FR(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function _0(n,t,e){return n[t]=e}function RR(n,t){return n[t]}function os(n,t,e){let i=n[t];return Object.is(i,e)?!1:(n[t]=e,!0)}function u0(n,t,e,i){let r=os(n,t,e);return os(n,t+1,i)||r}function cS(n,t,e,i,r){let o=u0(n,t,e,i);return os(n,t+2,r)||o}function kR(n,t,e,i,r,o){let l=u0(n,t,e,i);return u0(n,t+2,r,o)||l}function NR(n,t,e,i,r,o,l,c,f){let p=t.consts,g=dm(t,n,4,l||null,c||null);ly()&&Ny(t,e,g,Qu(p,f),Dy),g.mergedAttrs=ec(g.mergedAttrs,g.attrs),hy(t,g);let m=g.tView=wy(2,g,i,r,o,t.directiveRegistry,t.pipeRegistry,null,t.schemas,p,null);return t.queries!==null&&(t.queries.template(t,g),m.queries=t.queries.embeddedTView(g)),g}function UR(n,t,e,i,r,o,l,c,f,p){let g=e+Pr,m=t.firstCreatePass?NR(g,t,n,i,r,o,l,c,f):t.data[g];Fl(m,!1);let x=LR(t,n,m,e);tm()&&lm(t,n,x,m),fc(x,n);let C=Jw(x,n,x,m);return n[g]=C,My(n,C),lR(C,m,n),Zp(m)&&am(t,n,m),f!=null&&Ay(n,m,p),m}function j(n,t,e,i,r,o,l,c){let f=Ht(),p=wi(),g=Qu(p.consts,o);return UR(f,p,n,t,e,i,r,g,l,c),j}var LR=BR;function BR(n,t,e,i){return nm(!0),t[ci].createComment("")}var dS=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var fS=new it("");var VR=(()=>{class n{static \u0275prov=$e({token:n,providedIn:"root",factory:()=>new H2})}return n})(),H2=class{queuedEffectCount=0;queues=new Map;schedule(t){this.enqueue(t)}remove(t){let e=t.zone,i=this.queues.get(e);i.has(t)&&(i.delete(t),this.queuedEffectCount--)}enqueue(t){let e=t.zone;this.queues.has(e)||this.queues.set(e,new Set);let i=this.queues.get(e);i.has(t)||(this.queuedEffectCount++,i.add(t))}flush(){for(;this.queuedEffectCount>0;)for(let[t,e]of this.queues)t===null?this.flushQueue(e):t.run(()=>this.flushQueue(e))}flushQueue(t){for(let e of t)t.delete(e),this.queuedEffectCount--,e.run()}};function kl(n){return!!n&&typeof n.then=="function"}function hS(n){return!!n&&typeof n.subscribe=="function"}var pS=new it("");function By(n){return h0([{provide:pS,multi:!0,useValue:n}])}var mS=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i});appInits=Pe(pS,{optional:!0})??[];injector=Pe(po);constructor(){}runInitializers(){if(this.initialized)return;let e=[];for(let r of this.appInits){let o=Ir(this.injector,r);if(kl(o))e.push(o);else if(hS(o)){let l=new Promise((c,f)=>{o.subscribe({complete:c,error:f})});e.push(l)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),e.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),pm=new it("");function HR(){Ev(()=>{throw new ot(600,!1)})}function zR(n){return n.isBoundToModule}var jR=10;var Il=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=Pe(HO);afterRenderManager=Pe(Mw);zonelessEnabled=Pe(cw);rootEffectScheduler=Pe(VR);dirtyFlags=0;tracingSnapshot=null;externalTestViews=new Set;afterTick=new bi;get allViews(){return[...this.externalTestViews.keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];isStable=Pe(Ws).hasPendingTasks.pipe(qt(e=>!e));constructor(){Pe(pc,{optional:!0})}whenStable(){let e;return new Promise(i=>{e=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{e.unsubscribe()})}_injector=Pe(Ji);_rendererFactory=null;get injector(){return this._injector}bootstrap(e,i){return this.bootstrapImpl(e,i)}bootstrapImpl(e,i,r=po.NULL){Fn(10);let o=e instanceof Qw;if(!this._injector.get(mS).done){let C="";throw new ot(405,C)}let c;o?c=e:c=this._injector.get(fm).resolveComponentFactory(e),this.componentTypes.push(c.componentType);let f=zR(c)?void 0:this._injector.get(rc),p=i||c.selector,g=c.create(r,[],p,f),m=g.location.nativeElement,x=g.injector.get(fS,null);return x?.registerApplication(m),g.onDestroy(()=>{this.detachView(g.hostView),yp(this.components,g),x?.unregisterApplication(m)}),this._loadComponent(g),Fn(11,g),g}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){Fn(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(xy.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new ot(101,!1);let e=dn(null);try{this._runningTick=!0,this.synchronize()}catch(i){this.internalErrorHandler(i)}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,dn(e),this.afterTick.next(),Fn(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(nc,null,{optional:!0}));let e=0;for(;this.dirtyFlags!==0&&e++<jR;)Fn(14),this.synchronizeOnce(),Fn(15)}synchronizeOnce(){if(this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush()),this.dirtyFlags&7){let e=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:i,notifyErrorHandler:r}of this.allViews)WR(i,r,e,this.zonelessEnabled);if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}else this._rendererFactory?.begin?.(),this._rendererFactory?.end?.();this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:e})=>Jp(e))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(e){let i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){let i=e;yp(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(pm,[]).forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>yp(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new ot(406,!1);let e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function yp(n,t){let e=n.indexOf(t);e>-1&&n.splice(e,1)}function WR(n,t,e,i){if(!e&&!Jp(n))return;Yw(n,t,e&&!i?0:1)}function Ma(n,t,e,i){let r=Ht(),o=Kp();if(os(r,o,t)){let l=wi(),c=em();Y5(c,r,n,t,e,i)}return Ma}function Vy(n,t,e,i){return os(n,Kp(),e)?t+Ns(e)+i:dr}function GR(n,t,e,i,r,o){let l=W4(),c=u0(n,l,e,r);return Qp(2),c?t+Ns(e)+i+Ns(r)+o:dr}function $R(n,t,e,i,r,o,l,c){let f=W4(),p=cS(n,f,e,r,l);return Qp(3),p?t+Ns(e)+i+Ns(r)+o+Ns(l)+c:dr}function pp(n,t){return n<<17|t<<2}function Ol(n){return n>>17&32767}function YR(n){return(n&2)==2}function qR(n,t){return n&131071|t<<17}function z2(n){return n|2}function oc(n){return(n&131068)>>2}function Jv(n,t){return n&-131069|t<<2}function XR(n){return(n&1)===1}function j2(n){return n|1}function ZR(n,t,e,i,r,o){let l=o?t.classBindings:t.styleBindings,c=Ol(l),f=oc(l);n[i]=e;let p=!1,g;if(Array.isArray(e)){let m=e;g=m[1],(g===null||f0(m,g)>0)&&(p=!0)}else g=e;if(r)if(f!==0){let x=Ol(n[c+1]);n[i+1]=pp(x,c),x!==0&&(n[x+1]=Jv(n[x+1],i)),n[c+1]=qR(n[c+1],i)}else n[i+1]=pp(c,0),c!==0&&(n[c+1]=Jv(n[c+1],i)),c=i;else n[i+1]=pp(f,0),c===0?c=i:n[f+1]=Jv(n[f+1],i),f=i;p&&(n[i+1]=z2(n[i+1])),KE(n,g,i,!0),KE(n,g,i,!1),JR(t,g,n,i,o),l=pp(c,f),o?t.classBindings=l:t.styleBindings=l}function JR(n,t,e,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof t=="string"&&f0(o,t)>=0&&(e[i+1]=j2(e[i+1]))}function KE(n,t,e,i){let r=n[e+1],o=t===null,l=i?Ol(r):oc(r),c=!1;for(;l!==0&&(c===!1||o);){let f=n[l],p=n[l+1];KR(f,t)&&(c=!0,n[l+1]=i?j2(p):z2(p)),l=i?Ol(p):oc(p)}c&&(n[e+1]=i?z2(r):j2(r))}function KR(n,t){return n===null||t==null||(Array.isArray(n)?n[1]:n)===t?!0:Array.isArray(n)&&typeof t=="string"?f0(n,t)>=0:!1}var Fo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function QR(n){return n.substring(Fo.key,Fo.keyEnd)}function ek(n){return tk(n),gS(n,_S(n,0,Fo.textEnd))}function gS(n,t){let e=Fo.textEnd;return e===t?-1:(t=Fo.keyEnd=nk(n,Fo.key=t,e),_S(n,t,e))}function tk(n){Fo.key=0,Fo.keyEnd=0,Fo.value=0,Fo.valueEnd=0,Fo.textEnd=n.length}function _S(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function nk(n,t,e){for(;t<e&&n.charCodeAt(t)>32;)t++;return t}function w(n,t,e){let i=Ht(),r=Kp();if(os(i,r,t)){let o=wi(),l=em();Ty(o,l,i,n,t,i[ci],e,!1)}return w}function W2(n,t,e,i,r){Py(t,n,e,r?"class":"style",i)}function fr(n,t,e){return yS(n,t,e,!1),fr}function Ie(n,t){return yS(n,t,null,!0),Ie}function Kn(n){xS(lk,vS,n,!0)}function vS(n,t){for(let e=ek(t);e>=0;e=gS(t,e))Yp(n,QR(t),!0)}function yS(n,t,e,i){let r=Ht(),o=wi(),l=Qp(2);if(o.firstUpdatePass&&CS(o,n,l,i),t!==dr&&os(r,l,t)){let c=o.data[js()];ES(o,c,r,r[ci],n,r[l+1]=ck(t,e),i,l)}}function xS(n,t,e,i){let r=wi(),o=Qp(2);r.firstUpdatePass&&CS(r,null,o,i);let l=Ht();if(e!==dr&&os(l,o,e)){let c=r.data[js()];if(wS(c,i)&&!bS(r,o)){let f=i?c.classesWithoutHost:c.stylesWithoutHost;f!==null&&(e=n2(f,e||"")),W2(r,c,l,e,i)}else uk(r,c,l,l[ci],l[o+1],l[o+1]=ak(n,t,e),i,o)}}function bS(n,t){return t>=n.expandoStartIndex}function CS(n,t,e,i){let r=n.data;if(r[e+1]===null){let o=r[js()],l=bS(n,e);wS(o,i)&&t===null&&!l&&(t=!1),t=ik(r,o,t,i),ZR(r,o,t,e,l,i)}}function ik(n,t,e,i){let r=pO(n),o=i?t.residualClasses:t.residualStyles;if(r===null)(i?t.classBindings:t.styleBindings)===0&&(e=Kv(null,n,t,e,i),e=c0(e,t.attrs,i),o=null);else{let l=t.directiveStylingLast;if(l===-1||n[l]!==r)if(e=Kv(r,n,t,e,i),o===null){let f=rk(n,t,i);f!==void 0&&Array.isArray(f)&&(f=Kv(null,n,t,f[1],i),f=c0(f,t.attrs,i),ok(n,t,i,f))}else o=sk(n,t,i)}return o!==void 0&&(i?t.residualClasses=o:t.residualStyles=o),e}function rk(n,t,e){let i=e?t.classBindings:t.styleBindings;if(oc(i)!==0)return n[Ol(i)]}function ok(n,t,e,i){let r=e?t.classBindings:t.styleBindings;n[Ol(r)]=i}function sk(n,t,e){let i,r=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<r;o++){let l=n[o].hostAttrs;i=c0(i,l,e)}return c0(i,t.attrs,e)}function Kv(n,t,e,i,r){let o=null,l=e.directiveEnd,c=e.directiveStylingLast;for(c===-1?c=e.directiveStart:c++;c<l&&(o=t[c],i=c0(i,o.hostAttrs,r),o!==n);)c++;return n!==null&&(e.directiveStylingLast=c),i}function c0(n,t,e){let i=e?1:2,r=-1;if(t!==null)for(let o=0;o<t.length;o++){let l=t[o];typeof l=="number"?r=l:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),Yp(n,l,e?!0:t[++o]))}return n===void 0?null:n}function ak(n,t,e){if(e==null||e==="")return Ar;let i=[],r=im(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&t(i,r);return i}function lk(n,t,e){let i=String(t);i!==""&&!i.includes(" ")&&Yp(n,i,e)}function uk(n,t,e,i,r,o,l,c){r===dr&&(r=Ar);let f=0,p=0,g=0<r.length?r[0]:null,m=0<o.length?o[0]:null;for(;g!==null||m!==null;){let x=f<r.length?r[f+1]:void 0,C=p<o.length?o[p+1]:void 0,A=null,O;g===m?(f+=2,p+=2,x!==C&&(A=m,O=C)):m===null||g!==null&&g<m?(f+=2,A=g):(p+=2,A=m,O=C),A!==null&&ES(n,t,e,i,A,O,l,c),g=f<r.length?r[f]:null,m=p<o.length?o[p]:null}}function ES(n,t,e,i,r,o,l,c){if(!(t.type&3))return;let f=n.data,p=f[c+1],g=XR(p)?QE(f,t,e,r,oc(p),l):void 0;if(!zp(g)){zp(o)||YR(p)&&(o=QE(f,null,e,r,c,l));let m=N4(js(),e);pF(i,l,m,r,o)}}function QE(n,t,e,i,r,o){let l=t===null,c;for(;r>0;){let f=n[r],p=Array.isArray(f),g=p?f[1]:f,m=g===null,x=e[r+1];x===dr&&(x=m?Ar:void 0);let C=m?zv(x,i):g===i?x:void 0;if(p&&!zp(C)&&(C=zv(f,i)),zp(C)&&(c=C,l))return c;let A=n[r+1];r=l?Ol(A):oc(A)}if(t!==null){let f=o?t.residualClasses:t.residualStyles;f!=null&&(c=zv(f,i))}return c}function zp(n){return n!==void 0}function ck(n,t){return n==null||n===""||(typeof t=="string"?n=n+t:typeof n=="object"&&(n=Tr(im(n)))),n}function wS(n,t){return(n.flags&(t?8:16))!==0}function SS(n,t,e){let i=Ht(),r=Vy(i,n,t,e);xS(Yp,vS,r,!0)}function s(n,t,e,i){let r=Ht(),o=wi(),l=Pr+n,c=r[ci],f=o.firstCreatePass?nS(l,o,r,t,Dy,ly(),e,i):o.data[l],p=dk(o,r,f,c,t,n);r[l]=p;let g=Zp(f);return Fl(f,!0),Iw(c,p,f),!Bw(f)&&tm()&&lm(o,r,p,f),(nO()===0||g)&&fc(p,r),iO(),g&&(am(o,r,f),Cy(o,f,r)),i!==null&&Ay(r,f),s}function a(){let n=Or();uy()?z4():(n=n.parent,Fl(n,!1));let t=n;sO(t)&&aO(),rO();let e=wi();return e.firstCreatePass&&iS(e,t),t.classesWithoutHost!=null&&xO(t)&&W2(e,t,Ht(),t.classesWithoutHost,!0),t.stylesWithoutHost!=null&&bO(t)&&W2(e,t,Ht(),t.stylesWithoutHost,!1),a}function b(n,t,e,i){return s(n,t,e,i),a(),b}var dk=(n,t,e,i,r,o)=>(nm(!0),Dw(i,r,_O()));function fk(n,t,e,i,r){let o=t.consts,l=Qu(o,i),c=dm(t,n,8,"ng-container",l);l!==null&&I2(c,l,!0);let f=Qu(o,r);return ly()&&Ny(t,e,c,f,Dy),c.mergedAttrs=ec(c.mergedAttrs,c.attrs),t.queries!==null&&t.queries.elementStart(t,c),c}function v0(n,t,e){let i=Ht(),r=wi(),o=n+Pr,l=r.firstCreatePass?fk(o,r,i,t,e):r.data[o];Fl(l,!0);let c=hk(r,i,l,n);return i[o]=c,tm()&&lm(r,i,c,l),fc(c,i),Zp(l)&&(am(r,i,l),Cy(r,l,i)),e!=null&&Ay(i,l),v0}function y0(){let n=Or(),t=wi();return uy()?z4():(n=n.parent,Fl(n,!1)),t.firstCreatePass&&(hy(t,n),iy(n)&&t.queries.elementEnd(n)),y0}var hk=(n,t,e,i)=>(nm(!0),x5(t[ci],""));function he(){return Ht()}var yl=void 0;function pk(n){let t=Math.floor(Math.abs(n)),e=n.toString().replace(/^[^.]*\.?/,"").length;return t===1&&e===0?1:5}var mk=["en",[["a","p"],["AM","PM"],yl],[["AM","PM"],yl,yl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],yl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],yl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",yl,"{1} 'at' {0}",yl],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",pk],Qv={};function Fr(n){let t=gk(n),e=e4(t);if(e)return e;let i=t.split("-")[0];if(e=e4(i),e)return e;if(i==="en")return mk;throw new ot(701,!1)}function e4(n){return n in Qv||(Qv[n]=e0.ng&&e0.ng.common&&e0.ng.common.locales&&e0.ng.common.locales[n]),Qv[n]}var ai=function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n}(ai||{});function gk(n){return n.toLowerCase().replace(/_/g,"-")}var jp="en-US",_k="USD";var vk=jp;function yk(n){typeof n=="string"&&(vk=n.toLowerCase().replace(/_/g,"-"))}function t4(n,t,e){return function i(r){if(r===Function)return e;let o=ac(n)?ns(n.index,t):t;ky(o,5);let l=t[Dr],c=n4(t,l,e,r),f=i.__ngNextListenerFn__;for(;f;)c=n4(t,l,f,r)&&c,f=f.__ngNextListenerFn__;return c}}function n4(n,t,e,i){let r=dn(null);try{return Fn(6,t,e),e(i)!==!1}catch(o){return xk(n,o),!1}finally{Fn(7,t,e),dn(r)}}function xk(n,t){let e=n[Ju],i=e?e.get(is,null):null;i&&i.handleError(t)}function i4(n,t,e,i,r,o){let l=t[e],c=t[en],p=c.data[e].outputs[i],g=l[p],m=c.firstCreatePass?ay(c):null,x=sy(t),C=g.subscribe(o),A=x.length;x.push(o,C),m&&m.push(r,n.index,A,-(A+1))}function I(n,t,e,i){let r=Ht(),o=wi(),l=Or();return MS(o,r,r[ci],l,n,t,i),I}function bk(n,t,e,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let l=r[o];if(l===e&&r[o+1]===i){let c=t[Ap],f=r[o+2];return c.length>f?c[f]:null}typeof l=="string"&&(o+=2)}return null}function MS(n,t,e,i,r,o,l){let c=Zp(i),p=n.firstCreatePass?ay(n):null,g=sy(t),m=!0;if(i.type&3||l){let x=ss(i,t),C=l?l(x):x,A=g.length,O=l?M=>l(ts(M[i.index])):i.index,T=null;if(!l&&c&&(T=bk(n,t,r,i.index)),T!==null){let M=T.__ngLastListenerFn__||T;M.__ngNextListenerFn__=o,T.__ngLastListenerFn__=o,m=!1}else{o=t4(i,t,o),l5(t,C,r,o);let M=e.listen(C,r,o);g.push(o,M),p&&p.push(r,O,A,A+1)}}else o=t4(i,t,o);if(m){let x=i.outputs?.[r],C=i.hostDirectiveOutputs?.[r];if(C&&C.length)for(let A=0;A<C.length;A+=2){let O=C[A],T=C[A+1];i4(i,t,O,T,r,o)}if(x&&x.length)for(let A of x)i4(i,t,A,r,r,o)}}function E(n=1){return gO(n)}function Hy(n,t,e){return AS(n,"",t,"",e),Hy}function AS(n,t,e,i,r){let o=Ht(),l=Vy(o,t,e,i);if(l!==dr){let c=wi(),f=em();Ty(c,f,o,n,l,o[ci],r,!1)}return AS}function mc(n,t,e){gR(n,t,e)}function Nl(n){let t=Ht(),e=wi(),i=G4();cy(i+1);let r=Uy(e,i);if(n.dirty&&JI(t)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=yR(t,i);n.reset(o,WO),n.notifyOnChanges()}return!0}return!1}function Ul(){return pR(Ht(),G4())}function gc(n){let t=uO();return ry(t,Pr+n)}function u(n,t=""){let e=Ht(),i=wi(),r=n+Pr,o=i.firstCreatePass?dm(i,r,1,t,null):i.data[r],l=Ck(i,e,o,t,n);e[r]=l,tm()&&lm(i,e,l,o),Fl(o,!1)}var Ck=(n,t,e,i,r)=>(nm(!0),v5(t[ci],i));function B(n){return H("",n,""),B}function H(n,t,e){let i=Ht(),r=Vy(i,n,t,e);return r!==dr&&zy(i,js(),r),H}function Gn(n,t,e,i,r){let o=Ht(),l=GR(o,n,t,e,i,r);return l!==dr&&zy(o,js(),l),Gn}function Qi(n,t,e,i,r,o,l){let c=Ht(),f=$R(c,n,t,e,i,r,o,l);return f!==dr&&zy(c,js(),f),Qi}function zy(n,t,e){let i=N4(t,n);y5(n[ci],i,e)}function ve(n,t,e){gw(t)&&(t=t());let i=Ht(),r=Kp();if(os(i,r,t)){let o=wi(),l=em();Ty(o,l,i,n,t,i[ci],e,!1)}return ve}function Ce(n,t){let e=gw(n);return e&&n.set(t),e}function ye(n,t){let e=Ht(),i=wi(),r=Or();return MS(i,e,e[ci],r,n,t),ye}function Ek(n,t,e){let i=wi();if(i.firstCreatePass){let r=es(n);G2(e,i.data,i.blueprint,r,!0),G2(t,i.data,i.blueprint,r,!1)}}function G2(n,t,e,i,r){if(n=ur(n),Array.isArray(n))for(let o=0;o<n.length;o++)G2(n[o],t,e,i,r);else{let o=wi(),l=Ht(),c=Or(),f=Zu(n)?n:ur(n.provide),p=T4(n),g=c.providerIndexes&1048575,m=c.directiveStart,x=c.providerIndexes>>20;if(Zu(n)||!n.multi){let C=new Dl(p,r,Ne),A=t2(f,t,r?g:g+x,m);A===-1?(p2(Rp(c,l),o,f),e2(o,n,t.length),t.push(f),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),e.push(C),l.push(C)):(e[A]=C,l[A]=C)}else{let C=t2(f,t,g+x,m),A=t2(f,t,g,g+x),O=C>=0&&e[C],T=A>=0&&e[A];if(r&&!T||!r&&!O){p2(Rp(c,l),o,f);let M=Mk(r?Sk:wk,e.length,r,i,p);!r&&T&&(e[A].providerFactory=M),e2(o,n,t.length,0),t.push(f),c.directiveStart++,c.directiveEnd++,r&&(c.providerIndexes+=1048576),e.push(M),l.push(M)}else{let M=TS(e[r?A:C],p,!r&&i);e2(o,n,C>-1?C:A,M)}!r&&i&&T&&e[A].componentProviders++}}}function e2(n,t,e,i){let r=Zu(t),o=UI(t);if(r||o){let f=(o?ur(t.useClass):t).prototype.ngOnDestroy;if(f){let p=n.destroyHooks||(n.destroyHooks=[]);if(!r&&t.multi){let g=p.indexOf(e);g===-1?p.push(e,[i,f]):p[g+1].push(i,f)}else p.push(e,f)}}}function TS(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function t2(n,t,e,i){for(let r=e;r<i;r++)if(t[r]===n)return r;return-1}function wk(n,t,e,i,r){return $2(this.multi,[])}function Sk(n,t,e,i,r){let o=this.multi,l;if(this.providerFactory){let c=this.providerFactory.componentProviders,f=a0(i,i[en],this.providerFactory.index,r);l=f.slice(0,c),$2(o,l);for(let p=c;p<f.length;p++)l.push(f[p])}else l=[],$2(o,l);return l}function $2(n,t){for(let e=0;e<n.length;e++){let i=n[e];t.push(i())}return t}function Mk(n,t,e,i,r){let o=new Dl(n,e,Ne);return o.multi=[],o.index=t,o.componentProviders=0,TS(o,r,i&&!e),o}function Yr(n,t=[]){return e=>{e.providersResolver=(i,r)=>Ek(i,r?r(n):n,t)}}function Ll(n,t,e){let i=Rl()+n,r=Ht();return r[i]===dr?_0(r,i,e?t.call(e):t()):RR(r,i)}function Rr(n,t,e,i){return PS(Ht(),Rl(),n,t,e,i)}function Aa(n,t,e,i,r){return IS(Ht(),Rl(),n,t,e,i,r)}function x0(n,t,e,i,r,o){return Ak(Ht(),Rl(),n,t,e,i,r,o)}function DS(n,t,e,i,r,o,l){return Tk(Ht(),Rl(),n,t,e,i,r,o,l)}function mm(n,t){let e=n[t];return e===dr?void 0:e}function PS(n,t,e,i,r,o){let l=t+e;return os(n,l,r)?_0(n,l+1,o?i.call(o,r):i(r)):mm(n,l+1)}function IS(n,t,e,i,r,o,l){let c=t+e;return u0(n,c,r,o)?_0(n,c+2,l?i.call(l,r,o):i(r,o)):mm(n,c+2)}function Ak(n,t,e,i,r,o,l,c){let f=t+e;return cS(n,f,r,o,l)?_0(n,f+3,c?i.call(c,r,o,l):i(r,o,l)):mm(n,f+3)}function Tk(n,t,e,i,r,o,l,c,f){let p=t+e;return kR(n,p,r,o,l,c)?_0(n,p+4,f?i.call(f,r,o,l,c):i(r,o,l,c)):mm(n,p+4)}function ut(n,t){let e=wi(),i,r=n+Pr;e.firstCreatePass?(i=Dk(t,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks??=[]).push(r,i.onDestroy)):i=e.data[r];let o=i.factory||(i.factory=Cl(i.type,!0)),l,c=Mr(Ne);try{let f=Fp(!1),p=o();return Fp(f),ZI(e,Ht(),r,p),p}finally{Mr(c)}}function Dk(n,t){if(t)for(let e=t.length-1;e>=0;e--){let i=t[e];if(n===i.name)return i}}function _c(n,t,e){let i=n+Pr,r=Ht(),o=ry(r,i);return OS(r,i)?PS(r,Rl(),t,o.transform,e,o):o.transform(e)}function pt(n,t,e,i){let r=n+Pr,o=Ht(),l=ry(o,r);return OS(o,r)?IS(o,Rl(),t,l.transform,e,i,l):l.transform(e,i)}function OS(n,t){return n[en].data[t].pure}function FS(n,t){return cm(n,t)}var Y2=class{ngModuleFactory;componentFactories;constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}},RS=(()=>{class n{compileModuleSync(e){return new V2(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){let i=this.compileModuleSync(e),r=w4(e),o=Fw(r.declarations).reduce((l,c)=>{let f=wl(c);return f&&l.push(new ic(f)),l},[]);return new Y2(i,o)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Pk=(()=>{class n{zone=Pe(si);changeDetectionScheduler=Pe(tc);applicationRef=Pe(Il);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ik({ngZoneFactory:n,ignoreChangesOutsideZone:t,scheduleInRootZone:e}){return n??=()=>new si(St(Oe({},Ok()),{scheduleInRootZone:e})),[{provide:si,useFactory:n},{provide:r0,multi:!0,useFactory:()=>{let i=Pe(Pk,{optional:!0});return()=>i.initialize()}},{provide:r0,multi:!0,useFactory:()=>{let i=Pe(Fk);return()=>{i.initialize()}}},t===!0?{provide:dw,useValue:!0}:[],{provide:fw,useValue:e??uw}]}function Ok(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var Fk=(()=>{class n{subscription=new xi;initialized=!1;zone=Pe(si);pendingTasks=Pe(Ws);initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{si.assertNotInAngularZone(),queueMicrotask(()=>{e!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{si.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Rk=(()=>{class n{appRef=Pe(Il);taskService=Pe(Ws);ngZone=Pe(si);zonelessEnabled=Pe(cw);tracing=Pe(pc,{optional:!0});disableScheduling=Pe(dw,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new xi;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Np):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(Pe(fw,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof y2||!this.zoneIsDefined)}notify(e){if(!this.zonelessEnabled&&e===5)return;let i=!1;switch(e){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,i=!0;break}case 12:{this.appRef.dirtyFlags|=16,i=!0;break}case 13:{this.appRef.dirtyFlags|=2,i=!0;break}case 11:{i=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;let r=this.useMicrotaskScheduler?NE:hw;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(e){return!(this.disableScheduling&&!e||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Np+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){throw this.taskService.remove(e),i}finally{this.cleanup()}this.useMicrotaskScheduler=!0,NE(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function kk(){return typeof $localize<"u"&&$localize.locale||jp}var vc=new it("",{providedIn:"root",factory:()=>Pe(vc,Gt.Optional|Gt.SkipSelf)||kk()}),kS=new it("",{providedIn:"root",factory:()=>_k});var q2=new it(""),Nk=new it("");function Qd(n){return!n.moduleRef}function Uk(n){let t=Qd(n)?n.r3Injector:n.moduleRef.injector,e=t.get(si);return e.run(()=>{Qd(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=t.get(is,null),r;if(e.runOutsideAngular(()=>{r=e.onError.subscribe({next:o=>{i.handleError(o)}})}),Qd(n)){let o=()=>t.destroy(),l=n.platformInjector.get(q2);l.add(o),t.onDestroy(()=>{r.unsubscribe(),l.delete(o)})}else{let o=()=>n.moduleRef.destroy(),l=n.platformInjector.get(q2);l.add(o),n.moduleRef.onDestroy(()=>{yp(n.allPlatformModules,n.moduleRef),r.unsubscribe(),l.delete(o)})}return Bk(i,e,()=>{let o=t.get(mS);return o.runInitializers(),o.donePromise.then(()=>{let l=t.get(vc,jp);if(yk(l||jp),!t.get(Nk,!0))return Qd(n)?t.get(Il):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Qd(n)){let f=t.get(Il);return n.rootComponent!==void 0&&f.bootstrap(n.rootComponent),f}else return Lk(n.moduleRef,n.allPlatformModules),n.moduleRef})})})}function Lk(n,t){let e=n.injector.get(Il);if(n._bootstrapComponents.length>0)n._bootstrapComponents.forEach(i=>e.bootstrap(i));else if(n.instance.ngDoBootstrap)n.instance.ngDoBootstrap(e);else throw new ot(-403,!1);t.push(n)}function Bk(n,t,e){try{let i=e();return kl(i)?i.catch(r=>{throw t.runOutsideAngular(()=>n.handleError(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>n.handleError(i)),i}}var xp=null;function Vk(n=[],t){return po.create({name:t,providers:[{provide:qp,useValue:"platform"},{provide:q2,useValue:new Set([()=>xp=null])},...n]})}function Hk(n=[]){if(xp)return xp;let t=Vk(n);return xp=t,HR(),zk(t),t}function zk(n){let t=n.get(vy,null);Ir(n,()=>{t?.forEach(e=>e())})}var Bl=(()=>{class n{static __NG_ELEMENT_ID__=jk}return n})();function jk(n){return Wk(Or(),Ht(),(n&16)===16)}function Wk(n,t,e){if(ac(n)&&!e){let i=ns(n.index,t);return new l0(i,i)}else if(n.type&175){let i=t[Qo];return new l0(i,t)}return null}var X2=class{constructor(){}supports(t){return uS(t)}create(t){return new Z2(t)}},Gk=(n,t)=>t,Z2=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(t){this._trackByFn=t||Gk}forEachItem(t){let e;for(e=this._itHead;e!==null;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){let l=!i||e&&e.currentIndex<r4(i,r,o)?e:i,c=r4(l,r,o),f=l.currentIndex;if(l===i)r--,i=i._nextRemoved;else if(e=e._next,l.previousIndex==null)r++;else{o||(o=[]);let p=c-r,g=f-r;if(p!=g){for(let x=0;x<p;x++){let C=x<o.length?o[x]:o[x]=0,A=C+x;g<=A&&A<p&&(o[x]=C+1)}let m=l.previousIndex;o[m]=g-p}}c!==f&&t(l,c,f)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;e!==null;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;e!==null;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;e!==null;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;e!==null;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;e!==null;e=e._nextIdentityChange)t(e)}diff(t){if(t==null&&(t=[]),!uS(t))throw new ot(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._itHead,i=!1,r,o,l;if(Array.isArray(t)){this.length=t.length;for(let c=0;c<this.length;c++)o=t[c],l=this._trackByFn(c,o),e===null||!Object.is(e.trackById,l)?(e=this._mismatch(e,o,l,c),i=!0):(i&&(e=this._verifyReinsertion(e,o,l,c)),Object.is(e.item,o)||this._addIdentityChange(e,o)),e=e._next}else r=0,OR(t,c=>{l=this._trackByFn(r,c),e===null||!Object.is(e.trackById,l)?(e=this._mismatch(e,c,l,r),i=!0):(i&&(e=this._verifyReinsertion(e,c,l,r)),Object.is(e.item,c)||this._addIdentityChange(e,c)),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;t!==null;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;t!==null;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;t!==null;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,r){let o;return t===null?o=this._itTail:(o=t._prev,this._remove(t)),t=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),t!==null?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,o,r)):(t=this._linkedRecords===null?null:this._linkedRecords.get(i,r),t!==null?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,o,r)):t=this._addAfter(new J2(e,i),o,r)),t}_verifyReinsertion(t,e,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?t=this._reinsertAfter(o,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;t!==null;){let e=t._next;this._addToRemovals(this._unlink(t)),t=e}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(t);let r=t._prevRemoved,o=t._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail===null?this._additionsTail=this._additionsHead=t:this._additionsTail=this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){let r=e===null?this._itHead:e._next;return t._next=r,t._prev=e,r===null?this._itTail=t:r._prev=t,e===null?this._itHead=t:e._next=t,this._linkedRecords===null&&(this._linkedRecords=new Wp),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){this._linkedRecords!==null&&this._linkedRecords.remove(t);let e=t._prev,i=t._next;return e===null?this._itHead=i:e._next=i,i===null?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail===null?this._movesTail=this._movesHead=t:this._movesTail=this._movesTail._nextMoved=t),t}_addToRemovals(t){return this._unlinkedRecords===null&&(this._unlinkedRecords=new Wp),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=t:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=t,t}},J2=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(t,e){this.item=t,this.trackById=e}},K2=class{_head=null;_tail=null;add(t){this._head===null?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;i!==null;i=i._nextDup)if((e===null||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){let e=t._prevDup,i=t._nextDup;return e===null?this._head=i:e._nextDup=i,i===null?this._tail=e:i._prevDup=e,this._head===null}},Wp=class{map=new Map;put(t){let e=t.trackById,i=this.map.get(e);i||(i=new K2,this.map.set(e,i)),i.add(t)}get(t,e){let i=t,r=this.map.get(i);return r?r.get(t,e):null}remove(t){let e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function r4(n,t,e){let i=n.previousIndex;if(i===null)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+t+r}function o4(){return new jy([new X2])}var jy=(()=>{class n{factories;static \u0275prov=$e({token:n,providedIn:"root",factory:o4});constructor(e){this.factories=e}static create(e,i){if(i!=null){let r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:i=>n.create(e,i||o4()),deps:[[n,new MI,new SI]]}}find(e){let i=this.factories.find(r=>r.supports(e));if(i!=null)return i;throw new ot(901,!1)}}return n})();function NS(n){let{rootComponent:t,appProviders:e,platformProviders:i,platformRef:r}=n;Fn(8);try{let o=r?.injector??Hk(i),l=[Ik({}),{provide:tc,useExisting:Rk},...e||[]],c=new Hp({providers:l,parent:o,debugName:"",runEnvironmentInitializers:!1});return Uk({r3Injector:c.injector,platformInjector:o,rootComponent:t})}catch(o){return Promise.reject(o)}finally{Fn(9)}}function b0(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function ls(n){return Mv(n)}function yc(n,t){return Cv(n,t?.equal)}var s4=class{[fo];constructor(t){this[fo]=t}destroy(){this[fo].destroy()}};function US(n){let t=wl(n);if(!t)return null;let e=new ic(t);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}$();$();var Si=new it("");var VS=null;function vo(){return VS}function Wy(n){VS??=n}var C0=class{},E0=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:()=>Pe(HS),providedIn:"platform"})}return n})(),Gy=new it(""),HS=(()=>{class n extends E0{_location;_history;_doc=Pe(Si);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return vo().getBaseHref(this._doc)}onPopState(e){let i=vo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){let i=vo().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,i,r){this._history.pushState(e,i,r)}replaceState(e,i,r){this._history.replaceState(e,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function gm(n,t){return n?t?n.endsWith("/")?t.startsWith("/")?n+t.slice(1):n+t:t.startsWith("/")?n+t:`${n}/${t}`:n:t}function LS(n){let t=n.search(/#|\?|$/);return n[t-1]==="/"?n.slice(0,t-1)+n.slice(t):n}function No(n){return n&&n[0]!=="?"?`?${n}`:n}var $s=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:()=>Pe(vm),providedIn:"root"})}return n})(),_m=new it(""),vm=(()=>{class n extends $s{_platformLocation;_baseHref;_removeListenerFns=[];constructor(e,i){super(),this._platformLocation=e,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??Pe(Si).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return gm(this._baseHref,e)}path(e=!1){let i=this._platformLocation.pathname+No(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${i}${r}`:i}pushState(e,i,r,o){let l=this.prepareExternalUrl(r+No(o));this._platformLocation.pushState(e,i,l)}replaceState(e,i,r,o){let l=this.prepareExternalUrl(r+No(o));this._platformLocation.replaceState(e,i,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(i){return new(i||n)(We(E0),We(_m,8))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Ta=(()=>{class n{_subject=new bi;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(e){this._locationStrategy=e;let i=this._locationStrategy.getBaseHref();this._basePath=qk(LS(BS(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+No(i))}normalize(e){return n.stripTrailingSlash(Yk(this._basePath,BS(e)))}prepareExternalUrl(e){return e&&e[0]!=="/"&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,i="",r=null){this._locationStrategy.pushState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+No(i)),r)}replaceState(e,i="",r=null){this._locationStrategy.replaceState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+No(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(r=>r(e,i))}subscribe(e,i,r){return this._subject.subscribe({next:e,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=No;static joinWithSlash=gm;static stripTrailingSlash=LS;static \u0275fac=function(i){return new(i||n)(We($s))};static \u0275prov=$e({token:n,factory:()=>$k(),providedIn:"root"})}return n})();function $k(){return new Ta(We($s))}function Yk(n,t){if(!n||!t.startsWith(n))return t;let e=t.substring(n.length);return e===""||["/",";","?","#"].includes(e[0])?e:t}function BS(n){return n.replace(/\/index.html$/,"")}function qk(n){if(new RegExp("^(https?:)?//").test(n)){let[,e]=n.split(/\/\/[^\/]+/);return e}return n}var Ky=(()=>{class n extends $s{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(e,i){super(),this._platformLocation=e,i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(e){let i=gm(this._baseHref,e);return i.length>0?"#"+i:i}pushState(e,i,r,o){let l=this.prepareExternalUrl(r+No(o))||this._platformLocation.pathname;this._platformLocation.pushState(e,i,l)}replaceState(e,i,r,o){let l=this.prepareExternalUrl(r+No(o))||this._platformLocation.pathname;this._platformLocation.replaceState(e,i,l)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(i){return new(i||n)(We(E0),We(_m,8))};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})(),qS={ADP:[void 0,void 0,0],AFN:[void 0,"\u060B",0],ALL:[void 0,void 0,0],AMD:[void 0,"\u058F",2],AOA:[void 0,"Kz"],ARS:[void 0,"$"],AUD:["A$","$"],AZN:[void 0,"\u20BC"],BAM:[void 0,"KM"],BBD:[void 0,"$"],BDT:[void 0,"\u09F3"],BHD:[void 0,void 0,3],BIF:[void 0,void 0,0],BMD:[void 0,"$"],BND:[void 0,"$"],BOB:[void 0,"Bs"],BRL:["R$"],BSD:[void 0,"$"],BWP:[void 0,"P"],BYN:[void 0,void 0,2],BYR:[void 0,void 0,0],BZD:[void 0,"$"],CAD:["CA$","$",2],CHF:[void 0,void 0,2],CLF:[void 0,void 0,4],CLP:[void 0,"$",0],CNY:["CN\xA5","\xA5"],COP:[void 0,"$",2],CRC:[void 0,"\u20A1",2],CUC:[void 0,"$"],CUP:[void 0,"$"],CZK:[void 0,"K\u010D",2],DJF:[void 0,void 0,0],DKK:[void 0,"kr",2],DOP:[void 0,"$"],EGP:[void 0,"E\xA3"],ESP:[void 0,"\u20A7",0],EUR:["\u20AC"],FJD:[void 0,"$"],FKP:[void 0,"\xA3"],GBP:["\xA3"],GEL:[void 0,"\u20BE"],GHS:[void 0,"GH\u20B5"],GIP:[void 0,"\xA3"],GNF:[void 0,"FG",0],GTQ:[void 0,"Q"],GYD:[void 0,"$",2],HKD:["HK$","$"],HNL:[void 0,"L"],HRK:[void 0,"kn"],HUF:[void 0,"Ft",2],IDR:[void 0,"Rp",2],ILS:["\u20AA"],INR:["\u20B9"],IQD:[void 0,void 0,0],IRR:[void 0,void 0,0],ISK:[void 0,"kr",0],ITL:[void 0,void 0,0],JMD:[void 0,"$"],JOD:[void 0,void 0,3],JPY:["\xA5",void 0,0],KHR:[void 0,"\u17DB"],KMF:[void 0,"CF",0],KPW:[void 0,"\u20A9",0],KRW:["\u20A9",void 0,0],KWD:[void 0,void 0,3],KYD:[void 0,"$"],KZT:[void 0,"\u20B8"],LAK:[void 0,"\u20AD",0],LBP:[void 0,"L\xA3",0],LKR:[void 0,"Rs"],LRD:[void 0,"$"],LTL:[void 0,"Lt"],LUF:[void 0,void 0,0],LVL:[void 0,"Ls"],LYD:[void 0,void 0,3],MGA:[void 0,"Ar",0],MGF:[void 0,void 0,0],MMK:[void 0,"K",0],MNT:[void 0,"\u20AE",2],MRO:[void 0,void 0,0],MUR:[void 0,"Rs",2],MXN:["MX$","$"],MYR:[void 0,"RM"],NAD:[void 0,"$"],NGN:[void 0,"\u20A6"],NIO:[void 0,"C$"],NOK:[void 0,"kr",2],NPR:[void 0,"Rs"],NZD:["NZ$","$"],OMR:[void 0,void 0,3],PHP:["\u20B1"],PKR:[void 0,"Rs",2],PLN:[void 0,"z\u0142"],PYG:[void 0,"\u20B2",0],RON:[void 0,"lei"],RSD:[void 0,void 0,0],RUB:[void 0,"\u20BD"],RWF:[void 0,"RF",0],SBD:[void 0,"$"],SEK:[void 0,"kr",2],SGD:[void 0,"$"],SHP:[void 0,"\xA3"],SLE:[void 0,void 0,2],SLL:[void 0,void 0,0],SOS:[void 0,void 0,0],SRD:[void 0,"$"],SSP:[void 0,"\xA3"],STD:[void 0,void 0,0],STN:[void 0,"Db"],SYP:[void 0,"\xA3",0],THB:[void 0,"\u0E3F"],TMM:[void 0,void 0,0],TND:[void 0,void 0,3],TOP:[void 0,"T$"],TRL:[void 0,void 0,0],TRY:[void 0,"\u20BA"],TTD:[void 0,"$"],TWD:["NT$","$",2],TZS:[void 0,void 0,2],UAH:[void 0,"\u20B4"],UGX:[void 0,void 0,0],USD:["$"],UYI:[void 0,void 0,0],UYU:[void 0,"$"],UYW:[void 0,void 0,4],UZS:[void 0,void 0,2],VEF:[void 0,"Bs",2],VND:["\u20AB",void 0,0],VUV:[void 0,void 0,0],XAF:["FCFA",void 0,0],XCD:["EC$","$"],XOF:["F\u202FCFA",void 0,0],XPF:["CFPF",void 0,0],XXX:["\xA4"],YER:[void 0,void 0,0],ZAR:[void 0,"R"],ZMK:[void 0,void 0,0],ZMW:[void 0,"ZK"],ZWD:[void 0,void 0,0]},Tm=function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n}(Tm||{});var er=function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n}(er||{}),kn=function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n}(kn||{}),kr=function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n}(kr||{}),Gi={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function XS(n){return Fr(n)[ai.LocaleId]}function ZS(n,t,e){let i=Fr(n),r=[i[ai.DayPeriodsFormat],i[ai.DayPeriodsStandalone]],o=yo(r,t);return yo(o,e)}function JS(n,t,e){let i=Fr(n),r=[i[ai.DaysFormat],i[ai.DaysStandalone]],o=yo(r,t);return yo(o,e)}function KS(n,t,e){let i=Fr(n),r=[i[ai.MonthsFormat],i[ai.MonthsStandalone]],o=yo(r,t);return yo(o,e)}function QS(n,t){let i=Fr(n)[ai.Eras];return yo(i,t)}function w0(n,t){let e=Fr(n);return yo(e[ai.DateFormat],t)}function S0(n,t){let e=Fr(n);return yo(e[ai.TimeFormat],t)}function M0(n,t){let i=Fr(n)[ai.DateTimeFormat];return yo(i,t)}function Lo(n,t){let e=Fr(n),i=e[ai.NumberSymbols][t];if(typeof i>"u"){if(t===Gi.CurrencyDecimal)return e[ai.NumberSymbols][Gi.Decimal];if(t===Gi.CurrencyGroup)return e[ai.NumberSymbols][Gi.Group]}return i}function Qy(n,t){return Fr(n)[ai.NumberFormats][t]}function Zk(n){return Fr(n)[ai.Currencies]}function eM(n){if(!n[ai.ExtraData])throw new Error(`Missing extra locale data for the locale "${n[ai.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function tM(n){let t=Fr(n);return eM(t),(t[ai.ExtraData][2]||[]).map(i=>typeof i=="string"?$y(i):[$y(i[0]),$y(i[1])])}function nM(n,t,e){let i=Fr(n);eM(i);let r=[i[ai.ExtraData][0],i[ai.ExtraData][1]],o=yo(r,t)||[];return yo(o,e)||[]}function yo(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new Error("Locale data API: locale data undefined")}function $y(n){let[t,e]=n.split(":");return{hours:+t,minutes:+e}}function iM(n,t,e="en"){let i=Zk(e)[n]||qS[n]||[],r=i[1];return t==="narrow"&&typeof r=="string"?r:i[0]||n}var Jk=2;function rM(n){let t,e=qS[n];return e&&(t=e[2]),typeof t=="number"?t:Jk}var Kk=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ym={},Qk=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function oM(n,t,e,i){let r=l7(n);t=Ys(e,t)||t;let l=[],c;for(;t;)if(c=Qk.exec(t),c){l=l.concat(c.slice(1));let g=l.pop();if(!g)break;t=g}else{l.push(t);break}let f=r.getTimezoneOffset();i&&(f=aM(i,f),r=a7(r,i));let p="";return l.forEach(g=>{let m=o7(g);p+=m?m(r,e,f):g==="''"?"'":g.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),p}function wm(n,t,e){let i=new Date(0);return i.setFullYear(n,t,e),i.setHours(0,0,0),i}function Ys(n,t){let e=XS(n);if(ym[e]??={},ym[e][t])return ym[e][t];let i="";switch(t){case"shortDate":i=w0(n,kr.Short);break;case"mediumDate":i=w0(n,kr.Medium);break;case"longDate":i=w0(n,kr.Long);break;case"fullDate":i=w0(n,kr.Full);break;case"shortTime":i=S0(n,kr.Short);break;case"mediumTime":i=S0(n,kr.Medium);break;case"longTime":i=S0(n,kr.Long);break;case"fullTime":i=S0(n,kr.Full);break;case"short":let r=Ys(n,"shortTime"),o=Ys(n,"shortDate");i=xm(M0(n,kr.Short),[r,o]);break;case"medium":let l=Ys(n,"mediumTime"),c=Ys(n,"mediumDate");i=xm(M0(n,kr.Medium),[l,c]);break;case"long":let f=Ys(n,"longTime"),p=Ys(n,"longDate");i=xm(M0(n,kr.Long),[f,p]);break;case"full":let g=Ys(n,"fullTime"),m=Ys(n,"fullDate");i=xm(M0(n,kr.Full),[g,m]);break}return i&&(ym[e][t]=i),i}function xm(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,i){return t!=null&&i in t?t[i]:e})),n}function Uo(n,t,e="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=e));let l=String(n);for(;l.length<t;)l="0"+l;return i&&(l=l.slice(l.length-t)),o+l}function e7(n,t){return Uo(n,3).substring(0,t)}function Mi(n,t,e=0,i=!1,r=!1){return function(o,l){let c=t7(n,o);if((e>0||c>-e)&&(c+=e),n===3)c===0&&e===-12&&(c=12);else if(n===6)return e7(c,t);let f=Lo(l,Gi.MinusSign);return Uo(c,t,f,i,r)}}function t7(n,t){switch(n){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();case 3:return t.getHours();case 4:return t.getMinutes();case 5:return t.getSeconds();case 6:return t.getMilliseconds();case 7:return t.getDay();default:throw new Error(`Unknown DateType value "${n}".`)}}function $n(n,t,e=er.Format,i=!1){return function(r,o){return n7(r,o,n,t,e,i)}}function n7(n,t,e,i,r,o){switch(e){case 2:return KS(t,r,i)[n.getMonth()];case 1:return JS(t,r,i)[n.getDay()];case 0:let l=n.getHours(),c=n.getMinutes();if(o){let p=tM(t),g=nM(t,r,i),m=p.findIndex(x=>{if(Array.isArray(x)){let[C,A]=x,O=l>=C.hours&&c>=C.minutes,T=l<A.hours||l===A.hours&&c<A.minutes;if(C.hours<A.hours){if(O&&T)return!0}else if(O||T)return!0}else if(x.hours===l&&x.minutes===c)return!0;return!1});if(m!==-1)return g[m]}return ZS(t,r,i)[l<12?0:1];case 3:return QS(t,i)[n.getFullYear()<=0?0:1];default:let f=e;throw new Error(`unexpected translation type ${f}`)}}function bm(n){return function(t,e,i){let r=-1*i,o=Lo(e,Gi.MinusSign),l=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+Uo(l,2,o)+Uo(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+Uo(l,1,o);case 2:return"GMT"+(r>=0?"+":"")+Uo(l,2,o)+":"+Uo(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+Uo(l,2,o)+":"+Uo(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${n}"`)}}}var i7=0,Em=4;function r7(n){let t=wm(n,i7,1).getDay();return wm(n,0,1+(t<=Em?Em:Em+7)-t)}function sM(n){let t=n.getDay(),e=t===0?-3:Em-t;return wm(n.getFullYear(),n.getMonth(),n.getDate()+e)}function Yy(n,t=!1){return function(e,i){let r;if(t){let o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,l=e.getDate();r=1+Math.floor((l+o)/7)}else{let o=sM(e),l=r7(o.getFullYear()),c=o.getTime()-l.getTime();r=1+Math.round(c/6048e5)}return Uo(r,n,Lo(i,Gi.MinusSign))}}function Cm(n,t=!1){return function(e,i){let o=sM(e).getFullYear();return Uo(o,n,Lo(i,Gi.MinusSign),t)}}var qy={};function o7(n){if(qy[n])return qy[n];let t;switch(n){case"G":case"GG":case"GGG":t=$n(3,kn.Abbreviated);break;case"GGGG":t=$n(3,kn.Wide);break;case"GGGGG":t=$n(3,kn.Narrow);break;case"y":t=Mi(0,1,0,!1,!0);break;case"yy":t=Mi(0,2,0,!0,!0);break;case"yyy":t=Mi(0,3,0,!1,!0);break;case"yyyy":t=Mi(0,4,0,!1,!0);break;case"Y":t=Cm(1);break;case"YY":t=Cm(2,!0);break;case"YYY":t=Cm(3);break;case"YYYY":t=Cm(4);break;case"M":case"L":t=Mi(1,1,1);break;case"MM":case"LL":t=Mi(1,2,1);break;case"MMM":t=$n(2,kn.Abbreviated);break;case"MMMM":t=$n(2,kn.Wide);break;case"MMMMM":t=$n(2,kn.Narrow);break;case"LLL":t=$n(2,kn.Abbreviated,er.Standalone);break;case"LLLL":t=$n(2,kn.Wide,er.Standalone);break;case"LLLLL":t=$n(2,kn.Narrow,er.Standalone);break;case"w":t=Yy(1);break;case"ww":t=Yy(2);break;case"W":t=Yy(1,!0);break;case"d":t=Mi(2,1);break;case"dd":t=Mi(2,2);break;case"c":case"cc":t=Mi(7,1);break;case"ccc":t=$n(1,kn.Abbreviated,er.Standalone);break;case"cccc":t=$n(1,kn.Wide,er.Standalone);break;case"ccccc":t=$n(1,kn.Narrow,er.Standalone);break;case"cccccc":t=$n(1,kn.Short,er.Standalone);break;case"E":case"EE":case"EEE":t=$n(1,kn.Abbreviated);break;case"EEEE":t=$n(1,kn.Wide);break;case"EEEEE":t=$n(1,kn.Narrow);break;case"EEEEEE":t=$n(1,kn.Short);break;case"a":case"aa":case"aaa":t=$n(0,kn.Abbreviated);break;case"aaaa":t=$n(0,kn.Wide);break;case"aaaaa":t=$n(0,kn.Narrow);break;case"b":case"bb":case"bbb":t=$n(0,kn.Abbreviated,er.Standalone,!0);break;case"bbbb":t=$n(0,kn.Wide,er.Standalone,!0);break;case"bbbbb":t=$n(0,kn.Narrow,er.Standalone,!0);break;case"B":case"BB":case"BBB":t=$n(0,kn.Abbreviated,er.Format,!0);break;case"BBBB":t=$n(0,kn.Wide,er.Format,!0);break;case"BBBBB":t=$n(0,kn.Narrow,er.Format,!0);break;case"h":t=Mi(3,1,-12);break;case"hh":t=Mi(3,2,-12);break;case"H":t=Mi(3,1);break;case"HH":t=Mi(3,2);break;case"m":t=Mi(4,1);break;case"mm":t=Mi(4,2);break;case"s":t=Mi(5,1);break;case"ss":t=Mi(5,2);break;case"S":t=Mi(6,1);break;case"SS":t=Mi(6,2);break;case"SSS":t=Mi(6,3);break;case"Z":case"ZZ":case"ZZZ":t=bm(0);break;case"ZZZZZ":t=bm(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=bm(1);break;case"OOOO":case"ZZZZ":case"zzzz":t=bm(2);break;default:return null}return qy[n]=t,t}function aM(n,t){n=n.replace(/:/g,"");let e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function s7(n,t){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+t),n}function a7(n,t,e){let r=n.getTimezoneOffset(),o=aM(t,r);return s7(n,-1*(o-r))}function l7(n){if(zS(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,l=1]=n.split("-").map(c=>+c);return wm(r,o-1,l)}let e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let i;if(i=n.match(Kk))return u7(i)}let t=new Date(n);if(!zS(t))throw new Error(`Unable to convert "${n}" into a date`);return t}function u7(n){let t=new Date(0),e=0,i=0,r=n[8]?t.setUTCFullYear:t.setFullYear,o=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));let l=Number(n[4]||0)-e,c=Number(n[5]||0)-i,f=Number(n[6]||0),p=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(t,l,c,f,p),t}function zS(n){return n instanceof Date&&!isNaN(n.valueOf())}var c7=/^(\d+)?\.((\d+)(-(\d+))?)?$/,jS=22,Sm=".",A0="0",d7=";",f7=",",Xy="#",WS="\xA4";function lM(n,t,e,i,r,o,l=!1){let c="",f=!1;if(!isFinite(n))c=Lo(e,Gi.Infinity);else{let p=p7(n);l&&(p=h7(p));let g=t.minInt,m=t.minFrac,x=t.maxFrac;if(o){let G=o.match(c7);if(G===null)throw new Error(`${o} is not a valid digit info`);let Y=G[1],q=G[3],X=G[5];Y!=null&&(g=Zy(Y)),q!=null&&(m=Zy(q)),X!=null?x=Zy(X):q!=null&&m>x&&(x=m)}m7(p,m,x);let C=p.digits,A=p.integerLen,O=p.exponent,T=[];for(f=C.every(G=>!G);A<g;A++)C.unshift(0);for(;A<0;A++)C.unshift(0);A>0?T=C.splice(A,C.length):(T=C,C=[0]);let M=[];for(C.length>=t.lgSize&&M.unshift(C.splice(-t.lgSize,C.length).join(""));C.length>t.gSize;)M.unshift(C.splice(-t.gSize,C.length).join(""));C.length&&M.unshift(C.join("")),c=M.join(Lo(e,i)),T.length&&(c+=Lo(e,r)+T.join("")),O&&(c+=Lo(e,Gi.Exponential)+"+"+O)}return n<0&&!f?c=t.negPre+c+t.negSuf:c=t.posPre+c+t.posSuf,c}function uM(n,t,e,i,r){let o=Qy(t,Tm.Currency),l=dM(o,Lo(t,Gi.MinusSign));return l.minFrac=rM(i),l.maxFrac=l.minFrac,lM(n,l,t,Gi.CurrencyGroup,Gi.CurrencyDecimal,r).replace(WS,e).replace(WS,"").trim()}function cM(n,t,e){let i=Qy(t,Tm.Decimal),r=dM(i,Lo(t,Gi.MinusSign));return lM(n,r,t,Gi.Group,Gi.Decimal,e)}function dM(n,t="-"){let e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(d7),r=i[0],o=i[1],l=r.indexOf(Sm)!==-1?r.split(Sm):[r.substring(0,r.lastIndexOf(A0)+1),r.substring(r.lastIndexOf(A0)+1)],c=l[0],f=l[1]||"";e.posPre=c.substring(0,c.indexOf(Xy));for(let g=0;g<f.length;g++){let m=f.charAt(g);m===A0?e.minFrac=e.maxFrac=g+1:m===Xy?e.maxFrac=g+1:e.posSuf+=m}let p=c.split(f7);if(e.gSize=p[1]?p[1].length:0,e.lgSize=p[2]||p[1]?(p[2]||p[1]).length:0,o){let g=r.length-e.posPre.length-e.posSuf.length,m=o.indexOf(Xy);e.negPre=o.substring(0,m).replace(/'/g,""),e.negSuf=o.slice(m+g).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}function h7(n){if(n.digits[0]===0)return n;let t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(t===0?n.digits.push(0,0):t===1&&n.digits.push(0),n.integerLen+=2),n}function p7(n){let t=Math.abs(n)+"",e=0,i,r,o,l,c;for((r=t.indexOf(Sm))>-1&&(t=t.replace(Sm,"")),(o=t.search(/e/i))>0?(r<0&&(r=o),r+=+t.slice(o+1),t=t.substring(0,o)):r<0&&(r=t.length),o=0;t.charAt(o)===A0;o++);if(o===(c=t.length))i=[0],r=1;else{for(c--;t.charAt(c)===A0;)c--;for(r-=o,i=[],l=0;o<=c;o++,l++)i[l]=Number(t.charAt(o))}return r>jS&&(i=i.splice(0,jS-1),e=r-1,r=1),{digits:i,exponent:e,integerLen:r}}function m7(n,t,e){if(t>e)throw new Error(`The minimum number of digits after fraction (${t}) is higher than the maximum (${e}).`);let i=n.digits,r=i.length-n.integerLen,o=Math.min(Math.max(t,r),e),l=o+n.integerLen,c=i[l];if(l>0){i.splice(Math.max(n.integerLen,l));for(let m=l;m<i.length;m++)i[m]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,l=o+1),i[0]=0;for(let m=1;m<l;m++)i[m]=0}if(c>=5)if(l-1<0){for(let m=0;m>l;m--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[l-1]++;for(;r<Math.max(0,o);r++)i.push(0);let f=o!==0,p=t+n.integerLen,g=i.reduceRight(function(m,x,C,A){return x=x+m,A[C]=x<10?x:x-10,f&&(A[C]===0&&C>=p?A.pop():f=!1),x>=10?1:0},0);g&&(i.unshift(g),n.integerLen++)}function Zy(n){let t=parseInt(n);if(isNaN(t))throw new Error("Invalid integer literal when parsing "+n);return t}var Jy=/\s+/,GS=[],Bo=(()=>{class n{_ngEl;_renderer;initialClasses=GS;rawClass;stateMap=new Map;constructor(e,i){this._ngEl=e,this._renderer=i}set klass(e){this.initialClasses=e!=null?e.trim().split(Jy):GS}set ngClass(e){this.rawClass=typeof e=="string"?e.trim().split(Jy):e}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(let i of e)this._updateState(i,!0);else if(e!=null)for(let i of Object.keys(e))this._updateState(i,!!e[i]);this._applyStateDiff()}_updateState(e,i){let r=this.stateMap.get(e);r!==void 0?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let e of this.stateMap){let i=e[0],r=e[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(e,i){e=e.trim(),e.length>0&&e.split(Jy).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||n)(Ne($r),Ne(Gs))};static \u0275dir=Rn({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var Mm=class{$implicit;ngForOf;index;count;constructor(t,e,i,r){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},Nn=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){let e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){let i=this._viewContainer;e.forEachOperation((r,o,l)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new Mm(r.item,this._ngForOf,-1,-1),l===null?void 0:l);else if(l==null)i.remove(o===null?void 0:o);else if(o!==null){let c=i.get(o);i.move(c,l),$S(c,r)}});for(let r=0,o=i.length;r<o;r++){let c=i.get(r).context;c.index=r,c.count=o,c.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);$S(o,r)})}static ngTemplateContextGuard(e,i){return!0}static \u0275fac=function(i){return new(i||n)(Ne(Sa),Ne(Pl),Ne(jy))};static \u0275dir=Rn({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function $S(n,t){n.context.$implicit=t.item}var An=(()=>{class n{_viewContainer;_context=new Am;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(e,i){this._viewContainer=e,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){YS(e,!1),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){YS(e,!1),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(e,i){return!0}static \u0275fac=function(i){return new(i||n)(Ne(Sa),Ne(Pl))};static \u0275dir=Rn({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),Am=class{$implicit=null;ngIf=null};function YS(n,t){if(n&&!n.createEmbeddedView)throw new ot(2020,!1)}function ex(n,t){return new ot(2100,!1)}var g7="mediumDate",fM=new it(""),hM=new it(""),qr=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(e,i,r){this.locale=e,this.defaultTimezone=i,this.defaultOptions=r}transform(e,i,r,o){if(e==null||e===""||e!==e)return null;try{let l=i??this.defaultOptions?.dateFormat??g7,c=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return oM(e,l,o||this.locale,c)}catch(l){throw ex(n,l.message)}}static \u0275fac=function(i){return new(i||n)(Ne(vc,16),Ne(fM,24),Ne(hM,24))};static \u0275pipe=hm({name:"date",type:n,pure:!0})}return n})();var T0=(()=>{class n{_locale;constructor(e){this._locale=e}transform(e,i,r){if(!pM(e))return null;r||=this._locale;try{let o=mM(e);return cM(o,r,i)}catch(o){throw ex(n,o.message)}}static \u0275fac=function(i){return new(i||n)(Ne(vc,16))};static \u0275pipe=hm({name:"number",type:n,pure:!0})}return n})();var D0=(()=>{class n{_locale;_defaultCurrencyCode;constructor(e,i="USD"){this._locale=e,this._defaultCurrencyCode=i}transform(e,i=this._defaultCurrencyCode,r="symbol",o,l){if(!pM(e))return null;l||=this._locale,typeof r=="boolean"&&(r=r?"symbol":"code");let c=i||this._defaultCurrencyCode;r!=="code"&&(r==="symbol"||r==="symbol-narrow"?c=iM(c,r==="symbol"?"wide":"narrow",l):c=r);try{let f=mM(e);return uM(f,l,c,i,o)}catch(f){throw ex(n,f.message)}}static \u0275fac=function(i){return new(i||n)(Ne(vc,16),Ne(kS,16))};static \u0275pipe=hm({name:"currency",type:n,pure:!0})}return n})();function pM(n){return!(n==null||n===""||n!==n)}function mM(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new Error(`${n} is not a number`);return n}var hn=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=_o({type:n});static \u0275inj=mo({})}return n})();$();function P0(n,t){t=encodeURIComponent(t);for(let e of n.split(";")){let i=e.indexOf("="),[r,o]=i==-1?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(o)}return null}var tx="browser",gM="server";function Dm(n){return n===gM}var Vl=class{};var _M=(()=>{class n{static \u0275prov=$e({token:n,providedIn:"root",factory:()=>new nx(Pe(Si),window)})}return n})(),nx=class{document;window;offset=()=>[0,0];constructor(t,e){this.document=t,this.window=e}setOffset(t){Array.isArray(t)?this.offset=()=>t:this.offset=t}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(t){this.window.scrollTo(t[0],t[1])}scrollToAnchor(t){let e=v7(this.document,t);e&&(this.scrollToElement(e),e.focus())}setHistoryScrollRestoration(t){this.window.history.scrollRestoration=t}scrollToElement(t){let e=t.getBoundingClientRect(),i=e.left+this.window.pageXOffset,r=e.top+this.window.pageYOffset,o=this.offset();this.window.scrollTo(i-o[0],r-o[1])}};function v7(n,t){let e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),r=i.currentNode;for(;r;){let o=r.shadowRoot;if(o){let l=o.getElementById(t)||o.querySelector(`[name="${t}"]`);if(l)return l}r=i.nextNode()}}return null}$();var Om=new it(""),sx=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,i){this._zone=i,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,r,o){return this._findPluginFor(i).addEventListener(e,i,r,o)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(o=>o.supports(e)),!i)throw new ot(5101,!1);return this._eventNameToPlugin.set(e,i),i}static \u0275fac=function(i){return new(i||n)(We(Om),We(si))};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})(),I0=class{_doc;constructor(t){this._doc=t}manager},Pm="ng-app-id";function vM(n){for(let t of n)t.remove()}function yM(n,t){let e=t.createElement("style");return e.textContent=n,e}function y7(n,t,e,i){let r=n.head?.querySelectorAll(`style[${Pm}="${t}"],link[${Pm}="${t}"]`);if(r)for(let o of r)o.removeAttribute(Pm),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&e.set(o.textContent,{usage:0,elements:[o]})}function rx(n,t){let e=t.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",n),e}var ax=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;isServer;constructor(e,i,r,o={}){this.doc=e,this.appId=i,this.nonce=r,this.isServer=Dm(o),y7(e,i,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,i){for(let r of e)this.addUsage(r,this.inline,yM);i?.forEach(r=>this.addUsage(r,this.external,rx))}removeStyles(e,i){for(let r of e)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(e,i,r){let o=i.get(e);o?o.usage++:i.set(e,{usage:1,elements:[...this.hosts].map(l=>this.addElement(l,r(e,this.doc)))})}removeUsage(e,i){let r=i.get(e);r&&(r.usage--,r.usage<=0&&(vM(r.elements),i.delete(e)))}ngOnDestroy(){for(let[,{elements:e}]of[...this.inline,...this.external])vM(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(e,yM(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(e,rx(i,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,i){return this.nonce&&i.setAttribute("nonce",this.nonce),this.isServer&&i.setAttribute(Pm,this.appId),e.appendChild(i)}static \u0275fac=function(i){return new(i||n)(We(Si),We(_y),We(yy,8),We(hc))};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})(),ix={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},lx=/%COMP%/g;var bM="%COMP%",x7=`_nghost-${bM}`,b7=`_ngcontent-${bM}`,C7=!0,E7=new it("",{providedIn:"root",factory:()=>C7});function w7(n){return b7.replace(lx,n)}function S7(n){return x7.replace(lx,n)}function CM(n,t){return t.map(e=>e.replace(lx,n))}var ux=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(e,i,r,o,l,c,f,p=null,g=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=l,this.platformId=c,this.ngZone=f,this.nonce=p,this.tracingService=g,this.platformIsServer=Dm(c),this.defaultRenderer=new O0(e,l,f,this.platformIsServer,this.tracingService)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===rs.ShadowDom&&(i=St(Oe({},i),{encapsulation:rs.Emulated}));let r=this.getOrCreateRenderer(e,i);return r instanceof Im?r.applyToHost(e):r instanceof F0&&r.applyStyles(),r}getOrCreateRenderer(e,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let l=this.doc,c=this.ngZone,f=this.eventManager,p=this.sharedStylesHost,g=this.removeStylesOnCompDestroy,m=this.platformIsServer,x=this.tracingService;switch(i.encapsulation){case rs.Emulated:o=new Im(f,p,i,this.appId,g,l,c,m,x);break;case rs.ShadowDom:return new ox(f,p,e,i,l,c,this.nonce,m,x);default:o=new F0(f,p,i,g,l,c,m,x);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(i){return new(i||n)(We(sx),We(ax),We(_y),We(E7),We(Si),We(hc),We(si),We(yy),We(pc,8))};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})(),O0=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,e,i,r,o){this.eventManager=t,this.doc=e,this.ngZone=i,this.platformIsServer=r,this.tracingService=o}destroy(){}destroyNode=null;createElement(t,e){return e?this.doc.createElementNS(ix[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(xM(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(xM(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){e.remove()}selectRootElement(t,e){let i=typeof t=="string"?this.doc.querySelector(t):t;if(!i)throw new ot(-5104,!1);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;let o=ix[r];o?t.setAttributeNS(o,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){let r=ix[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(Bs.DashCase|Bs.Important)?t.style.setProperty(e,i,r&Bs.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&Bs.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t!=null&&(t[e]=i)}setValue(t,e){t.nodeValue=e}listen(t,e,i,r){if(typeof t=="string"&&(t=vo().getGlobalEventTarget(this.doc,t),!t))throw new ot(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(t,e,o)),this.eventManager.addEventListener(t,e,o,r)}decoratePreventDefault(t){return e=>{if(e==="__ngUnwrap__")return t;(this.platformIsServer?this.ngZone.runGuarded(()=>t(e)):t(e))===!1&&e.preventDefault()}}};function xM(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var ox=class extends O0{sharedStylesHost;hostEl;shadowRoot;constructor(t,e,i,r,o,l,c,f,p){super(t,o,l,f,p),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let g=r.styles;g=CM(r.id,g);for(let x of g){let C=document.createElement("style");c&&C.setAttribute("nonce",c),C.textContent=x,this.shadowRoot.appendChild(C)}let m=r.getExternalStyles?.();if(m)for(let x of m){let C=rx(x,o);c&&C.setAttribute("nonce",c),this.shadowRoot.appendChild(C)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(null,e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},F0=class extends O0{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,e,i,r,o,l,c,f,p){super(t,o,l,c,f),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r;let g=i.styles;this.styles=p?CM(p,g):g,this.styleUrls=i.getExternalStyles?.(p)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},Im=class extends F0{contentAttr;hostAttr;constructor(t,e,i,r,o,l,c,f,p){let g=r+"-"+i.id;super(t,e,i,o,l,c,f,p,g),this.contentAttr=w7(g),this.hostAttr=S7(g)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){let i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}};var Fm=class n extends C0{supportsDOMEvents=!0;static makeCurrent(){Wy(new n)}onAndCancel(t,e,i,r){return t.addEventListener(e,i,r),()=>{t.removeEventListener(e,i,r)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.remove()}createElement(t,e){return e=e||this.getDefaultDocument(),e.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return e==="window"?window:e==="document"?t:e==="body"?t.body:null}getBaseHref(t){let e=M7();return e==null?null:A7(e)}resetBaseElement(){R0=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return P0(document.cookie,t)}},R0=null;function M7(){return R0=R0||document.head.querySelector("base"),R0?R0.getAttribute("href"):null}function A7(n){return new URL(n,document.baseURI).pathname}var T7=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})(),wM=(()=>{class n extends I0{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r,o){return e.addEventListener(i,r,o),()=>this.removeEventListener(e,i,r,o)}removeEventListener(e,i,r,o){return e.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(We(Si))};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})(),EM=["alt","control","meta","shift"],D7={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},P7={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},SM=(()=>{class n extends I0{constructor(e){super(e)}supports(e){return n.parseEventName(e)!=null}addEventListener(e,i,r,o){let l=n.parseEventName(i),c=n.eventCallback(l.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>vo().onAndCancel(e,l.domEventName,c,o))}static parseEventName(e){let i=e.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),l="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),l="code."),EM.forEach(p=>{let g=i.indexOf(p);g>-1&&(i.splice(g,1),l+=p+".")}),l+=o,i.length!=0||o.length===0)return null;let f={};return f.domEventName=r,f.fullKey=l,f}static matchEventFullKeyCode(e,i){let r=D7[e.key]||e.key,o="";return i.indexOf("code.")>-1&&(r=e.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),EM.forEach(l=>{if(l!==r){let c=P7[l];c(e)&&(o+=l+".")}}),o+=r,o===i)}static eventCallback(e,i,r){return o=>{n.matchEventFullKeyCode(o,e)&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return e==="esc"?"escape":e}static \u0275fac=function(i){return new(i||n)(We(Si))};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})();function cx(n,t,e){return NS(Oe({rootComponent:n,platformRef:e?.platformRef},I7(t)))}function I7(n){return{appProviders:[...N7,...n?.providers??[]],platformProviders:k7}}function O7(){Fm.makeCurrent()}function F7(){return new is}function R7(){return Ew(document),document}var k7=[{provide:hc,useValue:tx},{provide:vy,useValue:O7,multi:!0},{provide:Si,useFactory:R7}];var N7=[{provide:qp,useValue:"root"},{provide:is,useFactory:F7},{provide:Om,useClass:wM,multi:!0,deps:[Si]},{provide:Om,useClass:SM,multi:!0,deps:[Si]},ux,ax,sx,{provide:nc,useExisting:ux},{provide:Vl,useClass:T7},[]];$();$();var bc=class{},k0=class{},Xr=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(t){t?typeof t=="string"?this.lazyInit=()=>{this.headers=new Map,t.split(`
`).forEach(e=>{let i=e.indexOf(":");if(i>0){let r=e.slice(0,i),o=e.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,i)=>{this.addHeaderEntry(i,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,i])=>{this.setHeaderEntries(e,i)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();let e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){let e=new n;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){let e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(t.name,e);let r=(t.op==="a"?this.headers.get(e):void 0)||[];r.push(...i),this.headers.set(e,r);break;case"d":let o=t.value;if(!o)this.headers.delete(e),this.normalizedNames.delete(e);else{let l=this.headers.get(e);if(!l)return;l=l.filter(c=>o.indexOf(c)===-1),l.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,l)}break}}addHeaderEntry(t,e){let i=t.toLowerCase();this.maybeSetNormalizedName(t,i),this.headers.has(i)?this.headers.get(i).push(e):this.headers.set(i,[e])}setHeaderEntries(t,e){let i=(Array.isArray(e)?e:[e]).map(o=>o.toString()),r=t.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(t,r)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}};var km=class{encodeKey(t){return MM(t)}encodeValue(t){return MM(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}};function U7(n,t){let e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{let o=r.indexOf("="),[l,c]=o==-1?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,o)),t.decodeValue(r.slice(o+1))],f=e.get(l)||[];f.push(c),e.set(l,f)}),e}var L7=/%(\d[a-f0-9])/gi,B7={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function MM(n){return encodeURIComponent(n).replace(L7,(t,e)=>B7[e]??t)}function Rm(n){return`${n}`}var Qn=class n{map;encoder;updates=null;cloneFrom=null;constructor(t={}){if(this.encoder=t.encoder||new km,t.fromString){if(t.fromObject)throw new ot(2805,!1);this.map=U7(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{let i=t.fromObject[e],r=Array.isArray(i)?i.map(Rm):[Rm(i)];this.map.set(e,r)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();let e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){let e=[];return Object.keys(t).forEach(i=>{let r=t[i];Array.isArray(r)?r.forEach(o=>{e.push({param:i,value:o,op:"a"})}):e.push({param:i,value:r,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{let e=this.encoder.encodeKey(t);return this.map.get(t).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>t!=="").join("&")}clone(t){let e=new n({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":let e=(t.op==="a"?this.map.get(t.param):void 0)||[];e.push(Rm(t.value)),this.map.set(t.param,e);break;case"d":if(t.value!==void 0){let i=this.map.get(t.param)||[],r=i.indexOf(Rm(t.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}else{this.map.delete(t.param);break}}}),this.cloneFrom=this.updates=null)}};var Nm=class{map=new Map;set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}};function V7(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function AM(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function TM(n){return typeof Blob<"u"&&n instanceof Blob}function DM(n){return typeof FormData<"u"&&n instanceof FormData}function H7(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var PM="Content-Type",IM="Accept",FM="X-Request-URL",RM="text/plain",kM="application/json",z7=`${kM}, ${RM}, */*`,xc=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;responseType="json";method;params;urlWithParams;transferCache;constructor(t,e,i,r){this.url=e,this.method=t.toUpperCase();let o;if(V7(this.method)||r?(this.body=i!==void 0?i:null,o=r):o=i,o&&(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),this.transferCache=o.transferCache),this.headers??=new Xr,this.context??=new Nm,!this.params)this.params=new Qn,this.urlWithParams=e;else{let l=this.params.toString();if(l.length===0)this.urlWithParams=e;else{let c=e.indexOf("?"),f=c===-1?"?":c<e.length-1?"&":"";this.urlWithParams=e+f+l}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||AM(this.body)||TM(this.body)||DM(this.body)||H7(this.body)?this.body:this.body instanceof Qn?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||DM(this.body)?null:TM(this.body)?this.body.type||null:AM(this.body)?null:typeof this.body=="string"?RM:this.body instanceof Qn?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?kM:null}clone(t={}){let e=t.method||this.method,i=t.url||this.url,r=t.responseType||this.responseType,o=t.transferCache??this.transferCache,l=t.body!==void 0?t.body:this.body,c=t.withCredentials??this.withCredentials,f=t.reportProgress??this.reportProgress,p=t.headers||this.headers,g=t.params||this.params,m=t.context??this.context;return t.setHeaders!==void 0&&(p=Object.keys(t.setHeaders).reduce((x,C)=>x.set(C,t.setHeaders[C]),p)),t.setParams&&(g=Object.keys(t.setParams).reduce((x,C)=>x.set(C,t.setParams[C]),g)),new n(e,i,l,{params:g,headers:p,context:m,reportProgress:f,responseType:r,withCredentials:c,transferCache:o})}},Hl=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Hl||{}),Cc=class{headers;status;statusText;url;ok;type;constructor(t,e=200,i="OK"){this.headers=t.headers||new Xr,this.status=t.status!==void 0?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.ok=this.status>=200&&this.status<300}},Um=class n extends Cc{constructor(t={}){super(t)}type=Hl.ResponseHeader;clone(t={}){return new n({headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}},N0=class n extends Cc{body;constructor(t={}){super(t),this.body=t.body!==void 0?t.body:null}type=Hl.Response;clone(t={}){return new n({body:t.body!==void 0?t.body:this.body,headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}},U0=class extends Cc{name="HttpErrorResponse";message;error;ok=!1;constructor(t){super(t,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${t.url||"(unknown url)"}`:this.message=`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}},j7=200,W7=204;function dx(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,transferCache:n.transferCache}}var pn=(()=>{class n{handler;constructor(e){this.handler=e}request(e,i,r={}){let o;if(e instanceof xc)o=e;else{let f;r.headers instanceof Xr?f=r.headers:f=new Xr(r.headers);let p;r.params&&(r.params instanceof Qn?p=r.params:p=new Qn({fromObject:r.params})),o=new xc(e,i,r.body!==void 0?r.body:null,{headers:f,context:r.context,params:p,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache})}let l=bt(o).pipe(Jo(f=>this.handler.handle(f)));if(e instanceof xc||r.observe==="events")return l;let c=l.pipe(lr(f=>f instanceof N0));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return c.pipe(qt(f=>{if(f.body!==null&&!(f.body instanceof ArrayBuffer))throw new ot(2806,!1);return f.body}));case"blob":return c.pipe(qt(f=>{if(f.body!==null&&!(f.body instanceof Blob))throw new ot(2807,!1);return f.body}));case"text":return c.pipe(qt(f=>{if(f.body!==null&&typeof f.body!="string")throw new ot(2808,!1);return f.body}));case"json":default:return c.pipe(qt(f=>f.body))}case"response":return c;default:throw new ot(2809,!1)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:new Qn().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,r={}){return this.request("PATCH",e,dx(r,i))}post(e,i,r={}){return this.request("POST",e,dx(r,i))}put(e,i,r={}){return this.request("PUT",e,dx(r,i))}static \u0275fac=function(i){return new(i||n)(We(bc))};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})();var G7=new it("");function NM(n,t){return t(n)}function $7(n,t){return(e,i)=>t.intercept(e,{handle:r=>n(r,i)})}function Y7(n,t,e){return(i,r)=>Ir(e,()=>t(i,o=>n(o,r)))}var UM=new it(""),hx=new it(""),LM=new it(""),px=new it("",{providedIn:"root",factory:()=>!0});function q7(){let n=null;return(t,e)=>{n===null&&(n=(Pe(UM,{optional:!0})??[]).reduceRight($7,NM));let i=Pe(Ws);if(Pe(px)){let o=i.add();return n(t,e).pipe(Ca(()=>i.remove(o)))}else return n(t,e)}}var Lm=(()=>{class n extends bc{backend;injector;chain=null;pendingTasks=Pe(Ws);contributeToStability=Pe(px);constructor(e,i){super(),this.backend=e,this.injector=i}handle(e){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(hx),...this.injector.get(LM,[])]));this.chain=i.reduceRight((r,o)=>Y7(r,o,this.injector),NM)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(e,r=>this.backend.handle(r)).pipe(Ca(()=>this.pendingTasks.remove(i)))}else return this.chain(e,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||n)(We(k0),We(Ji))};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})();var X7=/^\)\]\}',?\n/,Z7=RegExp(`^${FM}:`,"m");function J7(n){return"responseURL"in n&&n.responseURL?n.responseURL:Z7.test(n.getAllResponseHeaders())?n.getResponseHeader(FM):null}var fx=(()=>{class n{xhrFactory;constructor(e){this.xhrFactory=e}handle(e){if(e.method==="JSONP")throw new ot(-2800,!1);let i=this.xhrFactory;return(i.\u0275loadImpl?Wn(i.\u0275loadImpl()):bt(null)).pipe(Sr(()=>new En(o=>{let l=i.build();if(l.open(e.method,e.urlWithParams),e.withCredentials&&(l.withCredentials=!0),e.headers.forEach((O,T)=>l.setRequestHeader(O,T.join(","))),e.headers.has(IM)||l.setRequestHeader(IM,z7),!e.headers.has(PM)){let O=e.detectContentTypeHeader();O!==null&&l.setRequestHeader(PM,O)}if(e.responseType){let O=e.responseType.toLowerCase();l.responseType=O!=="json"?O:"text"}let c=e.serializeBody(),f=null,p=()=>{if(f!==null)return f;let O=l.statusText||"OK",T=new Xr(l.getAllResponseHeaders()),M=J7(l)||e.url;return f=new Um({headers:T,status:l.status,statusText:O,url:M}),f},g=()=>{let{headers:O,status:T,statusText:M,url:G}=p(),Y=null;T!==W7&&(Y=typeof l.response>"u"?l.responseText:l.response),T===0&&(T=Y?j7:0);let q=T>=200&&T<300;if(e.responseType==="json"&&typeof Y=="string"){let X=Y;Y=Y.replace(X7,"");try{Y=Y!==""?JSON.parse(Y):null}catch(Z){Y=X,q&&(q=!1,Y={error:Z,text:Y})}}q?(o.next(new N0({body:Y,headers:O,status:T,statusText:M,url:G||void 0})),o.complete()):o.error(new U0({error:Y,headers:O,status:T,statusText:M,url:G||void 0}))},m=O=>{let{url:T}=p(),M=new U0({error:O,status:l.status||0,statusText:l.statusText||"Unknown Error",url:T||void 0});o.error(M)},x=!1,C=O=>{x||(o.next(p()),x=!0);let T={type:Hl.DownloadProgress,loaded:O.loaded};O.lengthComputable&&(T.total=O.total),e.responseType==="text"&&l.responseText&&(T.partialText=l.responseText),o.next(T)},A=O=>{let T={type:Hl.UploadProgress,loaded:O.loaded};O.lengthComputable&&(T.total=O.total),o.next(T)};return l.addEventListener("load",g),l.addEventListener("error",m),l.addEventListener("timeout",m),l.addEventListener("abort",m),e.reportProgress&&(l.addEventListener("progress",C),c!==null&&l.upload&&l.upload.addEventListener("progress",A)),l.send(c),o.next({type:Hl.Sent}),()=>{l.removeEventListener("error",m),l.removeEventListener("abort",m),l.removeEventListener("load",g),l.removeEventListener("timeout",m),e.reportProgress&&(l.removeEventListener("progress",C),c!==null&&l.upload&&l.upload.removeEventListener("progress",A)),l.readyState!==l.DONE&&l.abort()}})))}static \u0275fac=function(i){return new(i||n)(We(Vl))};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})(),BM=new it(""),K7="XSRF-TOKEN",Q7=new it("",{providedIn:"root",factory:()=>K7}),eN="X-XSRF-TOKEN",tN=new it("",{providedIn:"root",factory:()=>eN}),L0=class{},nN=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(e,i){this.doc=e,this.cookieName=i}getToken(){let e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=P0(e,this.cookieName),this.lastCookieString=e),this.lastToken}static \u0275fac=function(i){return new(i||n)(We(Si),We(Q7))};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})(),iN=/^(?:https?:)?\/\//i;function rN(n,t){if(!Pe(BM)||n.method==="GET"||n.method==="HEAD"||iN.test(n.url))return t(n);let e=Pe(L0).getToken(),i=Pe(tN);return e!=null&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,e)})),t(n)}var mx=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(mx||{});function oN(n,t){return{\u0275kind:n,\u0275providers:t}}function Bm(...n){let t=[pn,fx,Lm,{provide:bc,useExisting:Lm},{provide:k0,useFactory:()=>Pe(G7,{optional:!0})??Pe(fx)},{provide:hx,useValue:rN,multi:!0},{provide:BM,useValue:!0},{provide:L0,useClass:nN}];for(let e of n)t.push(...e.\u0275providers);return h0(t)}var OM=new it("");function VM(){return oN(mx.LegacyInterceptors,[{provide:OM,useFactory:q7},{provide:hx,useExisting:OM,multi:!0}])}var B0=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=_o({type:n});static \u0275inj=mo({providers:[Bm(VM())]})}return n})();var HM=(()=>{class n{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(i){return new(i||n)(We(Si))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();$();$();$();var zt="primary",K0=Symbol("RouteTitle"),xx=class{params;constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function Wl(n){return new xx(n)}function XM(n,t,e){let i=e.path.split("/");if(i.length>n.length||e.pathMatch==="full"&&(t.hasChildren()||i.length<n.length))return null;let r={};for(let o=0;o<i.length;o++){let l=i[o],c=n[o];if(l[0]===":")r[l.substring(1)]=c;else if(l!==c.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function aN(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!us(n[e],t[e]))return!1;return!0}function us(n,t){let e=n?bx(n):void 0,i=t?bx(t):void 0;if(!e||!i||e.length!=i.length)return!1;let r;for(let o=0;o<e.length;o++)if(r=e[o],!ZM(n[r],t[r]))return!1;return!0}function bx(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function ZM(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;let e=[...n].sort(),i=[...t].sort();return e.every((r,o)=>i[o]===r)}else return n===t}function JM(n){return n.length>0?n[n.length-1]:null}function Oa(n){return Uv(n)?n:kl(n)?Wn(Promise.resolve(n)):bt(n)}var lN={exact:QM,subset:e3},KM={exact:uN,subset:cN,ignored:()=>!0};function zM(n,t,e){return lN[e.paths](n.root,t.root,e.matrixParams)&&KM[e.queryParams](n.queryParams,t.queryParams)&&!(e.fragment==="exact"&&n.fragment!==t.fragment)}function uN(n,t){return us(n,t)}function QM(n,t,e){if(!zl(n.segments,t.segments)||!zm(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(let i in t.children)if(!n.children[i]||!QM(n.children[i],t.children[i],e))return!1;return!0}function cN(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>ZM(n[e],t[e]))}function e3(n,t,e){return t3(n,t,t.segments,e)}function t3(n,t,e,i){if(n.segments.length>e.length){let r=n.segments.slice(0,e.length);return!(!zl(r,e)||t.hasChildren()||!zm(r,e,i))}else if(n.segments.length===e.length){if(!zl(n.segments,e)||!zm(n.segments,e,i))return!1;for(let r in t.children)if(!n.children[r]||!e3(n.children[r],t.children[r],i))return!1;return!0}else{let r=e.slice(0,n.segments.length),o=e.slice(n.segments.length);return!zl(n.segments,r)||!zm(n.segments,r,i)||!n.children[zt]?!1:t3(n.children[zt],t,o,i)}}function zm(n,t,e){return t.every((i,r)=>KM[e](n[r].parameters,i.parameters))}var ds=class{root;queryParams;fragment;_queryParamMap;constructor(t=new Tn([],{}),e={},i=null){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap??=Wl(this.queryParams),this._queryParamMap}toString(){return hN.serialize(this)}},Tn=class{segments;children;parent=null;constructor(t,e){this.segments=t,this.children=e,Object.values(e).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return jm(this)}},Da=class{path;parameters;_parameterMap;constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap??=Wl(this.parameters),this._parameterMap}toString(){return i3(this)}};function dN(n,t){return zl(n,t)&&n.every((e,i)=>us(e.parameters,t[i].parameters))}function zl(n,t){return n.length!==t.length?!1:n.every((e,i)=>e.path===t[i].path)}function fN(n,t){let e=[];return Object.entries(n.children).forEach(([i,r])=>{i===zt&&(e=e.concat(t(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==zt&&(e=e.concat(t(r,i)))}),e}var Gl=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:()=>new Pa,providedIn:"root"})}return n})(),Pa=class{parse(t){let e=new Ex(t);return new ds(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){let e=`/${V0(t.root,!0)}`,i=gN(t.queryParams),r=typeof t.fragment=="string"?`#${pN(t.fragment)}`:"";return`${e}${i}${r}`}},hN=new Pa;function jm(n){return n.segments.map(t=>i3(t)).join("/")}function V0(n,t){if(!n.hasChildren())return jm(n);if(t){let e=n.children[zt]?V0(n.children[zt],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==zt&&i.push(`${r}:${V0(o,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}else{let e=fN(n,(i,r)=>r===zt?[V0(n.children[zt],!1)]:[`${r}:${V0(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[zt]!=null?`${jm(n)}/${e[0]}`:`${jm(n)}/(${e.join("//")})`}}function n3(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Vm(n){return n3(n).replace(/%3B/gi,";")}function pN(n){return encodeURI(n)}function Cx(n){return n3(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Wm(n){return decodeURIComponent(n)}function jM(n){return Wm(n.replace(/\+/g,"%20"))}function i3(n){return`${Cx(n.path)}${mN(n.parameters)}`}function mN(n){return Object.entries(n).map(([t,e])=>`;${Cx(t)}=${Cx(e)}`).join("")}function gN(n){let t=Object.entries(n).map(([e,i])=>Array.isArray(i)?i.map(r=>`${Vm(e)}=${Vm(r)}`).join("&"):`${Vm(e)}=${Vm(i)}`).filter(e=>e);return t.length?`?${t.join("&")}`:""}var _N=/^[^\/()?;#]+/;function gx(n){let t=n.match(_N);return t?t[0]:""}var vN=/^[^\/()?;=#]+/;function yN(n){let t=n.match(vN);return t?t[0]:""}var xN=/^[^=?&#]+/;function bN(n){let t=n.match(xN);return t?t[0]:""}var CN=/^[^&#]+/;function EN(n){let t=n.match(CN);return t?t[0]:""}var Ex=class{url;remaining;constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Tn([],{}):new Tn([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i[zt]=new Tn(t,e)),i}parseSegment(){let t=gx(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new ot(4009,!1);return this.capture(t),new Da(Wm(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let e=yN(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){let r=gx(this.remaining);r&&(i=r,this.capture(i))}t[Wm(e)]=Wm(i)}parseQueryParam(t){let e=bN(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){let l=EN(this.remaining);l&&(i=l,this.capture(i))}let r=jM(e),o=jM(i);if(t.hasOwnProperty(r)){let l=t[r];Array.isArray(l)||(l=[l],t[r]=l),l.push(o)}else t[r]=o}parseParens(t){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=gx(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new ot(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):t&&(o=zt);let l=this.parseChildren();e[o]=Object.keys(l).length===1?l[zt]:new Tn([],l),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new ot(4011,!1)}};function r3(n){return n.segments.length>0?new Tn([],{[zt]:n}):n}function o3(n){let t={};for(let[i,r]of Object.entries(n.children)){let o=o3(r);if(i===zt&&o.segments.length===0&&o.hasChildren())for(let[l,c]of Object.entries(o.children))t[l]=c;else(o.segments.length>0||o.hasChildren())&&(t[i]=o)}let e=new Tn(n.segments,t);return wN(e)}function wN(n){if(n.numberOfChildren===1&&n.children[zt]){let t=n.children[zt];return new Tn(n.segments.concat(t.segments),t.children)}return n}function Ac(n){return n instanceof ds}function s3(n,t,e=null,i=null){let r=a3(n);return l3(r,t,e,i)}function a3(n){let t;function e(o){let l={};for(let f of o.children){let p=e(f);l[f.outlet]=p}let c=new Tn(o.url,l);return o===n&&(t=c),c}let i=e(n.root),r=r3(i);return t??r}function l3(n,t,e,i){let r=n;for(;r.parent;)r=r.parent;if(t.length===0)return _x(r,r,r,e,i);let o=SN(t);if(o.toRoot())return _x(r,r,new Tn([],{}),e,i);let l=MN(o,r,n),c=l.processChildren?z0(l.segmentGroup,l.index,o.commands):c3(l.segmentGroup,l.index,o.commands);return _x(r,l.segmentGroup,c,e,i)}function $m(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function W0(n){return typeof n=="object"&&n!=null&&n.outlets}function _x(n,t,e,i,r){let o={};i&&Object.entries(i).forEach(([f,p])=>{o[f]=Array.isArray(p)?p.map(g=>`${g}`):`${p}`});let l;n===t?l=e:l=u3(n,t,e);let c=r3(o3(l));return new ds(c,o,r)}function u3(n,t,e){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===t?i[r]=e:i[r]=u3(o,t,e)}),new Tn(n.segments,i)}var Ym=class{isAbsolute;numberOfDoubleDots;commands;constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&$m(i[0]))throw new ot(4003,!1);let r=i.find(W0);if(r&&r!==JM(i))throw new ot(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function SN(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new Ym(!0,0,n);let t=0,e=!1,i=n.reduce((r,o,l)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let c={};return Object.entries(o.outlets).forEach(([f,p])=>{c[f]=typeof p=="string"?p.split("/"):p}),[...r,{outlets:c}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:l===0?(o.split("/").forEach((c,f)=>{f==0&&c==="."||(f==0&&c===""?e=!0:c===".."?t++:c!=""&&r.push(c))}),r):[...r,o]},[]);return new Ym(e,t,i)}var Sc=class{segmentGroup;processChildren;index;constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}};function MN(n,t,e){if(n.isAbsolute)return new Sc(t,!0,0);if(!e)return new Sc(t,!1,NaN);if(e.parent===null)return new Sc(e,!0,0);let i=$m(n.commands[0])?0:1,r=e.segments.length-1+i;return AN(e,r,n.numberOfDoubleDots)}function AN(n,t,e){let i=n,r=t,o=e;for(;o>r;){if(o-=r,i=i.parent,!i)throw new ot(4005,!1);r=i.segments.length}return new Sc(i,!1,r-o)}function TN(n){return W0(n[0])?n[0].outlets:{[zt]:n}}function c3(n,t,e){if(n??=new Tn([],{}),n.segments.length===0&&n.hasChildren())return z0(n,t,e);let i=DN(n,t,e),r=e.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new Tn(n.segments.slice(0,i.pathIndex),{});return o.children[zt]=new Tn(n.segments.slice(i.pathIndex),n.children),z0(o,0,r)}else return i.match&&r.length===0?new Tn(n.segments,{}):i.match&&!n.hasChildren()?wx(n,t,e):i.match?z0(n,0,r):wx(n,t,e)}function z0(n,t,e){if(e.length===0)return new Tn(n.segments,{});{let i=TN(e),r={};if(Object.keys(i).some(o=>o!==zt)&&n.children[zt]&&n.numberOfChildren===1&&n.children[zt].segments.length===0){let o=z0(n.children[zt],t,e);return new Tn(n.segments,o.children)}return Object.entries(i).forEach(([o,l])=>{typeof l=="string"&&(l=[l]),l!==null&&(r[o]=c3(n.children[o],t,l))}),Object.entries(n.children).forEach(([o,l])=>{i[o]===void 0&&(r[o]=l)}),new Tn(n.segments,r)}}function DN(n,t,e){let i=0,r=t,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=e.length)return o;let l=n.segments[r],c=e[i];if(W0(c))break;let f=`${c}`,p=i<e.length-1?e[i+1]:null;if(r>0&&f===void 0)break;if(f&&p&&typeof p=="object"&&p.outlets===void 0){if(!GM(f,p,l))return o;i+=2}else{if(!GM(f,{},l))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function wx(n,t,e){let i=n.segments.slice(0,t),r=0;for(;r<e.length;){let o=e[r];if(W0(o)){let f=PN(o.outlets);return new Tn(i,f)}if(r===0&&$m(e[0])){let f=n.segments[t];i.push(new Da(f.path,WM(e[0]))),r++;continue}let l=W0(o)?o.outlets[zt]:`${o}`,c=r<e.length-1?e[r+1]:null;l&&c&&$m(c)?(i.push(new Da(l,WM(c))),r+=2):(i.push(new Da(l,{})),r++)}return new Tn(i,{})}function PN(n){let t={};return Object.entries(n).forEach(([e,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(t[e]=wx(new Tn([],{}),0,i))}),t}function WM(n){let t={};return Object.entries(n).forEach(([e,i])=>t[e]=`${i}`),t}function GM(n,t,e){return n==e.path&&us(t,e.parameters)}var Gm="imperative",ki=function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n}(ki||{}),Jr=class{id;url;constructor(t,e){this.id=t,this.url=e}},Ia=class extends Jr{type=ki.NavigationStart;navigationTrigger;restoredState;constructor(t,e,i="imperative",r=null){super(t,e),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ho=class extends Jr{urlAfterRedirects;type=ki.NavigationEnd;constructor(t,e,i){super(t,e),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Nr=function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n}(Nr||{}),Tc=function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n}(Tc||{}),cs=class extends Jr{reason;code;type=ki.NavigationCancel;constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},fs=class extends Jr{reason;code;type=ki.NavigationSkipped;constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r}},Dc=class extends Jr{error;target;type=ki.NavigationError;constructor(t,e,i,r){super(t,e),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},G0=class extends Jr{urlAfterRedirects;state;type=ki.RoutesRecognized;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},qm=class extends Jr{urlAfterRedirects;state;type=ki.GuardsCheckStart;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Xm=class extends Jr{urlAfterRedirects;state;shouldActivate;type=ki.GuardsCheckEnd;constructor(t,e,i,r,o){super(t,e),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Zm=class extends Jr{urlAfterRedirects;state;type=ki.ResolveStart;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Jm=class extends Jr{urlAfterRedirects;state;type=ki.ResolveEnd;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Km=class{route;type=ki.RouteConfigLoadStart;constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Qm=class{route;type=ki.RouteConfigLoadEnd;constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},eg=class{snapshot;type=ki.ChildActivationStart;constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},tg=class{snapshot;type=ki.ChildActivationEnd;constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ng=class{snapshot;type=ki.ActivationStart;constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ig=class{snapshot;type=ki.ActivationEnd;constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Pc=class{routerEvent;position;anchor;type=ki.Scroll;constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i}toString(){let t=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${t}')`}},$0=class{},Ic=class{url;navigationBehaviorOptions;constructor(t,e){this.url=t,this.navigationBehaviorOptions=e}};function IN(n,t){return n.providers&&!n._injector&&(n._injector=g0(n.providers,t,`Route: ${n.path}`)),n._injector??t}function Vo(n){return n.outlet||zt}function ON(n,t){let e=n.filter(i=>Vo(i)===t);return e.push(...n.filter(i=>Vo(i)!==t)),e}function Q0(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){let e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}var rg=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Q0(this.route?.snapshot)??this.rootInjector}constructor(t){this.rootInjector=t,this.children=new $l(this.rootInjector)}},$l=(()=>{class n{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,i){let r=this.getOrCreateContext(e);r.outlet=i,this.contexts.set(e,r)}onChildOutletDestroyed(e){let i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new rg(this.rootInjector),this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(i){return new(i||n)(We(Ji))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),og=class{_root;constructor(t){this._root=t}get root(){return this._root.value}parent(t){let e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){let e=Sx(t,this._root);return e?e.children.map(i=>i.value):[]}firstChild(t){let e=Sx(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){let e=Mx(t,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return Mx(t,this._root).map(e=>e.value)}};function Sx(n,t){if(n===t.value)return t;for(let e of t.children){let i=Sx(n,e);if(i)return i}return null}function Mx(n,t){if(n===t.value)return[t];for(let e of t.children){let i=Mx(n,e);if(i.length)return i.unshift(t),i}return[]}var Zr=class{value;children;constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}};function wc(n){let t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}var Y0=class extends og{snapshot;constructor(t,e){super(t),this.snapshot=e,Rx(this,t)}toString(){return this.snapshot.toString()}};function d3(n){let t=FN(n),e=new Ri([new Da("",{})]),i=new Ri({}),r=new Ri({}),o=new Ri({}),l=new Ri(""),c=new Kr(e,i,o,l,r,zt,n,t.root);return c.snapshot=t.root,new Y0(new Zr(c,[]),t)}function FN(n){let t={},e={},i={},r="",o=new jl([],t,i,r,e,zt,n,null,{});return new q0("",new Zr(o,[]))}var Kr=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(t,e,i,r,o,l,c,f){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=l,this.component=c,this._futureSnapshot=f,this.title=this.dataSubject?.pipe(qt(p=>p[K0]))??bt(void 0),this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(qt(t=>Wl(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(qt(t=>Wl(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function sg(n,t,e="emptyOnly"){let i,{routeConfig:r}=n;return t!==null&&(e==="always"||r?.path===""||!t.component&&!t.routeConfig?.loadComponent)?i={params:Oe(Oe({},t.params),n.params),data:Oe(Oe({},t.data),n.data),resolve:Oe(Oe(Oe(Oe({},n.data),t.data),r?.data),n._resolvedData)}:i={params:Oe({},n.params),data:Oe({},n.data),resolve:Oe(Oe({},n.data),n._resolvedData??{})},r&&h3(r)&&(i.resolve[K0]=r.title),i}var jl=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[K0]}constructor(t,e,i,r,o,l,c,f,p){this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=l,this.component=c,this.routeConfig=f,this._resolve=p}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Wl(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Wl(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(i=>i.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${e}')`}},q0=class extends og{url;constructor(t,e){super(e),this.url=t,Rx(this,e)}toString(){return f3(this._root)}};function Rx(n,t){t.value._routerState=n,t.children.forEach(e=>Rx(n,e))}function f3(n){let t=n.children.length>0?` { ${n.children.map(f3).join(", ")} } `:"";return`${n.value}${t}`}function vx(n){if(n.snapshot){let t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,us(t.queryParams,e.queryParams)||n.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&n.fragmentSubject.next(e.fragment),us(t.params,e.params)||n.paramsSubject.next(e.params),aN(t.url,e.url)||n.urlSubject.next(e.url),us(t.data,e.data)||n.dataSubject.next(e.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function Ax(n,t){let e=us(n.params,t.params)&&dN(n.url,t.url),i=!n.parent!=!t.parent;return e&&!i&&(!n.parent||Ax(n.parent,t.parent))}function h3(n){return typeof n.title=="string"||n.title===null}var p3=new it(""),Yl=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=zt;activateEvents=new oi;deactivateEvents=new oi;attachEvents=new oi;detachEvents=new oi;routerOutletData=mw(void 0);parentContexts=Pe($l);location=Pe(Sa);changeDetector=Pe(Bl);inputBinder=Pe(ef,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){let{firstChange:i,previousValue:r}=e.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new ot(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new ot(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new ot(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new ot(4013,!1);this._activatedRoute=e;let r=this.location,l=e.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,f=new Tx(e,c,r.injector,this.routerOutletData);this.activated=r.createComponent(l,{index:r.length,injector:f,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Rn({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[zs]})}return n})(),Tx=class{route;childContexts;parent;outletData;constructor(t,e,i,r){this.route=t,this.childContexts=e,this.parent=i,this.outletData=r}get(t,e){return t===Kr?this.route:t===$l?this.childContexts:t===p3?this.outletData:this.parent.get(t,e)}},ef=new it(""),kx=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){let{activatedRoute:i}=e,r=Kd([i.queryParams,i.params,i.data]).pipe(Sr(([o,l,c],f)=>(c=Oe(Oe(Oe({},o),l),c),f===0?bt(c):Promise.resolve(c)))).subscribe(o=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(e);return}let l=US(i.component);if(!l){this.unsubscribeFromRouteData(e);return}for(let{templateName:c}of l.inputs)e.activatedComponentRef.setInput(c,o[c])});this.outletDataSubscriptions.set(e,r)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})(),Nx=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=nn({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&b(0,"router-outlet")},dependencies:[Yl],encapsulation:2})}return n})();function Ux(n){let t=n.children&&n.children.map(Ux),e=t?St(Oe({},n),{children:t}):Oe({},n);return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==zt&&(e.component=Nx),e}function RN(n,t,e){let i=X0(n,t._root,e?e._root:void 0);return new Y0(i,t)}function X0(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){let i=e.value;i._futureSnapshot=t.value;let r=kN(n,t,e);return new Zr(i,r)}else{if(n.shouldAttach(t.value)){let o=n.retrieve(t.value);if(o!==null){let l=o.route;return l.value._futureSnapshot=t.value,l.children=t.children.map(c=>X0(n,c)),l}}let i=NN(t.value),r=t.children.map(o=>X0(n,o));return new Zr(i,r)}}function kN(n,t,e){return t.children.map(i=>{for(let r of e.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return X0(n,i,r);return X0(n,i)})}function NN(n){return new Kr(new Ri(n.url),new Ri(n.params),new Ri(n.queryParams),new Ri(n.fragment),new Ri(n.data),n.outlet,n.component,n)}var Oc=class{redirectTo;navigationBehaviorOptions;constructor(t,e){this.redirectTo=t,this.navigationBehaviorOptions=e}},m3="ngNavigationCancelingError";function ag(n,t){let{redirectTo:e,navigationBehaviorOptions:i}=Ac(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,r=g3(!1,Nr.Redirect);return r.url=e,r.navigationBehaviorOptions=i,r}function g3(n,t){let e=new Error(`NavigationCancelingError: ${n||""}`);return e[m3]=!0,e.cancellationCode=t,e}function UN(n){return _3(n)&&Ac(n.url)}function _3(n){return!!n&&n[m3]}var LN=(n,t,e,i)=>qt(r=>(new Dx(t,r.targetRouterState,r.currentRouterState,e,i).activate(n),r)),Dx=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(t,e,i,r,o){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(t){let e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),vx(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){let r=wc(e);t.children.forEach(o=>{let l=o.value.outlet;this.deactivateRoutes(o,r[l],i),delete r[l]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(t,e,i){let r=t.value,o=e?e.value:null;if(r===o)if(r.component){let l=i.getContext(r.outlet);l&&this.deactivateChildRoutes(t,e,l.children)}else this.deactivateChildRoutes(t,e,i);else o&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){let i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,o=wc(t);for(let l of Object.values(o))this.deactivateRouteAndItsChildren(l,r);if(i&&i.outlet){let l=i.outlet.detach(),c=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:l,route:t,contexts:c})}}deactivateRouteAndOutlet(t,e){let i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,o=wc(t);for(let l of Object.values(o))this.deactivateRouteAndItsChildren(l,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(t,e,i){let r=wc(e);t.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new ig(o.value.snapshot))}),t.children.length&&this.forwardEvent(new tg(t.value.snapshot))}activateRoutes(t,e,i){let r=t.value,o=e?e.value:null;if(vx(r),r===o)if(r.component){let l=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,l.children)}else this.activateChildRoutes(t,e,i);else if(r.component){let l=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let c=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),l.children.onOutletReAttached(c.contexts),l.attachRef=c.componentRef,l.route=c.route.value,l.outlet&&l.outlet.attach(c.componentRef,c.route.value),vx(c.route.value),this.activateChildRoutes(t,null,l.children)}else l.attachRef=null,l.route=r,l.outlet&&l.outlet.activateWith(r,l.injector),this.activateChildRoutes(t,null,l.children)}else this.activateChildRoutes(t,null,i)}},lg=class{path;route;constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},Mc=class{component;route;constructor(t,e){this.component=t,this.route=e}};function BN(n,t,e){let i=n._root,r=t?t._root:null;return H0(i,r,e,[i.value])}function VN(n){let t=n.routeConfig?n.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:n,guards:t}}function Rc(n,t){let e=Symbol(),i=t.get(n,e);return i===e?typeof n=="function"&&!h4(n)?n:t.get(n):i}function H0(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=wc(t);return n.children.forEach(l=>{HN(l,o[l.value.outlet],e,i.concat([l.value]),r),delete o[l.value.outlet]}),Object.entries(o).forEach(([l,c])=>j0(c,e.getContext(l),r)),r}function HN(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,l=t?t.value:null,c=e?e.getContext(n.value.outlet):null;if(l&&o.routeConfig===l.routeConfig){let f=zN(l,o,o.routeConfig.runGuardsAndResolvers);f?r.canActivateChecks.push(new lg(i)):(o.data=l.data,o._resolvedData=l._resolvedData),o.component?H0(n,t,c?c.children:null,i,r):H0(n,t,e,i,r),f&&c&&c.outlet&&c.outlet.isActivated&&r.canDeactivateChecks.push(new Mc(c.outlet.component,l))}else l&&j0(t,c,r),r.canActivateChecks.push(new lg(i)),o.component?H0(n,null,c?c.children:null,i,r):H0(n,null,e,i,r);return r}function zN(n,t,e){if(typeof e=="function")return e(n,t);switch(e){case"pathParamsChange":return!zl(n.url,t.url);case"pathParamsOrQueryParamsChange":return!zl(n.url,t.url)||!us(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ax(n,t)||!us(n.queryParams,t.queryParams);case"paramsChange":default:return!Ax(n,t)}}function j0(n,t,e){let i=wc(n),r=n.value;Object.entries(i).forEach(([o,l])=>{r.component?t?j0(l,t.children.getContext(o),e):j0(l,null,e):j0(l,t,e)}),r.component?t&&t.outlet&&t.outlet.isActivated?e.canDeactivateChecks.push(new Mc(t.outlet.component,r)):e.canDeactivateChecks.push(new Mc(null,r)):e.canDeactivateChecks.push(new Mc(null,r))}function tf(n){return typeof n=="function"}function jN(n){return typeof n=="boolean"}function WN(n){return n&&tf(n.canLoad)}function GN(n){return n&&tf(n.canActivate)}function $N(n){return n&&tf(n.canActivateChild)}function YN(n){return n&&tf(n.canDeactivate)}function qN(n){return n&&tf(n.canMatch)}function v3(n){return n instanceof Os||n?.name==="EmptyError"}var Hm=Symbol("INITIAL_VALUE");function Fc(){return Sr(n=>Kd(n.map(t=>t.pipe(Rs(1),Vv(Hm)))).pipe(qt(t=>{for(let e of t)if(e!==!0){if(e===Hm)return Hm;if(e===!1||XN(e))return e}return!0}),lr(t=>t!==Hm),Rs(1)))}function XN(n){return Ac(n)||n instanceof Oc}function ZN(n,t){return mi(e=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:l}}=e;return l.length===0&&o.length===0?bt(St(Oe({},e),{guardsResult:!0})):JN(l,i,r,n).pipe(mi(c=>c&&jN(c)?KN(i,o,n,t):bt(c)),qt(c=>St(Oe({},e),{guardsResult:c})))})}function JN(n,t,e,i){return Wn(n).pipe(mi(r=>iU(r.component,r.route,e,t,i)),ks(r=>r!==!0,!0))}function KN(n,t,e,i){return Wn(t).pipe(Jo(r=>zu(eU(r.route.parent,i),QN(r.route,i),nU(n,r.path,e),tU(n,r.route,e))),ks(r=>r!==!0,!0))}function QN(n,t){return n!==null&&t&&t(new ng(n)),bt(!0)}function eU(n,t){return n!==null&&t&&t(new eg(n)),bt(!0)}function tU(n,t,e){let i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||i.length===0)return bt(!0);let r=i.map(o=>dp(()=>{let l=Q0(t)??e,c=Rc(o,l),f=GN(c)?c.canActivate(t,n):Ir(l,()=>c(t,n));return Oa(f).pipe(ks())}));return bt(r).pipe(Fc())}function nU(n,t,e){let i=t[t.length-1],o=t.slice(0,t.length-1).reverse().map(l=>VN(l)).filter(l=>l!==null).map(l=>dp(()=>{let c=l.guards.map(f=>{let p=Q0(l.node)??e,g=Rc(f,p),m=$N(g)?g.canActivateChild(i,n):Ir(p,()=>g(i,n));return Oa(m).pipe(ks())});return bt(c).pipe(Fc())}));return bt(o).pipe(Fc())}function iU(n,t,e,i,r){let o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!o||o.length===0)return bt(!0);let l=o.map(c=>{let f=Q0(t)??r,p=Rc(c,f),g=YN(p)?p.canDeactivate(n,t,e,i):Ir(f,()=>p(n,t,e,i));return Oa(g).pipe(ks())});return bt(l).pipe(Fc())}function rU(n,t,e,i){let r=t.canLoad;if(r===void 0||r.length===0)return bt(!0);let o=r.map(l=>{let c=Rc(l,n),f=WN(c)?c.canLoad(t,e):Ir(n,()=>c(t,e));return Oa(f)});return bt(o).pipe(Fc(),y3(i))}function y3(n){return Fv(Ei(t=>{if(typeof t!="boolean")throw ag(n,t)}),qt(t=>t===!0))}function oU(n,t,e,i){let r=t.canMatch;if(!r||r.length===0)return bt(!0);let o=r.map(l=>{let c=Rc(l,n),f=qN(c)?c.canMatch(t,e):Ir(n,()=>c(t,e));return Oa(f)});return bt(o).pipe(Fc(),y3(i))}var Z0=class{segmentGroup;constructor(t){this.segmentGroup=t||null}},J0=class extends Error{urlTree;constructor(t){super(),this.urlTree=t}};function Ec(n){return wr(new Z0(n))}function sU(n){return wr(new ot(4e3,!1))}function aU(n){return wr(g3(!1,Nr.GuardRejected))}var Px=class{urlSerializer;urlTree;constructor(t,e){this.urlSerializer=t,this.urlTree=e}lineralizeSegments(t,e){let i=[],r=e.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return bt(i);if(r.numberOfChildren>1||!r.children[zt])return sU(`${t.redirectTo}`);r=r.children[zt]}}applyRedirectCommands(t,e,i,r,o){if(typeof e!="string"){let c=e,{queryParams:f,fragment:p,routeConfig:g,url:m,outlet:x,params:C,data:A,title:O}=r,T=Ir(o,()=>c({params:C,data:A,queryParams:f,fragment:p,routeConfig:g,url:m,outlet:x,title:O}));if(T instanceof ds)throw new J0(T);e=T}let l=this.applyRedirectCreateUrlTree(e,this.urlSerializer.parse(e),t,i);if(e[0]==="/")throw new J0(l);return l}applyRedirectCreateUrlTree(t,e,i,r){let o=this.createSegmentGroup(t,e.root,i,r);return new ds(o,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){let i={};return Object.entries(t).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let c=o.substring(1);i[r]=e[c]}else i[r]=o}),i}createSegmentGroup(t,e,i,r){let o=this.createSegments(t,e.segments,i,r),l={};return Object.entries(e.children).forEach(([c,f])=>{l[c]=this.createSegmentGroup(t,f,i,r)}),new Tn(o,l)}createSegments(t,e,i,r){return e.map(o=>o.path[0]===":"?this.findPosParam(t,o,r):this.findOrReturn(o,i))}findPosParam(t,e,i){let r=i[e.path.substring(1)];if(!r)throw new ot(4001,!1);return r}findOrReturn(t,e){let i=0;for(let r of e){if(r.path===t.path)return e.splice(i),r;i++}return t}},Ix={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function lU(n,t,e,i,r){let o=x3(n,t,e);return o.matched?(i=IN(t,i),oU(i,t,e,r).pipe(qt(l=>l===!0?o:Oe({},Ix)))):bt(o)}function x3(n,t,e){if(t.path==="**")return uU(e);if(t.path==="")return t.pathMatch==="full"&&(n.hasChildren()||e.length>0)?Oe({},Ix):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let r=(t.matcher||XM)(e,n,t);if(!r)return Oe({},Ix);let o={};Object.entries(r.posParams??{}).forEach(([c,f])=>{o[c]=f.path});let l=r.consumed.length>0?Oe(Oe({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:l,positionalParamSegments:r.posParams??{}}}function uU(n){return{matched:!0,parameters:n.length>0?JM(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function $M(n,t,e,i){return e.length>0&&fU(n,e,i)?{segmentGroup:new Tn(t,dU(i,new Tn(e,n.children))),slicedSegments:[]}:e.length===0&&hU(n,e,i)?{segmentGroup:new Tn(n.segments,cU(n,e,i,n.children)),slicedSegments:e}:{segmentGroup:new Tn(n.segments,n.children),slicedSegments:e}}function cU(n,t,e,i){let r={};for(let o of e)if(cg(n,t,o)&&!i[Vo(o)]){let l=new Tn([],{});r[Vo(o)]=l}return Oe(Oe({},i),r)}function dU(n,t){let e={};e[zt]=t;for(let i of n)if(i.path===""&&Vo(i)!==zt){let r=new Tn([],{});e[Vo(i)]=r}return e}function fU(n,t,e){return e.some(i=>cg(n,t,i)&&Vo(i)!==zt)}function hU(n,t,e){return e.some(i=>cg(n,t,i))}function cg(n,t,e){return(n.hasChildren()||t.length>0)&&e.pathMatch==="full"?!1:e.path===""}function pU(n,t,e){return t.length===0&&!n.children[e]}var Ox=class{};function mU(n,t,e,i,r,o,l="emptyOnly"){return new Fx(n,t,e,i,r,l,o).recognize()}var gU=31,Fx=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(t,e,i,r,o,l,c){this.injector=t,this.configLoader=e,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=l,this.urlSerializer=c,this.applyRedirects=new Px(this.urlSerializer,this.urlTree)}noMatchError(t){return new ot(4002,`'${t.segmentGroup}'`)}recognize(){let t=$M(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(qt(({children:e,rootSnapshot:i})=>{let r=new Zr(i,e),o=new q0("",r),l=s3(i,[],this.urlTree.queryParams,this.urlTree.fragment);return l.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(l),{state:o,tree:l}}))}match(t){let e=new jl([],Object.freeze({}),Object.freeze(Oe({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),zt,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,t,zt,e).pipe(qt(i=>({children:i,rootSnapshot:e})),gi(i=>{if(i instanceof J0)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof Z0?this.noMatchError(i):i}))}processSegmentGroup(t,e,i,r,o){return i.segments.length===0&&i.hasChildren()?this.processChildren(t,e,i,o):this.processSegment(t,e,i,i.segments,r,!0,o).pipe(qt(l=>l instanceof Zr?[l]:[]))}processChildren(t,e,i,r){let o=[];for(let l of Object.keys(i.children))l==="primary"?o.unshift(l):o.push(l);return Wn(o).pipe(Jo(l=>{let c=i.children[l],f=ON(e,l);return this.processSegmentGroup(t,f,c,l,r)}),Bv((l,c)=>(l.push(...c),l)),ba(null),Lv(),mi(l=>{if(l===null)return Ec(i);let c=b3(l);return _U(c),bt(c)}))}processSegment(t,e,i,r,o,l,c){return Wn(e).pipe(Jo(f=>this.processSegmentAgainstRoute(f._injector??t,e,f,i,r,o,l,c).pipe(gi(p=>{if(p instanceof Z0)return bt(null);throw p}))),ks(f=>!!f),gi(f=>{if(v3(f))return pU(i,r,o)?bt(new Ox):Ec(i);throw f}))}processSegmentAgainstRoute(t,e,i,r,o,l,c,f){return Vo(i)!==l&&(l===zt||!cg(r,o,i))?Ec(r):i.redirectTo===void 0?this.matchSegmentAgainstRoute(t,r,i,o,l,f):this.allowRedirects&&c?this.expandSegmentAgainstRouteUsingRedirect(t,r,e,i,o,l,f):Ec(r)}expandSegmentAgainstRouteUsingRedirect(t,e,i,r,o,l,c){let{matched:f,parameters:p,consumedSegments:g,positionalParamSegments:m,remainingSegments:x}=x3(e,r,o);if(!f)return Ec(e);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>gU&&(this.allowRedirects=!1));let C=new jl(o,p,Object.freeze(Oe({},this.urlTree.queryParams)),this.urlTree.fragment,YM(r),Vo(r),r.component??r._loadedComponent??null,r,qM(r)),A=sg(C,c,this.paramsInheritanceStrategy);C.params=Object.freeze(A.params),C.data=Object.freeze(A.data);let O=this.applyRedirects.applyRedirectCommands(g,r.redirectTo,m,C,t);return this.applyRedirects.lineralizeSegments(r,O).pipe(mi(T=>this.processSegment(t,i,e,T.concat(x),l,!1,c)))}matchSegmentAgainstRoute(t,e,i,r,o,l){let c=lU(e,i,r,t,this.urlSerializer);return i.path==="**"&&(e.children={}),c.pipe(Sr(f=>f.matched?(t=i._injector??t,this.getChildConfig(t,i,r).pipe(Sr(({routes:p})=>{let g=i._loadedInjector??t,{parameters:m,consumedSegments:x,remainingSegments:C}=f,A=new jl(x,m,Object.freeze(Oe({},this.urlTree.queryParams)),this.urlTree.fragment,YM(i),Vo(i),i.component??i._loadedComponent??null,i,qM(i)),O=sg(A,l,this.paramsInheritanceStrategy);A.params=Object.freeze(O.params),A.data=Object.freeze(O.data);let{segmentGroup:T,slicedSegments:M}=$M(e,x,C,p);if(M.length===0&&T.hasChildren())return this.processChildren(g,p,T,A).pipe(qt(Y=>new Zr(A,Y)));if(p.length===0&&M.length===0)return bt(new Zr(A,[]));let G=Vo(i)===o;return this.processSegment(g,p,T,M,G?zt:o,!0,A).pipe(qt(Y=>new Zr(A,Y instanceof Zr?[Y]:[])))}))):Ec(e)))}getChildConfig(t,e,i){return e.children?bt({routes:e.children,injector:t}):e.loadChildren?e._loadedRoutes!==void 0?bt({routes:e._loadedRoutes,injector:e._loadedInjector}):rU(t,e,i,this.urlSerializer).pipe(mi(r=>r?this.configLoader.loadChildren(t,e).pipe(Ei(o=>{e._loadedRoutes=o.routes,e._loadedInjector=o.injector})):aU(e))):bt({routes:[],injector:t})}};function _U(n){n.sort((t,e)=>t.value.outlet===zt?-1:e.value.outlet===zt?1:t.value.outlet.localeCompare(e.value.outlet))}function vU(n){let t=n.value.routeConfig;return t&&t.path===""}function b3(n){let t=[],e=new Set;for(let i of n){if(!vU(i)){t.push(i);continue}let r=t.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),e.add(r)):t.push(i)}for(let i of e){let r=b3(i.children);t.push(new Zr(i.value,r))}return t.filter(i=>!e.has(i))}function YM(n){return n.data||{}}function qM(n){return n.resolve||{}}function yU(n,t,e,i,r,o){return mi(l=>mU(n,t,e,i,l.extractedUrl,r,o).pipe(qt(({state:c,tree:f})=>St(Oe({},l),{targetSnapshot:c,urlAfterRedirects:f}))))}function xU(n,t){return mi(e=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=e;if(!r.length)return bt(e);let o=new Set(r.map(f=>f.route)),l=new Set;for(let f of o)if(!l.has(f))for(let p of C3(f))l.add(p);let c=0;return Wn(l).pipe(Jo(f=>o.has(f)?bU(f,i,n,t):(f.data=sg(f,f.parent,n).resolve,bt(void 0))),Ei(()=>c++),ju(1),mi(f=>c===l.size?bt(e):Cr))})}function C3(n){let t=n.children.map(e=>C3(e)).flat();return[n,...t]}function bU(n,t,e,i){let r=n.routeConfig,o=n._resolve;return r?.title!==void 0&&!h3(r)&&(o[K0]=r.title),CU(o,n,t,i).pipe(qt(l=>(n._resolvedData=l,n.data=sg(n,n.parent,e).resolve,null)))}function CU(n,t,e,i){let r=bx(n);if(r.length===0)return bt({});let o={};return Wn(r).pipe(mi(l=>EU(n[l],t,e,i).pipe(ks(),Ei(c=>{if(c instanceof Oc)throw ag(new Pa,c);o[l]=c}))),ju(1),qt(()=>o),gi(l=>v3(l)?Cr:wr(l)))}function EU(n,t,e,i){let r=Q0(t)??i,o=Rc(n,r),l=o.resolve?o.resolve(t,e):Ir(r,()=>o(t,e));return Oa(l)}function yx(n){return Sr(t=>{let e=n(t);return e?Wn(e).pipe(qt(()=>t)):bt(t)})}var Lx=(()=>{class n{buildTitle(e){let i,r=e.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===zt);return i}getResolvedTitleForRoute(e){return e.data[K0]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:()=>Pe(E3),providedIn:"root"})}return n})(),E3=(()=>{class n extends Lx{title;constructor(e){super(),this.title=e}updateTitle(e){let i=this.buildTitle(e);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(We(HM))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),ql=new it("",{providedIn:"root",factory:()=>({})}),Xl=new it(""),dg=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=Pe(RS);loadComponent(e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return bt(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);let i=Oa(e.loadComponent()).pipe(qt(S3),Ei(o=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=o}),Ca(()=>{this.componentLoaders.delete(e)})),r=new Vu(i,()=>new bi).pipe(Bu());return this.componentLoaders.set(e,r),r}loadChildren(e,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return bt({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=w3(i,this.compiler,e,this.onLoadEndListener).pipe(Ca(()=>{this.childrenLoaders.delete(i)})),l=new Vu(o,()=>new bi).pipe(Bu());return this.childrenLoaders.set(i,l),l}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function w3(n,t,e,i){return Oa(n.loadChildren()).pipe(qt(S3),mi(r=>r instanceof Ly||Array.isArray(r)?bt(r):Wn(t.compileModuleAsync(r))),qt(r=>{i&&i(n);let o,l,c=!1;return Array.isArray(r)?(l=r,c=!0):(o=r.create(e).injector,l=o.get(Xl,[],{optional:!0,self:!0}).flat()),{routes:l.map(Ux),injector:o}}))}function wU(n){return n&&typeof n=="object"&&"default"in n}function S3(n){return wU(n)?n.default:n}var fg=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:()=>Pe(SU),providedIn:"root"})}return n})(),SU=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Bx=new it(""),Vx=new it("");function M3(n,t,e){let i=n.get(Vx),r=n.get(Si);return n.get(si).runOutsideAngular(()=>{if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,new Promise(p=>setTimeout(p));let o,l=new Promise(p=>{o=p}),c=r.startViewTransition(()=>(o(),MU(n))),{onViewTransitionCreated:f}=i;return f&&Ir(n,()=>f({transition:c,from:t,to:e})),l})}function MU(n){return new Promise(t=>{by({read:()=>setTimeout(t)},{injector:n})})}var Hx=new it(""),hg=(()=>{class n{currentNavigation=null;currentTransition=null;lastSuccessfulNavigation=null;events=new bi;transitionAbortSubject=new bi;configLoader=Pe(dg);environmentInjector=Pe(Ji);destroyRef=Pe(uc);urlSerializer=Pe(Gl);rootContexts=Pe($l);location=Pe(Ta);inputBindingEnabled=Pe(ef,{optional:!0})!==null;titleStrategy=Pe(Lx);options=Pe(ql,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=Pe(fg);createViewTransition=Pe(Bx,{optional:!0});navigationErrorHandler=Pe(Hx,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>bt(void 0);rootComponentType=null;destroyed=!1;constructor(){let e=r=>this.events.next(new Km(r)),i=r=>this.events.next(new Qm(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=e,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(e){let i=++this.navigationId;this.transitions?.next(St(Oe({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,id:i}))}setupNavigations(e){return this.transitions=new Ri(null),this.transitions.pipe(lr(i=>i!==null),Sr(i=>{let r=!1,o=!1;return bt(i).pipe(Sr(l=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",Nr.SupersededByNewNavigation),Cr;this.currentTransition=i,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?St(Oe({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let c=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),f=l.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!c&&f!=="reload"){let p="";return this.events.next(new fs(l.id,this.urlSerializer.serialize(l.rawUrl),p,Tc.IgnoredSameUrlNavigation)),l.resolve(!1),Cr}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return bt(l).pipe(Sr(p=>(this.events.next(new Ia(p.id,this.urlSerializer.serialize(p.extractedUrl),p.source,p.restoredState)),p.id!==this.navigationId?Cr:Promise.resolve(p))),yU(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),Ei(p=>{i.targetSnapshot=p.targetSnapshot,i.urlAfterRedirects=p.urlAfterRedirects,this.currentNavigation=St(Oe({},this.currentNavigation),{finalUrl:p.urlAfterRedirects});let g=new G0(p.id,this.urlSerializer.serialize(p.extractedUrl),this.urlSerializer.serialize(p.urlAfterRedirects),p.targetSnapshot);this.events.next(g)}));if(c&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:p,extractedUrl:g,source:m,restoredState:x,extras:C}=l,A=new Ia(p,this.urlSerializer.serialize(g),m,x);this.events.next(A);let O=d3(this.rootComponentType).snapshot;return this.currentTransition=i=St(Oe({},l),{targetSnapshot:O,urlAfterRedirects:g,extras:St(Oe({},C),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=g,bt(i)}else{let p="";return this.events.next(new fs(l.id,this.urlSerializer.serialize(l.extractedUrl),p,Tc.IgnoredByUrlHandlingStrategy)),l.resolve(!1),Cr}}),Ei(l=>{let c=new qm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(c)}),qt(l=>(this.currentTransition=i=St(Oe({},l),{guards:BN(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),i)),ZN(this.environmentInjector,l=>this.events.next(l)),Ei(l=>{if(i.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw ag(this.urlSerializer,l.guardsResult);let c=new Xm(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(c)}),lr(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Nr.GuardRejected),!1)),yx(l=>{if(l.guards.canActivateChecks.length!==0)return bt(l).pipe(Ei(c=>{let f=new Zm(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(f)}),Sr(c=>{let f=!1;return bt(c).pipe(xU(this.paramsInheritanceStrategy,this.environmentInjector),Ei({next:()=>f=!0,complete:()=>{f||this.cancelNavigationTransition(c,"",Nr.NoDataFromResolver)}}))}),Ei(c=>{let f=new Jm(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(f)}))}),yx(l=>{let c=f=>{let p=[];f.routeConfig?.loadComponent&&!f.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(f.routeConfig).pipe(Ei(g=>{f.component=g}),qt(()=>{})));for(let g of f.children)p.push(...c(g));return p};return Kd(c(l.targetSnapshot.root)).pipe(ba(null),Rs(1))}),yx(()=>this.afterPreactivation()),Sr(()=>{let{currentSnapshot:l,targetSnapshot:c}=i,f=this.createViewTransition?.(this.environmentInjector,l.root,c.root);return f?Wn(f).pipe(qt(()=>i)):bt(i)}),qt(l=>{let c=RN(e.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=i=St(Oe({},l),{targetRouterState:c}),this.currentNavigation.targetRouterState=c,i}),Ei(()=>{this.events.next(new $0)}),LN(this.rootContexts,e.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Rs(1),Ei({next:l=>{r=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ho(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{r=!0}}),Hv(this.transitionAbortSubject.pipe(Ei(l=>{throw l}))),Ca(()=>{!r&&!o&&this.cancelNavigationTransition(i,"",Nr.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation=null,this.currentTransition=null)}),gi(l=>{if(this.destroyed)return i.resolve(!1),Cr;if(o=!0,_3(l))this.events.next(new cs(i.id,this.urlSerializer.serialize(i.extractedUrl),l.message,l.cancellationCode)),UN(l)?this.events.next(new Ic(l.url,l.navigationBehaviorOptions)):i.resolve(!1);else{let c=new Dc(i.id,this.urlSerializer.serialize(i.extractedUrl),l,i.targetSnapshot??void 0);try{let f=Ir(this.environmentInjector,()=>this.navigationErrorHandler?.(c));if(f instanceof Oc){let{message:p,cancellationCode:g}=ag(this.urlSerializer,f);this.events.next(new cs(i.id,this.urlSerializer.serialize(i.extractedUrl),p,g)),this.events.next(new Ic(f.redirectTo,f.navigationBehaviorOptions))}else throw this.events.next(c),l}catch(f){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(f)}}return Cr}))}))}cancelNavigationTransition(e,i,r){let o=new cs(e.id,this.urlSerializer.serialize(e.extractedUrl),i,r);this.events.next(o),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return e.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function AU(n){return n!==Gm}var A3=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:()=>Pe(TU),providedIn:"root"})}return n})(),ug=class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}},TU=(()=>{class n extends ug{static \u0275fac=(()=>{let e;return function(r){return(e||(e=go(n)))(r||n)}})();static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),T3=(()=>{class n{urlSerializer=Pe(Gl);options=Pe(ql,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=Pe(Ta);urlHandlingStrategy=Pe(fg);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new ds;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:e,initialUrl:i,targetBrowserUrl:r}){let o=e!==void 0?this.urlHandlingStrategy.merge(e,i):i,l=r??o;return l instanceof ds?this.urlSerializer.serialize(l):l}commitTransition({targetRouterState:e,finalUrl:i,initialUrl:r}){i&&e?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=e):this.rawUrlTree=r}routerState=d3(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:e}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e??this.rawUrlTree)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:()=>Pe(DU),providedIn:"root"})}return n})(),DU=(()=>{class n extends T3{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{e(i.url,i.state,"popstate")})})}handleRouterEvent(e,i){e instanceof Ia?this.updateStateMemento():e instanceof fs?this.commitTransition(i):e instanceof G0?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):e instanceof $0?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):e instanceof cs&&(e.code===Nr.GuardRejected||e.code===Nr.NoDataFromResolver)?this.restoreHistory(i):e instanceof Dc?this.restoreHistory(i,!0):e instanceof Ho&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,{extras:i,id:r}){let{replaceUrl:o,state:l}=i;if(this.location.isCurrentPathEqualTo(e)||o){let c=this.browserPageId,f=Oe(Oe({},l),this.generateNgRouterState(r,c));this.location.replaceState(e,"",f)}else{let c=Oe(Oe({},l),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(e,"",c)}}restoreHistory(e,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===e.finalUrl&&o===0&&(this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,i){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(r){return(e||(e=go(n)))(r||n)}})();static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function pg(n,t){n.events.pipe(lr(e=>e instanceof Ho||e instanceof cs||e instanceof Dc||e instanceof fs),qt(e=>e instanceof Ho||e instanceof fs?0:(e instanceof cs?e.code===Nr.Redirect||e.code===Nr.SupersededByNewNavigation:!1)?2:1),lr(e=>e!==2),Rs(1)).subscribe(()=>{t()})}var PU={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},IU={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},ei=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=Pe(dS);stateManager=Pe(T3);options=Pe(ql,{optional:!0})||{};pendingTasks=Pe(Ws);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=Pe(hg);urlSerializer=Pe(Gl);location=Pe(Ta);urlHandlingStrategy=Pe(fg);_events=new bi;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=Pe(A3);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=Pe(Xl,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!Pe(ef,{optional:!0});constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}eventsSubscription=new xi;subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=this.navigationTransitions.currentNavigation;if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof cs&&i.code!==Nr.Redirect&&i.code!==Nr.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Ho)this.navigated=!0;else if(i instanceof Ic){let l=i.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),f=Oe({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||AU(r.source)},l);this.scheduleNavigation(c,Gm,null,f,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}FU(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortSubject.next(r)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Gm,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,i,r)=>{this.navigateToSyncWithBrowser(e,r,i)})}navigateToSyncWithBrowser(e,i,r){let o={replaceUrl:!0},l=r?.navigationId?r:null;if(r){let f=Oe({},r);delete f.navigationId,delete f.\u0275routerPageId,Object.keys(f).length!==0&&(o.state=f)}let c=this.parseUrl(e);this.scheduleNavigation(c,i,l,o)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(Ux),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,i={}){let{relativeTo:r,queryParams:o,fragment:l,queryParamsHandling:c,preserveFragment:f}=i,p=f?this.currentUrlTree.fragment:l,g=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":g=Oe(Oe({},this.currentUrlTree.queryParams),o);break;case"preserve":g=this.currentUrlTree.queryParams;break;default:g=o||null}g!==null&&(g=this.removeEmptyProps(g));let m;try{let x=r?r.snapshot:this.routerState.snapshot.root;m=a3(x)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),m=this.currentUrlTree.root}return l3(m,e,g,p??null)}navigateByUrl(e,i={skipLocationChange:!1}){let r=Ac(e)?e:this.parseUrl(e),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,Gm,null,i)}navigate(e,i={skipLocationChange:!1}){return OU(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.urlSerializer.parse("/")}}isActive(e,i){let r;if(i===!0?r=Oe({},PU):i===!1?r=Oe({},IU):r=i,Ac(e))return zM(this.currentUrlTree,e,r);let o=this.parseUrl(e);return zM(this.currentUrlTree,o,r)}removeEmptyProps(e){return Object.entries(e).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(e,i,r,o,l){if(this.disposed)return Promise.resolve(!1);let c,f,p;l?(c=l.resolve,f=l.reject,p=l.promise):p=new Promise((m,x)=>{c=m,f=x});let g=this.pendingTasks.add();return pg(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(g))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:o,resolve:c,reject:f,promise:p,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),p.catch(m=>Promise.reject(m))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function OU(n){for(let t=0;t<n.length;t++)if(n[t]==null)throw new ot(4008,!1)}function FU(n){return!(n instanceof $0)&&!(n instanceof Ic)}$();var nf=class{};var D3=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(e,i,r,o){this.router=e,this.injector=i,this.preloadingStrategy=r,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(lr(e=>e instanceof Ho),Jo(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,i){let r=[];for(let o of i){o.providers&&!o._injector&&(o._injector=g0(o.providers,e,`Route: ${o.path}`));let l=o._injector??e,c=o._loadedInjector??l;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&r.push(this.preloadConfig(l,o)),(o.children||o._loadedRoutes)&&r.push(this.processRoutes(c,o.children??o._loadedRoutes))}return Wn(r).pipe(Hu())}preloadConfig(e,i){return this.preloadingStrategy.preload(i,()=>{let r;i.loadChildren&&i.canLoad===void 0?r=this.loader.loadChildren(e,i):r=bt(null);let o=r.pipe(mi(l=>l===null?bt(void 0):(i._loadedRoutes=l.routes,i._loadedInjector=l.injector,this.processRoutes(l.injector??e,l.routes))));if(i.loadComponent&&!i._loadedComponent){let l=this.loader.loadComponent(i);return Wn([o,l]).pipe(Hu())}else return o})}static \u0275fac=function(i){return new(i||n)(We(ei),We(Ji),We(nf),We(dg))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),P3=new it(""),RU=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource="imperative";restoredId=0;store={};constructor(e,i,r,o,l={}){this.urlSerializer=e,this.transitions=i,this.viewportScroller=r,this.zone=o,this.options=l,l.scrollPositionRestoration||="disabled",l.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Ia?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Ho?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof fs&&e.code===Tc.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof Pc&&(e.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0]):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(e.position):e.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(e.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(e,i){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new Pc(e,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(i){eS()};static \u0275prov=$e({token:n,factory:n.\u0275fac})}return n})();function jx(n,...t){return h0([{provide:Xl,multi:!0,useValue:n},[],{provide:Kr,useFactory:I3,deps:[ei]},{provide:pm,multi:!0,useFactory:O3},t.map(e=>e.\u0275providers)])}function I3(n){return n.routerState.root}function rf(n,t){return{\u0275kind:n,\u0275providers:t}}function O3(){let n=Pe(po);return t=>{let e=n.get(Il);if(t!==e.components[0])return;let i=n.get(ei),r=n.get(F3);n.get(Wx)===1&&i.initialNavigation(),n.get(N3,null,Gt.Optional)?.setUpPreloading(),n.get(P3,null,Gt.Optional)?.init(),i.resetRootComponentType(e.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var F3=new it("",{factory:()=>new bi}),Wx=new it("",{providedIn:"root",factory:()=>1});function R3(){let n=[{provide:Wx,useValue:0},By(()=>{let t=Pe(po);return t.get(Gy,Promise.resolve()).then(()=>new Promise(i=>{let r=t.get(ei),o=t.get(F3);pg(r,()=>{i(!0)}),t.get(hg).afterPreactivation=()=>(i(!0),o.closed?bt(void 0):o),r.initialNavigation()}))})];return rf(2,n)}function k3(){let n=[By(()=>{Pe(ei).setUpLocationChangeListener()}),{provide:Wx,useValue:2}];return rf(3,n)}var N3=new it("");function U3(n){return rf(0,[{provide:N3,useExisting:D3},{provide:nf,useExisting:n}])}function L3(){return rf(8,[kx,{provide:ef,useExisting:kx}])}function B3(n){m0("NgRouterViewTransitions");let t=[{provide:Bx,useValue:M3},{provide:Vx,useValue:Oe({skipNextTransition:!!n?.skipInitialTransition},n)}];return rf(9,t)}var V3=[Ta,{provide:Gl,useClass:Pa},ei,$l,{provide:Kr,useFactory:I3,deps:[ei]},dg,[]],qs=(()=>{class n{constructor(){}static forRoot(e,i){return{ngModule:n,providers:[V3,[],{provide:Xl,multi:!0,useValue:e},[],i?.errorHandler?{provide:Hx,useValue:i.errorHandler}:[],{provide:ql,useValue:i||{}},i?.useHash?NU():UU(),kU(),i?.preloadingStrategy?U3(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?LU(i):[],i?.bindToComponentInputs?L3().\u0275providers:[],i?.enableViewTransitions?B3().\u0275providers:[],BU()]}}static forChild(e){return{ngModule:n,providers:[{provide:Xl,multi:!0,useValue:e}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=_o({type:n});static \u0275inj=mo({})}return n})();function kU(){return{provide:P3,useFactory:()=>{let n=Pe(_M),t=Pe(si),e=Pe(ql),i=Pe(hg),r=Pe(Gl);return e.scrollOffset&&n.setOffset(e.scrollOffset),new RU(r,i,n,t,e)}}}function NU(){return{provide:$s,useClass:Ky}}function UU(){return{provide:$s,useClass:vm}}function LU(n){return[n.initialNavigation==="disabled"?k3().\u0275providers:[],n.initialNavigation==="enabledBlocking"?R3().\u0275providers:[]]}var zx=new it("");function BU(){return[{provide:zx,useFactory:O3},{provide:pm,multi:!0,useExisting:zx}]}$();$();$();$();var Z3=(()=>{class n{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,i){this._renderer=e,this._elementRef=i}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(i){return new(i||n)(Ne(Gs),Ne($r))};static \u0275dir=Rn({type:n})}return n})(),df=(()=>{class n extends Z3{static \u0275fac=(()=>{let e;return function(r){return(e||(e=go(n)))(r||n)}})();static \u0275dir=Rn({type:n,features:[Wi]})}return n})(),Jl=new it(""),HU={provide:Jl,useExisting:cr(()=>ff),multi:!0},ff=(()=>{class n extends df{writeValue(e){this.setProperty("checked",e)}static \u0275fac=(()=>{let e;return function(r){return(e||(e=go(n)))(r||n)}})();static \u0275dir=Rn({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){i&1&&I("change",function(l){return r.onChange(l.target.checked)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Yr([HU]),Wi]})}return n})(),zU={provide:Jl,useExisting:cr(()=>Yn),multi:!0};function jU(){let n=vo()?vo().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var WU=new it(""),Yn=(()=>{class n extends Z3{_compositionMode;_composing=!1;constructor(e,i,r){super(e,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!jU())}writeValue(e){let i=e??"";this.setProperty("value",i)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(i){return new(i||n)(Ne(Gs),Ne($r),Ne(WU,8))};static \u0275dir=Rn({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&I("input",function(l){return r._handleInput(l.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(l){return r._compositionEnd(l.target.value)})},standalone:!1,features:[Yr([zU]),Wi]})}return n})();function qx(n){return n==null||Xx(n)===0}function Xx(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var Kl=new it(""),Mg=new it(""),GU=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Tt=class{static min(t){return J3(t)}static max(t){return K3(t)}static required(t){return Q3(t)}static requiredTrue(t){return $U(t)}static email(t){return YU(t)}static minLength(t){return qU(t)}static maxLength(t){return XU(t)}static pattern(t){return ZU(t)}static nullValidator(t){return gg()}static compose(t){return oA(t)}static composeAsync(t){return sA(t)}};function J3(n){return t=>{if(t.value==null||n==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}function K3(n){return t=>{if(t.value==null||n==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}function Q3(n){return qx(n.value)?{required:!0}:null}function $U(n){return n.value===!0?null:{required:!0}}function YU(n){return qx(n.value)||GU.test(n.value)?null:{email:!0}}function qU(n){return t=>{let e=t.value?.length??Xx(t.value);return e===null||e===0?null:e<n?{minlength:{requiredLength:n,actualLength:e}}:null}}function XU(n){return t=>{let e=t.value?.length??Xx(t.value);return e!==null&&e>n?{maxlength:{requiredLength:n,actualLength:e}}:null}}function ZU(n){if(!n)return gg;let t,e;return typeof n=="string"?(e="",n.charAt(0)!=="^"&&(e+="^"),e+=n,n.charAt(n.length-1)!=="$"&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),i=>{if(qx(i.value))return null;let r=i.value;return t.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}function gg(n){return null}function eA(n){return n!=null}function tA(n){return kl(n)?Wn(n):n}function nA(n){let t={};return n.forEach(e=>{t=e!=null?Oe(Oe({},t),e):t}),Object.keys(t).length===0?null:t}function iA(n,t){return t.map(e=>e(n))}function JU(n){return!n.validate}function rA(n){return n.map(t=>JU(t)?t:e=>t.validate(e))}function oA(n){if(!n)return null;let t=n.filter(eA);return t.length==0?null:function(e){return nA(iA(e,t))}}function Zx(n){return n!=null?oA(rA(n)):null}function sA(n){if(!n)return null;let t=n.filter(eA);return t.length==0?null:function(e){let i=iA(e,t).map(tA);return Fs(i).pipe(qt(nA))}}function Jx(n){return n!=null?sA(rA(n)):null}function H3(n,t){return n===null?[t]:Array.isArray(n)?[...n,t]:[n,t]}function aA(n){return n._rawValidators}function lA(n){return n._rawAsyncValidators}function Gx(n){return n?Array.isArray(n)?n:[n]:[]}function _g(n,t){return Array.isArray(n)?n.includes(t):n===t}function z3(n,t){let e=Gx(t);return Gx(n).forEach(r=>{_g(e,r)||e.push(r)}),e}function j3(n,t){return Gx(t).filter(e=>!_g(n,e))}var vg=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=Zx(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Jx(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},Xs=class extends vg{name;get formDirective(){return null}get path(){return null}},Zl=class extends vg{_parent=null;name=null;valueAccessor=null},yg=class{_cd;constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},KU={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},Bae=St(Oe({},KU),{"[class.ng-submitted]":"isSubmitted"}),ii=(()=>{class n extends yg{constructor(e){super(e)}static \u0275fac=function(i){return new(i||n)(Ne(Zl,2))};static \u0275dir=Rn({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&Ie("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[Wi]})}return n})(),Ai=(()=>{class n extends yg{constructor(e){super(e)}static \u0275fac=function(i){return new(i||n)(Ne(Xs,10))};static \u0275dir=Rn({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&Ie("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[Wi]})}return n})();var of="VALID",mg="INVALID",kc="PENDING",sf="DISABLED",Ra=class{},xg=class extends Ra{value;source;constructor(t,e){super(),this.value=t,this.source=e}},lf=class extends Ra{pristine;source;constructor(t,e){super(),this.pristine=t,this.source=e}},uf=class extends Ra{touched;source;constructor(t,e){super(),this.touched=t,this.source=e}},Nc=class extends Ra{status;source;constructor(t,e){super(),this.status=t,this.source=e}},bg=class extends Ra{source;constructor(t){super(),this.source=t}},Cg=class extends Ra{source;constructor(t){super(),this.source=t}};function Kx(n){return(Ag(n)?n.validators:n)||null}function QU(n){return Array.isArray(n)?Zx(n):n||null}function Qx(n,t){return(Ag(t)?t.asyncValidators:n)||null}function eL(n){return Array.isArray(n)?Jx(n):n||null}function Ag(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function uA(n,t,e){let i=n.controls;if(!(t?Object.keys(i):i).length)throw new ot(1e3,"");if(!i[e])throw new ot(1001,"")}function cA(n,t,e){n._forEachChild((i,r)=>{if(e[r]===void 0)throw new ot(1002,"")})}var Uc=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(t,e){this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return ls(this.statusReactive)}set status(t){ls(()=>this.statusReactive.set(t))}_status=yc(()=>this.statusReactive());statusReactive=dc(void 0);get valid(){return this.status===of}get invalid(){return this.status===mg}get pending(){return this.status==kc}get disabled(){return this.status===sf}get enabled(){return this.status!==sf}errors;get pristine(){return ls(this.pristineReactive)}set pristine(t){ls(()=>this.pristineReactive.set(t))}_pristine=yc(()=>this.pristineReactive());pristineReactive=dc(!0);get dirty(){return!this.pristine}get touched(){return ls(this.touchedReactive)}set touched(t){ls(()=>this.touchedReactive.set(t))}_touched=yc(()=>this.touchedReactive());touchedReactive=dc(!1);get untouched(){return!this.touched}_events=new bi;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(z3(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(z3(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(j3(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(j3(t,this._rawAsyncValidators))}hasValidator(t){return _g(this._rawValidators,t)}hasAsyncValidator(t){return _g(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let e=this.touched===!1;this.touched=!0;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(St(Oe({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new uf(!0,i))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=t.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:i})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,i),e&&t.emitEvent!==!1&&this._events.next(new uf(!1,i))}markAsDirty(t={}){let e=this.pristine===!0;this.pristine=!1;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(St(Oe({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new lf(!1,i))}markAsPristine(t={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=t.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,i),e&&t.emitEvent!==!1&&this._events.next(new lf(!0,i))}markAsPending(t={}){this.status=kc;let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new Nc(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(St(Oe({},t),{sourceControl:e}))}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=sf,this.errors=null,this._forEachChild(r=>{r.disable(St(Oe({},t),{onlySelf:!0}))}),this._updateValue();let i=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new xg(this.value,i)),this._events.next(new Nc(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(St(Oe({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=of,this._forEachChild(i=>{i.enable(St(Oe({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(St(Oe({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===of||this.status===kc)&&this._runAsyncValidator(i,t.emitEvent)}let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new xg(this.value,e)),this._events.next(new Nc(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(St(Oe({},t),{sourceControl:e}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?sf:of}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=kc,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1};let i=tA(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=this._hasOwnPendingAsyncValidator?.emitEvent??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(t,e){let i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,i){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||i)&&this._events.next(new Nc(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,i)}_initObservables(){this.valueChanges=new oi,this.statusChanges=new oi}_calculateStatus(){return this._allControlsDisabled()?sf:this.errors?mg:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(kc)?kc:this._anyControlsHaveStatus(mg)?mg:of}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),r&&this._events.next(new lf(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new uf(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_onDisabledChange=[];_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){Ag(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=QU(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=eL(this._rawAsyncValidators)}},ka=class extends Uc{constructor(t,e,i){super(Kx(e),Qx(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){cA(this,!0,t),Object.keys(t).forEach(i=>{uA(this,!0,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(Object.keys(t).forEach(i=>{let r=this.controls[i];r&&r.patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,r)=>{i.reset(t?t[r]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>i._syncPendingControls()?!0:e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{let i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[e,i]of Object.entries(this.controls))if(this.contains(e)&&t(i))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(e,i,r)=>((i.enabled||this.disabled)&&(e[r]=i.value),e))}_reduceChildren(t,e){let i=t;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var $x=class extends ka{};var hf=new it("",{providedIn:"root",factory:()=>Tg}),Tg="always";function dA(n,t){return[...t.path,n]}function Eg(n,t,e=Tg){eb(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(n.disabled),nL(n,t),rL(n,t),iL(n,t),tL(n,t)}function W3(n,t,e=!0){let i=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(i),t.valueAccessor.registerOnTouched(i)),Sg(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function wg(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function tL(n,t){if(t.valueAccessor.setDisabledState){let e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}function eb(n,t){let e=aA(n);t.validator!==null?n.setValidators(H3(e,t.validator)):typeof e=="function"&&n.setValidators([e]);let i=lA(n);t.asyncValidator!==null?n.setAsyncValidators(H3(i,t.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();wg(t._rawValidators,r),wg(t._rawAsyncValidators,r)}function Sg(n,t){let e=!1;if(n!==null){if(t.validator!==null){let r=aA(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(l=>l!==t.validator);o.length!==r.length&&(e=!0,n.setValidators(o))}}if(t.asyncValidator!==null){let r=lA(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(l=>l!==t.asyncValidator);o.length!==r.length&&(e=!0,n.setAsyncValidators(o))}}}let i=()=>{};return wg(t._rawValidators,i),wg(t._rawAsyncValidators,i),e}function nL(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&fA(n,t)})}function iL(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&fA(n,t),n.updateOn!=="submit"&&n.markAsTouched()})}function fA(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function rL(n,t){let e=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}function hA(n,t){n==null,eb(n,t)}function oL(n,t){return Sg(n,t)}function pA(n,t){if(!n.hasOwnProperty("model"))return!1;let e=n.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function sL(n){return Object.getPrototypeOf(n.constructor)===df}function mA(n,t){n._syncPendingControls(),t.forEach(e=>{let i=e.control;i.updateOn==="submit"&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function gA(n,t){if(!t)return null;Array.isArray(t);let e,i,r;return t.forEach(o=>{o.constructor===Yn?e=o:sL(o)?i=o:r=o}),r||i||e||null}function aL(n,t){let e=n.indexOf(t);e>-1&&n.splice(e,1)}var lL={provide:Xs,useExisting:cr(()=>mr)},af=Promise.resolve(),mr=(()=>{class n extends Xs{callSetDisabledState;get submitted(){return ls(this.submittedReactive)}_submitted=yc(()=>this.submittedReactive());submittedReactive=dc(!1);_directives=new Set;form;ngSubmit=new oi;options;constructor(e,i,r){super(),this.callSetDisabledState=r,this.form=new ka({},Zx(e),Jx(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){af.then(()=>{let i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),Eg(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){af.then(()=>{let i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){af.then(()=>{let i=this._findContainer(e.path),r=new ka({});hA(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){af.then(()=>{let i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){af.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submittedReactive.set(!0),mA(this.form,this._directives),this.ngSubmit.emit(e),this.form._events.next(new bg(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submittedReactive.set(!1),this.form._events.next(new Cg(this.form))}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static \u0275fac=function(i){return new(i||n)(Ne(Kl,10),Ne(Mg,10),Ne(hf,8))};static \u0275dir=Rn({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){i&1&&I("submit",function(l){return r.onSubmit(l)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Yr([lL]),Wi]})}return n})();function G3(n,t){let e=n.indexOf(t);e>-1&&n.splice(e,1)}function $3(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var cf=class extends Uc{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(t=null,e,i){super(Kx(e),Qx(i,e)),this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ag(e)&&(e.nonNullable||e.initialValueIsDefault)&&($3(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){G3(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){G3(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){$3(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var uL=n=>n instanceof cf;var cL={provide:Zl,useExisting:cr(()=>ti)},Y3=Promise.resolve(),ti=(()=>{class n extends Zl{_changeDetectorRef;callSetDisabledState;control=new cf;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new oi;constructor(e,i,r,o,l,c){super(),this._changeDetectorRef=l,this.callSetDisabledState=c,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=gA(this,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),pA(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Eg(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){Y3.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let i=e.isDisabled.currentValue,r=i!==0&&b0(i);Y3.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?dA(e,this._parent):[e]}static \u0275fac=function(i){return new(i||n)(Ne(Xs,9),Ne(Kl,10),Ne(Mg,10),Ne(Jl,10),Ne(Bl,8),Ne(hf,8))};static \u0275dir=Rn({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[Yr([cL]),Wi,zs]})}return n})();var Ti=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=Rn({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})(),dL={provide:Jl,useExisting:cr(()=>gr),multi:!0},gr=(()=>{class n extends df{writeValue(e){let i=e??"";this.setProperty("value",i)}registerOnChange(e){this.onChange=i=>{e(i==""?null:parseFloat(i))}}static \u0275fac=(()=>{let e;return function(r){return(e||(e=go(n)))(r||n)}})();static \u0275dir=Rn({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){i&1&&I("input",function(l){return r.onChange(l.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[Yr([dL]),Wi]})}return n})();var _A=new it("");var fL={provide:Xs,useExisting:cr(()=>Ql)},Ql=(()=>{class n extends Xs{callSetDisabledState;get submitted(){return ls(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}_submitted=yc(()=>this._submittedReactive());_submittedReactive=dc(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new oi;constructor(e,i,r){super(),this.callSetDisabledState=r,this._setValidators(e),this._setAsyncValidators(i)}ngOnChanges(e){e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(Sg(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let i=this.form.get(e.path);return Eg(i,e,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),i}getControl(e){return this.form.get(e.path)}removeControl(e){W3(e.control||null,e,!1),aL(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,i){this.form.get(e.path).setValue(i)}onSubmit(e){return this._submittedReactive.set(!0),mA(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new bg(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this._submittedReactive.set(!1),this.form._events.next(new Cg(this.form))}_updateDomValue(){this.directives.forEach(e=>{let i=e.control,r=this.form.get(e.path);i!==r&&(W3(i||null,e),uL(r)&&(Eg(r,e,this.callSetDisabledState),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let i=this.form.get(e.path);hA(i,e),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let i=this.form.get(e.path);i&&oL(i,e)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){eb(this.form,this),this._oldForm&&Sg(this._oldForm,this)}static \u0275fac=function(i){return new(i||n)(Ne(Kl,10),Ne(Mg,10),Ne(hf,8))};static \u0275dir=Rn({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&I("submit",function(l){return r.onSubmit(l)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[Yr([fL]),Wi,zs]})}return n})();var hL={provide:Zl,useExisting:cr(()=>eu)},eu=(()=>{class n extends Zl{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(e){}model;update=new oi;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,i,r,o,l){super(),this._ngModelWarningConfig=l,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=gA(this,o)}ngOnChanges(e){this._added||this._setUpControl(),pA(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return dA(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(Ne(Xs,13),Ne(Kl,10),Ne(Mg,10),Ne(Jl,10),Ne(_A,8))};static \u0275dir=Rn({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[Yr([hL]),Wi,zs]})}return n})();var pL={provide:Jl,useExisting:cr(()=>di),multi:!0};function vA(n,t){return n==null?`${t}`:(t&&typeof t=="object"&&(t="Object"),`${n}: ${t}`.slice(0,50))}function mL(n){return n.split(":")[0]}var di=(()=>{class n extends df{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){this.value=e;let i=this._getOptionId(e),r=vA(i,e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){let i=mL(e);return this._optionMap.has(i)?this._optionMap.get(i):e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=go(n)))(r||n)}})();static \u0275dir=Rn({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){i&1&&I("change",function(l){return r.onChange(l.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Yr([pL]),Wi]})}return n})(),Di=(()=>{class n{_element;_renderer;_select;id;constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){this._select!=null&&(this._select._optionMap.set(this.id,e),this._setElementValue(vA(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(Ne($r),Ne(Gs),Ne(di,9))};static \u0275dir=Rn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),gL={provide:Jl,useExisting:cr(()=>yA),multi:!0};function q3(n,t){return n==null?`${t}`:(typeof t=="string"&&(t=`'${t}'`),t&&typeof t=="object"&&(t="Object"),`${n}: ${t}`.slice(0,50))}function _L(n){return n.split(":")[0]}var yA=(()=>{class n extends df{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){this.value=e;let i;if(Array.isArray(e)){let r=e.map(o=>this._getOptionId(o));i=(o,l)=>{o._setSelected(r.indexOf(l.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{let r=[],o=i.selectedOptions;if(o!==void 0){let l=o;for(let c=0;c<l.length;c++){let f=l[c],p=this._getOptionValue(f.value);r.push(p)}}else{let l=i.options;for(let c=0;c<l.length;c++){let f=l[c];if(f.selected){let p=this._getOptionValue(f.value);r.push(p)}}}this.value=r,e(r)}}_registerOption(e){let i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){let i=_L(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=go(n)))(r||n)}})();static \u0275dir=Rn({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){i&1&&I("change",function(l){return r.onChange(l.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[Yr([gL]),Wi]})}return n})(),Pi=(()=>{class n{_element;_renderer;_select;id;_value;constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){this._select!=null&&(this._value=e,this._setElementValue(q3(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(q3(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(Ne($r),Ne(Gs),Ne(yA,9))};static \u0275dir=Rn({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function xA(n){return typeof n=="number"?n:parseFloat(n)}var tb=(()=>{class n{_validator=gg;_onChange;_enabled;ngOnChanges(e){if(this.inputName in e){let i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):gg,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return e!=null}static \u0275fac=function(i){return new(i||n)};static \u0275dir=Rn({type:n,features:[zs]})}return n})(),vL={provide:Kl,useExisting:cr(()=>tu),multi:!0},tu=(()=>{class n extends tb{max;inputName="max";normalizeInput=e=>xA(e);createValidator=e=>K3(e);static \u0275fac=(()=>{let e;return function(r){return(e||(e=go(n)))(r||n)}})();static \u0275dir=Rn({type:n,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&Ma("max",r._enabled?r.max:null)},inputs:{max:"max"},standalone:!1,features:[Yr([vL]),Wi]})}return n})(),yL={provide:Kl,useExisting:cr(()=>_r),multi:!0},_r=(()=>{class n extends tb{min;inputName="min";normalizeInput=e=>xA(e);createValidator=e=>J3(e);static \u0275fac=(()=>{let e;return function(r){return(e||(e=go(n)))(r||n)}})();static \u0275dir=Rn({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&Ma("min",r._enabled?r.min:null)},inputs:{min:"min"},standalone:!1,features:[Yr([yL]),Wi]})}return n})(),xL={provide:Kl,useExisting:cr(()=>$i),multi:!0};var $i=(()=>{class n extends tb{required;inputName="required";normalizeInput=b0;createValidator=e=>Q3;enabled(e){return e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=go(n)))(r||n)}})();static \u0275dir=Rn({type:n,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,r){i&2&&Ma("required",r._enabled?"":null)},inputs:{required:"required"},standalone:!1,features:[Yr([xL]),Wi]})}return n})();var bA=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=_o({type:n});static \u0275inj=mo({})}return n})(),Yx=class extends Uc{constructor(t,e,i){super(Kx(e),Qx(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){this.controls.push(t),this._registerControl(t),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,i={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,e={}){let i=this._adjustIndex(t);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,i={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),e&&(this.controls.splice(r,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){cA(this,!1,t),t.forEach((i,r)=>{uA(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(t.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,i)=>i._syncPendingControls()?!0:e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(let t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}};function X3(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var Lc=(()=>{class n{useNonNullable=!1;get nonNullable(){let e=new n;return e.useNonNullable=!0,e}group(e,i=null){let r=this._reduceControls(e),o={};return X3(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new ka(r,o)}record(e,i=null){let r=this._reduceControls(e);return new $x(r,i)}control(e,i,r){let o={};return this.useNonNullable?(X3(i)?o=i:(o.validators=i,o.asyncValidators=r),new cf(e,St(Oe({},o),{nonNullable:!0}))):new cf(e,i,r)}array(e,i,r){let o=e.map(l=>this._createControl(l));return new Yx(o,i,r)}_reduceControls(e){let i={};return Object.keys(e).forEach(r=>{i[r]=this._createControl(e[r])}),i}_createControl(e){if(e instanceof cf)return e;if(e instanceof Uc)return e;if(Array.isArray(e)){let i=e[0],r=e.length>1?e[1]:null,o=e.length>2?e[2]:null;return this.control(i,r,o)}else return this.control(e)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Un=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:hf,useValue:e.callSetDisabledState??Tg}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=_o({type:n});static \u0275inj=mo({imports:[bA]})}return n})(),Bc=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:_A,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:hf,useValue:e.callSetDisabledState??Tg}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=_o({type:n});static \u0275inj=mo({imports:[bA]})}return n})();$();$();var Bt={production:!0,apiUrl:"/api"};$();var CA=ya(Na());$();var _i={production:!0,apiUrl:"/api"};var qn=class n{constructor(t,e){this.http=t;this.router=e;this.loadUserFromStorage()}apiUrl=_i.apiUrl||"/api";currentUserSubject=new Ri(null);currentUser$=this.currentUserSubject.asObservable();loadUserFromStorage(){let t=localStorage.getItem("token"),e=localStorage.getItem("user");t&&e&&this.currentUserSubject.next(JSON.parse(e))}login(t,e){return this.http.post(`${this.apiUrl}/auth/login`,{username:t,password:e}).pipe(Ei(i=>{i.token&&(localStorage.setItem("token",i.token),localStorage.setItem("user",JSON.stringify(i.user)),this.currentUserSubject.next(i.user))}))}isLoggedIn(){return this.getToken()!==null}redirectToLogin(){CA.default.fire({icon:"warning",title:"Session Expired",text:"Please log in again to continue.",confirmButtonText:"OK"}).then(()=>{this.router.navigate(["/login"])})}logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),this.currentUserSubject.next(null),this.router.navigate(["/login"])}getToken(){return localStorage.getItem("token")}getCurrentUser(){let t=localStorage.getItem("user");return t?JSON.parse(t):null}isAuthenticated(){return!!this.getToken()}getAuthHeaders(){let t=this.getToken();return t?new Xr({Authorization:`Bearer ${t}`,"Content-Type":"application/json"}):new Xr({"Content-Type":"application/json"})}static \u0275fac=function(e){return new(e||n)(We(pn),We(ei))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})};var Dg=class n{constructor(t,e){this.http=t;this.authService=e}apiUrl=`${Bt.apiUrl}/count`;getClassesNumber(){return this.http.get(`${this.apiUrl}/classes`,{headers:this.authService.getAuthHeaders()})}getStudentsNumber(){return this.http.get(`${this.apiUrl}/students`,{headers:this.authService.getAuthHeaders()})}getTeachersNumber(){return this.http.get(`${this.apiUrl}/teachers`,{headers:this.authService.getAuthHeaders()})}static \u0275fac=function(e){return new(e||n)(We(pn),We(qn))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})};var Pg=class n{constructor(t){this.countService=t}studentCount=0;teacherCount=0;lessonCount=0;userName="\u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645";userRole="\u0627\u0644\u062F\u0648\u0631";userAvatar="https://ui-avatars.com/api/?name=User&background=random";notificationCount=3;searchTerm;ngOnInit(){this.loadStats(),this.loadUserData()}loadStats(){Fs({students:this.countService.getStudentsNumber(),teachers:this.countService.getTeachersNumber(),classes:this.countService.getClassesNumber()}).subscribe(t=>{this.studentCount=t.students.count,this.teacherCount=t.teachers.count,this.lessonCount=t.classes.count})}loadUserData(){setTimeout(()=>{this.userName="\u064A\u0627\u0633\u0631 \u062E\u064A\u0634\u0647",this.userRole="\u0645\u062F\u064A\u0631 \u0627\u0644\u0646\u0638\u0627\u0645",this.userAvatar="https://ui-avatars.com/api/?name=\u0623\u062D\u0645\u062F+\u0645\u062D\u0645\u062F&background=0D8ABC&color=fff"},800)}static \u0275fac=function(e){return new(e||n)(Ne(Dg))};static \u0275cmp=nn({type:n,selectors:[["app-header"]],decls:28,vars:7,consts:[[1,"glass-header"],[1,"stats-container"],[1,"stat-item"],[1,"bi","bi-people"],[1,"bi","bi-person-video3"],[1,"bi","bi-journal-bookmark"],[1,"search-container",2,"position","relative","width","200px","height","40px","margin-right","10px","margin-left","10px","margin-top","10px","margin-bottom","10px"],["type","text","placeholder","\u0627\u0628\u062D\u062B",2,"width","100%","height","100%","padding-left","35px","border-radius","20px","border","1px solid #ccc","outline","none",3,"ngModelChange","ngModel"],[1,"bi","bi-search",2,"display","inline-block","position","absolute","top","50%","left","10px","transform","translateY(-50%)","color","#999"],[1,"logo"],[1,"bi","bi-people-fill"],[1,"user-actions"],[1,"notification-badge"],[1,"bi","bi-bell"],[1,"dot"],[1,"profile-pill"],["alt","Avatar",3,"src"]],template:function(e,i){e&1&&(s(0,"header",0)(1,"div",1)(2,"div",2),b(3,"i",3),s(4,"span"),u(5),a()(),s(6,"div",2),b(7,"i",4),s(8,"span"),u(9),a()(),s(10,"div",2),b(11,"i",5),s(12,"span"),u(13),a()()(),s(14,"div",6)(15,"input",7),ye("ngModelChange",function(o){return Ce(i.searchTerm,o)||(i.searchTerm=o),o}),a(),b(16,"i",8),a(),s(17,"div",9),b(18,"i",10),a(),s(19,"div",11)(20,"div",12),b(21,"i",13),s(22,"span",14),u(23),a()(),s(24,"div",15)(25,"span"),u(26),a(),b(27,"img",16),a()()()),e&2&&(d(5),H("",i.studentCount," \u0637\u0627\u0644\u0628"),d(4),H("",i.teacherCount," \u0623\u0633\u062A\u0627\u0630"),d(4),H("",i.lessonCount," \u062D\u0635\u0629"),d(2),ve("ngModel",i.searchTerm),d(8),B(i.notificationCount),d(3),B(i.userName),d(),w("src",i.userAvatar,rm))},dependencies:[hn,Un,Yn,ii,ti],styles:['@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}[_nghost-%COMP%]{display:block;font-family:Cairo,sans-serif}.glass-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;height:70px;padding:0 30px;background:#fffffff2;backdrop-filter:blur(15px) saturate(180%);-webkit-backdrop-filter:blur(15px) saturate(180%);border-bottom:1px solid rgba(255,255,255,.2);box-shadow:0 8px 32px #00000014,inset 0 1px #fffc;position:sticky;top:0;z-index:1000;transition:all .3s cubic-bezier(.4,0,.2,1)}.glass-header[_ngcontent-%COMP%]:hover{background:#fffffffa}.stats-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;flex:1}.stats-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:10px 18px;background:#4361ee14;border-radius:20px;border:1.5px solid rgba(67,97,238,.15);transition:all .3s ease;cursor:default;position:relative;overflow:hidden}.stats-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,rgba(67,97,238,.1),transparent);opacity:0;transition:opacity .3s ease}.stats-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px);border-color:#4361ee4d;box-shadow:0 6px 20px #4361ee26}.stats-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:hover:before{opacity:1}.stats-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.3rem;color:#4361ee;filter:drop-shadow(0 2px 4px rgba(67,97,238,.3));transition:transform .3s ease}.stats-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1)}.stats-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;font-size:.95rem;letter-spacing:-.3px;position:relative;z-index:1}.search-container[_ngcontent-%COMP%]{position:relative;width:260px;margin:0 20px;flex-shrink:0}.search-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:42px;padding:0 20px 0 46px;background:#f1f5f9b3;border:2px solid transparent;border-radius:21px;font-size:.95rem;font-family:Cairo,sans-serif;color:#334155;transition:all .3s cubic-bezier(.4,0,.2,1);outline:none}.search-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:#fff;border-color:#4361ee;box-shadow:0 0 0 4px #4361ee1a,0 4px 12px #4361ee26;padding-right:24px}.search-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#94a3b8;font-weight:400}.search-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover:not(:focus){background:#f1f5f9e6;border-color:#94a3b84d}.search-container[_ngcontent-%COMP%]   .bi-search[_ngcontent-%COMP%]{position:absolute;left:18px;top:50%;transform:translateY(-50%);color:#94a3b8;font-size:1.1rem;pointer-events:none;transition:color .3s ease}.search-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + .bi-search[_ngcontent-%COMP%]{color:#4361ee}.logo[_ngcontent-%COMP%]{width:52px;height:52px;background:linear-gradient(135deg,#4361ee,#3a0ca3);border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0;margin:0 20px;box-shadow:0 6px 20px #4361ee4d,inset 0 2px 4px #ffffff4d;transition:all .4s cubic-bezier(.34,1.56,.64,1);cursor:pointer;position:relative;overflow:hidden}.logo[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:-2px;background:linear-gradient(45deg,#4361ee,#3a0ca3,#4361ee,#7209b7,#3a0ca3,#4361ee);background-size:400% 400%;border-radius:50%;z-index:-1;animation:_ngcontent-%COMP%_gradientShift 3s ease infinite;opacity:0;transition:opacity .3s ease}.logo[_ngcontent-%COMP%]:hover{transform:scale(1.1) rotate(15deg);box-shadow:0 12px 32px #4361ee66,inset 0 2px 4px #fff6}.logo[_ngcontent-%COMP%]:hover:before{opacity:1}.logo[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#fff;font-size:1.6rem;filter:drop-shadow(0 2px 4px rgba(0,0,0,.2));transition:transform .4s ease}.logo[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1)}@keyframes _ngcontent-%COMP%_gradientShift{0%{background-position:0% 50%}50%{background-position:100% 50%}to{background-position:0% 50%}}.user-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;flex:1;justify-content:flex-end}.user-actions[_ngcontent-%COMP%]   .notification-badge[_ngcontent-%COMP%]{position:relative;cursor:pointer;transition:transform .3s ease}.user-actions[_ngcontent-%COMP%]   .notification-badge[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.user-actions[_ngcontent-%COMP%]   .notification-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.4rem;color:#475569;transition:color .3s ease}.user-actions[_ngcontent-%COMP%]   .notification-badge[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{color:#4361ee}.user-actions[_ngcontent-%COMP%]   .notification-badge[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{position:absolute;top:-6px;right:-6px;width:20px;height:20px;background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;border-radius:50%;font-size:.7rem;font-weight:700;display:flex;align-items:center;justify-content:center;border:2px solid white;box-shadow:0 2px 8px #ef444466;animation:_ngcontent-%COMP%_pulse 2s infinite}.profile-pill[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:8px 20px 8px 8px;background:linear-gradient(135deg,#4361ee1a,#7877c60d);border-radius:30px;border:2px solid rgba(67,97,238,.15);transition:all .4s cubic-bezier(.4,0,.2,1);cursor:pointer;position:relative;overflow:hidden}.profile-pill[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,rgba(67,97,238,.2),transparent);opacity:0;transition:opacity .3s ease}.profile-pill[_ngcontent-%COMP%]:hover{transform:translateY(-2px);border-color:#4361ee;box-shadow:0 8px 24px #4361ee33,inset 0 1px #ffffff4d}.profile-pill[_ngcontent-%COMP%]:hover:before{opacity:1}.profile-pill[_ngcontent-%COMP%]:active{transform:translateY(0)}.profile-pill[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;font-size:.95rem;position:relative;z-index:1;transition:color .3s ease}.profile-pill[_ngcontent-%COMP%]:hover   span[_ngcontent-%COMP%]{color:#4361ee}.profile-pill[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:38px;height:38px;border-radius:50%;object-fit:cover;border:2px solid white;box-shadow:0 4px 12px #00000026,inset 0 2px 4px #ffffff80;transition:all .3s ease;position:relative;z-index:1}.profile-pill[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{transform:scale(1.05);border-color:#4361ee}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1);box-shadow:0 2px 8px #ef444466}50%{transform:scale(1.1);box-shadow:0 4px 16px #ef444499}to{transform:scale(1);box-shadow:0 2px 8px #ef444466}}@media (max-width: 1200px){.stats-container[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.9rem}.search-container[_ngcontent-%COMP%]{width:220px}}@media (max-width: 992px){.glass-header[_ngcontent-%COMP%]{padding:0 20px}.stats-container[_ngcontent-%COMP%]{display:none}.search-container[_ngcontent-%COMP%]{flex:1;max-width:240px;margin:0 15px}}@media (max-width: 768px){.glass-header[_ngcontent-%COMP%]{height:65px;padding:0 16px}.search-container[_ngcontent-%COMP%]{display:none}.user-actions[_ngcontent-%COMP%]{gap:15px}.user-actions[_ngcontent-%COMP%]   .profile-pill[_ngcontent-%COMP%]{padding:6px}.user-actions[_ngcontent-%COMP%]   .profile-pill[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:none}.logo[_ngcontent-%COMP%]{width:46px;height:46px;margin:0 10px}.logo[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.4rem}}@media (max-width: 480px){.glass-header[_ngcontent-%COMP%]{padding:0 12px}.logo[_ngcontent-%COMP%]{display:none}.user-actions[_ngcontent-%COMP%]   .notification-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.3rem}.user-actions[_ngcontent-%COMP%]   .notification-badge[_ngcontent-%COMP%]   .dot[_ngcontent-%COMP%]{width:18px;height:18px;font-size:.65rem}}@media (prefers-color-scheme: dark){.glass-header[_ngcontent-%COMP%]{background:#0f172af2;border-bottom:1px solid rgba(255,255,255,.1);box-shadow:0 8px 32px #0000004d,inset 0 1px #ffffff0d}.stat-item[_ngcontent-%COMP%]{background:#4361ee26!important;border-color:#4361ee40!important}.stat-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#e2e8f0!important}.search-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:#1e293bb3;color:#f1f5f9}.search-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{background:#1e293bf2}.search-container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#94a3b8}.profile-pill[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4361ee33,#7877c61a)!important}.profile-pill[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#e2e8f0!important}.user-actions[_ngcontent-%COMP%]   .notification-badge[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#cbd5e1}}']})};$();function CL(n,t){if(n&1){let e=he();s(0,"div",15),I("click",function(){F(e);let r=E();return R(r.closeSidebar())}),b(1,"i",16),a()}}function EL(n,t){if(n&1){let e=he();s(0,"i",17),I("click",function(){F(e);let r=E();return R(r.toggleCollapsed())}),a()}}function wL(n,t){if(n&1&&(s(0,"span",25),u(1),a()),n&2){let e=E().$implicit;d(),B(e.notification)}}function SL(n,t){n&1&&b(0,"i",26)}function ML(n,t){if(n&1){let e=he();s(0,"li")(1,"a",29),I("click",function(){let r=F(e).$implicit,o=E(2).$implicit,l=E();return R(l.navigateTo(r.route,o.id))}),u(2),a()()}if(n&2){let e=t.$implicit;d(2),B(e.label)}}function AL(n,t){if(n&1&&(s(0,"ul",27),j(1,ML,3,1,"li",28),a()),n&2){let e=E().$implicit;d(),w("ngForOf",e.subItems)}}function TL(n,t){if(n&1){let e=he();s(0,"li",18)(1,"a",19),I("click",function(){let r=F(e).$implicit,o=E();return R(o.navigateTo(r.route,r.id))}),s(2,"div",20),b(3,"i"),j(4,wL,2,1,"span",21),a(),s(5,"span",22),u(6),a(),j(7,SL,1,0,"i",23),a(),j(8,AL,2,1,"ul",24),a()}if(n&2){let e=t.$implicit,i=E();d(),Ie("active",i.activeSection===e.id),w("title",e.label),d(2),SS("bi ",e.icon,""),d(),w("ngIf",e.notification),d(),Ie("collapsed",i.collapsed),d(),B(e.label),d(),w("ngIf",e.subItems),d(),w("ngIf",e.subItems)}}function DL(n,t){n&1&&(s(0,"div",30),b(1,"i",31),a())}var Ig=class n{constructor(t){this.router=t}isMobile=!1;sidebarClosed=new oi;collapsed=!1;activeSection="dashboard";hoveredItem=null;userName="Yasser";userRole="\u0645\u062F\u064A\u0631 \u0627\u0644\u0646\u0638\u0627\u0645";userAvatar="https://ui-avatars.com/api/?name=\u0623\u062D\u0645\u062F+\u0645\u062D\u0645\u062F&background=0D8ABC&color=fff";menuItems=[{id:"dashboard",icon:"bi-speedometer2",label:"\u0644\u0648\u062D\u0629 \u0627\u0644\u062A\u062D\u0643\u0645",route:"/home/dashboard",notification:3},{id:"live-classes",icon:"bi-camera-video",label:"\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u062D\u064A\u0629",route:"/home/live-class"},{id:"students",icon:"bi-people",label:"\u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0637\u0644\u0627\u0628",route:"/home/students-management",subItems:[{label:"\u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0637\u0644\u0627\u0628",route:"/home/students-management"},{label:"\u062D\u0633\u0627\u0628\u0627\u062A \u0627\u0644\u0637\u0644\u0627\u0628",route:"/home/students-accounts"},{label:"\u0637\u0644\u0628\u0627\u062A \u0627\u0644\u062A\u0633\u062C\u064A\u0644",route:"/home/registration-requests"}]},{id:"teachers",icon:"bi-person-video3",label:"\u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629",route:"/home/teachers-management"},{id:"classes",icon:"bi-book",label:"\u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u062D\u0635\u0635",route:"/home/lesson-management"},{id:"classrooms",icon:"bi-building",label:"\u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0642\u0627\u0639\u0627\u062A",route:"/home/rooms-management"},{id:"payments",icon:"bi-cash-coin",label:"\u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A",route:"/home/payments-management",notification:5},{id:"cards",icon:"bi-credit-card",label:"\u0627\u0644\u0628\u0637\u0627\u0642\u0627\u062A",route:"/home/cards-management"},{id:"gate-interface",icon:"bi-door-open",label:"\u0648\u0627\u062C\u0647\u0629 \u0627\u0644\u0645\u062F\u062E\u0644",route:"/home/gate-interface"},{id:"settings",icon:"bi-gear",label:"\u0627\u0644\u0625\u0639\u062F\u0627\u062F\u0627\u062A",route:"/home/settings",subItems:[{label:"\u0627\u0644\u0625\u0639\u062F\u0627\u062F\u0627\u062A \u0627\u0644\u0639\u0627\u0645\u0629",route:"/home/settings/general"},{label:"\u0635\u0644\u0627\u062D\u064A\u0627\u062A \u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645\u064A\u0646",route:"/home/settings/permissions"},{label:"\u0646\u0633\u062E \u0627\u062D\u062A\u064A\u0627\u0637\u064A",route:"/home/settings/backup"}]}];ngOnInit(){this.setActiveFromRoute(),this.checkScreenSize()}onResize(){this.checkScreenSize()}checkScreenSize(){this.isMobile=window.innerWidth<=768,this.isMobile||(this.collapsed=!1)}setActiveFromRoute(){let t=this.router.url,e=this.menuItems.find(i=>t.includes(i.route)||i.subItems&&i.subItems.some(r=>t.includes(r.route)));e&&(this.activeSection=e.id)}toggleCollapsed(){this.isMobile||(this.collapsed=!this.collapsed)}navigateTo(t,e){this.activeSection=e,this.router.navigate([t]).then(()=>{this.isMobile&&this.closeSidebar()})}closeSidebar(){this.sidebarClosed.emit()}logout(){this.router.navigate(["/login"])}onItemHover(t){this.collapsed&&!this.isMobile&&(this.hoveredItem=t)}onItemLeave(){this.hoveredItem=null}static \u0275fac=function(e){return new(e||n)(Ne(ei))};static \u0275cmp=nn({type:n,selectors:[["app-nav-bar"]],hostBindings:function(e,i){e&1&&I("resize",function(){return i.onResize()},!1,as)},inputs:{isMobile:"isMobile"},outputs:{sidebarClosed:"sidebarClosed"},decls:19,vars:12,consts:[[1,"sidebar"],["class","mobile-close-btn",3,"click",4,"ngIf"],[1,"user-info-compact"],[1,"user-avatar",3,"src","alt"],[1,"user-details"],[1,"user-name"],[1,"user-role"],["class","bi bi-chevron-left toggle-icon",3,"click",4,"ngIf"],[1,"nav-menu"],[1,"nav-list"],["class","nav-item",4,"ngFor","ngForOf"],[1,"logout-section"],[1,"logout-btn",3,"click"],[1,"bi","bi-box-arrow-left"],["class","mini-logo",4,"ngIf"],[1,"mobile-close-btn",3,"click"],[1,"bi","bi-x-lg"],[1,"bi","bi-chevron-left","toggle-icon",3,"click"],[1,"nav-item"],[1,"nav-link",3,"click","title"],[1,"nav-icon"],["class","notification-badge",4,"ngIf"],[1,"nav-label"],["class","bi bi-chevron-left arrow",4,"ngIf"],["class","sub-menu",4,"ngIf"],[1,"notification-badge"],[1,"bi","bi-chevron-left","arrow"],[1,"sub-menu"],[4,"ngFor","ngForOf"],[3,"click"],[1,"mini-logo"],[1,"bi","bi-building"]],template:function(e,i){e&1&&(s(0,"div",0),j(1,CL,2,0,"div",1),s(2,"div",2),b(3,"img",3),s(4,"div",4)(5,"p",5),u(6),a(),s(7,"small",6),u(8),a()(),j(9,EL,1,0,"i",7),a(),s(10,"div",8)(11,"ul",9),j(12,TL,9,12,"li",10),a()(),s(13,"div",11)(14,"a",12),I("click",function(){return i.logout()}),b(15,"i",13),s(16,"span"),u(17,"\u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062E\u0631\u0648\u062C"),a()()(),j(18,DL,2,0,"div",14),a()),e&2&&(Ie("mobile-open",i.isMobile),d(),w("ngIf",i.isMobile),d(2),w("src",i.userAvatar,rm)("alt",i.userName),d(3),B(i.userName),d(2),B(i.userRole),d(),w("ngIf",!i.isMobile),d(3),w("ngForOf",i.menuItems),d(4),Ie("collapsed",i.collapsed),d(2),w("ngIf",i.collapsed&&!i.isMobile))},dependencies:[hn,Nn,An],styles:['@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}[_nghost-%COMP%]{display:block;font-family:Cairo,sans-serif}.sidebar[_ngcontent-%COMP%]{position:fixed;top:70px;right:0;bottom:0;width:280px;background:linear-gradient(180deg,#0f172afa,#1e293bfa);backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%);color:#fff;overflow-x:hidden;overflow-y:auto;z-index:999;border-left:1px solid rgba(255,255,255,.1);box-shadow:-8px 0 32px #0000004d,inset 1px 0 #ffffff0d;transition:all .4s cubic-bezier(.4,0,.2,1)}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#ffffff0d;border-radius:3px}.sidebar[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#4361ee80;border-radius:3px}[_ngcontent-%COMP%]:is():hover{background:#4361eeb3}.sidebar.collapsed[_ngcontent-%COMP%]{width:80px}.sidebar.collapsed[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%], .sidebar.collapsed[_ngcontent-%COMP%]   .user-role[_ngcontent-%COMP%], .sidebar.collapsed[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%], .sidebar.collapsed[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .sidebar.collapsed[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%], .sidebar.collapsed[_ngcontent-%COMP%]   .sub-menu[_ngcontent-%COMP%]{opacity:0!important;visibility:hidden!important;transform:translate(20px)!important;width:0!important;height:0!important;overflow:hidden!important}.sidebar.collapsed[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{justify-content:center;padding:16px 0!important}.sidebar.collapsed[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]{margin:0!important}.sidebar.collapsed[_ngcontent-%COMP%]   .user-info-compact[_ngcontent-%COMP%]{padding:20px 0!important;justify-content:center}.sidebar.collapsed[_ngcontent-%COMP%]   .user-avatar[_ngcontent-%COMP%]{width:40px!important;height:40px!important}.sidebar.collapsed[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]{justify-content:center;padding:16px 0!important}.sidebar.collapsed[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin:0!important}.mobile-close-btn[_ngcontent-%COMP%]{position:absolute;top:15px;left:15px;width:36px;height:36px;background:#ef444433;border-radius:10px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;z-index:1001;display:none}.mobile-close-btn[_ngcontent-%COMP%]:hover{background:#ef44444d;transform:rotate(90deg) scale(1.1)}.mobile-close-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#ef4444;font-size:1.2rem;transition:transform .3s ease}.mobile-close-btn[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:scale(1.1)}.user-info-compact[_ngcontent-%COMP%]{padding:25px 20px;border-bottom:1px solid rgba(255,255,255,.1);display:flex;align-items:center;gap:15px;transition:padding .3s ease;position:relative;overflow:hidden}.user-info-compact[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(90deg,rgba(67,97,238,.1),transparent);opacity:0;transition:opacity .3s ease}.user-info-compact[_ngcontent-%COMP%]:hover:before{opacity:1}.user-info-compact[_ngcontent-%COMP%]   .user-avatar[_ngcontent-%COMP%]{width:50px;height:50px;border-radius:50%;object-fit:cover;border:3px solid #4361ee;box-shadow:0 4px 15px #4361ee66,inset 0 2px 4px #fff3;transition:all .4s cubic-bezier(.34,1.56,.64,1);flex-shrink:0;z-index:1}.user-info-compact[_ngcontent-%COMP%]   .user-avatar[_ngcontent-%COMP%]:hover{transform:scale(1.1) rotate(5deg);border-color:#4cc9f0;box-shadow:0 6px 25px #4361ee99,inset 0 2px 4px #ffffff4d}.user-info-compact[_ngcontent-%COMP%]   .user-details[_ngcontent-%COMP%]{flex:1;overflow:hidden;z-index:1}.user-info-compact[_ngcontent-%COMP%]   .user-details[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%]{font-weight:600;font-size:1rem;color:#fff;margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:transform .3s ease}.user-info-compact[_ngcontent-%COMP%]   .user-details[_ngcontent-%COMP%]   .user-role[_ngcontent-%COMP%]{font-size:.85rem;color:#ffffffb3;background:#ffffff1a;padding:3px 10px;border-radius:12px;display:inline-block;transition:all .3s ease}.user-info-compact[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]{color:#fff9;cursor:pointer;font-size:1.1rem;transition:all .4s cubic-bezier(.4,0,.2,1);flex-shrink:0;z-index:1}.user-info-compact[_ngcontent-%COMP%]   .toggle-icon[_ngcontent-%COMP%]:hover{color:#fff;transform:rotate(-90deg) scale(1.2)}.nav-menu[_ngcontent-%COMP%]{padding:20px 0;flex:1}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{position:relative}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]:hover > .nav-link[_ngcontent-%COMP%]{background:#4361ee33;padding-right:25px}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]:hover > .nav-link[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{transform:rotate(90deg)}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]:hover > .sub-menu[_ngcontent-%COMP%]{opacity:1;visibility:visible;transform:translate(0)}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px 24px;color:#fffc;text-decoration:none;transition:all .3s cubic-bezier(.4,0,.2,1);cursor:pointer;position:relative;border-right:3px solid transparent;margin:4px 0}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover{color:#fff;background:#4361ee26}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover   .nav-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transform:scale(1.1)}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover   .nav-label[_ngcontent-%COMP%]{transform:translate(-5px)}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{background:linear-gradient(90deg,rgba(67,97,238,.25),transparent);color:#fff;border-right-color:#4361ee}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#4cc9f0;text-shadow:0 0 15px rgba(76,201,240,.5)}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%]{font-weight:600}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]{position:relative;margin-left:15px;flex-shrink:0}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.3rem;color:#ffffffe6;transition:all .3s ease}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   .nav-icon[_ngcontent-%COMP%]   .notification-badge[_ngcontent-%COMP%]{position:absolute;top:-8px;left:-8px;background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;font-size:.7rem;min-width:20px;height:20px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;border:2px solid #1e293b;box-shadow:0 3px 10px #ef444466;animation:_ngcontent-%COMP%_pulse 2s infinite}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%]{flex:1;font-size:.95rem;font-weight:500;transition:all .3s ease;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.nav-menu[_ngcontent-%COMP%]   .nav-list[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]   .arrow[_ngcontent-%COMP%]{font-size:.9rem;color:#ffffff80;transition:transform .3s ease;margin-right:auto}.sub-menu[_ngcontent-%COMP%]{position:absolute;right:calc(100% + 5px);top:0;background:#1e293bfa;backdrop-filter:blur(20px);border-radius:16px;box-shadow:0 10px 40px #0006,0 0 0 1px #ffffff1a;min-width:220px;z-index:1000;opacity:0;visibility:hidden;transform:translate(-10px);transition:all .3s cubic-bezier(.4,0,.2,1);overflow:hidden}.sub-menu[_ngcontent-%COMP%]:before{content:"";position:absolute;right:-5px;top:24px;border-left:5px solid rgba(30,41,59,.98);border-top:5px solid transparent;border-bottom:5px solid transparent;filter:drop-shadow(2px 0 2px rgba(0,0,0,.2))}.sub-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:first-child   a[_ngcontent-%COMP%]{border-radius:16px 16px 0 0}.sub-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:last-child   a[_ngcontent-%COMP%]{border-radius:0 0 16px 16px}.sub-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{display:block;padding:14px 20px;color:#fffc;text-decoration:none;transition:all .3s ease;border-left:3px solid transparent;font-size:.9rem}.sub-menu[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{background:#4361ee33;color:#fff;padding-right:25px;border-left-color:#4cc9f0}.logout-section[_ngcontent-%COMP%]{padding:20px;border-top:1px solid rgba(255,255,255,.1);margin-top:auto;position:sticky;bottom:0;background:#0f172ae6;backdrop-filter:blur(10px)}.logout-section[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:16px 20px;background:linear-gradient(135deg,rgba(239,68,68,.2),transparent);color:#ef4444e6;border-radius:16px;cursor:pointer;transition:all .4s cubic-bezier(.4,0,.2,1);border:2px solid rgba(239,68,68,.2);position:relative;overflow:hidden}.logout-section[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(135deg,rgba(239,68,68,.3),transparent);opacity:0;transition:opacity .3s ease}.logout-section[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,rgba(239,68,68,.3),transparent);border-color:#ef444466;transform:translate(-5px);color:#fff}.logout-section[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]:hover:before{opacity:1}.logout-section[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]:hover   i[_ngcontent-%COMP%]{transform:translate(-5px)}.logout-section[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem;transition:transform .3s ease;z-index:1}.logout-section[_ngcontent-%COMP%]   .logout-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;font-weight:600;font-size:.95rem;transition:all .3s ease;z-index:1}.mini-logo[_ngcontent-%COMP%]{position:absolute;bottom:90px;right:50%;transform:translate(50%);color:#4361ee99;font-size:1.8rem;text-align:center;transition:all .3s ease;cursor:default}.mini-logo[_ngcontent-%COMP%]:hover{color:#4361ee;transform:translate(50%) scale(1.1)}@media (max-width: 768px){.sidebar[_ngcontent-%COMP%]{top:0;width:280px;transform:translate(100%);z-index:1100}.sidebar.mobile-open[_ngcontent-%COMP%]{transform:translate(0)}.mobile-close-btn[_ngcontent-%COMP%]{display:flex}.nav-menu[_ngcontent-%COMP%]{padding:15px 0}.logout-section[_ngcontent-%COMP%]{position:relative;margin-top:20px}}@media (max-width: 480px){.sidebar[_ngcontent-%COMP%]{width:100%}.user-info-compact[_ngcontent-%COMP%]{padding:20px 15px}.user-info-compact[_ngcontent-%COMP%]   .user-avatar[_ngcontent-%COMP%]{width:45px;height:45px}.nav-list[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{padding:14px 20px}}@media (prefers-color-scheme: light){.sidebar[_ngcontent-%COMP%]{background:linear-gradient(180deg,#fffffffa,#f8fafcfa);color:#1e293b;border-left:1px solid rgba(0,0,0,.1)}.sidebar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]{color:#475569}.sidebar[_ngcontent-%COMP%]   .nav-link[_ngcontent-%COMP%]:hover, .sidebar[_ngcontent-%COMP%]   .nav-link.active[_ngcontent-%COMP%]{color:#1e293b;background:#4361ee14}.sidebar[_ngcontent-%COMP%]   .sub-menu[_ngcontent-%COMP%]{background:#fffffffa;color:#1e293b}.sidebar[_ngcontent-%COMP%]   .sub-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#475569}.sidebar[_ngcontent-%COMP%]   .sub-menu[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#1e293b}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.1)}}']})};function PL(n,t){if(n&1){let e=he();s(0,"div",8),I("click",function(){F(e);let r=E();return R(r.toggleSidebar())}),b(1,"i",9),a()}if(n&2){let e=E();d(),Ie("bi-list",!e.sidebarOpen)("bi-x",e.sidebarOpen)}}var Og=class n{sidebarOpen=!1;isMobile=!1;ngOnInit(){this.checkScreenSize(),this.setupKeyboardListeners()}onResize(t){this.checkScreenSize()}onKeyDown(t){t.key==="Escape"&&this.sidebarOpen&&this.isMobile&&this.closeSidebar()}checkScreenSize(){this.isMobile=window.innerWidth<=768,!this.isMobile&&this.sidebarOpen&&this.closeSidebar()}setupKeyboardListeners(){document.addEventListener("keydown",t=>{(t.ctrlKey||t.metaKey)&&t.key==="m"&&(t.preventDefault(),this.toggleSidebar())})}toggleSidebar(){this.sidebarOpen=!this.sidebarOpen,this.updateBodyScroll(),this.playClickSound()}closeSidebar(){this.sidebarOpen=!1,this.updateBodyScroll()}updateBodyScroll(){this.isMobile&&(this.sidebarOpen?document.body.classList.add("no-scroll"):document.body.classList.remove("no-scroll"))}playClickSound(){}isLandscape(){return window.innerWidth>window.innerHeight&&this.isMobile}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=nn({type:n,selectors:[["app-home"]],hostBindings:function(e,i){e&1&&I("resize",function(o){return i.onResize(o)},!1,as)("keydown",function(o){return i.onKeyDown(o)},!1,as)},decls:9,vars:6,consts:[[1,"app-container"],[1,"app-header"],[1,"main-content"],["class","mobile-menu-toggle",3,"click",4,"ngIf"],[1,"app-sidebar",3,"sidebarClosed","isMobile"],[1,"mobile-overlay",3,"click"],[1,"content-area"],[1,"page-content"],[1,"mobile-menu-toggle",3,"click"],[1,"bi"]],template:function(e,i){e&1&&(s(0,"div",0),b(1,"app-header",1),s(2,"div",2),j(3,PL,2,4,"div",3),s(4,"app-nav-bar",4),I("sidebarClosed",function(){return i.closeSidebar()}),a(),s(5,"div",5),I("click",function(){return i.closeSidebar()}),a(),s(6,"main",6)(7,"div",7),b(8,"router-outlet"),a()()()()),e&2&&(d(3),w("ngIf",i.isMobile),d(),Ie("sidebar-open",i.sidebarOpen),w("isMobile",i.isMobile),d(),Ie("active",i.sidebarOpen&&i.isMobile))},dependencies:[hn,An,qs,Yl,Pg,Ig],styles:['.app-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100vh;background:linear-gradient(135deg,#667eea,#764ba2);position:relative;overflow:hidden}.app-container[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:radial-gradient(circle at 20% 80%,rgba(120,119,198,.2) 0%,transparent 50%),radial-gradient(circle at 80% 20%,rgba(255,119,198,.2) 0%,transparent 50%);pointer-events:none}.main-content[_ngcontent-%COMP%]{display:flex;flex:1;position:relative;padding-top:70px}.mobile-menu-toggle[_ngcontent-%COMP%]{display:none;position:fixed;bottom:30px;right:30px;z-index:1000;width:56px;height:56px;background:linear-gradient(135deg,#4361ee,#3a0ca3);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;cursor:pointer;box-shadow:0 8px 25px #4361ee66,inset 0 2px 4px #fff3;transition:all .4s cubic-bezier(.34,1.56,.64,1)}.mobile-menu-toggle[_ngcontent-%COMP%]:hover{transform:scale(1.1) rotate(180deg);box-shadow:0 12px 35px #4361ee99,inset 0 2px 4px #ffffff4d}.mobile-menu-toggle[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem;transition:transform .3s ease}@media (max-width: 768px){.mobile-menu-toggle[_ngcontent-%COMP%]{display:flex}}.mobile-overlay[_ngcontent-%COMP%]{display:none}@media (max-width: 768px){.mobile-overlay[_ngcontent-%COMP%]{display:block;position:fixed;inset:0;background:#000000b3;backdrop-filter:blur(5px);z-index:900;opacity:0;visibility:hidden;transition:all .3s ease}.mobile-overlay.active[_ngcontent-%COMP%]{opacity:1;visibility:visible}}.content-area[_ngcontent-%COMP%]{flex:1;padding:0;margin:0 280px 0 0;overflow-y:auto;background:#f8fafc;transition:margin-right .4s cubic-bezier(.4,0,.2,1);min-height:calc(100vh - 70px);width:100%}.content-area.sidebar-collapsed[_ngcontent-%COMP%]{margin-right:80px}@media (max-width: 768px){.content-area[_ngcontent-%COMP%]{margin-right:0;padding:20px}}.page-content[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;width:100%;animation:_ngcontent-%COMP%_fadeIn .5s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}']})};$();var ps=ya(Na());function IL(n,t){n&1&&(s(0,"span"),u(1,"\u062F\u062E\u0648\u0644 \u0627\u0644\u0646\u0638\u0627\u0645"),a())}function OL(n,t){n&1&&b(0,"div",30)}var Fg=class n{constructor(t){this.router=t}apiUrl=_i.apiUrl;username="";password="";rememberMe=!1;currentYear=new Date().getFullYear();isLoading=!1;passwordFieldType="password";ngOnInit(){this.loadRememberedUser()}loadRememberedUser(){let t=localStorage.getItem("rememberedUser");if(t)try{let e=JSON.parse(t);e.rememberMe&&(this.username=e.username,this.rememberMe=!0)}catch{localStorage.removeItem("rememberedUser")}}togglePasswordVisibility(){this.passwordFieldType=this.passwordFieldType==="password"?"text":"password"}login(){return wt(this,null,function*(){if(!this.isFormValid()){ps.default.fire({title:"\u062E\u0637\u0623",text:"\u064A\u0631\u062C\u0649 \u0625\u0643\u0645\u0627\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A",icon:"error",confirmButtonColor:"#0a66c2"});return}this.isLoading=!0;try{let t=yield fetch(`${this.apiUrl}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username.trim(),password:this.password})}),e=yield t.json();t.ok&&e.token?(localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(e.user)),this.rememberMe?localStorage.setItem("rememberedUser",JSON.stringify({username:this.username.trim(),rememberMe:!0})):localStorage.removeItem("rememberedUser"),yield ps.default.fire({title:"\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644",text:"\u062C\u0627\u0631\u064A \u062A\u062D\u0648\u064A\u0644\u0643 \u0625\u0644\u0649 \u0645\u062F\u0631\u0633\u0629 \u0627\u0644\u0631\u0648\u0627\u062F...",icon:"success",timer:1500,showConfirmButton:!1}),this.router.navigate(["/home/lesson-management"])):ps.default.fire({title:"\u0641\u0634\u0644 \u0627\u0644\u062F\u062E\u0648\u0644",text:e.message||"\u0628\u064A\u0627\u0646\u0627\u062A \u063A\u064A\u0631 \u0635\u062D\u064A\u062D\u0629",icon:"error"})}catch{ps.default.fire({title:"\u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u0627\u062A\u0635\u0627\u0644",text:"\u064A\u0631\u062C\u0649 \u0627\u0644\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0625\u0646\u062A\u0631\u0646\u062A",icon:"error"})}finally{this.isLoading=!1}})}onUsernameKeyPress(t){t.key==="Enter"&&document.getElementById("password")?.focus()}l;onPasswordKeyPress(t){t.key==="Enter"&&this.login()}forgotPassword(){ps.default.fire({title:"\u0646\u0633\u064A\u062A \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631\u061F",text:"\u064A\u0631\u062C\u0649 \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0625\u062F\u0627\u0631\u0629 \u0645\u062F\u0631\u0633\u0629 \u0627\u0644\u0631\u0648\u0627\u062F \u0644\u0625\u0639\u0627\u062F\u0629 \u062A\u0639\u064A\u064A\u0646 \u062D\u0633\u0627\u0628\u0643.",icon:"info",confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"})}navigateToRegister(){this.router.navigate(["/register"])}isFormValid(){return this.username.trim().length>0&&this.password.length>0}getGreeting(){return new Date().getHours()<12?"\u0635\u0628\u0627\u062D \u0627\u0644\u062E\u064A\u0631":"\u0645\u0633\u0627\u0621 \u0627\u0644\u062E\u064A\u0631"}redirectToAccountingInterface(){return wt(this,null,function*(){if(!this.isFormValid()){ps.default.fire({title:"\u062E\u0637\u0623",text:"\u064A\u0631\u062C\u0649 \u0625\u0643\u0645\u0627\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A",icon:"error",confirmButtonColor:"#0a66c2"});return}this.isLoading=!0;try{let t=yield fetch(`${this.apiUrl}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:this.username.trim(),password:this.password})}),e=yield t.json();t.ok&&e.token?(localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(e.user)),this.rememberMe?localStorage.setItem("rememberedUser",JSON.stringify({username:this.username.trim(),rememberMe:!0})):localStorage.removeItem("rememberedUser"),yield ps.default.fire({title:"\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u062E\u0648\u0644",text:"\u062C\u0627\u0631\u064A \u062A\u062D\u0648\u064A\u0644\u0643 \u0625\u0644\u0649 \u0645\u062F\u0631\u0633\u0629 \u0627\u0644\u0631\u0648\u0627\u062F...",icon:"success",timer:1500,showConfirmButton:!1}),this.router.navigate(["/accounting"])):ps.default.fire({title:"\u0641\u0634\u0644 \u0627\u0644\u062F\u062E\u0648\u0644",text:e.message||"\u0628\u064A\u0627\u0646\u0627\u062A \u063A\u064A\u0631 \u0635\u062D\u064A\u062D\u0629",icon:"error"})}catch{ps.default.fire({title:"\u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u0627\u062A\u0635\u0627\u0644",text:"\u064A\u0631\u062C\u0649 \u0627\u0644\u062A\u062D\u0642\u0642 \u0645\u0646 \u0627\u0644\u0625\u0646\u062A\u0631\u0646\u062A",icon:"error"})}finally{this.isLoading=!1}})}static \u0275fac=function(e){return new(e||n)(Ne(ei))};static \u0275cmp=nn({type:n,selectors:[["app-login"]],decls:46,vars:14,consts:[[1,"bg-animation"],[1,"login-container"],[1,"glass-card","animate-fade-up"],[1,"top-badge"],[1,"card-header"],[1,"logo-circle"],[1,"bi","bi-mortarboard-fill"],[1,"header-text"],[1,"title"],[1,"subtitle"],[1,"login-form",3,"ngSubmit"],[1,"input-group"],[1,"input-wrapper"],["type","text","name","username","placeholder","\u0623\u062F\u062E\u0644 \u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645",3,"ngModelChange","keypress","ngModel","disabled"],[1,"bi","bi-person-fill"],["name","password","id","password","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",3,"ngModelChange","keypress","type","ngModel","disabled"],[1,"bi",2,"cursor","pointer",3,"click","ngClass"],[1,"form-options"],[1,"checkbox-container"],["type","checkbox","name","rememberMe",3,"ngModelChange","ngModel"],[1,"checkmark"],[1,"forgot-link",3,"click"],[1,"button-group"],["type","submit",1,"btn-login",3,"disabled"],[4,"ngIf"],["class","spinner",4,"ngIf"],["type","button",1,"btn-accounting",3,"click","disabled"],[1,"divider-line"],[1,"btn-new",3,"click","disabled"],[1,"footer-info"],[1,"spinner"]],template:function(e,i){e&1&&(b(0,"div",0),s(1,"div",1)(2,"div",2)(3,"div",3),u(4,"\u0645\u062F\u0631\u0633\u0629 \u0627\u0644\u0631\u0648\u0627\u062F \u0644\u0644\u062A\u0639\u0644\u064A\u0645 \u0648 \u0627\u0644\u0645\u0639\u0627\u0631\u0641"),a(),s(5,"div",4)(6,"div",5),b(7,"i",6),a(),s(8,"div",7)(9,"h2",8),u(10,"Ta3limi"),a(),s(11,"p",9),u(12),a()()(),s(13,"form",10),I("ngSubmit",function(){return i.login()}),s(14,"div",11)(15,"label"),u(16,"\u0627\u0633\u0645 \u0627\u0644\u0645\u0633\u062A\u062E\u062F\u0645"),a(),s(17,"div",12)(18,"input",13),ye("ngModelChange",function(o){return Ce(i.username,o)||(i.username=o),o}),I("keypress",function(o){return i.onUsernameKeyPress(o)}),a(),b(19,"i",14),a()(),s(20,"div",11)(21,"label"),u(22,"\u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631"),a(),s(23,"div",12)(24,"input",15),ye("ngModelChange",function(o){return Ce(i.password,o)||(i.password=o),o}),I("keypress",function(o){return i.onPasswordKeyPress(o)}),a(),s(25,"i",16),I("click",function(){return i.togglePasswordVisibility()}),a()()(),s(26,"div",17)(27,"label",18)(28,"input",19),ye("ngModelChange",function(o){return Ce(i.rememberMe,o)||(i.rememberMe=o),o}),a(),b(29,"span",20),u(30," \u062A\u0630\u0643\u0631\u0646\u064A "),a(),s(31,"a",21),I("click",function(){return i.forgotPassword()}),u(32,"\u0646\u0633\u064A\u062A \u0643\u0644\u0645\u0629 \u0627\u0644\u0645\u0631\u0648\u0631\u061F"),a()(),s(33,"div",22)(34,"button",23),j(35,IL,2,0,"span",24)(36,OL,1,0,"div",25),a(),s(37,"button",26),I("click",function(){return i.redirectToAccountingInterface()}),u(38," \u0648\u0627\u062C\u0647\u0629 \u0627\u0644\u0645\u062D\u0627\u0633\u0628\u0629 "),a()()(),s(39,"div",27)(40,"span"),u(41,"\u0623\u0648"),a()(),s(42,"button",28),I("click",function(){return i.navigateToRegister()}),u(43," \u0625\u0646\u0634\u0627\u0621 \u062D\u0633\u0627\u0628 \u062C\u062F\u064A\u062F "),a(),s(44,"footer",29),u(45),a()()()),e&2&&(d(12),H("",i.getGreeting(),"\u060C \u0646\u0638\u0627\u0645 \u0627\u0644\u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0630\u0643\u064A"),d(6),ve("ngModel",i.username),w("disabled",i.isLoading),d(6),w("type",i.passwordFieldType),ve("ngModel",i.password),w("disabled",i.isLoading),d(),w("ngClass",i.passwordFieldType==="password"?"bi-eye-slash-fill":"bi-eye-fill"),d(3),ve("ngModel",i.rememberMe),d(6),w("disabled",i.isLoading||!i.isFormValid()),d(),w("ngIf",!i.isLoading),d(),w("ngIf",i.isLoading),d(),w("disabled",i.isLoading),d(5),w("disabled",i.isLoading),d(3),H(" \xA9 ",i.currentYear," Redox Club | \u0627\u0644\u0625\u0635\u062F\u0627\u0631 1.0.3 "))},dependencies:[Un,Ti,Yn,ff,ii,Ai,ti,mr,hn,Bo,An],styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;width:100vw;padding:20px;position:relative}.bg-animation[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;z-index:-1;background:linear-gradient(135deg,#0a66c2f2,#004182f2),url(https://images.unsplash.com/photo-1509062522246-3755977927d7?q=80&w=2000);background-size:cover;background-position:center}.glass-card[_ngcontent-%COMP%]{background:#ffffff1f;backdrop-filter:blur(25px);-webkit-backdrop-filter:blur(25px);border:1px solid var(--glass-border);border-radius:40px;padding:40px;color:var(--text-light);width:100%;max-width:420px;box-shadow:0 25px 50px #0000004d;text-align:center}.top-badge[_ngcontent-%COMP%]{background:#fff;color:var(--dark-blue);display:inline-block;padding:8px 20px;border-radius:30px;font-weight:700;font-size:1.1rem;margin-bottom:25px;box-shadow:0 4px 10px #0000001a}.card-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin-bottom:30px}.logo-circle[_ngcontent-%COMP%]{width:70px;height:70px;background:#fff;border-radius:50%;display:flex;justify-content:center;align-items:center;font-size:2.2rem;color:var(--main-blue);margin:0 auto 15px}.title[_ngcontent-%COMP%]{margin:0;font-size:1.8rem;font-weight:700}.subtitle[_ngcontent-%COMP%]{margin:5px 0 30px;opacity:.8;font-size:.9rem}.login-form[_ngcontent-%COMP%]{width:100%}.input-group[_ngcontent-%COMP%]{margin-bottom:18px;text-align:right;width:100%}.input-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:.85rem;margin-right:10px;color:var(--text-light)}.input-wrapper[_ngcontent-%COMP%]{position:relative;width:100%}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%!important;padding:14px 15px 14px 45px;border-radius:18px;border:none;font-size:1rem;color:var(--text-dark);background:#fff;outline:none;direction:rtl}.input-wrapper[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;left:15px;top:50%;transform:translateY(-50%);color:var(--main-blue);font-size:1.1rem;z-index:5}.form-options[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;font-size:.85rem}.forgot-link[_ngcontent-%COMP%]{color:#90c4ff;cursor:pointer;text-decoration:none;transition:all .3s ease}.forgot-link[_ngcontent-%COMP%]:hover{color:#fff;text-decoration:underline}.btn-login[_ngcontent-%COMP%]{width:100%;padding:15px;border-radius:18px;border:none;background:#fff;color:var(--dark-blue);font-weight:700;font-size:1.1rem;cursor:pointer;transition:.3s;margin-top:10px}.btn-login[_ngcontent-%COMP%]:hover:not(:disabled){transform:scale(1.02);background:#f0f0f0}.btn-login[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-new[_ngcontent-%COMP%]{width:100%;padding:12px;border-radius:18px;border:1px solid white;background:transparent;color:#fff;cursor:pointer;margin-top:10px;transition:all .3s ease}.btn-new[_ngcontent-%COMP%]:hover{background:#ffffff1a}.divider-line[_ngcontent-%COMP%]{margin:25px 0;border-bottom:1px solid rgba(255,255,255,.2);position:relative}.divider-line[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{position:absolute;top:-10px;left:50%;transform:translate(-50%);background:var(--dark-blue);padding:0 15px;font-size:.8rem;border-radius:10px}.spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:3px solid rgba(0,0,0,.1);border-radius:50%;border-top-color:var(--main-blue);animation:_ngcontent-%COMP%_spin .8s linear infinite;display:inline-block}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.animate-fade-up[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_floatIn .8s ease-out forwards}@keyframes _ngcontent-%COMP%_floatIn{0%{opacity:0;transform:translateY(30px)}to{opacity:1;transform:translateY(0)}}@media (max-width: 480px){.glass-card[_ngcontent-%COMP%]{padding:30px 20px;border-radius:30px}.logo-circle[_ngcontent-%COMP%]{width:60px;height:60px;font-size:1.8rem}.title[_ngcontent-%COMP%]{font-size:1.5rem}.input-wrapper[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:12px 12px 12px 40px}.btn-login[_ngcontent-%COMP%], .btn-new[_ngcontent-%COMP%]{padding:12px}}.btn-accounting[_ngcontent-%COMP%]{border:#90c4ff;padding:8px;margin:23px;position:relative;border:currentColor;border-width:0 0 2px;border-style:solid;background:transparent;color:#90c4ff;cursor:pointer;transition:.3s;font-size:1.1rem}.btn-accounting[_ngcontent-%COMP%]:hover{transform:scale(1.02);background:#f0f0f0;transform:scaleZ(1)}"]})};$();function FL(n,t){if(n&1&&(s(0,"option",46),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),B(e)}}function RL(n,t){if(n&1&&(s(0,"option",46),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),B(e)}}function kL(n,t){if(n&1){let e=he();s(0,"div",47)(1,"div",48),u(2),a(),s(3,"button",49),I("click",function(){F(e);let r=E();return R(r.deleteSelectedLessons())}),b(4,"i",50),u(5," \u062D\u0630\u0641 \u0627\u0644\u0645\u062D\u062F\u062F "),a()()}if(n&2){let e=E();d(2),H(" \u062A\u0645 \u062A\u062D\u062F\u064A\u062F ",e.selectedLessons.size," \u062D\u0635\u0629 ")}}function NL(n,t){if(n&1&&(s(0,"span",51),u(1),a()),n&2){let e=E();d(),H(" ",e.sortDirection==="asc"?"\u2191":"\u2193"," ")}}function UL(n,t){if(n&1&&(s(0,"span",51),u(1),a()),n&2){let e=E();d(),H(" ",e.sortDirection==="asc"?"\u2191":"\u2193"," ")}}function LL(n,t){if(n&1&&(s(0,"span",51),u(1),a()),n&2){let e=E();d(),H(" ",e.sortDirection==="asc"?"\u2191":"\u2193"," ")}}function BL(n,t){if(n&1&&(s(0,"span",51),u(1),a()),n&2){let e=E();d(),H(" ",e.sortDirection==="asc"?"\u2191":"\u2193"," ")}}function VL(n,t){if(n&1){let e=he();s(0,"tr",52),I("click",function(){let r=F(e).$implicit,o=E();return R(o.navigateToDetails(r._id))}),s(1,"td",53),I("click",function(r){return F(e),R(r.stopPropagation())}),s(2,"input",36),I("change",function(r){let o=F(e).$implicit,l=E();return R(l.toggleSelection(o._id,r))}),a()(),s(3,"td")(4,"div",54)(5,"div",55),u(6),a(),s(7,"div",56),u(8),a()()(),s(9,"td")(10,"span",57),u(11),a()(),s(12,"td"),u(13),a(),s(14,"td")(15,"div",58)(16,"div",59),u(17),a()()(),s(18,"td",60),u(19),a(),s(20,"td")(21,"div",61),b(22,"i",62),u(23),a()(),s(24,"td")(25,"span",63),u(26),a()(),s(27,"td",64)(28,"div",65),u(29),a()(),s(30,"td",66),I("click",function(r){return F(e),R(r.stopPropagation())}),s(31,"div",67)(32,"button",68),I("click",function(){let r=F(e).$implicit,o=E();return R(o.navigateToDetails(r._id))}),b(33,"i",69),a(),s(34,"button",70),I("click",function(r){let o=F(e).$implicit,l=E();return R(l.deleteLesson(o._id,r))}),b(35,"i",50),a()()()()}if(n&2){let e=t.$implicit,i=E();d(2),w("checked",i.selectedLessons.has(e._id)),d(4),B(e.name),d(2),H("ID: ",e._id.substring(0,8),""),d(3),B(e.subject),d(2),B(e.academicYear),d(4),B(i.getTeacherName(e)),d(2),B(i.formatPrice(e.price)),d(4),H(" ",i.getStudentsCount(e)," "),d(2),Ie("monthly",e.paymentSystem==="monthly")("rounds",e.paymentSystem==="rounds"),d(),H(" ",i.getPaymentSystemText(e.paymentSystem)," "),d(3),H(" ",i.formatSchedule(e.schedule)," ")}}function HL(n,t){if(n&1){let e=he();s(0,"div",71)(1,"div",72),b(2,"i",73),a(),s(3,"h3"),u(4,"\u0644\u0627 \u062A\u0648\u062C\u062F \u062D\u0635\u0635"),a(),s(5,"p"),u(6,"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u0649 \u062D\u0635\u0635 \u062A\u0637\u0627\u0628\u0642 \u0645\u0639\u0627\u064A\u064A\u0631 \u0627\u0644\u0628\u062D\u062B"),a(),s(7,"button",4),I("click",function(){F(e);let r=E();return R(r.openAddLessonDialog())}),b(8,"i",5),u(9," \u0625\u0636\u0627\u0641\u0629 \u062D\u0635\u0629 \u062C\u062F\u064A\u062F\u0629 "),a()()}}function zL(n,t){n&1&&(s(0,"div",74),b(1,"div",75),s(2,"p"),u(3,"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062D\u0635\u0635..."),a()())}function jL(n,t){if(n&1){let e=he();s(0,"button",85),I("click",function(){F(e);let r=E().$implicit,o=E(2);return R(o.goToPage(r))}),u(1),a()}if(n&2){let e=E().$implicit,i=E(2);Ie("active",e===i.currentPage),d(),H(" ",e," ")}}function WL(n,t){n&1&&(s(0,"span",86),u(1,"..."),a())}function GL(n,t){if(n&1&&(v0(0),j(1,jL,2,3,"button",83)(2,WL,2,0,"span",84),y0()),n&2){let e=t.$implicit;d(),w("ngIf",e!=="..."),d(),w("ngIf",e==="...")}}function $L(n,t){if(n&1){let e=he();s(0,"div",76)(1,"button",77),I("click",function(){F(e);let r=E();return R(r.prevPage())}),b(2,"i",78),a(),s(3,"div",79),j(4,GL,3,2,"ng-container",80),a(),s(5,"button",77),I("click",function(){F(e);let r=E();return R(r.nextPage())}),b(6,"i",81),a(),s(7,"div",82),u(8),a()()}if(n&2){let e=E();d(),w("disabled",e.currentPage===1),d(3),w("ngForOf",e.getVisiblePages()),d(),w("disabled",e.currentPage===e.totalPages),d(3),Qi(" \u0639\u0631\u0636 ",(e.currentPage-1)*e.itemsPerPage+1,"-",e.Math.min(e.currentPage*e.itemsPerPage,e.totalItems)," \u0645\u0646 ",e.totalItems," ")}}function YL(n,t){if(n&1&&(s(0,"div",87),b(1,"i",88),u(2),a()),n&2){let e=E();d(2),H(" ",e.errorMessage," ")}}function qL(n,t){if(n&1&&(s(0,"div",89),b(1,"i",90),u(2),a()),n&2){let e=E();d(2),H(" ",e.successMessage," ")}}function XL(n,t){if(n&1&&(s(0,"option",46),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),H(" ",e," ")}}function ZL(n,t){if(n&1&&(s(0,"option",46),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),H(" ",e," ")}}function JL(n,t){if(n&1&&(s(0,"option",46),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),H(" ",e.name," ")}}function KL(n,t){if(n&1){let e=he();s(0,"div",127)(1,"h4"),u(2,"\u0625\u0639\u062F\u0627\u062F\u0627\u062A \u0627\u0644\u062C\u0648\u0644\u0627\u062A"),a(),s(3,"div",98)(4,"div",99)(5,"label",128),u(6,"\u0639\u062F\u062F \u0627\u0644\u062D\u0635\u0635"),a(),s(7,"input",129),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.newLesson.roundSettings.sessionCount,r)||(o.newLesson.roundSettings.sessionCount=r),R(r)}),a()(),s(8,"div",99)(9,"label",130),u(10,"\u0645\u062F\u0629 \u0627\u0644\u062D\u0635\u0629 (\u0633\u0627\u0639\u0627\u062A)"),a(),s(11,"input",131),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.newLesson.roundSettings.sessionDuration,r)||(o.newLesson.roundSettings.sessionDuration=r),R(r)}),a()(),s(12,"div",99)(13,"label",132),u(14,"\u0641\u0627\u0635\u0644 \u0628\u064A\u0646 \u0627\u0644\u062D\u0635\u0635 (\u0623\u064A\u0627\u0645)"),a(),s(15,"input",133),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.newLesson.roundSettings.breakBetweenSessions,r)||(o.newLesson.roundSettings.breakBetweenSessions=r),R(r)}),a()()()()}if(n&2){let e=E(2);d(7),ve("ngModel",e.newLesson.roundSettings.sessionCount),d(4),ve("ngModel",e.newLesson.roundSettings.sessionDuration),d(4),ve("ngModel",e.newLesson.roundSettings.breakBetweenSessions)}}function QL(n,t){if(n&1&&(s(0,"option",46),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),B(e)}}function e8(n,t){if(n&1&&(s(0,"option",46),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),H(" ",e.name," ")}}function t8(n,t){if(n&1){let e=he();s(0,"div",134)(1,"div",98)(2,"div",99)(3,"label"),u(4,"\u0627\u0644\u064A\u0648\u0645"),a(),s(5,"select",135),ye("ngModelChange",function(r){let o=F(e).$implicit;return Ce(o.day,r)||(o.day=r),R(r)}),s(6,"option",25),u(7,"\u0627\u062E\u062A\u0631 \u0627\u0644\u064A\u0648\u0645"),a(),j(8,QL,2,2,"option",26),a()(),s(9,"div",99)(10,"label"),u(11,"\u0627\u0644\u0648\u0642\u062A"),a(),s(12,"input",136),ye("ngModelChange",function(r){let o=F(e).$implicit;return Ce(o.time,r)||(o.time=r),R(r)}),a()(),s(13,"div",99)(14,"label"),u(15,"\u0627\u0644\u0642\u0627\u0639\u0629"),a(),s(16,"select",135),ye("ngModelChange",function(r){let o=F(e).$implicit;return Ce(o.classroom,r)||(o.classroom=r),R(r)}),s(17,"option",25),u(18,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0642\u0627\u0639\u0629"),a(),j(19,e8,2,2,"option",26),a()(),s(20,"div",137)(21,"button",138),I("click",function(){let r=F(e).index,o=E(2);return R(o.removeScheduleRow(r))}),b(22,"i",50),a()()()()}if(n&2){let e=t.$implicit,i=t.index,r=E(2);d(5),ve("ngModel",e.day),w("name","day"+i),d(3),w("ngForOf",r.days),d(4),ve("ngModel",e.time),w("name","time"+i),d(4),ve("ngModel",e.classroom),w("name","classroom"+i),d(3),w("ngForOf",r.classrooms)}}function n8(n,t){n&1&&(s(0,"div",139)(1,"p"),u(2,"\u0644\u0645 \u064A\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0623\u064A \u062C\u062F\u0648\u0644 \u0632\u0645\u0646\u064A"),a()())}function i8(n,t){n&1&&b(0,"span",140)}function r8(n,t){if(n&1){let e=he();s(0,"div",91)(1,"div",92)(2,"div",93)(3,"h2"),u(4,"\u0625\u0636\u0627\u0641\u0629 \u062D\u0635\u0629 \u062C\u062F\u064A\u062F\u0629"),a(),s(5,"button",94),I("click",function(){F(e);let r=E();return R(r.showAddDialog=!1)}),b(6,"i",95),a()(),s(7,"div",96)(8,"form",97),I("submit",function(r){return F(e),E().createLesson(),R(r.preventDefault())}),s(9,"div",98)(10,"div",99)(11,"label",100),u(12,"\u0627\u0633\u0645 \u0627\u0644\u062D\u0635\u0629 *"),a(),s(13,"input",101),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLesson.name,r)||(o.newLesson.name=r),R(r)}),a()(),s(14,"div",99)(15,"label",102),u(16,"\u0627\u0644\u0645\u0627\u062F\u0629 *"),a(),s(17,"select",103),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLesson.subject,r)||(o.newLesson.subject=r),R(r)}),s(18,"option",25),u(19,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0645\u0627\u062F\u0629"),a(),j(20,XL,2,2,"option",26),a()(),s(21,"div",99)(22,"label",104),u(23,"\u0627\u0644\u0633\u0646\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629 *"),a(),s(24,"select",105),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLesson.academicYear,r)||(o.newLesson.academicYear=r),R(r)}),s(25,"option",25),u(26,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0633\u0646\u0629"),a(),j(27,ZL,2,2,"option",26),a()(),s(28,"div",99)(29,"label",106),u(30,"\u0627\u0644\u0633\u0639\u0631 (\u062F.\u062C) *"),a(),s(31,"input",107),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLesson.price,r)||(o.newLesson.price=r),R(r)}),a()(),s(32,"div",99)(33,"label",108),u(34,"\u0627\u0644\u0645\u062F\u0631\u0633"),a(),s(35,"select",109),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLesson.teacher,r)||(o.newLesson.teacher=r),R(r)}),s(36,"option",25),u(37,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0645\u062F\u0631\u0633"),a(),j(38,JL,2,2,"option",26),a()(),s(39,"div",99)(40,"label",110),u(41,"\u0646\u0638\u0627\u0645 \u0627\u0644\u062F\u0641\u0639"),a(),s(42,"select",111),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLesson.paymentSystem,r)||(o.newLesson.paymentSystem=r),R(r)}),s(43,"option",112),u(44,"\u0634\u0647\u0631\u064A"),a(),s(45,"option",113),u(46,"\u062C\u0648\u0644\u0627\u062A"),a()()(),s(47,"div",114)(48,"label",115),u(49,"\u0627\u0644\u0648\u0635\u0641"),a(),s(50,"textarea",116),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLesson.description,r)||(o.newLesson.description=r),R(r)}),a()()(),j(51,KL,16,3,"div",117),s(52,"div",118)(53,"div",119)(54,"h4"),u(55,"\u0627\u0644\u062C\u062F\u0648\u0644 \u0627\u0644\u0632\u0645\u0646\u064A"),a(),s(56,"button",120),I("click",function(){F(e);let r=E();return R(r.addScheduleRow())}),b(57,"i",5),u(58," \u0625\u0636\u0627\u0641\u0629 \u0648\u0642\u062A "),a()(),j(59,t8,23,8,"div",121)(60,n8,3,0,"div",122),a(),s(61,"div",123)(62,"button",124),I("click",function(){F(e);let r=E();return R(r.showAddDialog=!1)}),u(63," \u0625\u0644\u063A\u0627\u0621 "),a(),s(64,"button",125),j(65,i8,1,0,"span",126),u(66," \u062D\u0641\u0638 \u0627\u0644\u062D\u0635\u0629 "),a()()()()()()}if(n&2){let e=E();d(13),ve("ngModel",e.newLesson.name),d(4),ve("ngModel",e.newLesson.subject),d(3),w("ngForOf",e.subjects),d(4),ve("ngModel",e.newLesson.academicYear),d(3),w("ngForOf",e.academicYears),d(4),ve("ngModel",e.newLesson.price),d(4),ve("ngModel",e.newLesson.teacher),d(3),w("ngForOf",e.teachers),d(4),ve("ngModel",e.newLesson.paymentSystem),d(8),ve("ngModel",e.newLesson.description),d(),w("ngIf",e.newLesson.paymentSystem==="rounds"),d(8),w("ngForOf",e.newLesson.schedule),d(),w("ngIf",e.newLesson.schedule.length===0),d(4),w("disabled",e.loading),d(),w("ngIf",e.loading)}}var Rg=class n{http=Pe(pn);router=Pe(ei);lessons=[];filteredLessons=[];loading=!1;errorMessage="";successMessage="";filterSubject="";filterAcademicYear="";filterTeacher="";showAddDialog=!1;newLesson={name:"",subject:"",academicYear:"",price:0,teacher:"",description:"",paymentSystem:"monthly",roundSettings:{sessionCount:8,sessionDuration:2,breakBetweenSessions:0},schedule:[]};subjects=["\u0631\u064A\u0627\u0636\u064A\u0627\u062A","\u0641\u064A\u0632\u064A\u0627\u0621","\u0639\u0644\u0648\u0645","\u0644\u063A\u0629 \u0639\u0631\u0628\u064A\u0629","\u0644\u063A\u0629 \u0641\u0631\u0646\u0633\u064A\u0629","\u0644\u063A\u0629 \u0627\u0646\u062C\u0644\u064A\u0632\u064A\u0629","\u062A\u0627\u0631\u064A\u062E","\u062C\u063A\u0631\u0627\u0641\u064A\u0627","\u0641\u0644\u0633\u0641\u0629","\u0625\u0639\u0644\u0627\u0645 \u0622\u0644\u064A"];academicYears=["1AS","2AS","3AS","1MS","2MS","3MS","4MS","5MS","1AP","2AP","3AP","4AP","5AP","NS"];days=["\u0627\u0644\u0633\u0628\u062A","\u0627\u0644\u0623\u062D\u062F","\u0627\u0644\u0625\u062B\u0646\u064A\u0646","\u0627\u0644\u062B\u0644\u0627\u062B\u0627\u0621","\u0627\u0644\u0623\u0631\u0628\u0639\u0627\u0621","\u0627\u0644\u062E\u0645\u064A\u0633","\u0627\u0644\u062C\u0645\u0639\u0629"];teachers=[];classrooms=[];currentPage=1;itemsPerPage=10;totalItems=0;sortField="name";sortDirection="asc";selectedLessons=new Set;ngOnInit(){this.loadClasses(),this.loadTeachers(),this.loadClassrooms()}loadClasses(){this.loading=!0,this.http.get(`${_i.apiUrl}/classes`).subscribe({next:t=>{this.lessons=t,this.filteredLessons=[...t],this.applyFilter(),this.loading=!1},error:t=>{console.error("Error loading classes:",t),this.errorMessage="\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u062D\u0635\u0635",this.loading=!1}})}loadTeachers(){this.http.get(`${_i.apiUrl}/teachers`).subscribe({next:t=>{this.teachers=t},error:t=>{console.error("Error loading teachers:",t)}})}loadClassrooms(){this.http.get(`${_i.apiUrl}/classrooms`).subscribe({next:t=>{this.classrooms=t},error:t=>{console.error("Error loading classrooms:",t)}})}applyFilter(){this.filteredLessons=this.lessons.filter(t=>{let e=!this.filterSubject||t.subject===this.filterSubject,i=!this.filterAcademicYear||t.academicYear===this.filterAcademicYear,r=!this.filterTeacher||t.teacher?.name?.toLowerCase().includes(this.filterTeacher.toLowerCase());return e&&i&&r}),this.totalItems=this.filteredLessons.length,this.currentPage=1,this.sortData()}clearFilters(){this.filterSubject="",this.filterAcademicYear="",this.filterTeacher="",this.filteredLessons=[...this.lessons],this.totalItems=this.lessons.length,this.sortData()}sortData(){this.filteredLessons.sort((t,e)=>{let i=t[this.sortField],r=e[this.sortField];return i===void 0||r===void 0?0:(typeof i=="string"&&(i=i.toLowerCase()),typeof r=="string"&&(r=r.toLowerCase()),i<r?this.sortDirection==="asc"?-1:1:i>r?this.sortDirection==="asc"?1:-1:0)})}onSort(t){this.sortField===t?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=t,this.sortDirection="asc"),this.sortData()}navigateToDetails(t){this.router.navigate(["/home/lesson-detail",t])}openAddLessonDialog(){this.showAddDialog=!0,this.newLesson={name:"",subject:"",academicYear:"",price:0,teacher:"",description:"",paymentSystem:"monthly",roundSettings:{sessionCount:8,sessionDuration:2,breakBetweenSessions:0},schedule:[]}}addScheduleRow(){this.newLesson.schedule.push({day:"",time:"",classroom:""})}removeScheduleRow(t){this.newLesson.schedule.splice(t,1)}createLesson(){if(!this.newLesson.name||!this.newLesson.subject||!this.newLesson.academicYear||!this.newLesson.price){this.errorMessage="\u064A\u0631\u062C\u0649 \u0645\u0644\u0621 \u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0642\u0648\u0644 \u0627\u0644\u0645\u0637\u0644\u0648\u0628\u0629";return}this.loading=!0,this.http.post(`${_i.apiUrl}/classes`,this.newLesson).subscribe({next:t=>{this.successMessage=t.message||"\u062A\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062D\u0635\u0629 \u0628\u0646\u062C\u0627\u062D",this.showAddDialog=!1,this.loadClasses(),this.loading=!1,setTimeout(()=>{this.successMessage=""},3e3)},error:t=>{console.error("Error creating lesson:",t),this.errorMessage=t.error?.error||"\u0641\u0634\u0644 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062D\u0635\u0629",this.loading=!1,setTimeout(()=>{this.errorMessage=""},3e3)}})}deleteLesson(t,e){e.stopPropagation(),confirm("\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u062D\u0635\u0629\u061F \u0633\u064A\u062A\u0645 \u062D\u0630\u0641 \u062C\u0645\u064A\u0639 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0645\u0631\u062A\u0628\u0637\u0629 \u0628\u0647\u0627.")&&(this.loading=!0,this.http.delete(`${_i.apiUrl}/classes/${t}`).subscribe({next:()=>{this.successMessage="\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u062D\u0635\u0629 \u0628\u0646\u062C\u0627\u062D",this.loadClasses(),this.loading=!1,setTimeout(()=>{this.successMessage=""},3e3)},error:i=>{console.error("Error deleting lesson:",i),this.errorMessage=i.error?.error||"\u0641\u0634\u0644 \u062D\u0630\u0641 \u0627\u0644\u062D\u0635\u0629",this.loading=!1,setTimeout(()=>{this.errorMessage=""},3e3)}}))}toggleSelection(t,e){e.stopPropagation(),this.selectedLessons.has(t)?this.selectedLessons.delete(t):this.selectedLessons.add(t)}toggleAllSelection(){this.selectedLessons.size===this.paginatedLessons.length?this.selectedLessons.clear():this.paginatedLessons.forEach(t=>{this.selectedLessons.add(t._id)})}deleteSelectedLessons(){if(this.selectedLessons.size===0){alert("\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u062D\u0635\u0635 \u0644\u0644\u062D\u0630\u0641");return}if(confirm(`\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 ${this.selectedLessons.size} \u062D\u0635\u0629\u061F \u0633\u064A\u062A\u0645 \u062D\u0630\u0641 \u062C\u0645\u064A\u0639 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0645\u0631\u062A\u0628\u0637\u0629 \u0628\u0647\u0627.`)){this.loading=!0;let t=Array.from(this.selectedLessons).map(e=>this.http.delete(`${_i.apiUrl}/classes/${e}`).toPromise());Promise.all(t).then(()=>{this.successMessage=`\u062A\u0645 \u062D\u0630\u0641 ${this.selectedLessons.size} \u062D\u0635\u0629 \u0628\u0646\u062C\u0627\u062D`,this.selectedLessons.clear(),this.loadClasses(),this.loading=!1,setTimeout(()=>{this.successMessage=""},3e3)}).catch(e=>{console.error("Error deleting lessons:",e),this.errorMessage="\u0641\u0634\u0644 \u062D\u0630\u0641 \u0628\u0639\u0636 \u0627\u0644\u062D\u0635\u0635",this.loading=!1,setTimeout(()=>{this.errorMessage=""},3e3)})}}get paginatedLessons(){let t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage;return this.filteredLessons.slice(t,e)}get totalPages(){return Math.ceil(this.totalItems/this.itemsPerPage)}get pages(){return Array.from({length:this.totalPages},(t,e)=>e+1)}goToPage(t){this.currentPage=t}prevPage(){this.currentPage>1&&this.currentPage--}nextPage(){this.currentPage<this.totalPages&&this.currentPage++}formatPrice(t){return new Intl.NumberFormat("ar-DZ").format(t)+" \u062F.\u062C"}formatSchedule(t=[]){return t.length===0?"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F":t.map(e=>`${e.day} ${e.time}`).join("\u060C ")}getPaymentSystemText(t){return t==="monthly"?"\u0634\u0647\u0631\u064A":"\u062C\u0648\u0644\u0627\u062A"}getStudentsCount(t){return t.students?.length||0}getTeacherName(t){return t.teacher?.name||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}getTotalStudents(){return this.lessons.reduce((t,e)=>t+(e.students?.length||0),0)}getAveragePrice(){if(this.lessons.length===0)return 0;let t=this.lessons.reduce((e,i)=>e+i.price,0);return Math.round(t/this.lessons.length)}getMonthlyCount(){return this.lessons.filter(t=>t.paymentSystem==="monthly").length}getVisiblePages(){let t=[];if(this.totalPages<=5)for(let i=1;i<=this.totalPages;i++)t.push(i);else{t.push(1),this.currentPage>3&&t.push("...");let i=Math.max(2,this.currentPage-1),r=Math.min(this.totalPages-1,this.currentPage+1);for(let o=i;o<=r;o++)t.push(o);this.currentPage<this.totalPages-2&&t.push("..."),t.push(this.totalPages)}return t}exportToExcel(){console.log("Export to Excel functionality")}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=nn({type:n,selectors:[["app-lesson-management"]],decls:107,vars:30,consts:[[1,"lesson-management-container"],[1,"header"],[1,"page-title"],[1,"header-actions"],[1,"btn","btn-primary",3,"click"],[1,"icon-add"],[1,"btn","btn-secondary",3,"click"],[1,"icon-export"],[1,"stats-container"],[1,"stat-card"],[1,"stat-icon"],[1,"icon-class"],[1,"stat-content"],[1,"stat-value"],[1,"stat-label"],[1,"icon-students"],[1,"icon-money"],[1,"icon-calendar"],[1,"filters-section"],[1,"filters-header"],[1,"btn","btn-link",3,"click"],[1,"filters-grid"],[1,"filter-group"],["for","filterSubject"],["id","filterSubject",1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","filterAcademicYear"],["id","filterAcademicYear",1,"form-select",3,"ngModelChange","ngModel"],["for","filterTeacher"],["type","text","id","filterTeacher","placeholder","\u0627\u0628\u062D\u062B \u0628\u0627\u0633\u0645 \u0627\u0644\u0645\u062F\u0631\u0633",1,"form-input",3,"ngModelChange","ngModel"],["class","bulk-actions",4,"ngIf"],[1,"table-container"],[1,"table-responsive"],[1,"data-table"],[1,"checkbox-cell"],["type","checkbox",3,"change","checked"],[3,"click"],["class","sort-icon",4,"ngIf"],["class","clickable-row",3,"click",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],["class","loading-state",4,"ngIf"],["class","pagination",4,"ngIf"],["class","alert alert-error",4,"ngIf"],["class","alert alert-success",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[3,"value"],[1,"bulk-actions"],[1,"selected-count"],[1,"btn","btn-danger",3,"click"],[1,"icon-delete"],[1,"sort-icon"],[1,"clickable-row",3,"click"],[1,"checkbox-cell",3,"click"],[1,"lesson-name-cell"],[1,"lesson-name"],[1,"lesson-id"],[1,"subject-badge"],[1,"teacher-cell"],[1,"teacher-name"],[1,"price-cell"],[1,"students-count"],[1,"icon-students-small"],[1,"payment-badge"],[1,"schedule-cell"],[1,"schedule-list"],[1,"actions-cell",3,"click"],[1,"action-buttons"],["title","\u0639\u0631\u0636 \u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644",1,"btn-icon","btn-view",3,"click"],[1,"icon-view"],["title","\u062D\u0630\u0641 \u0627\u0644\u062D\u0635\u0629",1,"btn-icon","btn-delete",3,"click"],[1,"empty-state"],[1,"empty-state-icon"],[1,"icon-empty"],[1,"loading-state"],[1,"spinner"],[1,"pagination"],[1,"pagination-btn",3,"click","disabled"],[1,"icon-chevron-right"],[1,"page-numbers"],[4,"ngFor","ngForOf"],[1,"icon-chevron-left"],[1,"pagination-info"],["class","page-number",3,"active","click",4,"ngIf"],["class","ellipsis",4,"ngIf"],[1,"page-number",3,"click"],[1,"ellipsis"],[1,"alert","alert-error"],[1,"icon-error"],[1,"alert","alert-success"],[1,"icon-success"],[1,"modal-overlay"],[1,"modal"],[1,"modal-header"],[1,"btn-icon","btn-close",3,"click"],[1,"icon-close"],[1,"modal-body"],[3,"submit"],[1,"form-grid"],[1,"form-group"],["for","lessonName"],["type","text","id","lessonName","name","lessonName","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","subject"],["id","subject","name","subject","required","",1,"form-select",3,"ngModelChange","ngModel"],["for","academicYear"],["id","academicYear","name","academicYear","required","",1,"form-select",3,"ngModelChange","ngModel"],["for","price"],["type","number","id","price","name","price","min","0","required","",1,"form-input",3,"ngModelChange","ngModel"],["for","teacher"],["id","teacher","name","teacher",1,"form-select",3,"ngModelChange","ngModel"],["for","paymentSystem"],["id","paymentSystem","name","paymentSystem",1,"form-select",3,"ngModelChange","ngModel"],["value","monthly"],["value","rounds"],[1,"form-group","full-width"],["for","description"],["id","description","name","description","rows","3",1,"form-textarea",3,"ngModelChange","ngModel"],["class","round-settings",4,"ngIf"],[1,"schedule-section"],[1,"section-header"],["type","button",1,"btn","btn-outline",3,"click"],["class","schedule-row",4,"ngFor","ngForOf"],["class","empty-schedule",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-small",4,"ngIf"],[1,"round-settings"],["for","sessionCount"],["type","number","id","sessionCount","name","sessionCount","min","1",1,"form-input",3,"ngModelChange","ngModel"],["for","sessionDuration"],["type","number","id","sessionDuration","name","sessionDuration","min","0.5","step","0.5",1,"form-input",3,"ngModelChange","ngModel"],["for","breakBetweenSessions"],["type","number","id","breakBetweenSessions","name","breakBetweenSessions","min","0",1,"form-input",3,"ngModelChange","ngModel"],[1,"schedule-row"],[1,"form-select",3,"ngModelChange","ngModel","name"],["type","time",1,"form-input",3,"ngModelChange","ngModel","name"],[1,"form-group","remove-btn"],["type","button","title","\u0625\u0632\u0627\u0644\u0629",1,"btn-icon","btn-danger",3,"click"],[1,"empty-schedule"],[1,"spinner-small"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"div",1)(2,"h1",2),u(3,"\u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u062D\u0635\u0635"),a(),s(4,"div",3)(5,"button",4),I("click",function(){return i.openAddLessonDialog()}),b(6,"i",5),u(7," \u0625\u0636\u0627\u0641\u0629 \u062D\u0635\u0629 \u062C\u062F\u064A\u062F\u0629 "),a(),s(8,"button",6),I("click",function(){return i.exportToExcel()}),b(9,"i",7),u(10," \u062A\u0635\u062F\u064A\u0631 "),a()()(),s(11,"div",8)(12,"div",9)(13,"div",10),b(14,"i",11),a(),s(15,"div",12)(16,"h3",13),u(17),a(),s(18,"p",14),u(19,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u062D\u0635\u0635"),a()()(),s(20,"div",9)(21,"div",10),b(22,"i",15),a(),s(23,"div",12)(24,"h3",13),u(25),a(),s(26,"p",14),u(27,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0637\u0644\u0627\u0628"),a()()(),s(28,"div",9)(29,"div",10),b(30,"i",16),a(),s(31,"div",12)(32,"h3",13),u(33),a(),s(34,"p",14),u(35,"\u0645\u062A\u0648\u0633\u0637 \u0627\u0644\u0633\u0639\u0631"),a()()(),s(36,"div",9)(37,"div",10),b(38,"i",17),a(),s(39,"div",12)(40,"h3",13),u(41),a(),s(42,"p",14),u(43,"\u062D\u0635\u0635 \u0634\u0647\u0631\u064A\u0629"),a()()()(),s(44,"div",18)(45,"div",19)(46,"h3"),u(47,"\u062A\u0635\u0641\u064A\u0629 \u0627\u0644\u0646\u062A\u0627\u0626\u062C"),a(),s(48,"button",20),I("click",function(){return i.clearFilters()}),u(49,"\u0625\u0639\u0627\u062F\u0629 \u062A\u0639\u064A\u064A\u0646"),a()(),s(50,"div",21)(51,"div",22)(52,"label",23),u(53,"\u0627\u0644\u0645\u0627\u062F\u0629"),a(),s(54,"select",24),ye("ngModelChange",function(o){return Ce(i.filterSubject,o)||(i.filterSubject=o),o}),I("ngModelChange",function(){return i.applyFilter()}),s(55,"option",25),u(56,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0645\u0648\u0627\u062F"),a(),j(57,FL,2,2,"option",26),a()(),s(58,"div",22)(59,"label",27),u(60,"\u0627\u0644\u0633\u0646\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),a(),s(61,"select",28),ye("ngModelChange",function(o){return Ce(i.filterAcademicYear,o)||(i.filterAcademicYear=o),o}),I("ngModelChange",function(){return i.applyFilter()}),s(62,"option",25),u(63,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0633\u0646\u0648\u0627\u062A"),a(),j(64,RL,2,2,"option",26),a()(),s(65,"div",22)(66,"label",29),u(67,"\u0627\u0633\u0645 \u0627\u0644\u0645\u062F\u0631\u0633"),a(),s(68,"input",30),ye("ngModelChange",function(o){return Ce(i.filterTeacher,o)||(i.filterTeacher=o),o}),I("ngModelChange",function(){return i.applyFilter()}),a()()()(),j(69,kL,6,1,"div",31),s(70,"div",32)(71,"div",33)(72,"table",34)(73,"thead")(74,"tr")(75,"th",35)(76,"input",36),I("change",function(){return i.toggleAllSelection()}),a()(),s(77,"th",37),I("click",function(){return i.onSort("name")}),u(78," \u0627\u0633\u0645 \u0627\u0644\u062D\u0635\u0629 "),j(79,NL,2,1,"span",38),a(),s(80,"th",37),I("click",function(){return i.onSort("subject")}),u(81," \u0627\u0644\u0645\u0627\u062F\u0629 "),j(82,UL,2,1,"span",38),a(),s(83,"th",37),I("click",function(){return i.onSort("academicYear")}),u(84," \u0627\u0644\u0633\u0646\u0629 "),j(85,LL,2,1,"span",38),a(),s(86,"th"),u(87,"\u0627\u0644\u0645\u062F\u0631\u0633"),a(),s(88,"th",37),I("click",function(){return i.onSort("price")}),u(89," \u0627\u0644\u0633\u0639\u0631 "),j(90,BL,2,1,"span",38),a(),s(91,"th"),u(92,"\u0627\u0644\u0637\u0644\u0627\u0628"),a(),s(93,"th"),u(94,"\u0646\u0638\u0627\u0645 \u0627\u0644\u062F\u0641\u0639"),a(),s(95,"th"),u(96,"\u0627\u0644\u062C\u062F\u0648\u0644"),a(),s(97,"th"),u(98,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(99,"tbody"),j(100,VL,36,14,"tr",39),a()()(),j(101,HL,10,0,"div",40)(102,zL,4,0,"div",41),a(),j(103,$L,9,6,"div",42)(104,YL,3,1,"div",43)(105,qL,3,1,"div",44),a(),j(106,r8,67,15,"div",45)),e&2&&(d(17),B(i.lessons.length),d(8),B(i.getTotalStudents()),d(8),B(i.formatPrice(i.getAveragePrice())),d(8),B(i.getMonthlyCount()),d(13),ve("ngModel",i.filterSubject),d(3),w("ngForOf",i.subjects),d(4),ve("ngModel",i.filterAcademicYear),d(3),w("ngForOf",i.academicYears),d(4),ve("ngModel",i.filterTeacher),d(),w("ngIf",i.selectedLessons.size>0),d(7),w("checked",i.selectedLessons.size===i.paginatedLessons.length&&i.paginatedLessons.length>0),d(),Ie("sorted",i.sortField==="name"),d(2),w("ngIf",i.sortField==="name"),d(),Ie("sorted",i.sortField==="subject"),d(2),w("ngIf",i.sortField==="subject"),d(),Ie("sorted",i.sortField==="academicYear"),d(2),w("ngIf",i.sortField==="academicYear"),d(3),Ie("sorted",i.sortField==="price"),d(2),w("ngIf",i.sortField==="price"),d(10),w("ngForOf",i.paginatedLessons),d(),w("ngIf",i.filteredLessons.length===0&&!i.loading),d(),w("ngIf",i.loading),d(),w("ngIf",i.totalPages>1),d(),w("ngIf",i.errorMessage),d(),w("ngIf",i.successMessage),d(),w("ngIf",i.showAddDialog))},dependencies:[hn,Nn,An,qs,B0,Un,Ti,Di,Pi,Yn,gr,di,ii,Ai,$i,_r,ti,mr],styles:['@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}.lesson-management-container[_ngcontent-%COMP%]{font-family:Cairo,sans-serif;background:#f8fafc;min-height:100vh;animation:_ngcontent-%COMP%_fadeIn .5s ease-out;margin:0;padding:0;height:100%;display:flex;flex-direction:column}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);padding:30px;border-radius:0 0 24px 24px;box-shadow:0 4px 20px #0000001a;margin-bottom:30px;color:#fff;position:relative;overflow:hidden}.header[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(45deg,rgba(255,255,255,.1),transparent);pointer-events:none}.header[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:2.2rem;font-weight:700;margin-bottom:15px;text-shadow:0 2px 4px rgba(0,0,0,.2)}.header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:15px;align-items:center}.btn[_ngcontent-%COMP%]{padding:12px 24px;border:none;border-radius:12px;font-size:.95rem;font-weight:600;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);display:inline-flex;align-items:center;justify-content:center;gap:8px;font-family:Cairo,sans-serif}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important}.btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4361ee,#3a0ca3);color:#fff;box-shadow:0 4px 15px #4361ee4d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #4361ee66}.btn-primary[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.btn-secondary[_ngcontent-%COMP%]{background:#fff3;color:#fff;border:2px solid rgba(255,255,255,.3);backdrop-filter:blur(10px)}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){background:#ffffff4d;border-color:#ffffff80}.btn-danger[_ngcontent-%COMP%]{background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;box-shadow:0 4px 15px #ef44444d}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #ef444466}.btn-link[_ngcontent-%COMP%]{background:transparent;color:#4361ee;text-decoration:underline;padding:8px 16px;font-size:.9rem}.btn-link[_ngcontent-%COMP%]:hover{color:#3a0ca3}.btn-outline[_ngcontent-%COMP%]{background:transparent;border:2px solid #4361ee;color:#4361ee}.btn-outline[_ngcontent-%COMP%]:hover{background:#4361ee1a}.btn-icon[_ngcontent-%COMP%]{width:40px;height:40px;padding:0;border-radius:10px;display:flex;align-items:center;justify-content:center;background:transparent;border:none;cursor:pointer;transition:all .3s ease}.btn-icon[_ngcontent-%COMP%]:hover{background:#0000000d}.btn-view[_ngcontent-%COMP%]{color:#4361ee}.btn-view[_ngcontent-%COMP%]:hover{background:#4361ee1a}.btn-delete[_ngcontent-%COMP%]{color:#ef4444}.btn-delete[_ngcontent-%COMP%]:hover{background:#ef44441a}.btn-close[_ngcontent-%COMP%]{font-size:1.2rem;color:#64748b}.btn-close[_ngcontent-%COMP%]:hover{color:#ef4444}.stats-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px;margin:-60px 30px 30px;position:relative;z-index:2}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:25px;box-shadow:0 8px 32px #00000014;display:flex;align-items:center;gap:20px;border:1px solid rgba(226,232,240,.5);transition:all .4s cubic-bezier(.34,1.56,.64,1);cursor:default;color:#fff}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-8px);box-shadow:0 16px 48px #0000001f;border-color:#4361ee}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:15px;display:flex;align-items:center;justify-content:center;font-size:1.8rem;flex-shrink:0}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   i.icon-class[_ngcontent-%COMP%]{color:#4361ee}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   i.icon-students[_ngcontent-%COMP%]{color:#10b981}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   i.icon-money[_ngcontent-%COMP%]{color:#f59e0b}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   i.icon-calendar[_ngcontent-%COMP%]{color:#8b5cf6}.stat-card[_ngcontent-%COMP%]   .stat-content[_ngcontent-%COMP%]{flex:1}.stat-card[_ngcontent-%COMP%]   .stat-content[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#fff;margin-bottom:5px;line-height:1}.stat-card[_ngcontent-%COMP%]   .stat-content[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#64748b;font-size:.9rem;font-weight:500;margin:0}.filters-section[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:25px;margin:30px;box-shadow:0 4px 20px #0000000d;border:1px solid #f1f5f9}.filters-section[_ngcontent-%COMP%]   .filters-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px}.filters-section[_ngcontent-%COMP%]   .filters-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;color:#1e293b;margin:0}.filters-section[_ngcontent-%COMP%]   .filters-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#475569;font-weight:500;font-size:.95rem}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:2px solid #e2e8f0;border-radius:12px;font-size:.95rem;font-family:Cairo,sans-serif;color:#1e293b;transition:all .3s ease;background:#fff}[_ngcontent-%COMP%]:is(.form-input,.form-select,.form-textarea):focus{outline:none;border-color:#4361ee;box-shadow:0 0 0 3px #4361ee1a}[_ngcontent-%COMP%]:is(.form-input,.form-select,.form-textarea)::placeholder{color:#94a3b8}.form-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:100px}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px}.form-grid.full-width[_ngcontent-%COMP%]{grid-template-columns:1fr}.bulk-actions[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4361ee1a,#4cc9f01a);border:2px dashed #4361ee;border-radius:16px;padding:20px;margin:0 30px 20px;display:flex;justify-content:space-between;align-items:center;animation:_ngcontent-%COMP%_slideIn .3s ease-out}.bulk-actions[_ngcontent-%COMP%]   .selected-count[_ngcontent-%COMP%]{font-weight:600;color:#4361ee;font-size:1rem}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.table-container[_ngcontent-%COMP%]{background:#fff;border-radius:20px;margin:0 30px;overflow:hidden;box-shadow:0 4px 20px #0000000d}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0;min-width:1200px}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9)}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:20px 16px;text-align:right;font-weight:600;color:#475569;font-size:.95rem;border-bottom:2px solid #e2e8f0;white-space:nowrap;cursor:pointer;transition:background-color .3s ease;position:relative}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:hover{background:#4361ee0d}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.sorted[_ngcontent-%COMP%]{color:#4361ee}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]   .sort-icon[_ngcontent-%COMP%]{margin-right:8px;font-size:.9rem}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:first-child{border-radius:20px 0 0}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{border-radius:0 20px 0 0}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #f1f5f9;transition:all .3s ease}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#4361ee08}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.clickable-row[_ngcontent-%COMP%]{cursor:pointer}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.clickable-row[_ngcontent-%COMP%]:hover{background:#4361ee0d;transform:translate(-4px)}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:18px 16px;color:#475569;font-size:.95rem;border-bottom:1px solid #f1f5f9}.checkbox-cell[_ngcontent-%COMP%]{width:50px;text-align:center}.checkbox-cell[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:18px;height:18px;border-radius:4px;border:2px solid #cbd5e1;cursor:pointer;transition:all .3s ease;appearance:none;position:relative}.checkbox-cell[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked{background:#4361ee;border-color:#4361ee}.checkbox-cell[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked:after{content:"\\2713";position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-size:.8rem;font-weight:700}.checkbox-cell[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover:not(:checked){border-color:#4361ee}.lesson-name-cell[_ngcontent-%COMP%]   .lesson-name[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;margin-bottom:4px}.lesson-name-cell[_ngcontent-%COMP%]   .lesson-id[_ngcontent-%COMP%]{font-size:.8rem;color:#94a3b8}.subject-badge[_ngcontent-%COMP%]{display:inline-block;padding:6px 12px;background:#4361ee1a;color:#4361ee;border-radius:20px;font-size:.85rem;font-weight:500}.teacher-cell[_ngcontent-%COMP%]   .teacher-name[_ngcontent-%COMP%]{font-weight:500;color:#1e293b}.price-cell[_ngcontent-%COMP%]{font-weight:700;color:#10b981;font-size:1rem}.students-count[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#64748b;font-weight:500}.students-count[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#10b981;font-size:1.1rem}.payment-badge[_ngcontent-%COMP%]{display:inline-block;padding:6px 12px;border-radius:20px;font-size:.85rem;font-weight:500}.payment-badge.monthly[_ngcontent-%COMP%]{background:#8b5cf61a;color:#8b5cf6}.payment-badge.rounds[_ngcontent-%COMP%]{background:#f59e0b1a;color:#f59e0b}.schedule-cell[_ngcontent-%COMP%]   .schedule-list[_ngcontent-%COMP%]{max-width:200px;font-size:.9rem;color:#64748b;line-height:1.4}.actions-cell[_ngcontent-%COMP%]{width:120px}.actions-cell[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px;opacity:0;transition:opacity .3s ease}tr[_ngcontent-%COMP%]:hover   .actions-cell[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{opacity:1}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.empty-state[_ngcontent-%COMP%]   .empty-state-icon[_ngcontent-%COMP%]{width:80px;height:80px;margin:0 auto 20px;background:linear-gradient(135deg,#4361ee1a,#4cc9f01a);border-radius:50%;display:flex;align-items:center;justify-content:center}.empty-state[_ngcontent-%COMP%]   .empty-state-icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2.5rem;color:#4361ee}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;color:#1e293b;margin-bottom:10px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#64748b;margin-bottom:25px;max-width:400px;margin-left:auto;margin-right:auto}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:3px solid rgba(67,97,238,.1);border-top-color:#4361ee;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 20px}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#64748b;font-size:.95rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:15px;padding:25px;margin:0 30px}.pagination[_ngcontent-%COMP%]   .pagination-btn[_ngcontent-%COMP%]{width:40px;height:40px;border:2px solid #e2e8f0;border-radius:10px;background:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;color:#64748b}.pagination[_ngcontent-%COMP%]   .pagination-btn[_ngcontent-%COMP%]:hover:not(:disabled){border-color:#4361ee;color:#4361ee;transform:translateY(-2px)}.pagination[_ngcontent-%COMP%]   .pagination-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   .pagination-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.pagination[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]{display:flex;gap:5px}.pagination[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]{min-width:40px;height:40px;border:2px solid #e2e8f0;border-radius:10px;background:#fff;color:#64748b;font-weight:500;cursor:pointer;transition:all .3s ease}.pagination[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]:hover{border-color:#4361ee;color:#4361ee}.pagination[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number.active[_ngcontent-%COMP%]{background:#4361ee;border-color:#4361ee;color:#fff}.pagination[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .ellipsis[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:40px;color:#94a3b8}.pagination[_ngcontent-%COMP%]   .pagination-info[_ngcontent-%COMP%]{color:#64748b;font-size:.9rem;margin-right:auto}.alert[_ngcontent-%COMP%]{padding:16px 20px;border-radius:12px;margin:20px 30px;display:flex;align-items:center;gap:12px;animation:_ngcontent-%COMP%_slideIn .3s ease-out}.alert[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.2rem}.alert.alert-error[_ngcontent-%COMP%]{background:#ef44441a;color:#ef4444;border:1px solid rgba(239,68,68,.2)}.alert.alert-success[_ngcontent-%COMP%]{background:#10b9811a;color:#10b981;border:1px solid rgba(16,185,129,.2)}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000b3;backdrop-filter:blur(5px);display:flex;align-items:center;justify-content:center;z-index:2000;padding:20px;animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:24px;width:100%;max-width:800px;max-height:90vh;overflow-y:auto;box-shadow:0 25px 50px -12px #00000040;animation:_ngcontent-%COMP%_modalSlideIn .3s cubic-bezier(.34,1.56,.64,1)}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{padding:25px 30px;border-bottom:1px solid #f1f5f9;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;background:#fff;border-radius:24px 24px 0 0;z-index:1}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;color:#1e293b}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:30px}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .section-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.1rem;color:#1e293b}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .round-settings[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .schedule-section[_ngcontent-%COMP%]{margin-top:30px;padding-top:25px;border-top:1px solid #f1f5f9}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .schedule-row[_ngcontent-%COMP%]{background:#f8fafc;border-radius:12px;padding:20px;margin-bottom:15px;border:1px solid #e2e8f0}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .schedule-row[_ngcontent-%COMP%]   .remove-btn[_ngcontent-%COMP%]{display:flex;align-items:flex-end}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .empty-schedule[_ngcontent-%COMP%]{text-align:center;padding:30px;background:#f8fafc;border-radius:12px;border:2px dashed #e2e8f0}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .empty-schedule[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#94a3b8;margin:0}.modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{padding:20px 30px;border-top:1px solid #f1f5f9;display:flex;justify-content:flex-end;gap:15px;position:sticky;bottom:0;background:#fff;border-radius:0 0 24px 24px}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(30px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.spinner-small[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;display:inline-block;margin-left:8px}@media (max-width: 768px){.header[_ngcontent-%COMP%]{padding:20px;text-align:center}.header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{flex-direction:column;gap:10px}.stats-container[_ngcontent-%COMP%]{margin:-40px 20px 20px;grid-template-columns:repeat(2,1fr);color:#fff}.stat-card[_ngcontent-%COMP%]{padding:20px}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:50px;height:50px;font-size:1.5rem}.stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:1.5rem;color:#fff}.filters-section[_ngcontent-%COMP%], .bulk-actions[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%], .pagination[_ngcontent-%COMP%], .alert[_ngcontent-%COMP%]{margin:20px}.filters-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.bulk-actions[_ngcontent-%COMP%]{flex-direction:column;gap:15px;text-align:center}.pagination[_ngcontent-%COMP%]{flex-wrap:wrap;gap:10px}.pagination[_ngcontent-%COMP%]   .pagination-info[_ngcontent-%COMP%]{margin-right:0;width:100%;text-align:center;order:3;margin-top:10px}.modal[_ngcontent-%COMP%]{margin:20px}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:20px}.modal[_ngcontent-%COMP%]   .form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal[_ngcontent-%COMP%]   .schedule-row[_ngcontent-%COMP%]   .form-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(auto-fit,minmax(150px,1fr))}}@media (max-width: 480px){.stats-container[_ngcontent-%COMP%]{grid-template-columns:1fr}.stat-card[_ngcontent-%COMP%]{flex-direction:column;text-align:center;gap:15px}.page-title[_ngcontent-%COMP%]{font-size:1.8rem}.modal-footer[_ngcontent-%COMP%]{flex-direction:column}.modal-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}@media (prefers-color-scheme: dark){.lesson-management-container[_ngcontent-%COMP%]{background:#0f172a}.header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4338ca,#7c3aed)}.stat-card[_ngcontent-%COMP%], .filters-section[_ngcontent-%COMP%], .table-container[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]{background:#1e293b;border-color:#334155;color:#e2e8f0}.stat-value[_ngcontent-%COMP%], .page-title[_ngcontent-%COMP%], .modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .section-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#f1f5f9}.stat-label[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], .filters-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .selected-count[_ngcontent-%COMP%], .pagination-info[_ngcontent-%COMP%]{color:#cbd5e1}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{background:#334155;border-color:#475569;color:#f1f5f9}[_ngcontent-%COMP%]:is(.form-input,.form-select,.form-textarea):focus{border-color:#6366f1}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:#1e293bcc}.data-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{color:#cbd5e1;border-bottom-color:#475569}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom-color:#334155}.data-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#cbd5e1;border-bottom-color:#334155}.subject-badge[_ngcontent-%COMP%], .payment-badge[_ngcontent-%COMP%]{opacity:.9}.empty-schedule[_ngcontent-%COMP%], .schedule-row[_ngcontent-%COMP%]{background:#334155;border-color:#475569}.pagination-btn[_ngcontent-%COMP%], .page-number[_ngcontent-%COMP%]{background:#334155;border-color:#475569;color:#cbd5e1}.page-number.active[_ngcontent-%COMP%]{background:#4f46e5}}']})};$();var ni=ya(Na());$();var Vc=class n{constructor(t,e){this.http=t;this.authService=e}apiUrl=Bt.apiUrl;getStudents(){return this.http.get(`${this.apiUrl}/students`,{headers:this.authService.getAuthHeaders()})}getStudentById(t){return this.http.get(`${this.apiUrl}/students/${t}`,{headers:this.authService.getAuthHeaders()})}createStudent(t){return this.http.post(`${this.apiUrl}/students`,t,{headers:this.authService.getAuthHeaders()})}updateStudent(t,e){return this.http.put(`${this.apiUrl}/students/${t}`,e,{headers:this.authService.getAuthHeaders()})}deleteStudent(t){return this.http.delete(`${this.apiUrl}/students/${t}`,{headers:this.authService.getAuthHeaders()})}payRegistrationFee(t,e){return this.http.post(`${this.apiUrl}/students/${t}/pay-registration`,e,{headers:this.authService.getAuthHeaders()})}getStudentClasses(t){return this.http.get(`${this.apiUrl}/students/${t}/classes`,{headers:this.authService.getAuthHeaders()})}getStudentsWithoutAccounts(){return this.http.get(`${this.apiUrl}/students?hasAccount=false`,{headers:this.authService.getAuthHeaders()})}enrollStudentMultiple(t,e){return this.http.post(`${this.apiUrl}/students/${t}/enroll-multiple`,e,{headers:this.authService.getAuthHeaders()})}static \u0275fac=function(e){return new(e||n)(We(pn),We(qn))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})};function o8(n,t){if(n&1&&(s(0,"option",30),u(1),a()),n&2){let e=t.$implicit;w("value",e.value),d(),H(" ",e.label," ")}}function s8(n,t){n&1&&(s(0,"div",31),b(1,"div",32),s(2,"h3"),u(3,"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0637\u0644\u0627\u0628..."),a(),s(4,"p"),u(5,"\u064A\u0631\u062C\u0649 \u0627\u0644\u0627\u0646\u062A\u0638\u0627\u0631 \u0642\u0644\u064A\u0644\u0627\u064B"),a()())}function a8(n,t){if(n&1){let e=he();s(0,"div",33),b(1,"i",34),s(2,"h3"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0637\u0644\u0627\u0628"),a(),s(4,"p"),u(5,"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u0649 \u0623\u064A \u0637\u0644\u0627\u0628 \u0645\u0637\u0627\u0628\u0642\u064A\u0646 \u0644\u0628\u062D\u062B\u0643. \u062C\u0631\u0628 \u0645\u0635\u0637\u0644\u062D\u0627\u062A \u0628\u062D\u062B \u0645\u062E\u062A\u0644\u0641\u0629 \u0623\u0648 \u0633\u062C\u0644 \u0637\u0627\u0644\u0628\u0627\u064B \u062C\u062F\u064A\u062F\u0627\u064B."),a(),s(6,"div",35)(7,"button",7),I("click",function(){F(e);let r=E();return R(r.openRegistrationForm())}),b(8,"i",8),s(9,"span"),u(10,"\u0625\u0636\u0627\u0641\u0629 \u0637\u0627\u0644\u0628"),a()(),s(11,"button",9),I("click",function(){F(e);let r=E();return R(r.openBulkImportForm())}),b(12,"i",10),s(13,"span"),u(14,"\u0627\u0633\u062A\u064A\u0631\u0627\u062F \u062C\u0645\u0627\u0639\u064A"),a()()()()}}function l8(n,t){if(n&1&&(s(0,"div",60),b(1,"i",69),s(2,"span"),u(3),ut(4,"date"),a()()),n&2){let e=E().$implicit;d(3),H("\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062A\u0633\u062C\u064A\u0644: ",pt(4,1,e.registrationDate,"dd/MM/yyyy"),"")}}function u8(n,t){if(n&1&&(s(0,"div",60),b(1,"i",70),s(2,"span"),u(3),ut(4,"date"),a()()),n&2){let e=E().$implicit;d(3),H("\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0645\u064A\u0644\u0627\u062F: ",pt(4,1,e.birthDate,"dd/MM/yyyy"),"")}}function c8(n,t){if(n&1){let e=he();s(0,"div",38)(1,"div",39)(2,"div",40)(3,"div",41),u(4),a()(),s(5,"div",42)(6,"h3"),u(7),a(),s(8,"p",43),u(9),a(),s(10,"div",44)(11,"span",45),u(12),a(),s(13,"span",46),u(14),a()()(),s(15,"div",47)(16,"button",48),I("click",function(r){F(e);let o=E(2);return R(o.toggleDropdown(r))}),b(17,"i",49),a(),s(18,"div",50)(19,"button",51),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.viewStudentDetails(r))}),b(20,"i",52),s(21,"span"),u(22,"\u0639\u0631\u0636 \u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644"),a()(),s(23,"button",51),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.editStudent(r))}),b(24,"i",53),s(25,"span"),u(26,"\u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A"),a()(),s(27,"button",54),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.openPaymentModal(r))}),b(28,"i",55),s(29,"span"),u(30),a()(),b(31,"div",56),s(32,"button",57),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.deleteStudent(r))}),b(33,"i",58),s(34,"span"),u(35,"\u062D\u0630\u0641 \u0627\u0644\u0637\u0627\u0644\u0628"),a()()()()(),s(36,"div",59)(37,"div",60),b(38,"i",61),s(39,"span"),u(40),a()(),s(41,"div",60),b(42,"i",62),s(43,"span"),u(44),a()(),s(45,"div",60),b(46,"i",63),s(47,"span"),u(48),a()(),j(49,l8,5,4,"div",64)(50,u8,5,4,"div",64),a(),s(51,"div",65)(52,"button",66),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.viewStudentDetails(r))}),b(53,"i",52),s(54,"span",67),u(55,"\u0639\u0631\u0636 \u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644"),a()(),s(56,"button",68),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.openPaymentModal(r))}),b(57,"i",55),s(58,"span",67),u(59),a()()()()}if(n&2){let e=t.$implicit,i=E(2);d(2),fr("background",i.getAvatarColor(e)),d(2),H(" ",i.getStudentInitials(e)," "),d(3),B(e.name),d(2),H("\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628: ",e.studentId||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F",""),d(3),B(i.getAcademicYearName(e.academicYear)),d(),Kn(i.getPaymentStatusClass(e)),d(),H(" ",i.getPaymentStatus(e)," "),d(13),w("disabled",e.hasPaidRegistration),d(3),B(e.hasPaidRegistration?"\u0631\u0633\u0648\u0645 \u0645\u062F\u0641\u0648\u0639\u0629":"\u062F\u0641\u0639 \u0627\u0644\u0631\u0633\u0648\u0645"),d(10),H("\u0627\u0644\u0645\u0633\u062A\u0648\u0649: ",i.getAcademicYearName(e.academicYear),""),d(4),H("\u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631: ",e.parentName||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F",""),d(4),H("\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062A\u0641: ",e.parentPhone||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F",""),d(),w("ngIf",e.registrationDate),d(),w("ngIf",e.birthDate),d(6),w("disabled",e.hasPaidRegistration),d(3),H(" ",e.hasPaidRegistration?"\u0645\u062F\u0641\u0648\u0639":"\u062F\u0641\u0639 \u0627\u0644\u0631\u0633\u0648\u0645"," ")}}function d8(n,t){if(n&1&&(s(0,"div",36),j(1,c8,60,18,"div",37),a()),n&2){let e=E();d(),w("ngForOf",e.getDisplayedStudents())}}function f8(n,t){if(n&1&&(s(0,"option",30),u(1),a()),n&2){let e=t.$implicit;w("value",e.value),d(),H(" ",e.label," ")}}function h8(n,t){n&1&&b(0,"span",98)}function p8(n,t){if(n&1){let e=he();s(0,"div",71),I("click",function(){F(e);let r=E();return R(r.closeRegistrationForm())}),s(1,"div",72),I("click",function(r){return F(e),R(r.stopPropagation())}),s(2,"div",73)(3,"h2"),u(4),a(),s(5,"button",74),I("click",function(){F(e);let r=E();return R(r.closeRegistrationForm())}),b(6,"i",75),a()(),s(7,"div",76)(8,"form",77),I("submit",function(r){return F(e),E().registerStudent(),R(r.preventDefault())}),s(9,"div",78)(10,"div",79)(11,"label",80),u(12,"\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628 *"),a(),s(13,"input",81),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newStudent.name,r)||(o.newStudent.name=r),R(r)}),a()(),s(14,"div",79)(15,"label",82),u(16,"\u0627\u0644\u0645\u0633\u062A\u0648\u0649 \u0627\u0644\u062F\u0631\u0627\u0633\u064A *"),a(),s(17,"select",83),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newStudent.academicYear,r)||(o.newStudent.academicYear=r),R(r)}),s(18,"option",84),u(19,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0645\u0633\u062A\u0648\u0649"),a(),j(20,f8,2,2,"option",22),a()()(),s(21,"div",78)(22,"div",79)(23,"label",85),u(24,"\u0627\u0633\u0645 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631"),a(),s(25,"input",86),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newStudent.parentName,r)||(o.newStudent.parentName=r),R(r)}),a()(),s(26,"div",79)(27,"label",87),u(28,"\u0631\u0642\u0645 \u0647\u0627\u062A\u0641 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631"),a(),s(29,"input",88),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newStudent.parentPhone,r)||(o.newStudent.parentPhone=r),R(r)}),a()()(),s(30,"div",78)(31,"div",79)(32,"label",89),u(33,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0645\u064A\u0644\u0627\u062F"),a(),s(34,"input",90),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newStudent.birthDate,r)||(o.newStudent.birthDate=r),R(r)}),a()(),s(35,"div",79)(36,"label",91),u(37,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062A\u0633\u062C\u064A\u0644"),a(),s(38,"input",92),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newStudent.registrationDate,r)||(o.newStudent.registrationDate=r),R(r)}),a()()()()(),s(39,"div",93)(40,"button",11),I("click",function(){F(e);let r=E();return R(r.closeRegistrationForm())}),b(41,"i",94),s(42,"span"),u(43,"\u0625\u0644\u063A\u0627\u0621"),a()(),s(44,"button",95),I("click",function(){F(e);let r=E();return R(r.registerStudent())}),b(45,"i",96),s(46,"span"),u(47),a(),j(48,h8,1,0,"span",97),a()()()()}if(n&2){let e=E();d(4),B(e.editMode?"\u062A\u0639\u062F\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0637\u0627\u0644\u0628":"\u062A\u0633\u062C\u064A\u0644 \u0637\u0627\u0644\u0628 \u062C\u062F\u064A\u062F"),d(9),ve("ngModel",e.newStudent.name),d(4),ve("ngModel",e.newStudent.academicYear),d(3),w("ngForOf",e.academicYears.slice(1)),d(5),ve("ngModel",e.newStudent.parentName),d(4),ve("ngModel",e.newStudent.parentPhone),d(5),ve("ngModel",e.newStudent.birthDate),d(4),ve("ngModel",e.newStudent.registrationDate),d(6),w("disabled",e.loading),d(3),B(e.editMode?"\u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A":"\u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u0637\u0627\u0644\u0628"),d(),w("ngIf",e.loading)}}function m8(n,t){if(n&1&&(s(0,"option",30),u(1),a()),n&2){let e=t.$implicit;w("value",e.value),d(),H(" ",e.label," ")}}function g8(n,t){if(n&1&&(s(0,"option",30),u(1),a()),n&2){let e=t.$implicit;w("value",e.value),d(),H(" ",e.label," ")}}function _8(n,t){if(n&1){let e=he();s(0,"tr")(1,"td"),u(2),a(),s(3,"td")(4,"input",118),ye("ngModelChange",function(r){let o=F(e).$implicit;return Ce(o.name,r)||(o.name=r),R(r)}),a()(),s(5,"td")(6,"input",119),ye("ngModelChange",function(r){let o=F(e).$implicit;return Ce(o.parentName,r)||(o.parentName=r),R(r)}),a()(),s(7,"td")(8,"input",120),ye("ngModelChange",function(r){let o=F(e).$implicit;return Ce(o.parentPhone,r)||(o.parentPhone=r),R(r)}),a()(),s(9,"td")(10,"select",121),ye("ngModelChange",function(r){let o=F(e).$implicit;return Ce(o.academicYear,r)||(o.academicYear=r),R(r)}),s(11,"option",84),u(12,"\u0627\u062E\u062A\u0631 \u0645\u0633\u062A\u0648\u0649"),a(),j(13,g8,2,2,"option",22),a()(),s(14,"td")(15,"input",122),ye("ngModelChange",function(r){let o=F(e).$implicit;return Ce(o.birthDate,r)||(o.birthDate=r),R(r)}),a()(),s(16,"td")(17,"button",123),I("click",function(){let r=F(e).index,o=E(2);return R(o.removeImportRow(r))}),b(18,"i",124),a()()()}if(n&2){let e=t.$implicit,i=t.index,r=E(2);d(2),B(i+1),d(2),ve("ngModel",e.name),d(2),ve("ngModel",e.parentName),d(2),ve("ngModel",e.parentPhone),d(2),ve("ngModel",e.academicYear),d(3),w("ngForOf",r.academicYears.slice(1)),d(2),ve("ngModel",e.birthDate),d(2),w("disabled",r.bulkImportData.students.length===1)}}function v8(n,t){n&1&&b(0,"span",98)}function y8(n,t){if(n&1){let e=he();s(0,"div",71),I("click",function(){F(e);let r=E();return R(r.closeBulkImportForm())}),s(1,"div",99),I("click",function(r){return F(e),R(r.stopPropagation())}),s(2,"div",73)(3,"h2"),u(4,"\u0627\u0644\u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u062C\u0645\u0627\u0639\u064A\u0629 \u0644\u0644\u0637\u0644\u0627\u0628"),a(),s(5,"button",74),I("click",function(){F(e);let r=E();return R(r.closeBulkImportForm())}),b(6,"i",75),a()(),s(7,"div",76)(8,"div",100)(9,"div",101)(10,"div",102),I("click",function(){F(e);let r=E();return R(r.downloadImportTemplate())}),b(11,"i",103),s(12,"h4"),u(13,"\u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0646\u0645\u0648\u0630\u062C"),a(),s(14,"p"),u(15,"\u0646\u0645\u0648\u0630\u062C CSV \u0644\u0645\u0644\u0621 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A"),a()(),s(16,"div",102),I("click",function(){F(e);let r=E();return R(r.importFromText())}),b(17,"i",104),s(18,"h4"),u(19,"\u0646\u0633\u062E \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A"),a(),s(20,"p"),u(21,"\u0625\u062F\u062E\u0627\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A \u0643\u0646\u0635"),a()(),s(22,"div",102),I("click",function(){F(e);let r=E();return R(r.addImportRow())}),b(23,"i",105),s(24,"h4"),u(25,"\u0625\u0636\u0627\u0641\u0629 \u064A\u062F\u0648\u064A\u0629"),a(),s(26,"p"),u(27,"\u0625\u0636\u0627\u0641\u0629 \u0633\u062C\u0644\u0627\u062A \u062C\u062F\u064A\u062F\u0629"),a()()(),s(28,"div",106)(29,"label",107),u(30,"\u0627\u0644\u0645\u0633\u062A\u0648\u0649 \u0627\u0644\u0627\u0641\u062A\u0631\u0627\u0636\u064A \u0644\u062C\u0645\u064A\u0639 \u0627\u0644\u0637\u0644\u0627\u0628 (\u0627\u062E\u062A\u064A\u0627\u0631\u064A)"),a(),s(31,"select",108),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.bulkImportData.academicYear,r)||(o.bulkImportData.academicYear=r),R(r)}),s(32,"option",84),u(33,"\u0627\u062E\u062A\u0631 \u0645\u0633\u062A\u0648\u0649 \u0627\u0641\u062A\u0631\u0627\u0636\u064A"),a(),j(34,m8,2,2,"option",22),a(),s(35,"small",109),u(36,"\u0633\u064A\u062A\u0645 \u062A\u0637\u0628\u064A\u0642 \u0647\u0630\u0627 \u0627\u0644\u0645\u0633\u062A\u0648\u0649 \u0639\u0644\u0649 \u062C\u0645\u064A\u0639 \u0627\u0644\u0637\u0644\u0627\u0628 \u0645\u0627 \u0644\u0645 \u064A\u062A\u0645 \u062A\u062D\u062F\u064A\u062F \u0645\u0633\u062A\u0648\u0649 \u0645\u062E\u062A\u0644\u0641 \u0644\u0643\u0644 \u0637\u0627\u0644\u0628"),a()(),s(37,"div",110)(38,"div",111)(39,"h4"),u(40),a(),s(41,"button",112),I("click",function(){F(e);let r=E();return R(r.addImportRow())}),b(42,"i",113),u(43," \u0625\u0636\u0627\u0641\u0629 \u0637\u0627\u0644\u0628 "),a()(),s(44,"div",114)(45,"table",115)(46,"thead")(47,"tr")(48,"th"),u(49,"#"),a(),s(50,"th"),u(51,"\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628 *"),a(),s(52,"th"),u(53,"\u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631"),a(),s(54,"th"),u(55,"\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062A\u0641"),a(),s(56,"th"),u(57,"\u0627\u0644\u0645\u0633\u062A\u0648\u0649"),a(),s(58,"th"),u(59,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0645\u064A\u0644\u0627\u062F"),a(),s(60,"th"),u(61,"\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(62,"tbody"),j(63,_8,19,8,"tr",116),a()()()()()(),s(64,"div",93)(65,"button",11),I("click",function(){F(e);let r=E();return R(r.closeBulkImportForm())}),b(66,"i",94),s(67,"span"),u(68,"\u0625\u0644\u063A\u0627\u0621"),a()(),s(69,"button",13),I("click",function(){F(e);let r=E();return R(r.downloadImportTemplate())}),b(70,"i",117),s(71,"span"),u(72,"\u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0646\u0645\u0648\u0630\u062C"),a()(),s(73,"button",95),I("click",function(){F(e);let r=E();return R(r.importStudents())}),b(74,"i",10),s(75,"span"),u(76),a(),j(77,v8,1,0,"span",97),a()()()()}if(n&2){let e=E();d(31),ve("ngModel",e.bulkImportData.academicYear),d(3),w("ngForOf",e.academicYears.slice(1)),d(6),H("\u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0637\u0644\u0627\u0628 (",e.bulkImportData.students.length," \u0637\u0627\u0644\u0628)"),d(23),w("ngForOf",e.bulkImportData.students),d(10),w("disabled",e.loading||e.bulkImportData.students.length===0),d(3),H("\u0627\u0633\u062A\u064A\u0631\u0627\u062F ",e.bulkImportData.students.length," \u0637\u0627\u0644\u0628"),d(),w("ngIf",e.loading)}}function x8(n,t){n&1&&b(0,"span",98)}function b8(n,t){if(n&1){let e=he();s(0,"div",71),I("click",function(){F(e);let r=E();return R(r.closePaymentModal())}),s(1,"div",72),I("click",function(r){return F(e),R(r.stopPropagation())}),s(2,"div",73)(3,"h2"),u(4,"\u062F\u0641\u0639 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644"),a(),s(5,"button",74),I("click",function(){F(e);let r=E();return R(r.closePaymentModal())}),b(6,"i",75),a()(),s(7,"div",76)(8,"div",125)(9,"div",126)(10,"div",40)(11,"div",41),u(12),a()(),s(13,"div",127)(14,"h3"),u(15),a(),s(16,"p",43),u(17),a(),s(18,"p",128),u(19),a()()(),s(20,"form",129),I("submit",function(r){return F(e),E().processPayment(),R(r.preventDefault())}),s(21,"div",78)(22,"div",79)(23,"label",130),u(24,"\u0627\u0644\u0645\u0628\u0644\u063A (\u062F\u064A\u0646\u0627\u0631 \u062C\u0632\u0627\u0626\u0631\u064A) *"),a(),s(25,"input",131),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.paymentData.amount,r)||(o.paymentData.amount=r),R(r)}),a()(),s(26,"div",79)(27,"label",132),u(28,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639 *"),a(),s(29,"select",133),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.paymentData.paymentMethod,r)||(o.paymentData.paymentMethod=r),R(r)}),s(30,"option",134),u(31,"\u0646\u0642\u062F\u0627\u064B"),a(),s(32,"option",135),u(33,"\u0628\u0637\u0627\u0642\u0629 \u0627\u0626\u062A\u0645\u0627\u0646"),a(),s(34,"option",136),u(35,"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A"),a(),s(36,"option",137),u(37,"\u0634\u064A\u0643"),a()()()(),s(38,"div",79)(39,"label",138),u(40,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A \u0625\u0636\u0627\u0641\u064A\u0629"),a(),s(41,"textarea",139),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.paymentData.notes,r)||(o.paymentData.notes=r),R(r)}),a()()()()(),s(42,"div",93)(43,"button",11),I("click",function(){F(e);let r=E();return R(r.closePaymentModal())}),b(44,"i",94),s(45,"span"),u(46,"\u0625\u0644\u063A\u0627\u0621"),a()(),s(47,"button",95),I("click",function(){F(e);let r=E();return R(r.processPayment())}),b(48,"i",55),s(49,"span"),u(50,"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062F\u0641\u0639"),a(),j(51,x8,1,0,"span",97),a()()()()}if(n&2){let e=E();d(10),fr("background",e.getAvatarColor(e.selectedStudent)),d(2),H(" ",e.getStudentInitials(e.selectedStudent)," "),d(3),B(e.selectedStudent.name),d(2),H("\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628: ",e.selectedStudent.studentId||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F",""),d(2),H("\u0627\u0644\u0645\u0633\u062A\u0648\u0649: ",e.getAcademicYearName(e.selectedStudent.academicYear),""),d(6),ve("ngModel",e.paymentData.amount),d(4),ve("ngModel",e.paymentData.paymentMethod),d(12),ve("ngModel",e.paymentData.notes),d(6),w("disabled",e.loading),d(4),w("ngIf",e.loading)}}var kg=class n{constructor(t,e){this.studentsService=t;this.router=e}toggleBodyScroll(t){if(typeof document<"u"){let e=document.querySelector("body");e&&(t?e.classList.add("no-scroll","modal-open"):e.classList.remove("no-scroll","modal-open"))}}students=[];filteredStudents=[];loading=!1;searchTerm="";selectedAcademicYear="all";showRegistrationForm=!1;showEditForm=!1;showBulkImportForm=!1;showPaymentModal=!1;selectedStudent=null;editMode=!1;newStudent={name:"",parentName:"",parentPhone:"",academicYear:"",birthDate:"",registrationDate:new Date().toISOString().split("T")[0]};bulkImportData={students:[{name:"",parentName:"",parentPhone:"",academicYear:"",birthDate:""}],delimiter:",",academicYear:""};paymentData={amount:600,paymentMethod:"cash",notes:""};academicYears=[{value:"all",label:"\u062C\u0645\u064A\u0639 \u0627\u0644\u0645\u0633\u062A\u0648\u064A\u0627\u062A"},{value:"1AS",label:"\u0627\u0644\u0623\u0648\u0644\u0649 \u062B\u0627\u0646\u0648\u064A"},{value:"2AS",label:"\u0627\u0644\u062B\u0627\u0646\u064A\u0629 \u062B\u0627\u0646\u0648\u064A"},{value:"3AS",label:"\u0627\u0644\u062B\u0627\u0644\u062B\u0629 \u062B\u0627\u0646\u0648\u064A"},{value:"1MS",label:"\u0627\u0644\u0623\u0648\u0644\u0649 \u0645\u062A\u0648\u0633\u0637"},{value:"2MS",label:"\u0627\u0644\u062B\u0627\u0646\u064A\u0629 \u0645\u062A\u0648\u0633\u0637"},{value:"3MS",label:"\u0627\u0644\u062B\u0627\u0644\u062B\u0629 \u0645\u062A\u0648\u0633\u0637"},{value:"4MS",label:"\u0627\u0644\u0631\u0627\u0628\u0639\u0629 \u0645\u062A\u0648\u0633\u0637"},{value:"1AP",label:"\u0627\u0644\u0623\u0648\u0644\u0649 \u0627\u0628\u062A\u062F\u0627\u0626\u064A"},{value:"2AP",label:"\u0627\u0644\u062B\u0627\u0646\u064A\u0629 \u0627\u0628\u062A\u062F\u0627\u0626\u064A"},{value:"3AP",label:"\u0627\u0644\u062B\u0627\u0644\u062B\u0629 \u0627\u0628\u062A\u062F\u0627\u0626\u064A"},{value:"4AP",label:"\u0627\u0644\u0631\u0627\u0628\u0639\u0629 \u0627\u0628\u062A\u062F\u0627\u0626\u064A"},{value:"5AP",label:"\u0627\u0644\u062E\u0627\u0645\u0633\u0629 \u0627\u0628\u062A\u062F\u0627\u0626\u064A"}];ngOnInit(){this.loadStudents()}loadStudents(){this.loading=!0,this.studentsService.getStudents().subscribe({next:t=>{this.students=t,this.filteredStudents=[...this.students],this.loading=!1},error:t=>{console.error("Error loading students:",t),ni.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0637\u0644\u0627\u0628","error"),this.loading=!1}})}filterStudents(){this.filteredStudents=this.students.filter(t=>{let e=!this.searchTerm||t.name.toLowerCase().includes(this.searchTerm.toLowerCase())||t.studentId&&t.studentId.includes(this.searchTerm)||t.parentName&&t.parentName.toLowerCase().includes(this.searchTerm.toLowerCase()),i=this.selectedAcademicYear==="all"||t.academicYear===this.selectedAcademicYear;return e&&i})}getDisplayedStudents(){return this.filteredStudents}clearSearch(){this.searchTerm="",this.selectedAcademicYear="all",this.filterStudents()}getAvatarColor(t){if(!t)return"#0a66c2";let e=["#0a66c2","#004182","#2563eb","#3b82f6","#7c3aed","#10b981","#06b6d4","#f59e0b","#ef4444","#8b5cf6"],i=t.name.length%e.length;return e[i]}getStudentInitials(t){return t?t.name.charAt(0).toUpperCase():"?"}getAcademicYearName(t){if(!t)return"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F";let e=this.academicYears.find(i=>i.value===t);return e?e.label:t}getPaymentStatus(t){return t.hasPaidRegistration?"\u0645\u062F\u0641\u0648\u0639":"\u063A\u064A\u0631 \u0645\u062F\u0641\u0648\u0639"}getPaymentStatusClass(t){return t.hasPaidRegistration?"status-paid":"status-unpaid"}openRegistrationForm(){this.editMode=!1,this.resetForm(),this.showRegistrationForm=!0,this.toggleBodyScroll(!0)}editStudent(t){this.editMode=!0,this.selectedStudent=t,this.newStudent={name:t.name,parentName:t.parentName||"",parentPhone:t.parentPhone||"",academicYear:t.academicYear,birthDate:t.birthDate||"",registrationDate:t.registrationDate?new Date(t.registrationDate).toISOString().split("T")[0]:new Date().toISOString().split("T")[0]},this.showRegistrationForm=!0}closeRegistrationForm(){this.showRegistrationForm=!1,this.selectedStudent=null,this.toggleBodyScroll(!1),this.resetForm()}registerStudent(){if(this.validateStudentForm())if(this.loading=!0,this.editMode&&this.selectedStudent){let t=this.selectedStudent._id||this.selectedStudent.id;if(!t){ni.default.fire("\u062E\u0637\u0623","\u0644\u0627 \u064A\u0645\u0643\u0646 \u062A\u062D\u062F\u064A\u062F \u0647\u0648\u064A\u0629 \u0627\u0644\u0637\u0627\u0644\u0628","error"),this.loading=!1;return}this.studentsService.updateStudent(t,this.newStudent).subscribe({next:e=>{ni.default.fire("\u0646\u062C\u0627\u062D","\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0637\u0627\u0644\u0628 \u0628\u0646\u062C\u0627\u062D","success"),this.closeRegistrationForm(),this.loadStudents()},error:e=>{console.error("Error updating student:",e),ni.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u062F\u064A\u062B \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0637\u0627\u0644\u0628","error"),this.loading=!1}})}else this.studentsService.createStudent(this.newStudent).subscribe({next:t=>{ni.default.fire("\u0646\u062C\u0627\u062D","\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u0637\u0627\u0644\u0628 \u0628\u0646\u062C\u0627\u062D","success"),this.closeRegistrationForm(),this.loadStudents()},error:t=>{console.error("Error registering student:",t),ni.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u0637\u0627\u0644\u0628","error"),this.loading=!1}})}validateStudentForm(){return this.newStudent.name.trim()?this.newStudent.academicYear?!0:(ni.default.fire("\u062E\u0637\u0623","\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0645\u0633\u062A\u0648\u0649 \u0627\u0644\u062F\u0631\u0627\u0633\u064A","error"),!1):(ni.default.fire("\u062E\u0637\u0623","\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628","error"),!1)}resetForm(){this.newStudent={name:"",parentName:"",parentPhone:"",academicYear:"",birthDate:"",registrationDate:new Date().toISOString().split("T")[0]}}toggleDropdown(t){t.stopPropagation();let e=t.target.closest(".student-actions-dropdown")?.querySelector(".dropdown-menu");e&&e.classList.toggle("show")}closeAllDropdowns(t){document.querySelectorAll(".dropdown-menu.show").forEach(i=>{i.closest(".student-actions-dropdown")?.contains(t.target)||i.classList.remove("show")})}openBulkImportForm(){this.bulkImportData={students:[{name:"",parentName:"",parentPhone:"",academicYear:"",birthDate:""}],delimiter:",",academicYear:""},this.showBulkImportForm=!0,this.toggleBodyScroll(!0)}closeBulkImportForm(){this.showBulkImportForm=!1,this.toggleBodyScroll(!1)}addImportRow(){this.bulkImportData.students.push({name:"",parentName:"",parentPhone:"",academicYear:"",birthDate:""})}removeImportRow(t){this.bulkImportData.students.length>1&&this.bulkImportData.students.splice(t,1)}importFromText(){ni.default.fire({title:"\u0625\u062F\u062E\u0627\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0646\u0635\u064A\u0629",html:`
        <div>
          <p>\u0623\u062F\u062E\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0637\u0644\u0627\u0628\u060C \u0643\u0644 \u0637\u0627\u0644\u0628 \u0641\u064A \u0633\u0637\u0631 \u062C\u062F\u064A\u062F.</p>
          <p>\u0627\u0644\u0635\u064A\u063A\u0629: <strong>\u0627\u0644\u0627\u0633\u0645,\u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631,\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062A\u0641,\u0627\u0644\u0645\u0633\u062A\u0648\u0649,\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0645\u064A\u0644\u0627\u062F (\u0627\u062E\u062A\u064A\u0627\u0631\u064A)</strong></p>
          <p>\u0645\u062B\u0627\u0644: \u0645\u062D\u0645\u062F \u0623\u062D\u0645\u062F,\u0623\u062D\u0645\u062F \u0645\u062D\u0645\u062F,0551234567,1AS,2008-01-15</p>
          <textarea id="studentsText" rows="10" class="swal2-textarea" 
            placeholder="\u0623\u062F\u062E\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0637\u0644\u0627\u0628 \u0647\u0646\u0627..."></textarea>
          <div class="mt-3">
            <label for="delimiter">\u0627\u0644\u0641\u0627\u0635\u0644:</label>
            <select id="delimiter" class="swal2-select">
              <option value=",">\u0641\u0627\u0635\u0644\u0629 (,)</option>
              <option value=";">\u0641\u0627\u0635\u0644\u0629 \u0645\u0646\u0642\u0648\u0637\u0629 (;)</option>
              <option value="	">\u062A\u0628\u0648\u064A\u0628 (Tab)</option>
            </select>
          </div>
        </div>
      `,showCancelButton:!0,confirmButtonText:"\u0627\u0633\u062A\u064A\u0631\u0627\u062F",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",preConfirm:()=>{let t=document.getElementById("studentsText").value,e=document.getElementById("delimiter").value;return t.trim()?{text:t,delimiter:e}:(ni.default.showValidationMessage("\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0637\u0644\u0627\u0628"),!1)}}).then(t=>{t.isConfirmed&&t.value&&this.parseTextData(t.value.text,t.value.delimiter)})}parseTextData(t,e){let r=t.split(`
`).filter(o=>o.trim()!=="").map(o=>{let l=o.split(e).map(c=>c.trim());return l.length>=3?{name:l[0],parentName:l[1]||"",parentPhone:l[2]||"",academicYear:this.bulkImportData.academicYear||l[3]||"",birthDate:l[4]||""}:null}).filter(o=>o!==null);r.length>0?(this.bulkImportData.students=r,ni.default.fire("\u0646\u062C\u0627\u062D",`\u062A\u0645 \u062A\u062D\u0644\u064A\u0644 ${r.length} \u0637\u0627\u0644\u0628`,"success")):ni.default.fire("\u062E\u0637\u0623","\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u0649 \u0628\u064A\u0627\u0646\u0627\u062A \u0635\u062D\u064A\u062D\u0629","error")}importStudents(){this.validateBulkImportData()&&ni.default.fire({title:"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u0627\u0633\u062A\u064A\u0631\u0627\u062F",html:`\u0633\u064A\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 ${this.bulkImportData.students.length} \u0637\u0627\u0644\u0628. \u0647\u0644 \u062A\u0631\u064A\u062F \u0627\u0644\u0645\u062A\u0627\u0628\u0639\u0629\u061F`,icon:"warning",showCancelButton:!0,confirmButtonText:"\u0646\u0639\u0645\u060C \u0627\u0633\u062A\u064A\u0631\u0627\u062F",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621"}).then(t=>{t.isConfirmed&&this.processBulkImport()})}validateBulkImportData(){for(let t=0;t<this.bulkImportData.students.length;t++)if(!this.bulkImportData.students[t].name.trim())return ni.default.fire("\u062E\u0637\u0623",`\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628 \u0641\u064A \u0627\u0644\u0635\u0641 ${t+1}`,"error"),!1;return!this.bulkImportData.academicYear&&this.bulkImportData.students.some(t=>!t.academicYear)?(ni.default.fire("\u062E\u0637\u0623","\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u0627\u0644\u0645\u0633\u062A\u0648\u0649 \u0627\u0644\u062F\u0631\u0627\u0633\u064A \u0644\u0644\u0637\u0644\u0627\u0628","error"),!1):!0}processBulkImport(){this.loading=!0,this.bulkImportData.academicYear&&this.bulkImportData.students.forEach(o=>{o.academicYear||(o.academicYear=this.bulkImportData.academicYear)});let t=0,e=0,i=this.bulkImportData.students.length,r=o=>{if(o>=i){this.loading=!1,this.showBulkImportForm=!1,ni.default.fire({title:"\u062A\u0645 \u0627\u0644\u0627\u0633\u062A\u064A\u0631\u0627\u062F",html:`
            <div class="text-center">
              <i class="bi bi-check-circle-fill text-success" style="font-size: 3rem;"></i>
              <h4 class="mt-3">\u062A\u0645 \u0627\u0644\u0627\u0646\u062A\u0647\u0627\u0621 \u0645\u0646 \u0627\u0644\u0627\u0633\u062A\u064A\u0631\u0627\u062F</h4>
              <div class="mt-3">
                <p>\u0627\u0644\u0637\u0644\u0627\u0628 \u0627\u0644\u0645\u0636\u0627\u0641\u0629 \u0628\u0646\u062C\u0627\u062D: <strong>${t}</strong></p>
                <p>\u0627\u0644\u0637\u0644\u0627\u0628 \u0627\u0644\u062A\u064A \u0641\u0634\u0644 \u0625\u0636\u0627\u0641\u062A\u0647\u0627: <strong>${e}</strong></p>
              </div>
            </div>
          `,confirmButtonText:"\u062A\u0645"}).then(()=>{this.loadStudents()});return}let l=this.bulkImportData.students[o],c=St(Oe({},l),{registrationDate:new Date().toISOString().split("T")[0]});this.studentsService.createStudent(c).subscribe({next:f=>{t++,r(o+1)},error:f=>{console.error(`Error importing student ${l.name}:`,f),e++,r(o+1)}})};r(0)}downloadImportTemplate(){let e=encodeURI(`data:text/csv;charset=utf-8,\u0627\u0644\u0627\u0633\u0645,\u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631,\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062A\u0641,\u0627\u0644\u0645\u0633\u062A\u0648\u0649,\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0645\u064A\u0644\u0627\u062F
\u0645\u062D\u0645\u062F \u0623\u062D\u0645\u062F,\u0623\u062D\u0645\u062F \u0645\u062D\u0645\u062F,0551234567,1AS,2008-01-15
\u0633\u0627\u0631\u0629 \u0645\u062D\u0645\u062F,\u0645\u062D\u0645\u062F \u062E\u0627\u0644\u062F,0557654321,2AS,2007-05-20
\u0639\u0644\u064A \u062D\u0633\u0646,\u062D\u0633\u0646 \u0639\u0644\u064A,0551122334,1MS,2009-08-10`),i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("download","\u0646\u0645\u0648\u0630\u062C_\u0627\u0633\u062A\u064A\u0631\u0627\u062F_\u0627\u0644\u0637\u0644\u0627\u0628.csv"),document.body.appendChild(i),i.click(),document.body.removeChild(i)}openPaymentModal(t){this.selectedStudent=t,this.paymentData.amount=600,this.showPaymentModal=!0,this.toggleBodyScroll(!0)}closePaymentModal(){this.showPaymentModal=!1,this.selectedStudent=null,this.toggleBodyScroll(!1),this.paymentData={amount:600,paymentMethod:"cash",notes:""}}ngOnDestroy(){this.toggleBodyScroll(!1)}processPayment(){if(!this.selectedStudent)return;let t=this.selectedStudent._id||this.selectedStudent.id;if(!t){ni.default.fire("\u062E\u0637\u0623","\u0644\u0627 \u064A\u0645\u0643\u0646 \u062A\u062D\u062F\u064A\u062F \u0647\u0648\u064A\u0629 \u0627\u0644\u0637\u0627\u0644\u0628","error");return}this.loading=!0,this.studentsService.payRegistrationFee(t,this.paymentData).subscribe({next:e=>{ni.default.fire("\u0646\u062C\u0627\u062D","\u062A\u0645 \u062F\u0641\u0639 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644 \u0628\u0646\u062C\u0627\u062D","success"),this.closePaymentModal(),this.loadStudents()},error:e=>{console.error("Error processing payment:",e),ni.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u0645\u0639\u0627\u0644\u062C\u0629 \u0627\u0644\u062F\u0641\u0639","error"),this.loading=!1}})}viewStudentDetails(t){let e=t._id||t.id;e?this.router.navigate(["/home/students-management",e]):ni.default.fire("\u062E\u0637\u0623","\u0644\u0627 \u064A\u0645\u0643\u0646 \u0639\u0631\u0636 \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0637\u0627\u0644\u0628","error")}deleteStudent(t){let e=t._id||t.id;if(!e){ni.default.fire("\u062E\u0637\u0623","\u0644\u0627 \u064A\u0645\u0643\u0646 \u062A\u062D\u062F\u064A\u062F \u0647\u0648\u064A\u0629 \u0627\u0644\u0637\u0627\u0644\u0628 \u0644\u0644\u062D\u0630\u0641","error");return}ni.default.fire({title:"\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F\u061F",text:`\u0633\u064A\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u0637\u0627\u0644\u0628 ${t.name} \u0628\u0634\u0643\u0644 \u062F\u0627\u0626\u0645`,icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"\u0646\u0639\u0645\u060C \u0627\u062D\u0630\u0641",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621"}).then(i=>{i.isConfirmed&&this.studentsService.deleteStudent(e).subscribe({next:()=>{ni.default.fire("\u062A\u0645 \u0627\u0644\u062D\u0630\u0641","\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u0637\u0627\u0644\u0628 \u0628\u0646\u062C\u0627\u062D","success"),this.loadStudents()},error:r=>{console.error("Error deleting student:",r),ni.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062D\u0630\u0641 \u0627\u0644\u0637\u0627\u0644\u0628","error")}})})}parseCSV(t,e=","){let i=t.split(`
`),r=[],o=i[0].split(e).map(l=>l.trim());for(let l=1;l<i.length;l++){if(!i[l].trim())continue;let c={},f=i[l].split(e).map(p=>p.trim());for(let p=0;p<o.length;p++)c[o[p]]=f[p]||"";r.push(c)}return r}static \u0275fac=function(e){return new(e||n)(Ne(Vc),Ne(ei))};static \u0275cmp=nn({type:n,selectors:[["app-students-management"]],hostBindings:function(e,i){e&1&&I("click",function(o){return i.closeAllDropdowns(o)},!1,om)},decls:45,vars:10,consts:[[1,"students-management"],[1,"header"],[1,"header-content"],[1,"logo-section"],[1,"logo"],[1,"bi","bi-people-fill"],[1,"header-actions"],[1,"btn-primary",3,"click"],[1,"bi","bi-person-plus-fill"],[1,"btn-success",3,"click"],[1,"bi","bi-upload"],[1,"btn-secondary",3,"click"],[1,"bi","bi-arrow-clockwise"],[1,"btn-info",3,"click"],[1,"bi","bi-cloud-download-fill"],[1,"controls-section"],[1,"search-box"],["type","text","placeholder","\u0627\u0628\u062D\u062B \u0639\u0646 \u0637\u0627\u0644\u0628 \u0628\u0627\u0644\u0627\u0633\u0645 \u0623\u0648 \u0627\u0644\u0631\u0642\u0645 \u0623\u0648 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631...",3,"ngModelChange","input","ngModel"],[1,"bi","bi-search"],[1,"filter-group"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value","all"],[3,"value",4,"ngFor","ngForOf"],[1,"stats-badge"],[1,"badge-count"],[1,"badge-label"],["class","loading-container",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","students-grid",4,"ngIf"],["class","student-modal-overlay",3,"click",4,"ngIf"],[3,"value"],[1,"loading-container"],[1,"spinner"],[1,"empty-state"],[1,"bi","bi-person-x-fill"],[1,"empty-state-actions"],[1,"students-grid"],["class","student-card",4,"ngFor","ngForOf"],[1,"student-card"],[1,"student-header"],[1,"student-avatar","large"],[1,"avatar-fallback"],[1,"student-info"],[1,"student-id"],[1,"student-tags"],[1,"tag","academic-tag"],[1,"tag","status-tag"],[1,"student-actions-dropdown"],[1,"dropdown-toggle",3,"click"],[1,"bi","bi-three-dots-vertical"],[1,"dropdown-menu"],[1,"dropdown-item",3,"click"],[1,"bi","bi-eye-fill"],[1,"bi","bi-pencil-square"],[1,"dropdown-item",3,"click","disabled"],[1,"bi","bi-cash-stack"],[1,"dropdown-divider"],[1,"dropdown-item","text-danger",3,"click"],[1,"bi","bi-trash3-fill"],[1,"student-details"],[1,"detail-item"],[1,"bi","bi-mortarboard-fill"],[1,"bi","bi-person-vcard-fill"],[1,"bi","bi-telephone-fill"],["class","detail-item",4,"ngIf"],[1,"student-actions"],[1,"btn-action","btn-view",3,"click"],[1,"btn-text"],[1,"btn-action","btn-payment",3,"click","disabled"],[1,"bi","bi-calendar-check-fill"],[1,"bi","bi-balloon-fill"],[1,"student-modal-overlay",3,"click"],[1,"student-modal",3,"click"],[1,"student-modal-header"],[1,"close-btn",3,"click"],[1,"bi","bi-x-lg"],[1,"student-modal-body"],[1,"student-form",3,"submit"],[1,"form-row"],[1,"form-group"],["for","name"],["type","text","id","name","name","name","placeholder","\u0623\u062F\u062E\u0644 \u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628 \u0627\u0644\u0643\u0627\u0645\u0644","required","",3,"ngModelChange","ngModel"],["for","academicYear"],["id","academicYear","name","academicYear","required","",3,"ngModelChange","ngModel"],["value",""],["for","parentName"],["type","text","id","parentName","name","parentName","placeholder","\u0627\u0633\u0645 \u0648\u0644\u064A \u0623\u0645\u0631 \u0627\u0644\u0637\u0627\u0644\u0628",3,"ngModelChange","ngModel"],["for","parentPhone"],["type","tel","id","parentPhone","name","parentPhone","placeholder","05X XXX XXXX",3,"ngModelChange","ngModel"],["for","birthDate"],["type","date","id","birthDate","name","birthDate",3,"ngModelChange","ngModel"],["for","registrationDate"],["type","date","id","registrationDate","name","registrationDate",3,"ngModelChange","ngModel"],[1,"student-modal-footer"],[1,"bi","bi-x-circle"],[1,"btn-success",3,"click","disabled"],[1,"bi","bi-check-circle-fill"],["class","spinner-small",4,"ngIf"],[1,"spinner-small"],[1,"student-modal","student-modal-lg",3,"click"],[1,"bulk-import-container"],[1,"import-options"],[1,"option-card",3,"click"],[1,"bi","bi-file-earmark-arrow-down"],[1,"bi","bi-text-paragraph"],[1,"bi","bi-plus-circle"],[1,"form-group","full-width"],["for","defaultAcademicYear"],["id","defaultAcademicYear","name","defaultAcademicYear",3,"ngModelChange","ngModel"],[1,"form-text"],[1,"students-table-container"],[1,"table-header"],[1,"btn-sm","btn-success",3,"click"],[1,"bi","bi-plus"],[1,"table-responsive"],[1,"students-table"],[4,"ngFor","ngForOf"],[1,"bi","bi-download"],["type","text","placeholder","\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628","required","",3,"ngModelChange","ngModel"],["type","text","placeholder","\u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631",3,"ngModelChange","ngModel"],["type","tel","placeholder","05X XXX XXXX",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],["type","date",3,"ngModelChange","ngModel"],[1,"btn-icon","btn-danger",3,"click","disabled"],[1,"bi","bi-trash"],[1,"payment-info"],[1,"student-payment-header"],[1,"student-payment-details"],[1,"academic-year"],[1,"payment-form",3,"submit"],["for","amount"],["type","number","id","amount","name","amount","min","0","step","100","required","",3,"ngModelChange","ngModel"],["for","paymentMethod"],["id","paymentMethod","name","paymentMethod","required","",3,"ngModelChange","ngModel"],["value","cash"],["value","card"],["value","transfer"],["value","check"],["for","notes"],["id","notes","name","notes","rows","3","placeholder","\u0623\u064A \u0645\u0644\u0627\u062D\u0638\u0627\u062A \u0625\u0636\u0627\u0641\u064A\u0629 \u062D\u0648\u0644 \u0627\u0644\u062F\u0641\u0639...",3,"ngModelChange","ngModel"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"header",1)(2,"div",2)(3,"div",3)(4,"div",4),b(5,"i",5),a(),s(6,"h1"),u(7,"\u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0637\u0644\u0627\u0628"),a()(),s(8,"div",6)(9,"button",7),I("click",function(){return i.openRegistrationForm()}),b(10,"i",8),s(11,"span"),u(12,"\u0637\u0627\u0644\u0628 \u062C\u062F\u064A\u062F"),a()(),s(13,"button",9),I("click",function(){return i.openBulkImportForm()}),b(14,"i",10),s(15,"span"),u(16,"\u0625\u0636\u0627\u0641\u0629 \u062C\u0645\u0627\u0639\u064A\u0629"),a()(),s(17,"button",11),I("click",function(){return i.clearSearch()}),b(18,"i",12),s(19,"span"),u(20,"\u0625\u0639\u0627\u062F\u0629 \u062A\u0639\u064A\u064A\u0646"),a()(),s(21,"button",13),I("click",function(){return i.loadStudents()}),b(22,"i",14),s(23,"span"),u(24,"\u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A"),a()()()()(),s(25,"div",15)(26,"div",16)(27,"input",17),ye("ngModelChange",function(o){return Ce(i.searchTerm,o)||(i.searchTerm=o),o}),I("input",function(){return i.filterStudents()}),a(),b(28,"i",18),a(),s(29,"div",19)(30,"select",20),ye("ngModelChange",function(o){return Ce(i.selectedAcademicYear,o)||(i.selectedAcademicYear=o),o}),I("change",function(){return i.filterStudents()}),s(31,"option",21),u(32,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0645\u0633\u062A\u0648\u064A\u0627\u062A"),a(),j(33,o8,2,2,"option",22),a()(),s(34,"div",23)(35,"span",24),u(36),a(),s(37,"span",25),u(38,"\u0637\u0627\u0644\u0628"),a()()(),j(39,s8,6,0,"div",26)(40,a8,15,0,"div",27)(41,d8,2,1,"div",28)(42,p8,49,11,"div",29)(43,y8,78,7,"div",29)(44,b8,52,11,"div",29),a()),e&2&&(d(27),ve("ngModel",i.searchTerm),d(3),ve("ngModel",i.selectedAcademicYear),d(3),w("ngForOf",i.academicYears.slice(1)),d(3),B(i.getDisplayedStudents().length),d(3),w("ngIf",i.loading),d(),w("ngIf",!i.loading&&i.getDisplayedStudents().length===0),d(),w("ngIf",!i.loading&&i.getDisplayedStudents().length>0),d(),w("ngIf",i.showRegistrationForm),d(),w("ngIf",i.showBulkImportForm),d(),w("ngIf",i.showPaymentModal&&i.selectedStudent))},dependencies:[hn,Nn,An,qr,Un,Ti,Di,Pi,Yn,gr,di,ii,Ai,$i,_r,ti,mr],styles:[".students-management[_ngcontent-%COMP%]{direction:rtl;font-family:Cairo,Segoe UI,sans-serif;background:#f5f7fb;min-height:100vh;color:#2c3e50}.header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4f46e5,#6366f1);color:#fff;padding:20px 24px}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:16px}.logo-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.logo[_ngcontent-%COMP%]{width:48px;height:48px;background:#ffffff26;border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:22px}button[_ngcontent-%COMP%]{border:none;cursor:pointer;font-family:inherit}.header-actions[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.btn-primary[_ngcontent-%COMP%], .btn-success[_ngcontent-%COMP%], .btn-secondary[_ngcontent-%COMP%], .btn-info[_ngcontent-%COMP%]{padding:10px 16px;border-radius:10px;font-size:14px;display:flex;align-items:center;gap:6px;transition:.2s ease}.btn-primary[_ngcontent-%COMP%]{background:#22c55e;color:#fff}.btn-success[_ngcontent-%COMP%]{background:#16a34a;color:#fff}.btn-secondary[_ngcontent-%COMP%]{background:#e5e7eb;color:#374151}.btn-info[_ngcontent-%COMP%]{background:#0ea5e9;color:#fff}button[_ngcontent-%COMP%]:hover{opacity:.9;transform:translateY(-1px)}.controls-section[_ngcontent-%COMP%]{background:#fff;padding:16px 24px;display:flex;gap:16px;flex-wrap:wrap;align-items:center;box-shadow:0 4px 12px #0000000d}.search-box[_ngcontent-%COMP%]{position:relative;flex:1;min-width:240px}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:10px 36px 10px 14px;border-radius:10px;border:1px solid #d1d5db}.search-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;top:50%;right:12px;transform:translateY(-50%);color:#6b7280}.form-select[_ngcontent-%COMP%]{padding:10px;border-radius:10px;border:1px solid #d1d5db}.stats-badge[_ngcontent-%COMP%]{background:#eef2ff;padding:8px 14px;border-radius:999px;display:flex;gap:6px;font-weight:700;color:#4338ca}.students-grid[_ngcontent-%COMP%]{padding:24px;display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:20px}.student-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:16px;box-shadow:0 10px 30px #0000000f;display:flex;flex-direction:column;gap:14px;transition:.25s ease}.student-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px)}.student-header[_ngcontent-%COMP%]{display:flex;gap:14px;align-items:flex-start}.student-avatar.large[_ngcontent-%COMP%]{width:56px;height:56px;border-radius:50%;color:#fff;font-weight:700;display:flex;align-items:center;justify-content:center}.student-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:16px}.student-id[_ngcontent-%COMP%]{font-size:13px;color:#6b7280}.student-tags[_ngcontent-%COMP%]{display:flex;gap:6px;margin-top:6px}.tag[_ngcontent-%COMP%]{padding:4px 10px;border-radius:999px;font-size:12px;background:#f1f5f9}.status-paid[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.status-unpaid[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.student-details[_ngcontent-%COMP%]{border-top:1px dashed #e5e7eb;padding-top:10px;display:grid;gap:6px}.detail-item[_ngcontent-%COMP%]{font-size:13px;color:#374151;display:flex;gap:6px;align-items:center}.student-actions[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:auto}.btn-action[_ngcontent-%COMP%]{flex:1;padding:8px;border-radius:10px;font-size:13px;display:flex;justify-content:center;align-items:center;gap:6px}.btn-view[_ngcontent-%COMP%]{background:#eef2ff;color:#4338ca}.btn-payment[_ngcontent-%COMP%]{background:#ecfeff;color:#0369a1}.btn-action[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.loading-container[_ngcontent-%COMP%], .empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:#6b7280}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:48px;color:#c7d2fe}.student-modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000073;display:flex;align-items:center;justify-content:center;z-index:9999}.student-modal[_ngcontent-%COMP%]{background:#fff;width:100%;max-width:560px;border-radius:16px;box-shadow:0 20px 40px #0003;max-height:90vh;overflow-y:auto;animation:_ngcontent-%COMP%_modalFade .25s ease}.student-modal-lg[_ngcontent-%COMP%]{max-width:900px}@keyframes _ngcontent-%COMP%_modalFade{0%{opacity:0;transform:translateY(30px) scale(.98)}to{opacity:1;transform:translateY(0) scale(1)}}.student-modal-header[_ngcontent-%COMP%]{padding:18px 22px;border-bottom:1px solid #e5e7eb;display:flex;align-items:center;justify-content:space-between;background:#f9fafb;border-radius:16px 16px 0 0}.student-modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px;font-weight:700;color:#111827}.close-btn[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:10px;background:#f3f4f6;display:flex;align-items:center;justify-content:center;color:#374151;transition:.2s ease}.close-btn[_ngcontent-%COMP%]:hover{background:#fee2e2;color:#991b1b}.student-modal-body[_ngcontent-%COMP%]{padding:22px}.student-modal-footer[_ngcontent-%COMP%]{padding:16px 22px;border-top:1px solid #e5e7eb;display:flex;justify-content:flex-end;gap:10px;background:#f9fafb;border-radius:0 0 16px 16px}.student-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:18px}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:14px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:13px;font-weight:600;color:#374151}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{padding:10px 12px;border-radius:10px;border:1px solid #d1d5db;font-size:14px;transition:border-color .2s ease,box-shadow .2s ease}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px #6366f126}.form-text[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.student-modal-footer[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:#e5e7eb;color:#374151}.student-modal-footer[_ngcontent-%COMP%]   .btn-success[_ngcontent-%COMP%]{background:linear-gradient(135deg,#22c55e,#16a34a);color:#fff;font-weight:600}.student-modal-footer[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:10px 18px;border-radius:12px}button[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.student-modal[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.student-modal[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c7d2fe;border-radius:10px}.student-modal[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}"]})};$();$();$();var I_="182",Ja={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Ka={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},qA=0,kb=1,XA=2;var zf=1,ZA=2,hd=3,na=0,yr=1,so=2,ys=0,au=1,Nb=2,Ub=3,Lb=4,JA=5,Wa=100,KA=101,QA=102,eT=103,tT=104,nT=200,iT=201,rT=202,oT=203,r_=204,o_=205,sT=206,aT=207,lT=208,uT=209,cT=210,dT=211,fT=212,hT=213,pT=214,O_=0,F_=1,R_=2,lu=3,k_=4,N_=5,U_=6,L_=7,B_=0,mT=1,gT=2,Yo=0,Bb=1,Vb=2,Hb=3,zb=4,jb=5,Wb=6,Gb=7;var Mb=300,Qa=301,pu=302,V_=303,H_=304,jf=306,uu=1e3,ms=1001,s_=1002,zi=1003,_T=1004;var Wf=1005;var qi=1006,z_=1007;var el=1008;var Lr=1009,$b=1010,Yb=1011,pd=1012,j_=1013,qo=1014,Xo=1015,xs=1016,W_=1017,G_=1018,md=1020,qb=35902,Xb=35899,Zb=1021,Jb=1022,Mo=1023,gs=1026,tl=1027,Kb=1028,$_=1029,mu=1030,Y_=1031;var q_=1033,Gf=33776,$f=33777,Yf=33778,qf=33779,X_=35840,Z_=35841,J_=35842,K_=35843,Q_=36196,e1=37492,t1=37496,n1=37488,i1=37489,r1=37490,o1=37491,s1=37808,a1=37809,l1=37810,u1=37811,c1=37812,d1=37813,f1=37814,h1=37815,p1=37816,m1=37817,g1=37818,_1=37819,v1=37820,y1=37821,x1=36492,b1=36494,C1=36495,E1=36283,w1=36284,S1=36285,M1=36286;var bf=2300,a_=2301,n_=2302,Ab=2400,Tb=2401,Db=2402;var vT=3200;var Qb=0,yT=1,ra="",to="srgb",cu="srgb-linear",Cf="linear",Pn="srgb";var su=7680;var Pb=519,xT=512,bT=513,CT=514,A1=515,ET=516,wT=517,T1=518,ST=519,Ib=35044;var eC="300 es",Go=2e3,Ef=2001;function tC(n){for(let t=n.length-1;t>=0;--t)if(n[t]>=65535)return!0;return!1}function C8(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function nd(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function MT(){let n=nd("canvas");return n.style.display="block",n}var wA={},id=null;function nC(...n){let t="THREE."+n.shift();id?id("log",t,...n):console.log(t,...n)}function Mt(...n){let t="THREE."+n.shift();id?id("warn",t,...n):console.warn(t,...n)}function At(...n){let t="THREE."+n.shift();id?id("error",t,...n):console.error(t,...n)}function rd(...n){let t=n.join(" ");t in wA||(wA[t]=!0,Mt(...n))}function AT(n,t,e){return new Promise(function(i,r){function o(){switch(n.clientWaitSync(t,n.SYNC_FLUSH_COMMANDS_BIT,0)){case n.WAIT_FAILED:r();break;case n.TIMEOUT_EXPIRED:setTimeout(o,e);break;default:i()}}setTimeout(o,e)})}var _s=class{addEventListener(t,e){this._listeners===void 0&&(this._listeners={});let i=this._listeners;i[t]===void 0&&(i[t]=[]),i[t].indexOf(e)===-1&&i[t].push(e)}hasEventListener(t,e){let i=this._listeners;return i===void 0?!1:i[t]!==void 0&&i[t].indexOf(e)!==-1}removeEventListener(t,e){let i=this._listeners;if(i===void 0)return;let r=i[t];if(r!==void 0){let o=r.indexOf(e);o!==-1&&r.splice(o,1)}}dispatchEvent(t){let e=this._listeners;if(e===void 0)return;let i=e[t.type];if(i!==void 0){t.target=this;let r=i.slice(0);for(let o=0,l=r.length;o<l;o++)r[o].call(this,t);t.target=null}}},tr=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],SA=1234567,yf=Math.PI/180,od=180/Math.PI;function gd(){let n=Math.random()*4294967295|0,t=Math.random()*4294967295|0,e=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(tr[n&255]+tr[n>>8&255]+tr[n>>16&255]+tr[n>>24&255]+"-"+tr[t&255]+tr[t>>8&255]+"-"+tr[t>>16&15|64]+tr[t>>24&255]+"-"+tr[e&63|128]+tr[e>>8&255]+"-"+tr[e>>16&255]+tr[e>>24&255]+tr[i&255]+tr[i>>8&255]+tr[i>>16&255]+tr[i>>24&255]).toLowerCase()}function on(n,t,e){return Math.max(t,Math.min(e,n))}function iC(n,t){return(n%t+t)%t}function E8(n,t,e,i,r){return i+(n-t)*(r-i)/(e-t)}function w8(n,t,e){return n!==t?(e-n)/(t-n):0}function xf(n,t,e){return(1-e)*n+e*t}function S8(n,t,e,i){return xf(n,t,1-Math.exp(-e*i))}function M8(n,t=1){return t-Math.abs(iC(n,t*2)-t)}function A8(n,t,e){return n<=t?0:n>=e?1:(n=(n-t)/(e-t),n*n*(3-2*n))}function T8(n,t,e){return n<=t?0:n>=e?1:(n=(n-t)/(e-t),n*n*n*(n*(n*6-15)+10))}function D8(n,t){return n+Math.floor(Math.random()*(t-n+1))}function P8(n,t){return n+Math.random()*(t-n)}function I8(n){return n*(.5-Math.random())}function O8(n){n!==void 0&&(SA=n);let t=SA+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function F8(n){return n*yf}function R8(n){return n*od}function k8(n){return(n&n-1)===0&&n!==0}function N8(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function U8(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function L8(n,t,e,i,r){let o=Math.cos,l=Math.sin,c=o(e/2),f=l(e/2),p=o((t+i)/2),g=l((t+i)/2),m=o((t-i)/2),x=l((t-i)/2),C=o((i-t)/2),A=l((i-t)/2);switch(r){case"XYX":n.set(c*g,f*m,f*x,c*p);break;case"YZY":n.set(f*x,c*g,f*m,c*p);break;case"ZXZ":n.set(f*m,f*x,c*g,c*p);break;case"XZX":n.set(c*g,f*A,f*C,c*p);break;case"YXY":n.set(f*C,c*g,f*A,c*p);break;case"ZYZ":n.set(f*A,f*C,c*g,c*p);break;default:Mt("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function ed(n,t){switch(t.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function vr(n,t){switch(t.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}var rC={DEG2RAD:yf,RAD2DEG:od,generateUUID:gd,clamp:on,euclideanModulo:iC,mapLinear:E8,inverseLerp:w8,lerp:xf,damp:S8,pingpong:M8,smoothstep:A8,smootherstep:T8,randInt:D8,randFloat:P8,randFloatSpread:I8,seededRandom:O8,degToRad:F8,radToDeg:R8,isPowerOfTwo:k8,ceilPowerOfTwo:N8,floorPowerOfTwo:U8,setQuaternionFromProperEuler:L8,normalize:vr,denormalize:ed},Ft=class n{constructor(t=0,e=0){n.prototype.isVector2=!0,this.x=t,this.y=e}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,e){return this.x=t,this.y=e,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){let e=this.x,i=this.y,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6],this.y=r[1]*e+r[4]*i+r[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,e){return this.x=on(this.x,t.x,e.x),this.y=on(this.y,t.y,e.y),this}clampScalar(t,e){return this.x=on(this.x,t,e),this.y=on(this.y,t,e),this}clampLength(t,e){let i=this.length();return this.divideScalar(i||1).multiplyScalar(on(i,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){let e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;let i=this.dot(t)/e;return Math.acos(on(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let e=this.x-t.x,i=this.y-t.y;return e*e+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this}rotateAround(t,e){let i=Math.cos(e),r=Math.sin(e),o=this.x-t.x,l=this.y-t.y;return this.x=o*i-l*r+t.x,this.y=o*r+l*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},So=class{constructor(t=0,e=0,i=0,r=1){this.isQuaternion=!0,this._x=t,this._y=e,this._z=i,this._w=r}static slerpFlat(t,e,i,r,o,l,c){let f=i[r+0],p=i[r+1],g=i[r+2],m=i[r+3],x=o[l+0],C=o[l+1],A=o[l+2],O=o[l+3];if(c<=0){t[e+0]=f,t[e+1]=p,t[e+2]=g,t[e+3]=m;return}if(c>=1){t[e+0]=x,t[e+1]=C,t[e+2]=A,t[e+3]=O;return}if(m!==O||f!==x||p!==C||g!==A){let T=f*x+p*C+g*A+m*O;T<0&&(x=-x,C=-C,A=-A,O=-O,T=-T);let M=1-c;if(T<.9995){let G=Math.acos(T),Y=Math.sin(G);M=Math.sin(M*G)/Y,c=Math.sin(c*G)/Y,f=f*M+x*c,p=p*M+C*c,g=g*M+A*c,m=m*M+O*c}else{f=f*M+x*c,p=p*M+C*c,g=g*M+A*c,m=m*M+O*c;let G=1/Math.sqrt(f*f+p*p+g*g+m*m);f*=G,p*=G,g*=G,m*=G}}t[e]=f,t[e+1]=p,t[e+2]=g,t[e+3]=m}static multiplyQuaternionsFlat(t,e,i,r,o,l){let c=i[r],f=i[r+1],p=i[r+2],g=i[r+3],m=o[l],x=o[l+1],C=o[l+2],A=o[l+3];return t[e]=c*A+g*m+f*C-p*x,t[e+1]=f*A+g*x+p*m-c*C,t[e+2]=p*A+g*C+c*x-f*m,t[e+3]=g*A-c*m-f*x-p*C,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,e,i,r){return this._x=t,this._y=e,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,e=!0){let i=t._x,r=t._y,o=t._z,l=t._order,c=Math.cos,f=Math.sin,p=c(i/2),g=c(r/2),m=c(o/2),x=f(i/2),C=f(r/2),A=f(o/2);switch(l){case"XYZ":this._x=x*g*m+p*C*A,this._y=p*C*m-x*g*A,this._z=p*g*A+x*C*m,this._w=p*g*m-x*C*A;break;case"YXZ":this._x=x*g*m+p*C*A,this._y=p*C*m-x*g*A,this._z=p*g*A-x*C*m,this._w=p*g*m+x*C*A;break;case"ZXY":this._x=x*g*m-p*C*A,this._y=p*C*m+x*g*A,this._z=p*g*A+x*C*m,this._w=p*g*m-x*C*A;break;case"ZYX":this._x=x*g*m-p*C*A,this._y=p*C*m+x*g*A,this._z=p*g*A-x*C*m,this._w=p*g*m+x*C*A;break;case"YZX":this._x=x*g*m+p*C*A,this._y=p*C*m+x*g*A,this._z=p*g*A-x*C*m,this._w=p*g*m-x*C*A;break;case"XZY":this._x=x*g*m-p*C*A,this._y=p*C*m-x*g*A,this._z=p*g*A+x*C*m,this._w=p*g*m+x*C*A;break;default:Mt("Quaternion: .setFromEuler() encountered an unknown order: "+l)}return e===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,e){let i=e/2,r=Math.sin(i);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){let e=t.elements,i=e[0],r=e[4],o=e[8],l=e[1],c=e[5],f=e[9],p=e[2],g=e[6],m=e[10],x=i+c+m;if(x>0){let C=.5/Math.sqrt(x+1);this._w=.25/C,this._x=(g-f)*C,this._y=(o-p)*C,this._z=(l-r)*C}else if(i>c&&i>m){let C=2*Math.sqrt(1+i-c-m);this._w=(g-f)/C,this._x=.25*C,this._y=(r+l)/C,this._z=(o+p)/C}else if(c>m){let C=2*Math.sqrt(1+c-i-m);this._w=(o-p)/C,this._x=(r+l)/C,this._y=.25*C,this._z=(f+g)/C}else{let C=2*Math.sqrt(1+m-i-c);this._w=(l-r)/C,this._x=(o+p)/C,this._y=(f+g)/C,this._z=.25*C}return this._onChangeCallback(),this}setFromUnitVectors(t,e){let i=t.dot(e)+1;return i<1e-8?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*e.z-t.z*e.y,this._y=t.z*e.x-t.x*e.z,this._z=t.x*e.y-t.y*e.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(on(this.dot(t),-1,1)))}rotateTowards(t,e){let i=this.angleTo(t);if(i===0)return this;let r=Math.min(1,e/i);return this.slerp(t,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,e){let i=t._x,r=t._y,o=t._z,l=t._w,c=e._x,f=e._y,p=e._z,g=e._w;return this._x=i*g+l*c+r*p-o*f,this._y=r*g+l*f+o*c-i*p,this._z=o*g+l*p+i*f-r*c,this._w=l*g-i*c-r*f-o*p,this._onChangeCallback(),this}slerp(t,e){if(e<=0)return this;if(e>=1)return this.copy(t);let i=t._x,r=t._y,o=t._z,l=t._w,c=this.dot(t);c<0&&(i=-i,r=-r,o=-o,l=-l,c=-c);let f=1-e;if(c<.9995){let p=Math.acos(c),g=Math.sin(p);f=Math.sin(f*p)/g,e=Math.sin(e*p)/g,this._x=this._x*f+i*e,this._y=this._y*f+r*e,this._z=this._z*f+o*e,this._w=this._w*f+l*e,this._onChangeCallback()}else this._x=this._x*f+i*e,this._y=this._y*f+r*e,this._z=this._z*f+o*e,this._w=this._w*f+l*e,this.normalize();return this}slerpQuaternions(t,e,i){return this.copy(t).slerp(e,i)}random(){let t=2*Math.PI*Math.random(),e=2*Math.PI*Math.random(),i=Math.random(),r=Math.sqrt(1-i),o=Math.sqrt(i);return this.set(r*Math.sin(t),r*Math.cos(t),o*Math.sin(e),o*Math.cos(e))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,e=0){return this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this._onChangeCallback(),this}toArray(t=[],e=0){return t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t}fromBufferAttribute(t,e){return this._x=t.getX(e),this._y=t.getY(e),this._z=t.getZ(e),this._w=t.getW(e),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},ae=class n{constructor(t=0,e=0,i=0){n.prototype.isVector3=!0,this.x=t,this.y=e,this.z=i}set(t,e,i){return i===void 0&&(i=this.z),this.x=t,this.y=e,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this}applyEuler(t){return this.applyQuaternion(MA.setFromEuler(t))}applyAxisAngle(t,e){return this.applyQuaternion(MA.setFromAxisAngle(t,e))}applyMatrix3(t){let e=this.x,i=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[3]*i+o[6]*r,this.y=o[1]*e+o[4]*i+o[7]*r,this.z=o[2]*e+o[5]*i+o[8]*r,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){let e=this.x,i=this.y,r=this.z,o=t.elements,l=1/(o[3]*e+o[7]*i+o[11]*r+o[15]);return this.x=(o[0]*e+o[4]*i+o[8]*r+o[12])*l,this.y=(o[1]*e+o[5]*i+o[9]*r+o[13])*l,this.z=(o[2]*e+o[6]*i+o[10]*r+o[14])*l,this}applyQuaternion(t){let e=this.x,i=this.y,r=this.z,o=t.x,l=t.y,c=t.z,f=t.w,p=2*(l*r-c*i),g=2*(c*e-o*r),m=2*(o*i-l*e);return this.x=e+f*p+l*m-c*g,this.y=i+f*g+c*p-o*m,this.z=r+f*m+o*g-l*p,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){let e=this.x,i=this.y,r=this.z,o=t.elements;return this.x=o[0]*e+o[4]*i+o[8]*r,this.y=o[1]*e+o[5]*i+o[9]*r,this.z=o[2]*e+o[6]*i+o[10]*r,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,e){return this.x=on(this.x,t.x,e.x),this.y=on(this.y,t.y,e.y),this.z=on(this.z,t.z,e.z),this}clampScalar(t,e){return this.x=on(this.x,t,e),this.y=on(this.y,t,e),this.z=on(this.z,t,e),this}clampLength(t,e){let i=this.length();return this.divideScalar(i||1).multiplyScalar(on(i,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,e){let i=t.x,r=t.y,o=t.z,l=e.x,c=e.y,f=e.z;return this.x=r*f-o*c,this.y=o*l-i*f,this.z=i*c-r*l,this}projectOnVector(t){let e=t.lengthSq();if(e===0)return this.set(0,0,0);let i=t.dot(this)/e;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return ib.copy(this).projectOnVector(t),this.sub(ib)}reflect(t){return this.sub(ib.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){let e=Math.sqrt(this.lengthSq()*t.lengthSq());if(e===0)return Math.PI/2;let i=this.dot(t)/e;return Math.acos(on(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){let e=this.x-t.x,i=this.y-t.y,r=this.z-t.z;return e*e+i*i+r*r}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,e,i){let r=Math.sin(e)*t;return this.x=r*Math.sin(i),this.y=Math.cos(e)*t,this.z=r*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,e,i){return this.x=t*Math.sin(e),this.y=i,this.z=t*Math.cos(e),this}setFromMatrixPosition(t){let e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this}setFromMatrixScale(t){let e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=r,this}setFromMatrixColumn(t,e){return this.fromArray(t.elements,e*4)}setFromMatrix3Column(t,e){return this.fromArray(t.elements,e*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let t=Math.random()*Math.PI*2,e=Math.random()*2-1,i=Math.sqrt(1-e*e);return this.x=i*Math.cos(t),this.y=e,this.z=i*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},ib=new ae,MA=new So,jt=class n{constructor(t,e,i,r,o,l,c,f,p){n.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,e,i,r,o,l,c,f,p)}set(t,e,i,r,o,l,c,f,p){let g=this.elements;return g[0]=t,g[1]=r,g[2]=c,g[3]=e,g[4]=o,g[5]=f,g[6]=i,g[7]=l,g[8]=p,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){let e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this}extractBasis(t,e,i){return t.setFromMatrix3Column(this,0),e.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(t){let e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let i=t.elements,r=e.elements,o=this.elements,l=i[0],c=i[3],f=i[6],p=i[1],g=i[4],m=i[7],x=i[2],C=i[5],A=i[8],O=r[0],T=r[3],M=r[6],G=r[1],Y=r[4],q=r[7],X=r[2],Z=r[5],J=r[8];return o[0]=l*O+c*G+f*X,o[3]=l*T+c*Y+f*Z,o[6]=l*M+c*q+f*J,o[1]=p*O+g*G+m*X,o[4]=p*T+g*Y+m*Z,o[7]=p*M+g*q+m*J,o[2]=x*O+C*G+A*X,o[5]=x*T+C*Y+A*Z,o[8]=x*M+C*q+A*J,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this}determinant(){let t=this.elements,e=t[0],i=t[1],r=t[2],o=t[3],l=t[4],c=t[5],f=t[6],p=t[7],g=t[8];return e*l*g-e*c*p-i*o*g+i*c*f+r*o*p-r*l*f}invert(){let t=this.elements,e=t[0],i=t[1],r=t[2],o=t[3],l=t[4],c=t[5],f=t[6],p=t[7],g=t[8],m=g*l-c*p,x=c*f-g*o,C=p*o-l*f,A=e*m+i*x+r*C;if(A===0)return this.set(0,0,0,0,0,0,0,0,0);let O=1/A;return t[0]=m*O,t[1]=(r*p-g*i)*O,t[2]=(c*i-r*l)*O,t[3]=x*O,t[4]=(g*e-r*f)*O,t[5]=(r*o-c*e)*O,t[6]=C*O,t[7]=(i*f-p*e)*O,t[8]=(l*e-i*o)*O,this}transpose(){let t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){let e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this}setUvTransform(t,e,i,r,o,l,c){let f=Math.cos(o),p=Math.sin(o);return this.set(i*f,i*p,-i*(f*l+p*c)+l+t,-r*p,r*f,-r*(-p*l+f*c)+c+e,0,0,1),this}scale(t,e){return this.premultiply(rb.makeScale(t,e)),this}rotate(t){return this.premultiply(rb.makeRotation(-t)),this}translate(t,e){return this.premultiply(rb.makeTranslation(t,e)),this}makeTranslation(t,e){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,e,0,0,1),this}makeRotation(t){let e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,i,e,0,0,0,1),this}makeScale(t,e){return this.set(t,0,0,0,e,0,0,0,1),this}equals(t){let e=this.elements,i=t.elements;for(let r=0;r<9;r++)if(e[r]!==i[r])return!1;return!0}fromArray(t,e=0){for(let i=0;i<9;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){let i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}clone(){return new this.constructor().fromArray(this.elements)}},rb=new jt,AA=new jt().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),TA=new jt().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function B8(){let n={enabled:!0,workingColorSpace:cu,spaces:{},convert:function(r,o,l){return this.enabled===!1||o===l||!o||!l||(this.spaces[o].transfer===Pn&&(r.r=ta(r.r),r.g=ta(r.g),r.b=ta(r.b)),this.spaces[o].primaries!==this.spaces[l].primaries&&(r.applyMatrix3(this.spaces[o].toXYZ),r.applyMatrix3(this.spaces[l].fromXYZ)),this.spaces[l].transfer===Pn&&(r.r=td(r.r),r.g=td(r.g),r.b=td(r.b))),r},workingToColorSpace:function(r,o){return this.convert(r,this.workingColorSpace,o)},colorSpaceToWorking:function(r,o){return this.convert(r,o,this.workingColorSpace)},getPrimaries:function(r){return this.spaces[r].primaries},getTransfer:function(r){return r===ra?Cf:this.spaces[r].transfer},getToneMappingMode:function(r){return this.spaces[r].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(r,o=this.workingColorSpace){return r.fromArray(this.spaces[o].luminanceCoefficients)},define:function(r){Object.assign(this.spaces,r)},_getMatrix:function(r,o,l){return r.copy(this.spaces[o].toXYZ).multiply(this.spaces[l].fromXYZ)},_getDrawingBufferColorSpace:function(r){return this.spaces[r].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(r=this.workingColorSpace){return this.spaces[r].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(r,o){return rd("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),n.workingToColorSpace(r,o)},toWorkingColorSpace:function(r,o){return rd("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),n.colorSpaceToWorking(r,o)}},t=[.64,.33,.3,.6,.15,.06],e=[.2126,.7152,.0722],i=[.3127,.329];return n.define({[cu]:{primaries:t,whitePoint:i,transfer:Cf,toXYZ:AA,fromXYZ:TA,luminanceCoefficients:e,workingColorSpaceConfig:{unpackColorSpace:to},outputColorSpaceConfig:{drawingBufferColorSpace:to}},[to]:{primaries:t,whitePoint:i,transfer:Pn,toXYZ:AA,fromXYZ:TA,luminanceCoefficients:e,outputColorSpaceConfig:{drawingBufferColorSpace:to}}}),n}var yn=B8();function ta(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function td(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}var Hc,l_=class{static getDataURL(t,e="image/png"){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let i;if(t instanceof HTMLCanvasElement)i=t;else{Hc===void 0&&(Hc=nd("canvas")),Hc.width=t.width,Hc.height=t.height;let r=Hc.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),i=Hc}return i.toDataURL(e)}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){let e=nd("canvas");e.width=t.width,e.height=t.height;let i=e.getContext("2d");i.drawImage(t,0,0,t.width,t.height);let r=i.getImageData(0,0,t.width,t.height),o=r.data;for(let l=0;l<o.length;l++)o[l]=ta(o[l]/255)*255;return i.putImageData(r,0,0),e}else if(t.data){let e=t.data.slice(0);for(let i=0;i<e.length;i++)e instanceof Uint8Array||e instanceof Uint8ClampedArray?e[i]=Math.floor(ta(e[i]/255)*255):e[i]=ta(e[i]);return{data:e,width:t.width,height:t.height}}else return Mt("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}},V8=0,sd=class{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:V8++}),this.uuid=gd(),this.data=t,this.dataReady=!0,this.version=0}getSize(t){let e=this.data;return typeof HTMLVideoElement<"u"&&e instanceof HTMLVideoElement?t.set(e.videoWidth,e.videoHeight,0):typeof VideoFrame<"u"&&e instanceof VideoFrame?t.set(e.displayHeight,e.displayWidth,0):e!==null?t.set(e.width,e.height,e.depth||0):t.set(0,0,0),t}set needsUpdate(t){t===!0&&this.version++}toJSON(t){let e=t===void 0||typeof t=="string";if(!e&&t.images[this.uuid]!==void 0)return t.images[this.uuid];let i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let o;if(Array.isArray(r)){o=[];for(let l=0,c=r.length;l<c;l++)r[l].isDataTexture?o.push(ob(r[l].image)):o.push(ob(r[l]))}else o=ob(r);i.url=o}return e||(t.images[this.uuid]=i),i}};function ob(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?l_.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(Mt("Texture: Unable to serialize Texture."),{})}var H8=0,sb=new ae,Zo=(()=>{class n extends _s{constructor(e=n.DEFAULT_IMAGE,i=n.DEFAULT_MAPPING,r=ms,o=ms,l=qi,c=el,f=Mo,p=Lr,g=n.DEFAULT_ANISOTROPY,m=ra){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:H8++}),this.uuid=gd(),this.name="",this.source=new sd(e),this.mipmaps=[],this.mapping=i,this.channel=0,this.wrapS=r,this.wrapT=o,this.magFilter=l,this.minFilter=c,this.anisotropy=g,this.format=f,this.internalFormat=null,this.type=p,this.offset=new Ft(0,0),this.repeat=new Ft(1,1),this.center=new Ft(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new jt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=m,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(sb).x}get height(){return this.source.getSize(sb).y}get depth(){return this.source.getSize(sb).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(let i in e){let r=e[i];if(r===void 0){Mt(`Texture.setValues(): parameter '${i}' has value of undefined.`);continue}let o=this[i];if(o===void 0){Mt(`Texture.setValues(): property '${i}' does not exist.`);continue}o&&r&&o.isVector2&&r.isVector2||o&&r&&o.isVector3&&r.isVector3||o&&r&&o.isMatrix3&&r.isMatrix3?o.copy(r):this[i]=r}}toJSON(e){let i=e===void 0||typeof e=="string";if(!i&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];let r={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Mb)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case uu:e.x=e.x-Math.floor(e.x);break;case ms:e.x=e.x<0?0:1;break;case s_:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case uu:e.y=e.y-Math.floor(e.y);break;case ms:e.y=e.y<0?0:1;break;case s_:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}return n.DEFAULT_IMAGE=null,n.DEFAULT_MAPPING=Mb,n.DEFAULT_ANISOTROPY=1,n})(),ui=class n{constructor(t=0,e=0,i=0,r=1){n.prototype.isVector4=!0,this.x=t,this.y=e,this.z=i,this.w=r}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,e,i,r){return this.x=t,this.y=e,this.z=i,this.w=r,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this}addScaledVector(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){let e=this.x,i=this.y,r=this.z,o=this.w,l=t.elements;return this.x=l[0]*e+l[4]*i+l[8]*r+l[12]*o,this.y=l[1]*e+l[5]*i+l[9]*r+l[13]*o,this.z=l[2]*e+l[6]*i+l[10]*r+l[14]*o,this.w=l[3]*e+l[7]*i+l[11]*r+l[15]*o,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);let e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this}setAxisAngleFromRotationMatrix(t){let e,i,r,o,f=t.elements,p=f[0],g=f[4],m=f[8],x=f[1],C=f[5],A=f[9],O=f[2],T=f[6],M=f[10];if(Math.abs(g-x)<.01&&Math.abs(m-O)<.01&&Math.abs(A-T)<.01){if(Math.abs(g+x)<.1&&Math.abs(m+O)<.1&&Math.abs(A+T)<.1&&Math.abs(p+C+M-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;let Y=(p+1)/2,q=(C+1)/2,X=(M+1)/2,Z=(g+x)/4,J=(m+O)/4,oe=(A+T)/4;return Y>q&&Y>X?Y<.01?(i=0,r=.707106781,o=.707106781):(i=Math.sqrt(Y),r=Z/i,o=J/i):q>X?q<.01?(i=.707106781,r=0,o=.707106781):(r=Math.sqrt(q),i=Z/r,o=oe/r):X<.01?(i=.707106781,r=.707106781,o=0):(o=Math.sqrt(X),i=J/o,r=oe/o),this.set(i,r,o,e),this}let G=Math.sqrt((T-A)*(T-A)+(m-O)*(m-O)+(x-g)*(x-g));return Math.abs(G)<.001&&(G=1),this.x=(T-A)/G,this.y=(m-O)/G,this.z=(x-g)/G,this.w=Math.acos((p+C+M-1)/2),this}setFromMatrixPosition(t){let e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this.w=e[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,e){return this.x=on(this.x,t.x,e.x),this.y=on(this.y,t.y,e.y),this.z=on(this.z,t.z,e.z),this.w=on(this.w,t.w,e.w),this}clampScalar(t,e){return this.x=on(this.x,t,e),this.y=on(this.y,t,e),this.z=on(this.z,t,e),this.w=on(this.w,t,e),this}clampLength(t,e){let i=this.length();return this.divideScalar(i||1).multiplyScalar(on(i,t,e))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this}lerpVectors(t,e,i){return this.x=t.x+(e.x-t.x)*i,this.y=t.y+(e.y-t.y)*i,this.z=t.z+(e.z-t.z)*i,this.w=t.w+(e.w-t.w)*i,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,e=0){return this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this}toArray(t=[],e=0){return t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t}fromBufferAttribute(t,e){return this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},u_=class extends _s{constructor(t=1,e=1,i={}){super(),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:qi,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},i),this.isRenderTarget=!0,this.width=t,this.height=e,this.depth=i.depth,this.scissor=new ui(0,0,t,e),this.scissorTest=!1,this.viewport=new ui(0,0,t,e);let r={width:t,height:e,depth:i.depth},o=new Zo(r);this.textures=[];let l=i.count;for(let c=0;c<l;c++)this.textures[c]=o.clone(),this.textures[c].isRenderTargetTexture=!0,this.textures[c].renderTarget=this;this._setTextureOptions(i),this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.resolveDepthBuffer=i.resolveDepthBuffer,this.resolveStencilBuffer=i.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=i.depthTexture,this.samples=i.samples,this.multiview=i.multiview}_setTextureOptions(t={}){let e={minFilter:qi,generateMipmaps:!1,flipY:!1,internalFormat:null};t.mapping!==void 0&&(e.mapping=t.mapping),t.wrapS!==void 0&&(e.wrapS=t.wrapS),t.wrapT!==void 0&&(e.wrapT=t.wrapT),t.wrapR!==void 0&&(e.wrapR=t.wrapR),t.magFilter!==void 0&&(e.magFilter=t.magFilter),t.minFilter!==void 0&&(e.minFilter=t.minFilter),t.format!==void 0&&(e.format=t.format),t.type!==void 0&&(e.type=t.type),t.anisotropy!==void 0&&(e.anisotropy=t.anisotropy),t.colorSpace!==void 0&&(e.colorSpace=t.colorSpace),t.flipY!==void 0&&(e.flipY=t.flipY),t.generateMipmaps!==void 0&&(e.generateMipmaps=t.generateMipmaps),t.internalFormat!==void 0&&(e.internalFormat=t.internalFormat);for(let i=0;i<this.textures.length;i++)this.textures[i].setValues(e)}get texture(){return this.textures[0]}set texture(t){this.textures[0]=t}set depthTexture(t){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),t!==null&&(t.renderTarget=this),this._depthTexture=t}get depthTexture(){return this._depthTexture}setSize(t,e,i=1){if(this.width!==t||this.height!==e||this.depth!==i){this.width=t,this.height=e,this.depth=i;for(let r=0,o=this.textures.length;r<o;r++)this.textures[r].image.width=t,this.textures[r].image.height=e,this.textures[r].image.depth=i,this.textures[r].isData3DTexture!==!0&&(this.textures[r].isArrayTexture=this.textures[r].image.depth>1);this.dispose()}this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.textures.length=0;for(let e=0,i=t.textures.length;e<i;e++){this.textures[e]=t.textures[e].clone(),this.textures[e].isRenderTargetTexture=!0,this.textures[e].renderTarget=this;let r=Object.assign({},t.textures[e].image);this.textures[e].source=new sd(r)}return this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.resolveDepthBuffer=t.resolveDepthBuffer,this.resolveStencilBuffer=t.resolveStencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}},io=class extends u_{constructor(t=1,e=1,i={}){super(t,e,i),this.isWebGLRenderTarget=!0}},wf=class extends Zo{constructor(t=null,e=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:e,height:i,depth:r},this.magFilter=zi,this.minFilter=zi,this.wrapR=ms,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}};var c_=class extends Zo{constructor(t=null,e=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:e,height:i,depth:r},this.magFilter=zi,this.minFilter=zi,this.wrapR=ms,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};var Ga=class{constructor(t=new ae(1/0,1/0,1/0),e=new ae(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=e}set(t,e){return this.min.copy(t),this.max.copy(e),this}setFromArray(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e+=3)this.expandByPoint(zo.fromArray(t,e));return this}setFromBufferAttribute(t){this.makeEmpty();for(let e=0,i=t.count;e<i;e++)this.expandByPoint(zo.fromBufferAttribute(t,e));return this}setFromPoints(t){this.makeEmpty();for(let e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this}setFromCenterAndSize(t,e){let i=zo.copy(e).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t,e=!1){return this.makeEmpty(),this.expandByObject(t,e)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,e=!1){t.updateWorldMatrix(!1,!1);let i=t.geometry;if(i!==void 0){let o=i.getAttribute("position");if(e===!0&&o!==void 0&&t.isInstancedMesh!==!0)for(let l=0,c=o.count;l<c;l++)t.isMesh===!0?t.getVertexPosition(l,zo):zo.fromBufferAttribute(o,l),zo.applyMatrix4(t.matrixWorld),this.expandByPoint(zo);else t.boundingBox!==void 0?(t.boundingBox===null&&t.computeBoundingBox(),Ng.copy(t.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Ng.copy(i.boundingBox)),Ng.applyMatrix4(t.matrixWorld),this.union(Ng)}let r=t.children;for(let o=0,l=r.length;o<l;o++)this.expandByObject(r[o],e);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,e){return e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,zo),zo.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(pf),Ug.subVectors(this.max,pf),zc.subVectors(t.a,pf),jc.subVectors(t.b,pf),Wc.subVectors(t.c,pf),Ua.subVectors(jc,zc),La.subVectors(Wc,jc),nu.subVectors(zc,Wc);let e=[0,-Ua.z,Ua.y,0,-La.z,La.y,0,-nu.z,nu.y,Ua.z,0,-Ua.x,La.z,0,-La.x,nu.z,0,-nu.x,-Ua.y,Ua.x,0,-La.y,La.x,0,-nu.y,nu.x,0];return!ab(e,zc,jc,Wc,Ug)||(e=[1,0,0,0,1,0,0,0,1],!ab(e,zc,jc,Wc,Ug))?!1:(Lg.crossVectors(Ua,La),e=[Lg.x,Lg.y,Lg.z],ab(e,zc,jc,Wc,Ug))}clampPoint(t,e){return e.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,zo).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(zo).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Zs[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Zs[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Zs[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Zs[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Zs[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Zs[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Zs[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Zs[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Zs),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(t){return this.min.fromArray(t.min),this.max.fromArray(t.max),this}},Zs=[new ae,new ae,new ae,new ae,new ae,new ae,new ae,new ae],zo=new ae,Ng=new Ga,zc=new ae,jc=new ae,Wc=new ae,Ua=new ae,La=new ae,nu=new ae,pf=new ae,Ug=new ae,Lg=new ae,iu=new ae;function ab(n,t,e,i,r){for(let o=0,l=n.length-3;o<=l;o+=3){iu.fromArray(n,o);let c=r.x*Math.abs(iu.x)+r.y*Math.abs(iu.y)+r.z*Math.abs(iu.z),f=t.dot(iu),p=e.dot(iu),g=i.dot(iu);if(Math.max(-Math.max(f,p,g),Math.min(f,p,g))>c)return!1}return!0}var z8=new Ga,mf=new ae,lb=new ae,du=class{constructor(t=new ae,e=-1){this.isSphere=!0,this.center=t,this.radius=e}set(t,e){return this.center.copy(t),this.radius=e,this}setFromPoints(t,e){let i=this.center;e!==void 0?i.copy(e):z8.setFromPoints(t).getCenter(i);let r=0;for(let o=0,l=t.length;o<l;o++)r=Math.max(r,i.distanceToSquared(t[o]));return this.radius=Math.sqrt(r),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){let e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,e){let i=this.center.distanceToSquared(t);return e.copy(t),i>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;mf.subVectors(t,this.center);let e=mf.lengthSq();if(e>this.radius*this.radius){let i=Math.sqrt(e),r=(i-this.radius)*.5;this.center.addScaledVector(mf,r/i),this.radius+=r}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(lb.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(mf.copy(t.center).add(lb)),this.expandByPoint(mf.copy(t.center).sub(lb))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(t){return this.radius=t.radius,this.center.fromArray(t.center),this}},Js=new ae,ub=new ae,Bg=new ae,Ba=new ae,cb=new ae,Vg=new ae,db=new ae,fu=class{constructor(t=new ae,e=new ae(0,0,-1)){this.origin=t,this.direction=e}set(t,e){return this.origin.copy(t),this.direction.copy(e),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,e){return e.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Js)),this}closestPointToPoint(t,e){e.subVectors(t,this.origin);let i=e.dot(this.direction);return i<0?e.copy(this.origin):e.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){let e=Js.subVectors(t,this.origin).dot(this.direction);return e<0?this.origin.distanceToSquared(t):(Js.copy(this.origin).addScaledVector(this.direction,e),Js.distanceToSquared(t))}distanceSqToSegment(t,e,i,r){ub.copy(t).add(e).multiplyScalar(.5),Bg.copy(e).sub(t).normalize(),Ba.copy(this.origin).sub(ub);let o=t.distanceTo(e)*.5,l=-this.direction.dot(Bg),c=Ba.dot(this.direction),f=-Ba.dot(Bg),p=Ba.lengthSq(),g=Math.abs(1-l*l),m,x,C,A;if(g>0)if(m=l*f-c,x=l*c-f,A=o*g,m>=0)if(x>=-A)if(x<=A){let O=1/g;m*=O,x*=O,C=m*(m+l*x+2*c)+x*(l*m+x+2*f)+p}else x=o,m=Math.max(0,-(l*x+c)),C=-m*m+x*(x+2*f)+p;else x=-o,m=Math.max(0,-(l*x+c)),C=-m*m+x*(x+2*f)+p;else x<=-A?(m=Math.max(0,-(-l*o+c)),x=m>0?-o:Math.min(Math.max(-o,-f),o),C=-m*m+x*(x+2*f)+p):x<=A?(m=0,x=Math.min(Math.max(-o,-f),o),C=x*(x+2*f)+p):(m=Math.max(0,-(l*o+c)),x=m>0?o:Math.min(Math.max(-o,-f),o),C=-m*m+x*(x+2*f)+p);else x=l>0?-o:o,m=Math.max(0,-(l*x+c)),C=-m*m+x*(x+2*f)+p;return i&&i.copy(this.origin).addScaledVector(this.direction,m),r&&r.copy(ub).addScaledVector(Bg,x),C}intersectSphere(t,e){Js.subVectors(t.center,this.origin);let i=Js.dot(this.direction),r=Js.dot(Js)-i*i,o=t.radius*t.radius;if(r>o)return null;let l=Math.sqrt(o-r),c=i-l,f=i+l;return f<0?null:c<0?this.at(f,e):this.at(c,e)}intersectsSphere(t){return t.radius<0?!1:this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){let e=t.normal.dot(this.direction);if(e===0)return t.distanceToPoint(this.origin)===0?0:null;let i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null}intersectPlane(t,e){let i=this.distanceToPlane(t);return i===null?null:this.at(i,e)}intersectsPlane(t){let e=t.distanceToPoint(this.origin);return e===0||t.normal.dot(this.direction)*e<0}intersectBox(t,e){let i,r,o,l,c,f,p=1/this.direction.x,g=1/this.direction.y,m=1/this.direction.z,x=this.origin;return p>=0?(i=(t.min.x-x.x)*p,r=(t.max.x-x.x)*p):(i=(t.max.x-x.x)*p,r=(t.min.x-x.x)*p),g>=0?(o=(t.min.y-x.y)*g,l=(t.max.y-x.y)*g):(o=(t.max.y-x.y)*g,l=(t.min.y-x.y)*g),i>l||o>r||((o>i||isNaN(i))&&(i=o),(l<r||isNaN(r))&&(r=l),m>=0?(c=(t.min.z-x.z)*m,f=(t.max.z-x.z)*m):(c=(t.max.z-x.z)*m,f=(t.min.z-x.z)*m),i>f||c>r)||((c>i||i!==i)&&(i=c),(f<r||r!==r)&&(r=f),r<0)?null:this.at(i>=0?i:r,e)}intersectsBox(t){return this.intersectBox(t,Js)!==null}intersectTriangle(t,e,i,r,o){cb.subVectors(e,t),Vg.subVectors(i,t),db.crossVectors(cb,Vg);let l=this.direction.dot(db),c;if(l>0){if(r)return null;c=1}else if(l<0)c=-1,l=-l;else return null;Ba.subVectors(this.origin,t);let f=c*this.direction.dot(Vg.crossVectors(Ba,Vg));if(f<0)return null;let p=c*this.direction.dot(cb.cross(Ba));if(p<0||f+p>l)return null;let g=-c*Ba.dot(db);return g<0?null:this.at(g/l,o)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},li=class n{constructor(t,e,i,r,o,l,c,f,p,g,m,x,C,A,O,T){n.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,e,i,r,o,l,c,f,p,g,m,x,C,A,O,T)}set(t,e,i,r,o,l,c,f,p,g,m,x,C,A,O,T){let M=this.elements;return M[0]=t,M[4]=e,M[8]=i,M[12]=r,M[1]=o,M[5]=l,M[9]=c,M[13]=f,M[2]=p,M[6]=g,M[10]=m,M[14]=x,M[3]=C,M[7]=A,M[11]=O,M[15]=T,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new n().fromArray(this.elements)}copy(t){let e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this}copyPosition(t){let e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this}setFromMatrix3(t){let e=t.elements;return this.set(e[0],e[3],e[6],0,e[1],e[4],e[7],0,e[2],e[5],e[8],0,0,0,0,1),this}extractBasis(t,e,i){return this.determinant()===0?(t.set(1,0,0),e.set(0,1,0),i.set(0,0,1),this):(t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this)}makeBasis(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this}extractRotation(t){if(t.determinant()===0)return this.identity();let e=this.elements,i=t.elements,r=1/Gc.setFromMatrixColumn(t,0).length(),o=1/Gc.setFromMatrixColumn(t,1).length(),l=1/Gc.setFromMatrixColumn(t,2).length();return e[0]=i[0]*r,e[1]=i[1]*r,e[2]=i[2]*r,e[3]=0,e[4]=i[4]*o,e[5]=i[5]*o,e[6]=i[6]*o,e[7]=0,e[8]=i[8]*l,e[9]=i[9]*l,e[10]=i[10]*l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromEuler(t){let e=this.elements,i=t.x,r=t.y,o=t.z,l=Math.cos(i),c=Math.sin(i),f=Math.cos(r),p=Math.sin(r),g=Math.cos(o),m=Math.sin(o);if(t.order==="XYZ"){let x=l*g,C=l*m,A=c*g,O=c*m;e[0]=f*g,e[4]=-f*m,e[8]=p,e[1]=C+A*p,e[5]=x-O*p,e[9]=-c*f,e[2]=O-x*p,e[6]=A+C*p,e[10]=l*f}else if(t.order==="YXZ"){let x=f*g,C=f*m,A=p*g,O=p*m;e[0]=x+O*c,e[4]=A*c-C,e[8]=l*p,e[1]=l*m,e[5]=l*g,e[9]=-c,e[2]=C*c-A,e[6]=O+x*c,e[10]=l*f}else if(t.order==="ZXY"){let x=f*g,C=f*m,A=p*g,O=p*m;e[0]=x-O*c,e[4]=-l*m,e[8]=A+C*c,e[1]=C+A*c,e[5]=l*g,e[9]=O-x*c,e[2]=-l*p,e[6]=c,e[10]=l*f}else if(t.order==="ZYX"){let x=l*g,C=l*m,A=c*g,O=c*m;e[0]=f*g,e[4]=A*p-C,e[8]=x*p+O,e[1]=f*m,e[5]=O*p+x,e[9]=C*p-A,e[2]=-p,e[6]=c*f,e[10]=l*f}else if(t.order==="YZX"){let x=l*f,C=l*p,A=c*f,O=c*p;e[0]=f*g,e[4]=O-x*m,e[8]=A*m+C,e[1]=m,e[5]=l*g,e[9]=-c*g,e[2]=-p*g,e[6]=C*m+A,e[10]=x-O*m}else if(t.order==="XZY"){let x=l*f,C=l*p,A=c*f,O=c*p;e[0]=f*g,e[4]=-m,e[8]=p*g,e[1]=x*m+O,e[5]=l*g,e[9]=C*m-A,e[2]=A*m-C,e[6]=c*g,e[10]=O*m+x}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this}makeRotationFromQuaternion(t){return this.compose(j8,t,W8)}lookAt(t,e,i){let r=this.elements;return Qr.subVectors(t,e),Qr.lengthSq()===0&&(Qr.z=1),Qr.normalize(),Va.crossVectors(i,Qr),Va.lengthSq()===0&&(Math.abs(i.z)===1?Qr.x+=1e-4:Qr.z+=1e-4,Qr.normalize(),Va.crossVectors(i,Qr)),Va.normalize(),Hg.crossVectors(Qr,Va),r[0]=Va.x,r[4]=Hg.x,r[8]=Qr.x,r[1]=Va.y,r[5]=Hg.y,r[9]=Qr.y,r[2]=Va.z,r[6]=Hg.z,r[10]=Qr.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,e){let i=t.elements,r=e.elements,o=this.elements,l=i[0],c=i[4],f=i[8],p=i[12],g=i[1],m=i[5],x=i[9],C=i[13],A=i[2],O=i[6],T=i[10],M=i[14],G=i[3],Y=i[7],q=i[11],X=i[15],Z=r[0],J=r[4],oe=r[8],L=r[12],z=r[1],K=r[5],re=r[9],ce=r[13],we=r[2],Ee=r[6],xe=r[10],me=r[14],Me=r[3],qe=r[7],Be=r[11],Xe=r[15];return o[0]=l*Z+c*z+f*we+p*Me,o[4]=l*J+c*K+f*Ee+p*qe,o[8]=l*oe+c*re+f*xe+p*Be,o[12]=l*L+c*ce+f*me+p*Xe,o[1]=g*Z+m*z+x*we+C*Me,o[5]=g*J+m*K+x*Ee+C*qe,o[9]=g*oe+m*re+x*xe+C*Be,o[13]=g*L+m*ce+x*me+C*Xe,o[2]=A*Z+O*z+T*we+M*Me,o[6]=A*J+O*K+T*Ee+M*qe,o[10]=A*oe+O*re+T*xe+M*Be,o[14]=A*L+O*ce+T*me+M*Xe,o[3]=G*Z+Y*z+q*we+X*Me,o[7]=G*J+Y*K+q*Ee+X*qe,o[11]=G*oe+Y*re+q*xe+X*Be,o[15]=G*L+Y*ce+q*me+X*Xe,this}multiplyScalar(t){let e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this}determinant(){let t=this.elements,e=t[0],i=t[4],r=t[8],o=t[12],l=t[1],c=t[5],f=t[9],p=t[13],g=t[2],m=t[6],x=t[10],C=t[14],A=t[3],O=t[7],T=t[11],M=t[15],G=f*C-p*x,Y=c*C-p*m,q=c*x-f*m,X=l*C-p*g,Z=l*x-f*g,J=l*m-c*g;return e*(O*G-T*Y+M*q)-i*(A*G-T*X+M*Z)+r*(A*Y-O*X+M*J)-o*(A*q-O*Z+T*J)}transpose(){let t=this.elements,e;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(t,e,i){let r=this.elements;return t.isVector3?(r[12]=t.x,r[13]=t.y,r[14]=t.z):(r[12]=t,r[13]=e,r[14]=i),this}invert(){let t=this.elements,e=t[0],i=t[1],r=t[2],o=t[3],l=t[4],c=t[5],f=t[6],p=t[7],g=t[8],m=t[9],x=t[10],C=t[11],A=t[12],O=t[13],T=t[14],M=t[15],G=m*T*p-O*x*p+O*f*C-c*T*C-m*f*M+c*x*M,Y=A*x*p-g*T*p-A*f*C+l*T*C+g*f*M-l*x*M,q=g*O*p-A*m*p+A*c*C-l*O*C-g*c*M+l*m*M,X=A*m*f-g*O*f-A*c*x+l*O*x+g*c*T-l*m*T,Z=e*G+i*Y+r*q+o*X;if(Z===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let J=1/Z;return t[0]=G*J,t[1]=(O*x*o-m*T*o-O*r*C+i*T*C+m*r*M-i*x*M)*J,t[2]=(c*T*o-O*f*o+O*r*p-i*T*p-c*r*M+i*f*M)*J,t[3]=(m*f*o-c*x*o-m*r*p+i*x*p+c*r*C-i*f*C)*J,t[4]=Y*J,t[5]=(g*T*o-A*x*o+A*r*C-e*T*C-g*r*M+e*x*M)*J,t[6]=(A*f*o-l*T*o-A*r*p+e*T*p+l*r*M-e*f*M)*J,t[7]=(l*x*o-g*f*o+g*r*p-e*x*p-l*r*C+e*f*C)*J,t[8]=q*J,t[9]=(A*m*o-g*O*o-A*i*C+e*O*C+g*i*M-e*m*M)*J,t[10]=(l*O*o-A*c*o+A*i*p-e*O*p-l*i*M+e*c*M)*J,t[11]=(g*c*o-l*m*o-g*i*p+e*m*p+l*i*C-e*c*C)*J,t[12]=X*J,t[13]=(g*O*r-A*m*r+A*i*x-e*O*x-g*i*T+e*m*T)*J,t[14]=(A*c*r-l*O*r-A*i*f+e*O*f+l*i*T-e*c*T)*J,t[15]=(l*m*r-g*c*r+g*i*f-e*m*f-l*i*x+e*c*x)*J,this}scale(t){let e=this.elements,i=t.x,r=t.y,o=t.z;return e[0]*=i,e[4]*=r,e[8]*=o,e[1]*=i,e[5]*=r,e[9]*=o,e[2]*=i,e[6]*=r,e[10]*=o,e[3]*=i,e[7]*=r,e[11]*=o,this}getMaxScaleOnAxis(){let t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,r))}makeTranslation(t,e,i){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this}makeRotationX(t){let e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this}makeRotationY(t){let e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this}makeRotationZ(t){let e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,e){let i=Math.cos(e),r=Math.sin(e),o=1-i,l=t.x,c=t.y,f=t.z,p=o*l,g=o*c;return this.set(p*l+i,p*c-r*f,p*f+r*c,0,p*c+r*f,g*c+i,g*f-r*l,0,p*f-r*c,g*f+r*l,o*f*f+i,0,0,0,0,1),this}makeScale(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,e,i,r,o,l){return this.set(1,i,o,0,t,1,l,0,e,r,1,0,0,0,0,1),this}compose(t,e,i){let r=this.elements,o=e._x,l=e._y,c=e._z,f=e._w,p=o+o,g=l+l,m=c+c,x=o*p,C=o*g,A=o*m,O=l*g,T=l*m,M=c*m,G=f*p,Y=f*g,q=f*m,X=i.x,Z=i.y,J=i.z;return r[0]=(1-(O+M))*X,r[1]=(C+q)*X,r[2]=(A-Y)*X,r[3]=0,r[4]=(C-q)*Z,r[5]=(1-(x+M))*Z,r[6]=(T+G)*Z,r[7]=0,r[8]=(A+Y)*J,r[9]=(T-G)*J,r[10]=(1-(x+O))*J,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,this}decompose(t,e,i){let r=this.elements;if(t.x=r[12],t.y=r[13],t.z=r[14],this.determinant()===0)return i.set(1,1,1),e.identity(),this;let o=Gc.set(r[0],r[1],r[2]).length(),l=Gc.set(r[4],r[5],r[6]).length(),c=Gc.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),jo.copy(this);let p=1/o,g=1/l,m=1/c;return jo.elements[0]*=p,jo.elements[1]*=p,jo.elements[2]*=p,jo.elements[4]*=g,jo.elements[5]*=g,jo.elements[6]*=g,jo.elements[8]*=m,jo.elements[9]*=m,jo.elements[10]*=m,e.setFromRotationMatrix(jo),i.x=o,i.y=l,i.z=c,this}makePerspective(t,e,i,r,o,l,c=Go,f=!1){let p=this.elements,g=2*o/(e-t),m=2*o/(i-r),x=(e+t)/(e-t),C=(i+r)/(i-r),A,O;if(f)A=o/(l-o),O=l*o/(l-o);else if(c===Go)A=-(l+o)/(l-o),O=-2*l*o/(l-o);else if(c===Ef)A=-l/(l-o),O=-l*o/(l-o);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+c);return p[0]=g,p[4]=0,p[8]=x,p[12]=0,p[1]=0,p[5]=m,p[9]=C,p[13]=0,p[2]=0,p[6]=0,p[10]=A,p[14]=O,p[3]=0,p[7]=0,p[11]=-1,p[15]=0,this}makeOrthographic(t,e,i,r,o,l,c=Go,f=!1){let p=this.elements,g=2/(e-t),m=2/(i-r),x=-(e+t)/(e-t),C=-(i+r)/(i-r),A,O;if(f)A=1/(l-o),O=l/(l-o);else if(c===Go)A=-2/(l-o),O=-(l+o)/(l-o);else if(c===Ef)A=-1/(l-o),O=-o/(l-o);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+c);return p[0]=g,p[4]=0,p[8]=0,p[12]=x,p[1]=0,p[5]=m,p[9]=0,p[13]=C,p[2]=0,p[6]=0,p[10]=A,p[14]=O,p[3]=0,p[7]=0,p[11]=0,p[15]=1,this}equals(t){let e=this.elements,i=t.elements;for(let r=0;r<16;r++)if(e[r]!==i[r])return!1;return!0}fromArray(t,e=0){for(let i=0;i<16;i++)this.elements[i]=t[i+e];return this}toArray(t=[],e=0){let i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}},Gc=new ae,jo=new li,j8=new ae(0,0,0),W8=new ae(1,1,1),Va=new ae,Hg=new ae,Qr=new ae,DA=new li,PA=new So,$a=(()=>{class n{constructor(e=0,i=0,r=0,o=n.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=i,this._z=r,this._order=o}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,r,o=this._order){return this._x=e,this._y=i,this._z=r,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,r=!0){let o=e.elements,l=o[0],c=o[4],f=o[8],p=o[1],g=o[5],m=o[9],x=o[2],C=o[6],A=o[10];switch(i){case"XYZ":this._y=Math.asin(on(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(-m,A),this._z=Math.atan2(-c,l)):(this._x=Math.atan2(C,g),this._z=0);break;case"YXZ":this._x=Math.asin(-on(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(f,A),this._z=Math.atan2(p,g)):(this._y=Math.atan2(-x,l),this._z=0);break;case"ZXY":this._x=Math.asin(on(C,-1,1)),Math.abs(C)<.9999999?(this._y=Math.atan2(-x,A),this._z=Math.atan2(-c,g)):(this._y=0,this._z=Math.atan2(p,l));break;case"ZYX":this._y=Math.asin(-on(x,-1,1)),Math.abs(x)<.9999999?(this._x=Math.atan2(C,A),this._z=Math.atan2(p,l)):(this._x=0,this._z=Math.atan2(-c,g));break;case"YZX":this._z=Math.asin(on(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(-m,g),this._y=Math.atan2(-x,l)):(this._x=0,this._y=Math.atan2(f,A));break;case"XZY":this._z=Math.asin(-on(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(C,g),this._y=Math.atan2(f,l)):(this._x=Math.atan2(-m,A),this._y=0);break;default:Mt("Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,r===!0&&this._onChangeCallback(),this}setFromQuaternion(e,i,r){return DA.makeRotationFromQuaternion(e),this.setFromRotationMatrix(DA,i,r)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return PA.setFromEuler(this),this.setFromQuaternion(PA,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}return n.DEFAULT_ORDER="XYZ",n})(),Sf=class{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}},G8=0,IA=new ae,$c=new So,Ks=new li,zg=new ae,gf=new ae,$8=new ae,Y8=new So,OA=new ae(1,0,0),FA=new ae(0,1,0),RA=new ae(0,0,1),kA={type:"added"},q8={type:"removed"},Yc={type:"childadded",child:null},fb={type:"childremoved",child:null},$o=(()=>{class n extends _s{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:G8++}),this.uuid=gd(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=n.DEFAULT_UP.clone();let e=new ae,i=new $a,r=new So,o=new ae(1,1,1);function l(){r.setFromEuler(i,!1)}function c(){i.setFromQuaternion(r,void 0,!1)}i._onChange(l),r._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:r},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new li},normalMatrix:{value:new jt}}),this.matrix=new li,this.matrixWorld=new li,this.matrixAutoUpdate=n.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new Sf,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return $c.setFromAxisAngle(e,i),this.quaternion.multiply($c),this}rotateOnWorldAxis(e,i){return $c.setFromAxisAngle(e,i),this.quaternion.premultiply($c),this}rotateX(e){return this.rotateOnAxis(OA,e)}rotateY(e){return this.rotateOnAxis(FA,e)}rotateZ(e){return this.rotateOnAxis(RA,e)}translateOnAxis(e,i){return IA.copy(e).applyQuaternion(this.quaternion),this.position.add(IA.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(OA,e)}translateY(e){return this.translateOnAxis(FA,e)}translateZ(e){return this.translateOnAxis(RA,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(Ks.copy(this.matrixWorld).invert())}lookAt(e,i,r){e.isVector3?zg.copy(e):zg.set(e,i,r);let o=this.parent;this.updateWorldMatrix(!0,!1),gf.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Ks.lookAt(gf,zg,this.up):Ks.lookAt(zg,gf,this.up),this.quaternion.setFromRotationMatrix(Ks),o&&(Ks.extractRotation(o.matrixWorld),$c.setFromRotationMatrix(Ks),this.quaternion.premultiply($c.invert()))}add(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.add(arguments[i]);return this}return e===this?(At("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(kA),Yc.child=e,this.dispatchEvent(Yc),Yc.child=null):At("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}let i=this.children.indexOf(e);return i!==-1&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(q8),fb.child=e,this.dispatchEvent(fb),fb.child=null),this}removeFromParent(){let e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),Ks.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),Ks.multiply(e.parent.matrixWorld)),e.applyMatrix4(Ks),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(kA),Yc.child=e,this.dispatchEvent(Yc),Yc.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let r=0,o=this.children.length;r<o;r++){let c=this.children[r].getObjectByProperty(e,i);if(c!==void 0)return c}}getObjectsByProperty(e,i,r=[]){this[e]===i&&r.push(this);let o=this.children;for(let l=0,c=o.length;l<c;l++)o[l].getObjectsByProperty(e,i,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gf,e,$8),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(gf,Y8,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);let i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);let i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].traverseVisible(e)}traverseAncestors(e){let i=this.parent;i!==null&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);let i=this.children;for(let r=0,o=i.length;r<o;r++)i[r].updateMatrixWorld(e)}updateWorldMatrix(e,i){let r=this.parent;if(e===!0&&r!==null&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),i===!0){let o=this.children;for(let l=0,c=o.length;l<c;l++)o[l].updateWorldMatrix(!1,!0)}}toJSON(e){let i=e===void 0||typeof e=="string",r={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});let o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),o.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(o.type="BatchedMesh",o.perObjectFrustumCulled=this.perObjectFrustumCulled,o.sortObjects=this.sortObjects,o.drawRanges=this._drawRanges,o.reservedRanges=this._reservedRanges,o.geometryInfo=this._geometryInfo.map(f=>St(Oe({},f),{boundingBox:f.boundingBox?f.boundingBox.toJSON():void 0,boundingSphere:f.boundingSphere?f.boundingSphere.toJSON():void 0})),o.instanceInfo=this._instanceInfo.map(f=>Oe({},f)),o.availableInstanceIds=this._availableInstanceIds.slice(),o.availableGeometryIds=this._availableGeometryIds.slice(),o.nextIndexStart=this._nextIndexStart,o.nextVertexStart=this._nextVertexStart,o.geometryCount=this._geometryCount,o.maxInstanceCount=this._maxInstanceCount,o.maxVertexCount=this._maxVertexCount,o.maxIndexCount=this._maxIndexCount,o.geometryInitialized=this._geometryInitialized,o.matricesTexture=this._matricesTexture.toJSON(e),o.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(o.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(o.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(o.boundingBox=this.boundingBox.toJSON()));function l(f,p){return f[p.uuid]===void 0&&(f[p.uuid]=p.toJSON(e)),p.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(o.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=l(e.geometries,this.geometry);let f=this.geometry.parameters;if(f!==void 0&&f.shapes!==void 0){let p=f.shapes;if(Array.isArray(p))for(let g=0,m=p.length;g<m;g++){let x=p[g];l(e.shapes,x)}else l(e.shapes,p)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(l(e.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){let f=[];for(let p=0,g=this.material.length;p<g;p++)f.push(l(e.materials,this.material[p]));o.material=f}else o.material=l(e.materials,this.material);if(this.children.length>0){o.children=[];for(let f=0;f<this.children.length;f++)o.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){o.animations=[];for(let f=0;f<this.animations.length;f++){let p=this.animations[f];o.animations.push(l(e.animations,p))}}if(i){let f=c(e.geometries),p=c(e.materials),g=c(e.textures),m=c(e.images),x=c(e.shapes),C=c(e.skeletons),A=c(e.animations),O=c(e.nodes);f.length>0&&(r.geometries=f),p.length>0&&(r.materials=p),g.length>0&&(r.textures=g),m.length>0&&(r.images=m),x.length>0&&(r.shapes=x),C.length>0&&(r.skeletons=C),A.length>0&&(r.animations=A),O.length>0&&(r.nodes=O)}return r.object=o,r;function c(f){let p=[];for(let g in f){let m=f[g];delete m.metadata,p.push(m)}return p}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),i===!0)for(let r=0;r<e.children.length;r++){let o=e.children[r];this.add(o.clone())}return this}}return n.DEFAULT_UP=new ae(0,1,0),n.DEFAULT_MATRIX_AUTO_UPDATE=!0,n.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,n})(),Wo=new ae,Qs=new ae,hb=new ae,ea=new ae,qc=new ae,Xc=new ae,NA=new ae,pb=new ae,mb=new ae,gb=new ae,_b=new ui,vb=new ui,yb=new ui,ja=class n{constructor(t=new ae,e=new ae,i=new ae){this.a=t,this.b=e,this.c=i}static getNormal(t,e,i,r){r.subVectors(i,e),Wo.subVectors(t,e),r.cross(Wo);let o=r.lengthSq();return o>0?r.multiplyScalar(1/Math.sqrt(o)):r.set(0,0,0)}static getBarycoord(t,e,i,r,o){Wo.subVectors(r,e),Qs.subVectors(i,e),hb.subVectors(t,e);let l=Wo.dot(Wo),c=Wo.dot(Qs),f=Wo.dot(hb),p=Qs.dot(Qs),g=Qs.dot(hb),m=l*p-c*c;if(m===0)return o.set(0,0,0),null;let x=1/m,C=(p*f-c*g)*x,A=(l*g-c*f)*x;return o.set(1-C-A,A,C)}static containsPoint(t,e,i,r){return this.getBarycoord(t,e,i,r,ea)===null?!1:ea.x>=0&&ea.y>=0&&ea.x+ea.y<=1}static getInterpolation(t,e,i,r,o,l,c,f){return this.getBarycoord(t,e,i,r,ea)===null?(f.x=0,f.y=0,"z"in f&&(f.z=0),"w"in f&&(f.w=0),null):(f.setScalar(0),f.addScaledVector(o,ea.x),f.addScaledVector(l,ea.y),f.addScaledVector(c,ea.z),f)}static getInterpolatedAttribute(t,e,i,r,o,l){return _b.setScalar(0),vb.setScalar(0),yb.setScalar(0),_b.fromBufferAttribute(t,e),vb.fromBufferAttribute(t,i),yb.fromBufferAttribute(t,r),l.setScalar(0),l.addScaledVector(_b,o.x),l.addScaledVector(vb,o.y),l.addScaledVector(yb,o.z),l}static isFrontFacing(t,e,i,r){return Wo.subVectors(i,e),Qs.subVectors(t,e),Wo.cross(Qs).dot(r)<0}set(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this}setFromPointsAndIndices(t,e,i,r){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[r]),this}setFromAttributeAndIndices(t,e,i,r){return this.a.fromBufferAttribute(t,e),this.b.fromBufferAttribute(t,i),this.c.fromBufferAttribute(t,r),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return Wo.subVectors(this.c,this.b),Qs.subVectors(this.a,this.b),Wo.cross(Qs).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return n.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,e){return n.getBarycoord(t,this.a,this.b,this.c,e)}getInterpolation(t,e,i,r,o){return n.getInterpolation(t,this.a,this.b,this.c,e,i,r,o)}containsPoint(t){return n.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return n.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,e){let i=this.a,r=this.b,o=this.c,l,c;qc.subVectors(r,i),Xc.subVectors(o,i),pb.subVectors(t,i);let f=qc.dot(pb),p=Xc.dot(pb);if(f<=0&&p<=0)return e.copy(i);mb.subVectors(t,r);let g=qc.dot(mb),m=Xc.dot(mb);if(g>=0&&m<=g)return e.copy(r);let x=f*m-g*p;if(x<=0&&f>=0&&g<=0)return l=f/(f-g),e.copy(i).addScaledVector(qc,l);gb.subVectors(t,o);let C=qc.dot(gb),A=Xc.dot(gb);if(A>=0&&C<=A)return e.copy(o);let O=C*p-f*A;if(O<=0&&p>=0&&A<=0)return c=p/(p-A),e.copy(i).addScaledVector(Xc,c);let T=g*A-C*m;if(T<=0&&m-g>=0&&C-A>=0)return NA.subVectors(o,r),c=(m-g)/(m-g+(C-A)),e.copy(r).addScaledVector(NA,c);let M=1/(T+O+x);return l=O*M,c=x*M,e.copy(i).addScaledVector(qc,l).addScaledVector(Xc,c)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}},TT={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ha={h:0,s:0,l:0},jg={h:0,s:0,l:0};function xb(n,t,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?n+(t-n)*6*e:e<1/2?t:e<2/3?n+(t-n)*6*(2/3-e):n}var Zt=class{constructor(t,e,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,e,i)}set(t,e,i){if(e===void 0&&i===void 0){let r=t;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(t,e,i);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,e=to){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,yn.colorSpaceToWorking(this,e),this}setRGB(t,e,i,r=yn.workingColorSpace){return this.r=t,this.g=e,this.b=i,yn.colorSpaceToWorking(this,r),this}setHSL(t,e,i,r=yn.workingColorSpace){if(t=iC(t,1),e=on(e,0,1),i=on(i,0,1),e===0)this.r=this.g=this.b=i;else{let o=i<=.5?i*(1+e):i+e-i*e,l=2*i-o;this.r=xb(l,o,t+1/3),this.g=xb(l,o,t),this.b=xb(l,o,t-1/3)}return yn.colorSpaceToWorking(this,r),this}setStyle(t,e=to){function i(o){o!==void 0&&parseFloat(o)<1&&Mt("Color: Alpha component of "+t+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(t)){let o,l=r[1],c=r[2];switch(l){case"rgb":case"rgba":if(o=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return i(o[4]),this.setRGB(Math.min(255,parseInt(o[1],10))/255,Math.min(255,parseInt(o[2],10))/255,Math.min(255,parseInt(o[3],10))/255,e);if(o=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return i(o[4]),this.setRGB(Math.min(100,parseInt(o[1],10))/100,Math.min(100,parseInt(o[2],10))/100,Math.min(100,parseInt(o[3],10))/100,e);break;case"hsl":case"hsla":if(o=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(c))return i(o[4]),this.setHSL(parseFloat(o[1])/360,parseFloat(o[2])/100,parseFloat(o[3])/100,e);break;default:Mt("Color: Unknown color model "+t)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(t)){let o=r[1],l=o.length;if(l===3)return this.setRGB(parseInt(o.charAt(0),16)/15,parseInt(o.charAt(1),16)/15,parseInt(o.charAt(2),16)/15,e);if(l===6)return this.setHex(parseInt(o,16),e);Mt("Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,e);return this}setColorName(t,e=to){let i=TT[t.toLowerCase()];return i!==void 0?this.setHex(i,e):Mt("Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=ta(t.r),this.g=ta(t.g),this.b=ta(t.b),this}copyLinearToSRGB(t){return this.r=td(t.r),this.g=td(t.g),this.b=td(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=to){return yn.workingToColorSpace(nr.copy(this),t),Math.round(on(nr.r*255,0,255))*65536+Math.round(on(nr.g*255,0,255))*256+Math.round(on(nr.b*255,0,255))}getHexString(t=to){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,e=yn.workingColorSpace){yn.workingToColorSpace(nr.copy(this),e);let i=nr.r,r=nr.g,o=nr.b,l=Math.max(i,r,o),c=Math.min(i,r,o),f,p,g=(c+l)/2;if(c===l)f=0,p=0;else{let m=l-c;switch(p=g<=.5?m/(l+c):m/(2-l-c),l){case i:f=(r-o)/m+(r<o?6:0);break;case r:f=(o-i)/m+2;break;case o:f=(i-r)/m+4;break}f/=6}return t.h=f,t.s=p,t.l=g,t}getRGB(t,e=yn.workingColorSpace){return yn.workingToColorSpace(nr.copy(this),e),t.r=nr.r,t.g=nr.g,t.b=nr.b,t}getStyle(t=to){yn.workingToColorSpace(nr.copy(this),t);let e=nr.r,i=nr.g,r=nr.b;return t!==to?`color(${t} ${e.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(e*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(t,e,i){return this.getHSL(Ha),this.setHSL(Ha.h+t,Ha.s+e,Ha.l+i)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this}lerpColors(t,e,i){return this.r=t.r+(e.r-t.r)*i,this.g=t.g+(e.g-t.g)*i,this.b=t.b+(e.b-t.b)*i,this}lerpHSL(t,e){this.getHSL(Ha),t.getHSL(jg);let i=xf(Ha.h,jg.h,e),r=xf(Ha.s,jg.s,e),o=xf(Ha.l,jg.l,e);return this.setHSL(i,r,o),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){let e=this.r,i=this.g,r=this.b,o=t.elements;return this.r=o[0]*e+o[3]*i+o[6]*r,this.g=o[1]*e+o[4]*i+o[7]*r,this.b=o[2]*e+o[5]*i+o[8]*r,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,e=0){return this.r=t[e],this.g=t[e+1],this.b=t[e+2],this}toArray(t=[],e=0){return t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t}fromBufferAttribute(t,e){return this.r=t.getX(e),this.g=t.getY(e),this.b=t.getZ(e),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},nr=new Zt;Zt.NAMES=TT;var X8=0,ia=class extends _s{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:X8++}),this.uuid=gd(),this.name="",this.type="Material",this.blending=au,this.side=na,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=r_,this.blendDst=o_,this.blendEquation=Wa,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Zt(0,0,0),this.blendAlpha=0,this.depthFunc=lu,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Pb,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=su,this.stencilZFail=su,this.stencilZPass=su,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(let e in t){let i=t[e];if(i===void 0){Mt(`Material: parameter '${e}' has value of undefined.`);continue}let r=this[e];if(r===void 0){Mt(`Material: '${e}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[e]=i}}toJSON(t){let e=t===void 0||typeof t=="string";e&&(t={textures:{},images:{}});let i={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(i.sheenColorMap=this.sheenColorMap.toJSON(t).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(i.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(t).uuid),this.dispersion!==void 0&&(i.dispersion=this.dispersion),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapRotation!==void 0&&(i.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==au&&(i.blending=this.blending),this.side!==na&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==r_&&(i.blendSrc=this.blendSrc),this.blendDst!==o_&&(i.blendDst=this.blendDst),this.blendEquation!==Wa&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==lu&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Pb&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==su&&(i.stencilFail=this.stencilFail),this.stencilZFail!==su&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==su&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.allowOverride===!1&&(i.allowOverride=!1),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(o){let l=[];for(let c in o){let f=o[c];delete f.metadata,l.push(f)}return l}if(e){let o=r(t.textures),l=r(t.images);o.length>0&&(i.textures=o),l.length>0&&(i.images=l)}return i}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;let e=t.clippingPlanes,i=null;if(e!==null){let r=e.length;i=new Array(r);for(let o=0;o!==r;++o)i[o]=e[o].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.allowOverride=t.allowOverride,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}},Ya=class extends ia{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Zt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new $a,this.combine=B_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}};var Ii=new ae,Wg=new Ft,Z8=0,no=class{constructor(t,e,i=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:Z8++}),this.name="",this.array=t,this.itemSize=e,this.count=t!==void 0?t.length/e:0,this.normalized=i,this.usage=Ib,this.updateRanges=[],this.gpuType=Xo,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,e){this.updateRanges.push({start:t,count:e})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,e,i){t*=this.itemSize,i*=e.itemSize;for(let r=0,o=this.itemSize;r<o;r++)this.array[t+r]=e.array[i+r];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let e=0,i=this.count;e<i;e++)Wg.fromBufferAttribute(this,e),Wg.applyMatrix3(t),this.setXY(e,Wg.x,Wg.y);else if(this.itemSize===3)for(let e=0,i=this.count;e<i;e++)Ii.fromBufferAttribute(this,e),Ii.applyMatrix3(t),this.setXYZ(e,Ii.x,Ii.y,Ii.z);return this}applyMatrix4(t){for(let e=0,i=this.count;e<i;e++)Ii.fromBufferAttribute(this,e),Ii.applyMatrix4(t),this.setXYZ(e,Ii.x,Ii.y,Ii.z);return this}applyNormalMatrix(t){for(let e=0,i=this.count;e<i;e++)Ii.fromBufferAttribute(this,e),Ii.applyNormalMatrix(t),this.setXYZ(e,Ii.x,Ii.y,Ii.z);return this}transformDirection(t){for(let e=0,i=this.count;e<i;e++)Ii.fromBufferAttribute(this,e),Ii.transformDirection(t),this.setXYZ(e,Ii.x,Ii.y,Ii.z);return this}set(t,e=0){return this.array.set(t,e),this}getComponent(t,e){let i=this.array[t*this.itemSize+e];return this.normalized&&(i=ed(i,this.array)),i}setComponent(t,e,i){return this.normalized&&(i=vr(i,this.array)),this.array[t*this.itemSize+e]=i,this}getX(t){let e=this.array[t*this.itemSize];return this.normalized&&(e=ed(e,this.array)),e}setX(t,e){return this.normalized&&(e=vr(e,this.array)),this.array[t*this.itemSize]=e,this}getY(t){let e=this.array[t*this.itemSize+1];return this.normalized&&(e=ed(e,this.array)),e}setY(t,e){return this.normalized&&(e=vr(e,this.array)),this.array[t*this.itemSize+1]=e,this}getZ(t){let e=this.array[t*this.itemSize+2];return this.normalized&&(e=ed(e,this.array)),e}setZ(t,e){return this.normalized&&(e=vr(e,this.array)),this.array[t*this.itemSize+2]=e,this}getW(t){let e=this.array[t*this.itemSize+3];return this.normalized&&(e=ed(e,this.array)),e}setW(t,e){return this.normalized&&(e=vr(e,this.array)),this.array[t*this.itemSize+3]=e,this}setXY(t,e,i){return t*=this.itemSize,this.normalized&&(e=vr(e,this.array),i=vr(i,this.array)),this.array[t+0]=e,this.array[t+1]=i,this}setXYZ(t,e,i,r){return t*=this.itemSize,this.normalized&&(e=vr(e,this.array),i=vr(i,this.array),r=vr(r,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this}setXYZW(t,e,i,r,o){return t*=this.itemSize,this.normalized&&(e=vr(e,this.array),i=vr(i,this.array),r=vr(r,this.array),o=vr(o,this.array)),this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=r,this.array[t+3]=o,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==Ib&&(t.usage=this.usage),t}};var Mf=class extends no{constructor(t,e,i){super(new Uint16Array(t),e,i)}};var Af=class extends no{constructor(t,e,i){super(new Uint32Array(t),e,i)}};var hi=class extends no{constructor(t,e,i){super(new Float32Array(t),e,i)}},J8=0,Co=new li,bb=new $o,Zc=new ae,eo=new Ga,_f=new Ga,Hi=new ae,Ur=class n extends _s{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:J8++}),this.uuid=gd(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(tC(t)?Af:Mf)(t,1):this.index=t,this}setIndirect(t,e=0){return this.indirect=t,this.indirectOffset=e,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,e){return this.attributes[t]=e,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,e,i=0){this.groups.push({start:t,count:e,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(t,e){this.drawRange.start=t,this.drawRange.count=e}applyMatrix4(t){let e=this.attributes.position;e!==void 0&&(e.applyMatrix4(t),e.needsUpdate=!0);let i=this.attributes.normal;if(i!==void 0){let o=new jt().getNormalMatrix(t);i.applyNormalMatrix(o),i.needsUpdate=!0}let r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return Co.makeRotationFromQuaternion(t),this.applyMatrix4(Co),this}rotateX(t){return Co.makeRotationX(t),this.applyMatrix4(Co),this}rotateY(t){return Co.makeRotationY(t),this.applyMatrix4(Co),this}rotateZ(t){return Co.makeRotationZ(t),this.applyMatrix4(Co),this}translate(t,e,i){return Co.makeTranslation(t,e,i),this.applyMatrix4(Co),this}scale(t,e,i){return Co.makeScale(t,e,i),this.applyMatrix4(Co),this}lookAt(t){return bb.lookAt(t),bb.updateMatrix(),this.applyMatrix4(bb.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Zc).negate(),this.translate(Zc.x,Zc.y,Zc.z),this}setFromPoints(t){let e=this.getAttribute("position");if(e===void 0){let i=[];for(let r=0,o=t.length;r<o;r++){let l=t[r];i.push(l.x,l.y,l.z||0)}this.setAttribute("position",new hi(i,3))}else{let i=Math.min(t.length,e.count);for(let r=0;r<i;r++){let o=t[r];e.setXYZ(r,o.x,o.y,o.z||0)}t.length>e.count&&Mt("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),e.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ga);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){At("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ae(-1/0,-1/0,-1/0),new ae(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),e)for(let i=0,r=e.length;i<r;i++){let o=e[i];eo.setFromBufferAttribute(o),this.morphTargetsRelative?(Hi.addVectors(this.boundingBox.min,eo.min),this.boundingBox.expandByPoint(Hi),Hi.addVectors(this.boundingBox.max,eo.max),this.boundingBox.expandByPoint(Hi)):(this.boundingBox.expandByPoint(eo.min),this.boundingBox.expandByPoint(eo.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&At('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new du);let t=this.attributes.position,e=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){At("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ae,1/0);return}if(t){let i=this.boundingSphere.center;if(eo.setFromBufferAttribute(t),e)for(let o=0,l=e.length;o<l;o++){let c=e[o];_f.setFromBufferAttribute(c),this.morphTargetsRelative?(Hi.addVectors(eo.min,_f.min),eo.expandByPoint(Hi),Hi.addVectors(eo.max,_f.max),eo.expandByPoint(Hi)):(eo.expandByPoint(_f.min),eo.expandByPoint(_f.max))}eo.getCenter(i);let r=0;for(let o=0,l=t.count;o<l;o++)Hi.fromBufferAttribute(t,o),r=Math.max(r,i.distanceToSquared(Hi));if(e)for(let o=0,l=e.length;o<l;o++){let c=e[o],f=this.morphTargetsRelative;for(let p=0,g=c.count;p<g;p++)Hi.fromBufferAttribute(c,p),f&&(Zc.fromBufferAttribute(t,p),Hi.add(Zc)),r=Math.max(r,i.distanceToSquared(Hi))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&At('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let t=this.index,e=this.attributes;if(t===null||e.position===void 0||e.normal===void 0||e.uv===void 0){At("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=e.position,r=e.normal,o=e.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new no(new Float32Array(4*i.count),4));let l=this.getAttribute("tangent"),c=[],f=[];for(let oe=0;oe<i.count;oe++)c[oe]=new ae,f[oe]=new ae;let p=new ae,g=new ae,m=new ae,x=new Ft,C=new Ft,A=new Ft,O=new ae,T=new ae;function M(oe,L,z){p.fromBufferAttribute(i,oe),g.fromBufferAttribute(i,L),m.fromBufferAttribute(i,z),x.fromBufferAttribute(o,oe),C.fromBufferAttribute(o,L),A.fromBufferAttribute(o,z),g.sub(p),m.sub(p),C.sub(x),A.sub(x);let K=1/(C.x*A.y-A.x*C.y);isFinite(K)&&(O.copy(g).multiplyScalar(A.y).addScaledVector(m,-C.y).multiplyScalar(K),T.copy(m).multiplyScalar(C.x).addScaledVector(g,-A.x).multiplyScalar(K),c[oe].add(O),c[L].add(O),c[z].add(O),f[oe].add(T),f[L].add(T),f[z].add(T))}let G=this.groups;G.length===0&&(G=[{start:0,count:t.count}]);for(let oe=0,L=G.length;oe<L;++oe){let z=G[oe],K=z.start,re=z.count;for(let ce=K,we=K+re;ce<we;ce+=3)M(t.getX(ce+0),t.getX(ce+1),t.getX(ce+2))}let Y=new ae,q=new ae,X=new ae,Z=new ae;function J(oe){X.fromBufferAttribute(r,oe),Z.copy(X);let L=c[oe];Y.copy(L),Y.sub(X.multiplyScalar(X.dot(L))).normalize(),q.crossVectors(Z,L);let K=q.dot(f[oe])<0?-1:1;l.setXYZW(oe,Y.x,Y.y,Y.z,K)}for(let oe=0,L=G.length;oe<L;++oe){let z=G[oe],K=z.start,re=z.count;for(let ce=K,we=K+re;ce<we;ce+=3)J(t.getX(ce+0)),J(t.getX(ce+1)),J(t.getX(ce+2))}}computeVertexNormals(){let t=this.index,e=this.getAttribute("position");if(e!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new no(new Float32Array(e.count*3),3),this.setAttribute("normal",i);else for(let x=0,C=i.count;x<C;x++)i.setXYZ(x,0,0,0);let r=new ae,o=new ae,l=new ae,c=new ae,f=new ae,p=new ae,g=new ae,m=new ae;if(t)for(let x=0,C=t.count;x<C;x+=3){let A=t.getX(x+0),O=t.getX(x+1),T=t.getX(x+2);r.fromBufferAttribute(e,A),o.fromBufferAttribute(e,O),l.fromBufferAttribute(e,T),g.subVectors(l,o),m.subVectors(r,o),g.cross(m),c.fromBufferAttribute(i,A),f.fromBufferAttribute(i,O),p.fromBufferAttribute(i,T),c.add(g),f.add(g),p.add(g),i.setXYZ(A,c.x,c.y,c.z),i.setXYZ(O,f.x,f.y,f.z),i.setXYZ(T,p.x,p.y,p.z)}else for(let x=0,C=e.count;x<C;x+=3)r.fromBufferAttribute(e,x+0),o.fromBufferAttribute(e,x+1),l.fromBufferAttribute(e,x+2),g.subVectors(l,o),m.subVectors(r,o),g.cross(m),i.setXYZ(x+0,g.x,g.y,g.z),i.setXYZ(x+1,g.x,g.y,g.z),i.setXYZ(x+2,g.x,g.y,g.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let t=this.attributes.normal;for(let e=0,i=t.count;e<i;e++)Hi.fromBufferAttribute(t,e),Hi.normalize(),t.setXYZ(e,Hi.x,Hi.y,Hi.z)}toNonIndexed(){function t(c,f){let p=c.array,g=c.itemSize,m=c.normalized,x=new p.constructor(f.length*g),C=0,A=0;for(let O=0,T=f.length;O<T;O++){c.isInterleavedBufferAttribute?C=f[O]*c.data.stride+c.offset:C=f[O]*g;for(let M=0;M<g;M++)x[A++]=p[C++]}return new no(x,g,m)}if(this.index===null)return Mt("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let e=new n,i=this.index.array,r=this.attributes;for(let c in r){let f=r[c],p=t(f,i);e.setAttribute(c,p)}let o=this.morphAttributes;for(let c in o){let f=[],p=o[c];for(let g=0,m=p.length;g<m;g++){let x=p[g],C=t(x,i);f.push(C)}e.morphAttributes[c]=f}e.morphTargetsRelative=this.morphTargetsRelative;let l=this.groups;for(let c=0,f=l.length;c<f;c++){let p=l[c];e.addGroup(p.start,p.count,p.materialIndex)}return e}toJSON(){let t={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){let f=this.parameters;for(let p in f)f[p]!==void 0&&(t[p]=f[p]);return t}t.data={attributes:{}};let e=this.index;e!==null&&(t.data.index={type:e.array.constructor.name,array:Array.prototype.slice.call(e.array)});let i=this.attributes;for(let f in i){let p=i[f];t.data.attributes[f]=p.toJSON(t.data)}let r={},o=!1;for(let f in this.morphAttributes){let p=this.morphAttributes[f],g=[];for(let m=0,x=p.length;m<x;m++){let C=p[m];g.push(C.toJSON(t.data))}g.length>0&&(r[f]=g,o=!0)}o&&(t.data.morphAttributes=r,t.data.morphTargetsRelative=this.morphTargetsRelative);let l=this.groups;l.length>0&&(t.data.groups=JSON.parse(JSON.stringify(l)));let c=this.boundingSphere;return c!==null&&(t.data.boundingSphere=c.toJSON()),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let e={};this.name=t.name;let i=t.index;i!==null&&this.setIndex(i.clone());let r=t.attributes;for(let p in r){let g=r[p];this.setAttribute(p,g.clone(e))}let o=t.morphAttributes;for(let p in o){let g=[],m=o[p];for(let x=0,C=m.length;x<C;x++)g.push(m[x].clone(e));this.morphAttributes[p]=g}this.morphTargetsRelative=t.morphTargetsRelative;let l=t.groups;for(let p=0,g=l.length;p<g;p++){let m=l[p];this.addGroup(m.start,m.count,m.materialIndex)}let c=t.boundingBox;c!==null&&(this.boundingBox=c.clone());let f=t.boundingSphere;return f!==null&&(this.boundingSphere=f.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},UA=new li,ru=new fu,Gg=new du,LA=new ae,$g=new ae,Yg=new ae,qg=new ae,Cb=new ae,Xg=new ae,BA=new ae,Zg=new ae,gn=class extends $o{constructor(t=new Ur,e=new Ya){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,i=Object.keys(e);if(i.length>0){let r=e[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=r.length;o<l;o++){let c=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}getVertexPosition(t,e){let i=this.geometry,r=i.attributes.position,o=i.morphAttributes.position,l=i.morphTargetsRelative;e.fromBufferAttribute(r,t);let c=this.morphTargetInfluences;if(o&&c){Xg.set(0,0,0);for(let f=0,p=o.length;f<p;f++){let g=c[f],m=o[f];g!==0&&(Cb.fromBufferAttribute(m,t),l?Xg.addScaledVector(Cb,g):Xg.addScaledVector(Cb.sub(e),g))}e.add(Xg)}return e}raycast(t,e){let i=this.geometry,r=this.material,o=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),Gg.copy(i.boundingSphere),Gg.applyMatrix4(o),ru.copy(t.ray).recast(t.near),!(Gg.containsPoint(ru.origin)===!1&&(ru.intersectSphere(Gg,LA)===null||ru.origin.distanceToSquared(LA)>(t.far-t.near)**2))&&(UA.copy(o).invert(),ru.copy(t.ray).applyMatrix4(UA),!(i.boundingBox!==null&&ru.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(t,e,ru)))}_computeIntersections(t,e,i){let r,o=this.geometry,l=this.material,c=o.index,f=o.attributes.position,p=o.attributes.uv,g=o.attributes.uv1,m=o.attributes.normal,x=o.groups,C=o.drawRange;if(c!==null)if(Array.isArray(l))for(let A=0,O=x.length;A<O;A++){let T=x[A],M=l[T.materialIndex],G=Math.max(T.start,C.start),Y=Math.min(c.count,Math.min(T.start+T.count,C.start+C.count));for(let q=G,X=Y;q<X;q+=3){let Z=c.getX(q),J=c.getX(q+1),oe=c.getX(q+2);r=Jg(this,M,t,i,p,g,m,Z,J,oe),r&&(r.faceIndex=Math.floor(q/3),r.face.materialIndex=T.materialIndex,e.push(r))}}else{let A=Math.max(0,C.start),O=Math.min(c.count,C.start+C.count);for(let T=A,M=O;T<M;T+=3){let G=c.getX(T),Y=c.getX(T+1),q=c.getX(T+2);r=Jg(this,l,t,i,p,g,m,G,Y,q),r&&(r.faceIndex=Math.floor(T/3),e.push(r))}}else if(f!==void 0)if(Array.isArray(l))for(let A=0,O=x.length;A<O;A++){let T=x[A],M=l[T.materialIndex],G=Math.max(T.start,C.start),Y=Math.min(f.count,Math.min(T.start+T.count,C.start+C.count));for(let q=G,X=Y;q<X;q+=3){let Z=q,J=q+1,oe=q+2;r=Jg(this,M,t,i,p,g,m,Z,J,oe),r&&(r.faceIndex=Math.floor(q/3),r.face.materialIndex=T.materialIndex,e.push(r))}}else{let A=Math.max(0,C.start),O=Math.min(f.count,C.start+C.count);for(let T=A,M=O;T<M;T+=3){let G=T,Y=T+1,q=T+2;r=Jg(this,l,t,i,p,g,m,G,Y,q),r&&(r.faceIndex=Math.floor(T/3),e.push(r))}}}};function K8(n,t,e,i,r,o,l,c){let f;if(t.side===yr?f=i.intersectTriangle(l,o,r,!0,c):f=i.intersectTriangle(r,o,l,t.side===na,c),f===null)return null;Zg.copy(c),Zg.applyMatrix4(n.matrixWorld);let p=e.ray.origin.distanceTo(Zg);return p<e.near||p>e.far?null:{distance:p,point:Zg.clone(),object:n}}function Jg(n,t,e,i,r,o,l,c,f,p){n.getVertexPosition(c,$g),n.getVertexPosition(f,Yg),n.getVertexPosition(p,qg);let g=K8(n,t,e,i,$g,Yg,qg,BA);if(g){let m=new ae;ja.getBarycoord(BA,$g,Yg,qg,m),r&&(g.uv=ja.getInterpolatedAttribute(r,c,f,p,m,new Ft)),o&&(g.uv1=ja.getInterpolatedAttribute(o,c,f,p,m,new Ft)),l&&(g.normal=ja.getInterpolatedAttribute(l,c,f,p,m,new ae),g.normal.dot(i.direction)>0&&g.normal.multiplyScalar(-1));let x={a:c,b:f,c:p,normal:new ae,materialIndex:0};ja.getNormal($g,Yg,qg,x.normal),g.face=x,g.barycoord=m}return g}var pi=class n extends Ur{constructor(t=1,e=1,i=1,r=1,o=1,l=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:r,heightSegments:o,depthSegments:l};let c=this;r=Math.floor(r),o=Math.floor(o),l=Math.floor(l);let f=[],p=[],g=[],m=[],x=0,C=0;A("z","y","x",-1,-1,i,e,t,l,o,0),A("z","y","x",1,-1,i,e,-t,l,o,1),A("x","z","y",1,1,t,i,e,r,l,2),A("x","z","y",1,-1,t,i,-e,r,l,3),A("x","y","z",1,-1,t,e,i,r,o,4),A("x","y","z",-1,-1,t,e,-i,r,o,5),this.setIndex(f),this.setAttribute("position",new hi(p,3)),this.setAttribute("normal",new hi(g,3)),this.setAttribute("uv",new hi(m,2));function A(O,T,M,G,Y,q,X,Z,J,oe,L){let z=q/J,K=X/oe,re=q/2,ce=X/2,we=Z/2,Ee=J+1,xe=oe+1,me=0,Me=0,qe=new ae;for(let Be=0;Be<xe;Be++){let Xe=Be*K-ce;for(let Et=0;Et<Ee;Et++){let Re=Et*z-re;qe[O]=Re*G,qe[T]=Xe*Y,qe[M]=we,p.push(qe.x,qe.y,qe.z),qe[O]=0,qe[T]=0,qe[M]=Z>0?1:-1,g.push(qe.x,qe.y,qe.z),m.push(Et/J),m.push(1-Be/oe),me+=1}}for(let Be=0;Be<oe;Be++)for(let Xe=0;Xe<J;Xe++){let Et=x+Xe+Ee*Be,Re=x+Xe+Ee*(Be+1),wn=x+(Xe+1)+Ee*(Be+1),xn=x+(Xe+1)+Ee*Be;f.push(Et,Re,xn),f.push(Re,wn,xn),Me+=6}c.addGroup(C,Me,L),C+=Me,x+=me}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new n(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}};function gu(n){let t={};for(let e in n){t[e]={};for(let i in n[e]){let r=n[e][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(Mt("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[e][i]=null):t[e][i]=r.clone():Array.isArray(r)?t[e][i]=r.slice():t[e][i]=r}}return t}function rr(n){let t={};for(let e=0;e<n.length;e++){let i=gu(n[e]);for(let r in i)t[r]=i[r]}return t}function Q8(n){let t=[];for(let e=0;e<n.length;e++)t.push(n[e].clone());return t}function oC(n){let t=n.getRenderTarget();return t===null?n.outputColorSpace:t.isXRRenderTarget===!0?t.texture.colorSpace:yn.workingColorSpace}var DT={clone:gu,merge:rr},e9=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,t9=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,ro=class extends ia{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=e9,this.fragmentShader=t9,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=gu(t.uniforms),this.uniformsGroups=Q8(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this.defaultAttributeValues=Object.assign({},t.defaultAttributeValues),this.index0AttributeName=t.index0AttributeName,this.uniformsNeedUpdate=t.uniformsNeedUpdate,this}toJSON(t){let e=super.toJSON(t);e.glslVersion=this.glslVersion,e.uniforms={};for(let r in this.uniforms){let l=this.uniforms[r].value;l&&l.isTexture?e.uniforms[r]={type:"t",value:l.toJSON(t).uuid}:l&&l.isColor?e.uniforms[r]={type:"c",value:l.getHex()}:l&&l.isVector2?e.uniforms[r]={type:"v2",value:l.toArray()}:l&&l.isVector3?e.uniforms[r]={type:"v3",value:l.toArray()}:l&&l.isVector4?e.uniforms[r]={type:"v4",value:l.toArray()}:l&&l.isMatrix3?e.uniforms[r]={type:"m3",value:l.toArray()}:l&&l.isMatrix4?e.uniforms[r]={type:"m4",value:l.toArray()}:e.uniforms[r]={value:l}}Object.keys(this.defines).length>0&&(e.defines=this.defines),e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e.lights=this.lights,e.clipping=this.clipping;let i={};for(let r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(e.extensions=i),e}},Tf=class extends $o{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new li,this.projectionMatrix=new li,this.projectionMatrixInverse=new li,this.coordinateSystem=Go,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(t,e){return super.copy(t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,e){super.updateWorldMatrix(t,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},za=new ae,VA=new Ft,HA=new Ft,ir=class extends Tf{constructor(t=50,e=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=e,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){let e=.5*this.getFilmHeight()/t;this.fov=od*2*Math.atan(e),this.updateProjectionMatrix()}getFocalLength(){let t=Math.tan(yf*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return od*2*Math.atan(Math.tan(yf*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,e,i){za.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),e.set(za.x,za.y).multiplyScalar(-t/za.z),za.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(za.x,za.y).multiplyScalar(-t/za.z)}getViewSize(t,e){return this.getViewBounds(t,VA,HA),e.subVectors(HA,VA)}setViewOffset(t,e,i,r,o,l){this.aspect=t/e,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=this.near,e=t*Math.tan(yf*.5*this.fov)/this.zoom,i=2*e,r=this.aspect*i,o=-.5*r,l=this.view;if(this.view!==null&&this.view.enabled){let f=l.fullWidth,p=l.fullHeight;o+=l.offsetX*r/f,e-=l.offsetY*i/p,r*=l.width/f,i*=l.height/p}let c=this.filmOffset;c!==0&&(o+=t*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,e,e-i,t,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}},Jc=-90,Kc=1,d_=class extends $o{constructor(t,e,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;let r=new ir(Jc,Kc,t,e);r.layers=this.layers,this.add(r);let o=new ir(Jc,Kc,t,e);o.layers=this.layers,this.add(o);let l=new ir(Jc,Kc,t,e);l.layers=this.layers,this.add(l);let c=new ir(Jc,Kc,t,e);c.layers=this.layers,this.add(c);let f=new ir(Jc,Kc,t,e);f.layers=this.layers,this.add(f);let p=new ir(Jc,Kc,t,e);p.layers=this.layers,this.add(p)}updateCoordinateSystem(){let t=this.coordinateSystem,e=this.children.concat(),[i,r,o,l,c,f]=e;for(let p of e)this.remove(p);if(t===Go)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),o.up.set(0,0,-1),o.lookAt(0,1,0),l.up.set(0,0,1),l.lookAt(0,-1,0),c.up.set(0,1,0),c.lookAt(0,0,1),f.up.set(0,1,0),f.lookAt(0,0,-1);else if(t===Ef)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),o.up.set(0,0,1),o.lookAt(0,1,0),l.up.set(0,0,-1),l.lookAt(0,-1,0),c.up.set(0,-1,0),c.lookAt(0,0,1),f.up.set(0,-1,0),f.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);for(let p of e)this.add(p),p.updateMatrixWorld()}update(t,e){this.parent===null&&this.updateMatrixWorld();let{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());let[o,l,c,f,p,g]=this.children,m=t.getRenderTarget(),x=t.getActiveCubeFace(),C=t.getActiveMipmapLevel(),A=t.xr.enabled;t.xr.enabled=!1;let O=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,t.setRenderTarget(i,0,r),t.render(e,o),t.setRenderTarget(i,1,r),t.render(e,l),t.setRenderTarget(i,2,r),t.render(e,c),t.setRenderTarget(i,3,r),t.render(e,f),t.setRenderTarget(i,4,r),t.render(e,p),i.texture.generateMipmaps=O,t.setRenderTarget(i,5,r),t.render(e,g),t.setRenderTarget(m,x,C),t.xr.enabled=A,i.texture.needsPMREMUpdate=!0}},Df=class extends Zo{constructor(t=[],e=Qa,i,r,o,l,c,f,p,g){super(t,e,i,r,o,l,c,f,p,g),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}},Pf=class extends io{constructor(t=1,e={}){super(t,t,e),this.isWebGLCubeRenderTarget=!0;let i={width:t,height:t,depth:1},r=[i,i,i,i,i,i];this.texture=new Df(r),this._setTextureOptions(e),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(t,e){this.texture.type=e.type,this.texture.colorSpace=e.colorSpace,this.texture.generateMipmaps=e.generateMipmaps,this.texture.minFilter=e.minFilter,this.texture.magFilter=e.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new pi(5,5,5),o=new ro({name:"CubemapFromEquirect",uniforms:gu(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:yr,blending:ys});o.uniforms.tEquirect.value=e;let l=new gn(r,o),c=e.minFilter;return e.minFilter===el&&(e.minFilter=qi),new d_(1,10,this).update(t,l),e.minFilter=c,l.geometry.dispose(),l.material.dispose(),this}clear(t,e=!0,i=!0,r=!0){let o=t.getRenderTarget();for(let l=0;l<6;l++)t.setRenderTarget(this,l),t.clear(e,i,r);t.setRenderTarget(o)}},wo=class extends $o{constructor(){super(),this.isGroup=!0,this.type="Group"}},n9={type:"move"},ad=class{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new wo,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new wo,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ae,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ae),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new wo,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ae,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ae),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){let e=this._hand;if(e)for(let i of t.hand.values())this._getHandJoint(e,i)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,e,i){let r=null,o=null,l=null,c=this._targetRay,f=this._grip,p=this._hand;if(t&&e.session.visibilityState!=="visible-blurred"){if(p&&t.hand){l=!0;for(let O of t.hand.values()){let T=e.getJointPose(O,i),M=this._getHandJoint(p,O);T!==null&&(M.matrix.fromArray(T.transform.matrix),M.matrix.decompose(M.position,M.rotation,M.scale),M.matrixWorldNeedsUpdate=!0,M.jointRadius=T.radius),M.visible=T!==null}let g=p.joints["index-finger-tip"],m=p.joints["thumb-tip"],x=g.position.distanceTo(m.position),C=.02,A=.005;p.inputState.pinching&&x>C+A?(p.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!p.inputState.pinching&&x<=C-A&&(p.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else f!==null&&t.gripSpace&&(o=e.getPose(t.gripSpace,i),o!==null&&(f.matrix.fromArray(o.transform.matrix),f.matrix.decompose(f.position,f.rotation,f.scale),f.matrixWorldNeedsUpdate=!0,o.linearVelocity?(f.hasLinearVelocity=!0,f.linearVelocity.copy(o.linearVelocity)):f.hasLinearVelocity=!1,o.angularVelocity?(f.hasAngularVelocity=!0,f.angularVelocity.copy(o.angularVelocity)):f.hasAngularVelocity=!1));c!==null&&(r=e.getPose(t.targetRaySpace,i),r===null&&o!==null&&(r=o),r!==null&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,r.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(r.linearVelocity)):c.hasLinearVelocity=!1,r.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(r.angularVelocity)):c.hasAngularVelocity=!1,this.dispatchEvent(n9)))}return c!==null&&(c.visible=r!==null),f!==null&&(f.visible=o!==null),p!==null&&(p.visible=l!==null),this}_getHandJoint(t,e){if(t.joints[e.jointName]===void 0){let i=new wo;i.matrixAutoUpdate=!1,i.visible=!1,t.joints[e.jointName]=i,t.add(i)}return t.joints[e.jointName]}};var If=class extends $o{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new $a,this.environmentIntensity=1,this.environmentRotation=new $a,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,e){return super.copy(t,e),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){let e=super.toJSON(t);return this.fog!==null&&(e.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(e.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(e.object.backgroundIntensity=this.backgroundIntensity),e.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(e.object.environmentIntensity=this.environmentIntensity),e.object.environmentRotation=this.environmentRotation.toArray(),e}};var f_=class extends Zo{constructor(t=null,e=1,i=1,r,o,l,c,f,p=zi,g=zi,m,x){super(null,l,c,f,p,g,r,o,m,x),this.isDataTexture=!0,this.image={data:t,width:e,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}};var Eb=new ae,i9=new ae,r9=new jt,Eo=class{constructor(t=new ae(1,0,0),e=0){this.isPlane=!0,this.normal=t,this.constant=e}set(t,e){return this.normal.copy(t),this.constant=e,this}setComponents(t,e,i,r){return this.normal.set(t,e,i),this.constant=r,this}setFromNormalAndCoplanarPoint(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this}setFromCoplanarPoints(t,e,i){let r=Eb.subVectors(i,e).cross(i9.subVectors(t,e)).normalize();return this.setFromNormalAndCoplanarPoint(r,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){let t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,e){return e.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,e){let i=t.delta(Eb),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(t.start)===0?e.copy(t.start):null;let o=-(t.start.dot(this.normal)+this.constant)/r;return o<0||o>1?null:e.copy(t.start).addScaledVector(i,o)}intersectsLine(t){let e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,e){let i=e||r9.getNormalMatrix(t),r=this.coplanarPoint(Eb).applyMatrix4(t),o=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(o),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}},ou=new du,o9=new Ft(.5,.5),Kg=new ae,ld=class{constructor(t=new Eo,e=new Eo,i=new Eo,r=new Eo,o=new Eo,l=new Eo){this.planes=[t,e,i,r,o,l]}set(t,e,i,r,o,l){let c=this.planes;return c[0].copy(t),c[1].copy(e),c[2].copy(i),c[3].copy(r),c[4].copy(o),c[5].copy(l),this}copy(t){let e=this.planes;for(let i=0;i<6;i++)e[i].copy(t.planes[i]);return this}setFromProjectionMatrix(t,e=Go,i=!1){let r=this.planes,o=t.elements,l=o[0],c=o[1],f=o[2],p=o[3],g=o[4],m=o[5],x=o[6],C=o[7],A=o[8],O=o[9],T=o[10],M=o[11],G=o[12],Y=o[13],q=o[14],X=o[15];if(r[0].setComponents(p-l,C-g,M-A,X-G).normalize(),r[1].setComponents(p+l,C+g,M+A,X+G).normalize(),r[2].setComponents(p+c,C+m,M+O,X+Y).normalize(),r[3].setComponents(p-c,C-m,M-O,X-Y).normalize(),i)r[4].setComponents(f,x,T,q).normalize(),r[5].setComponents(p-f,C-x,M-T,X-q).normalize();else if(r[4].setComponents(p-f,C-x,M-T,X-q).normalize(),e===Go)r[5].setComponents(p+f,C+x,M+T,X+q).normalize();else if(e===Ef)r[5].setComponents(f,x,T,q).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+e);return this}intersectsObject(t){if(t.boundingSphere!==void 0)t.boundingSphere===null&&t.computeBoundingSphere(),ou.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{let e=t.geometry;e.boundingSphere===null&&e.computeBoundingSphere(),ou.copy(e.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(ou)}intersectsSprite(t){ou.center.set(0,0,0);let e=o9.distanceTo(t.center);return ou.radius=.7071067811865476+e,ou.applyMatrix4(t.matrixWorld),this.intersectsSphere(ou)}intersectsSphere(t){let e=this.planes,i=t.center,r=-t.radius;for(let o=0;o<6;o++)if(e[o].distanceToPoint(i)<r)return!1;return!0}intersectsBox(t){let e=this.planes;for(let i=0;i<6;i++){let r=e[i];if(Kg.x=r.normal.x>0?t.max.x:t.min.x,Kg.y=r.normal.y>0?t.max.y:t.min.y,Kg.z=r.normal.z>0?t.max.z:t.min.z,r.distanceToPoint(Kg)<0)return!1}return!0}containsPoint(t){let e=this.planes;for(let i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}};var Of=class extends ia{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Zt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}},h_=new ae,p_=new ae,zA=new li,vf=new fu,Qg=new du,wb=new ae,jA=new ae,m_=class extends $o{constructor(t=new Ur,e=new Of){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=e,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(t,e){return super.copy(t,e),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,i=[0];for(let r=1,o=e.count;r<o;r++)h_.fromBufferAttribute(e,r-1),p_.fromBufferAttribute(e,r),i[r]=i[r-1],i[r]+=h_.distanceTo(p_);t.setAttribute("lineDistance",new hi(i,1))}else Mt("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,e){let i=this.geometry,r=this.matrixWorld,o=t.params.Line.threshold,l=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Qg.copy(i.boundingSphere),Qg.applyMatrix4(r),Qg.radius+=o,t.ray.intersectsSphere(Qg)===!1)return;zA.copy(r).invert(),vf.copy(t.ray).applyMatrix4(zA);let c=o/((this.scale.x+this.scale.y+this.scale.z)/3),f=c*c,p=this.isLineSegments?2:1,g=i.index,x=i.attributes.position;if(g!==null){let C=Math.max(0,l.start),A=Math.min(g.count,l.start+l.count);for(let O=C,T=A-1;O<T;O+=p){let M=g.getX(O),G=g.getX(O+1),Y=e_(this,t,vf,f,M,G,O);Y&&e.push(Y)}if(this.isLineLoop){let O=g.getX(A-1),T=g.getX(C),M=e_(this,t,vf,f,O,T,A-1);M&&e.push(M)}}else{let C=Math.max(0,l.start),A=Math.min(x.count,l.start+l.count);for(let O=C,T=A-1;O<T;O+=p){let M=e_(this,t,vf,f,O,O+1,O);M&&e.push(M)}if(this.isLineLoop){let O=e_(this,t,vf,f,A-1,C,A-1);O&&e.push(O)}}}updateMorphTargets(){let e=this.geometry.morphAttributes,i=Object.keys(e);if(i.length>0){let r=e[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let o=0,l=r.length;o<l;o++){let c=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}};function e_(n,t,e,i,r,o,l){let c=n.geometry.attributes.position;if(h_.fromBufferAttribute(c,r),p_.fromBufferAttribute(c,o),e.distanceSqToSegment(h_,p_,wb,jA)>i)return;wb.applyMatrix4(n.matrixWorld);let p=t.ray.origin.distanceTo(wb);if(!(p<t.near||p>t.far))return{distance:p,point:jA.clone().applyMatrix4(n.matrixWorld),index:l,face:null,faceIndex:null,barycoord:null,object:n}}var WA=new ae,GA=new ae,g_=class extends m_{constructor(t,e){super(t,e),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let t=this.geometry;if(t.index===null){let e=t.attributes.position,i=[];for(let r=0,o=e.count;r<o;r+=2)WA.fromBufferAttribute(e,r),GA.fromBufferAttribute(e,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+WA.distanceTo(GA);t.setAttribute("lineDistance",new hi(i,1))}else Mt("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}};var ud=class extends Zo{constructor(t,e,i,r,o,l,c,f,p){super(t,e,i,r,o,l,c,f,p),this.isCanvasTexture=!0,this.needsUpdate=!0}},qa=class extends Zo{constructor(t,e,i=qo,r,o,l,c=zi,f=zi,p,g=gs,m=1){if(g!==gs&&g!==tl)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");let x={width:t,height:e,depth:m};super(x,r,o,l,c,f,g,i,p),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.source=new sd(Object.assign({},t.image)),this.compareFunction=t.compareFunction,this}toJSON(t){let e=super.toJSON(t);return this.compareFunction!==null&&(e.compareFunction=this.compareFunction),e}},__=class extends qa{constructor(t,e=qo,i=Qa,r,o,l=zi,c=zi,f,p=gs){let g={width:t,height:t,depth:1},m=[g,g,g,g,g,g];super(t,t,e,i,r,o,l,c,f,p),this.image=m,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(t){this.image=t}},Ff=class extends Zo{constructor(t=null){super(),this.sourceTexture=t,this.isExternalTexture=!0}copy(t){return super.copy(t),this.sourceTexture=t.sourceTexture,this}};var cd=class n extends Ur{constructor(t=1,e=1,i=1,r=32,o=1,l=!1,c=0,f=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:r,heightSegments:o,openEnded:l,thetaStart:c,thetaLength:f};let p=this;r=Math.floor(r),o=Math.floor(o);let g=[],m=[],x=[],C=[],A=0,O=[],T=i/2,M=0;G(),l===!1&&(t>0&&Y(!0),e>0&&Y(!1)),this.setIndex(g),this.setAttribute("position",new hi(m,3)),this.setAttribute("normal",new hi(x,3)),this.setAttribute("uv",new hi(C,2));function G(){let q=new ae,X=new ae,Z=0,J=(e-t)/i;for(let oe=0;oe<=o;oe++){let L=[],z=oe/o,K=z*(e-t)+t;for(let re=0;re<=r;re++){let ce=re/r,we=ce*f+c,Ee=Math.sin(we),xe=Math.cos(we);X.x=K*Ee,X.y=-z*i+T,X.z=K*xe,m.push(X.x,X.y,X.z),q.set(Ee,J,xe).normalize(),x.push(q.x,q.y,q.z),C.push(ce,1-z),L.push(A++)}O.push(L)}for(let oe=0;oe<r;oe++)for(let L=0;L<o;L++){let z=O[L][oe],K=O[L+1][oe],re=O[L+1][oe+1],ce=O[L][oe+1];(t>0||L!==0)&&(g.push(z,K,ce),Z+=3),(e>0||L!==o-1)&&(g.push(K,re,ce),Z+=3)}p.addGroup(M,Z,0),M+=Z}function Y(q){let X=A,Z=new Ft,J=new ae,oe=0,L=q===!0?t:e,z=q===!0?1:-1;for(let re=1;re<=r;re++)m.push(0,T*z,0),x.push(0,z,0),C.push(.5,.5),A++;let K=A;for(let re=0;re<=r;re++){let we=re/r*f+c,Ee=Math.cos(we),xe=Math.sin(we);J.x=L*xe,J.y=T*z,J.z=L*Ee,m.push(J.x,J.y,J.z),x.push(0,z,0),Z.x=Ee*.5+.5,Z.y=xe*.5*z+.5,C.push(Z.x,Z.y),A++}for(let re=0;re<r;re++){let ce=X+re,we=K+re;q===!0?g.push(we,we+1,ce):g.push(we+1,we,ce),oe+=3}p.addGroup(M,oe,q===!0?1:2),M+=oe}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new n(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}};var vs=class n extends Ur{constructor(t=1,e=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:r};let o=t/2,l=e/2,c=Math.floor(i),f=Math.floor(r),p=c+1,g=f+1,m=t/c,x=e/f,C=[],A=[],O=[],T=[];for(let M=0;M<g;M++){let G=M*x-l;for(let Y=0;Y<p;Y++){let q=Y*m-o;A.push(q,-G,0),O.push(0,0,1),T.push(Y/c),T.push(1-M/f)}}for(let M=0;M<f;M++)for(let G=0;G<c;G++){let Y=G+p*M,q=G+p*(M+1),X=G+1+p*(M+1),Z=G+1+p*M;C.push(Y,q,Z),C.push(q,X,Z)}this.setIndex(C),this.setAttribute("position",new hi(A,3)),this.setAttribute("normal",new hi(O,3)),this.setAttribute("uv",new hi(T,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new n(t.width,t.height,t.widthSegments,t.heightSegments)}};var Rf=class n extends Ur{constructor(t=1,e=32,i=16,r=0,o=Math.PI*2,l=0,c=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:r,phiLength:o,thetaStart:l,thetaLength:c},e=Math.max(3,Math.floor(e)),i=Math.max(2,Math.floor(i));let f=Math.min(l+c,Math.PI),p=0,g=[],m=new ae,x=new ae,C=[],A=[],O=[],T=[];for(let M=0;M<=i;M++){let G=[],Y=M/i,q=0;M===0&&l===0?q=.5/e:M===i&&f===Math.PI&&(q=-.5/e);for(let X=0;X<=e;X++){let Z=X/e;m.x=-t*Math.cos(r+Z*o)*Math.sin(l+Y*c),m.y=t*Math.cos(l+Y*c),m.z=t*Math.sin(r+Z*o)*Math.sin(l+Y*c),A.push(m.x,m.y,m.z),x.copy(m).normalize(),O.push(x.x,x.y,x.z),T.push(Z+q,1-Y),G.push(p++)}g.push(G)}for(let M=0;M<i;M++)for(let G=0;G<e;G++){let Y=g[M][G+1],q=g[M][G],X=g[M+1][G],Z=g[M+1][G+1];(M!==0||l>0)&&C.push(Y,q,Z),(M!==i-1||f<Math.PI)&&C.push(q,X,Z)}this.setIndex(C),this.setAttribute("position",new hi(A,3)),this.setAttribute("normal",new hi(O,3)),this.setAttribute("uv",new hi(T,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new n(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}};var v_=class extends ro{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}};var ri=class extends ia{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Zt(16777215),this.specular=new Zt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Zt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Qb,this.normalScale=new Ft(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new $a,this.combine=B_,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}};var y_=class extends ia{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=vT,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}},x_=class extends ia{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}};function t_(n,t){return!n||n.constructor===t?n:typeof t.BYTES_PER_ELEMENT=="number"?new t(n):Array.prototype.slice.call(n)}var hu=class{constructor(t,e,i,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new e.constructor(i),this.sampleValues=e,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(t){let e=this.parameterPositions,i=this._cachedIndex,r=e[i],o=e[i-1];n:{e:{let l;t:{i:if(!(t<r)){for(let c=i+2;;){if(r===void 0){if(t<o)break i;return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===c)break;if(o=r,r=e[++i],t<r)break e}l=e.length;break t}if(!(t>=o)){let c=e[1];t<c&&(i=2,o=c);for(let f=i-2;;){if(o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===f)break;if(r=o,o=e[--i-1],t>=o)break e}l=i,i=0;break t}break n}for(;i<l;){let c=i+l>>>1;t<e[c]?l=c:i=c+1}if(r=e[i],o=e[i-1],o===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=e.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,o,r)}return this.interpolate_(i,o,t,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){let e=this.resultBuffer,i=this.sampleValues,r=this.valueSize,o=t*r;for(let l=0;l!==r;++l)e[l]=i[o+l];return e}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}},b_=class extends hu{constructor(t,e,i,r){super(t,e,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ab,endingEnd:Ab}}intervalChanged_(t,e,i){let r=this.parameterPositions,o=t-2,l=t+1,c=r[o],f=r[l];if(c===void 0)switch(this.getSettings_().endingStart){case Tb:o=t,c=2*e-i;break;case Db:o=r.length-2,c=e+r[o]-r[o+1];break;default:o=t,c=i}if(f===void 0)switch(this.getSettings_().endingEnd){case Tb:l=t,f=2*i-e;break;case Db:l=1,f=i+r[1]-r[0];break;default:l=t-1,f=e}let p=(i-e)*.5,g=this.valueSize;this._weightPrev=p/(e-c),this._weightNext=p/(f-i),this._offsetPrev=o*g,this._offsetNext=l*g}interpolate_(t,e,i,r){let o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,f=t*c,p=f-c,g=this._offsetPrev,m=this._offsetNext,x=this._weightPrev,C=this._weightNext,A=(i-e)/(r-e),O=A*A,T=O*A,M=-x*T+2*x*O-x*A,G=(1+x)*T+(-1.5-2*x)*O+(-.5+x)*A+1,Y=(-1-C)*T+(1.5+C)*O+.5*A,q=C*T-C*O;for(let X=0;X!==c;++X)o[X]=M*l[g+X]+G*l[p+X]+Y*l[f+X]+q*l[m+X];return o}},C_=class extends hu{constructor(t,e,i,r){super(t,e,i,r)}interpolate_(t,e,i,r){let o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,f=t*c,p=f-c,g=(i-e)/(r-e),m=1-g;for(let x=0;x!==c;++x)o[x]=l[p+x]*m+l[f+x]*g;return o}},E_=class extends hu{constructor(t,e,i,r){super(t,e,i,r)}interpolate_(t){return this.copySampleValue_(t-1)}},oo=class{constructor(t,e,i,r){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(e===void 0||e.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=t_(e,this.TimeBufferType),this.values=t_(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(t){let e=t.constructor,i;if(e.toJSON!==this.toJSON)i=e.toJSON(t);else{i={name:t.name,times:t_(t.times,Array),values:t_(t.values,Array)};let r=t.getInterpolation();r!==t.DefaultInterpolation&&(i.interpolation=r)}return i.type=t.ValueTypeName,i}InterpolantFactoryMethodDiscrete(t){return new E_(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new C_(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new b_(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let e;switch(t){case bf:e=this.InterpolantFactoryMethodDiscrete;break;case a_:e=this.InterpolantFactoryMethodLinear;break;case n_:e=this.InterpolantFactoryMethodSmooth;break}if(e===void 0){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return Mt("KeyframeTrack:",i),this}return this.createInterpolant=e,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return bf;case this.InterpolantFactoryMethodLinear:return a_;case this.InterpolantFactoryMethodSmooth:return n_}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){let e=this.times;for(let i=0,r=e.length;i!==r;++i)e[i]+=t}return this}scale(t){if(t!==1){let e=this.times;for(let i=0,r=e.length;i!==r;++i)e[i]*=t}return this}trim(t,e){let i=this.times,r=i.length,o=0,l=r-1;for(;o!==r&&i[o]<t;)++o;for(;l!==-1&&i[l]>e;)--l;if(++l,o!==0||l!==r){o>=l&&(l=Math.max(l,1),o=l-1);let c=this.getValueSize();this.times=i.slice(o,l),this.values=this.values.slice(o*c,l*c)}return this}validate(){let t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(At("KeyframeTrack: Invalid value size in track.",this),t=!1);let i=this.times,r=this.values,o=i.length;o===0&&(At("KeyframeTrack: Track is empty.",this),t=!1);let l=null;for(let c=0;c!==o;c++){let f=i[c];if(typeof f=="number"&&isNaN(f)){At("KeyframeTrack: Time is not a valid number.",this,c,f),t=!1;break}if(l!==null&&l>f){At("KeyframeTrack: Out of order keys.",this,c,f,l),t=!1;break}l=f}if(r!==void 0&&C8(r))for(let c=0,f=r.length;c!==f;++c){let p=r[c];if(isNaN(p)){At("KeyframeTrack: Value is not a valid number.",this,c,p),t=!1;break}}return t}optimize(){let t=this.times.slice(),e=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===n_,o=t.length-1,l=1;for(let c=1;c<o;++c){let f=!1,p=t[c],g=t[c+1];if(p!==g&&(c!==1||p!==t[0]))if(r)f=!0;else{let m=c*i,x=m-i,C=m+i;for(let A=0;A!==i;++A){let O=e[m+A];if(O!==e[x+A]||O!==e[C+A]){f=!0;break}}}if(f){if(c!==l){t[l]=t[c];let m=c*i,x=l*i;for(let C=0;C!==i;++C)e[x+C]=e[m+C]}++l}}if(o>0){t[l]=t[o];for(let c=o*i,f=l*i,p=0;p!==i;++p)e[f+p]=e[c+p];++l}return l!==t.length?(this.times=t.slice(0,l),this.values=e.slice(0,l*i)):(this.times=t,this.values=e),this}clone(){let t=this.times.slice(),e=this.values.slice(),i=this.constructor,r=new i(this.name,t,e);return r.createInterpolant=this.createInterpolant,r}};oo.prototype.ValueTypeName="";oo.prototype.TimeBufferType=Float32Array;oo.prototype.ValueBufferType=Float32Array;oo.prototype.DefaultInterpolation=a_;var Xa=class extends oo{constructor(t,e,i){super(t,e,i)}};Xa.prototype.ValueTypeName="bool";Xa.prototype.ValueBufferType=Array;Xa.prototype.DefaultInterpolation=bf;Xa.prototype.InterpolantFactoryMethodLinear=void 0;Xa.prototype.InterpolantFactoryMethodSmooth=void 0;var w_=class extends oo{constructor(t,e,i,r){super(t,e,i,r)}};w_.prototype.ValueTypeName="color";var S_=class extends oo{constructor(t,e,i,r){super(t,e,i,r)}};S_.prototype.ValueTypeName="number";var M_=class extends hu{constructor(t,e,i,r){super(t,e,i,r)}interpolate_(t,e,i,r){let o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,f=(i-e)/(r-e),p=t*c;for(let g=p+c;p!==g;p+=4)So.slerpFlat(o,0,l,p-c,l,p,f);return o}},kf=class extends oo{constructor(t,e,i,r){super(t,e,i,r)}InterpolantFactoryMethodLinear(t){return new M_(this.times,this.values,this.getValueSize(),t)}};kf.prototype.ValueTypeName="quaternion";kf.prototype.InterpolantFactoryMethodSmooth=void 0;var Za=class extends oo{constructor(t,e,i){super(t,e,i)}};Za.prototype.ValueTypeName="string";Za.prototype.ValueBufferType=Array;Za.prototype.DefaultInterpolation=bf;Za.prototype.InterpolantFactoryMethodLinear=void 0;Za.prototype.InterpolantFactoryMethodSmooth=void 0;var A_=class extends oo{constructor(t,e,i,r){super(t,e,i,r)}};A_.prototype.ValueTypeName="vector";var i_={enabled:!1,files:{},add:function(n,t){this.enabled!==!1&&(this.files[n]=t)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}},T_=class{constructor(t,e,i){let r=this,o=!1,l=0,c=0,f,p=[];this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this._abortController=null,this.itemStart=function(g){c++,o===!1&&r.onStart!==void 0&&r.onStart(g,l,c),o=!0},this.itemEnd=function(g){l++,r.onProgress!==void 0&&r.onProgress(g,l,c),l===c&&(o=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(g){r.onError!==void 0&&r.onError(g)},this.resolveURL=function(g){return f?f(g):g},this.setURLModifier=function(g){return f=g,this},this.addHandler=function(g,m){return p.push(g,m),this},this.removeHandler=function(g){let m=p.indexOf(g);return m!==-1&&p.splice(m,2),this},this.getHandler=function(g){for(let m=0,x=p.length;m<x;m+=2){let C=p[m],A=p[m+1];if(C.global&&(C.lastIndex=0),C.test(g))return A}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}},PT=new T_,sC=(()=>{class n{constructor(e){this.manager=e!==void 0?e:PT,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){let r=this;return new Promise(function(o,l){r.load(e,o,i,l)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}return n.DEFAULT_MATERIAL_NAME="__DEFAULT",n})();var Qc=new WeakMap,D_=class extends sC{constructor(t){super(t)}load(t,e,i,r){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);let o=this,l=i_.get(`image:${t}`);if(l!==void 0){if(l.complete===!0)o.manager.itemStart(t),setTimeout(function(){e&&e(l),o.manager.itemEnd(t)},0);else{let m=Qc.get(l);m===void 0&&(m=[],Qc.set(l,m)),m.push({onLoad:e,onError:r})}return l}let c=nd("img");function f(){g(),e&&e(this);let m=Qc.get(this)||[];for(let x=0;x<m.length;x++){let C=m[x];C.onLoad&&C.onLoad(this)}Qc.delete(this),o.manager.itemEnd(t)}function p(m){g(),r&&r(m),i_.remove(`image:${t}`);let x=Qc.get(this)||[];for(let C=0;C<x.length;C++){let A=x[C];A.onError&&A.onError(m)}Qc.delete(this),o.manager.itemError(t),o.manager.itemEnd(t)}function g(){c.removeEventListener("load",f,!1),c.removeEventListener("error",p,!1)}return c.addEventListener("load",f,!1),c.addEventListener("error",p,!1),t.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(c.crossOrigin=this.crossOrigin),i_.add(`image:${t}`,c),o.manager.itemStart(t),c.src=t,c}};var Nf=class extends sC{constructor(t){super(t)}load(t,e,i,r){let o=new Zo,l=new D_(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(t,function(c){o.image=c,o.needsUpdate=!0,e!==void 0&&e(o)},i,r),o}},Uf=class extends $o{constructor(t,e=1){super(),this.isLight=!0,this.type="Light",this.color=new Zt(t),this.intensity=e}dispose(){this.dispatchEvent({type:"dispose"})}copy(t,e){return super.copy(t,e),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){let e=super.toJSON(t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,e}};var Sb=new li,$A=new ae,YA=new ae,Ob=class{constructor(t){this.camera=t,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new Ft(512,512),this.mapType=Lr,this.map=null,this.mapPass=null,this.matrix=new li,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ld,this._frameExtents=new Ft(1,1),this._viewportCount=1,this._viewports=[new ui(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){let e=this.camera,i=this.matrix;$A.setFromMatrixPosition(t.matrixWorld),e.position.copy($A),YA.setFromMatrixPosition(t.target.matrixWorld),e.lookAt(YA),e.updateMatrixWorld(),Sb.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Sb,e.coordinateSystem,e.reversedDepth),e.reversedDepth?i.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(Sb)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.intensity=t.intensity,this.bias=t.bias,this.radius=t.radius,this.autoUpdate=t.autoUpdate,this.needsUpdate=t.needsUpdate,this.normalBias=t.normalBias,this.blurSamples=t.blurSamples,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let t={};return this.intensity!==1&&(t.intensity=this.intensity),this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}};var dd=class extends Tf{constructor(t=-1,e=1,i=1,r=-1,o=.1,l=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=r,this.near=o,this.far=l,this.updateProjectionMatrix()}copy(t,e){return super.copy(t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,e,i,r,o,l){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=r,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2,o=i-t,l=i+t,c=r+e,f=r-e;if(this.view!==null&&this.view.enabled){let p=(this.right-this.left)/this.view.fullWidth/this.zoom,g=(this.top-this.bottom)/this.view.fullHeight/this.zoom;o+=p*this.view.offsetX,l=o+p*this.view.width,c-=g*this.view.offsetY,f=c-g*this.view.height}this.projectionMatrix.makeOrthographic(o,l,c,f,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){let e=super.toJSON(t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=Object.assign({},this.view)),e}},Fb=class extends Ob{constructor(){super(new dd(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},Lf=class extends Uf{constructor(t,e){super(t,e),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy($o.DEFAULT_UP),this.updateMatrix(),this.target=new $o,this.shadow=new Fb}dispose(){super.dispose(),this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}toJSON(t){let e=super.toJSON(t);return e.object.shadow=this.shadow.toJSON(),e.object.target=this.target.uuid,e}},Bf=class extends Uf{constructor(t,e){super(t,e),this.isAmbientLight=!0,this.type="AmbientLight"}};var P_=class extends ir{constructor(t=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=t}};var aC="\\[\\]\\.:\\/",s9=new RegExp("["+aC+"]","g"),lC="[^"+aC+"]",a9="[^"+aC.replace("\\.","")+"]",l9=/((?:WC+[\/:])*)/.source.replace("WC",lC),u9=/(WCOD+)?/.source.replace("WCOD",a9),c9=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",lC),d9=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",lC),f9=new RegExp("^"+l9+u9+c9+d9+"$"),h9=["material","materials","bones","map"],Rb=class{constructor(t,e,i){let r=i||fi.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}getValue(t,e){this.bind();let i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(t,e)}setValue(t,e){let i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,o=i.length;r!==o;++r)i[r].setValue(t,e)}bind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()}unbind(){let t=this._bindings;for(let e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}},fi=(()=>{class n{constructor(e,i,r){this.path=i,this.parsedPath=r||n.parseTrackName(i),this.node=n.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,i,r){return e&&e.isAnimationObjectGroup?new n.Composite(e,i,r):new n(e,i,r)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(s9,"")}static parseTrackName(e){let i=f9.exec(e);if(i===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},o=r.nodeName&&r.nodeName.lastIndexOf(".");if(o!==void 0&&o!==-1){let l=r.nodeName.substring(o+1);h9.indexOf(l)!==-1&&(r.nodeName=r.nodeName.substring(0,o),r.objectName=l)}if(r.propertyName===null||r.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,i){if(i===void 0||i===""||i==="."||i===-1||i===e.name||i===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(i);if(r!==void 0)return r}if(e.children){let r=function(l){for(let c=0;c<l.length;c++){let f=l[c];if(f.name===i||f.uuid===i)return f;let p=r(f.children);if(p)return p}return null},o=r(e.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,i){e[i]=this.targetObject[this.propertyName]}_getValue_array(e,i){let r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)e[i++]=r[o]}_getValue_arrayElement(e,i){e[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,i){this.resolvedProperty.toArray(e,i)}_setValue_direct(e,i){this.targetObject[this.propertyName]=e[i]}_setValue_direct_setNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,i){let r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)r[o]=e[i++]}_setValue_array_setNeedsUpdate(e,i){let r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)r[o]=e[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,i){let r=this.resolvedProperty;for(let o=0,l=r.length;o!==l;++o)r[o]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,i){this.resolvedProperty[this.propertyIndex]=e[i]}_setValue_arrayElement_setNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,i){this.resolvedProperty.fromArray(e,i)}_setValue_fromArray_setNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,i){this.bind(),this.getValue(e,i)}_setValue_unbound(e,i){this.bind(),this.setValue(e,i)}bind(){let e=this.node,i=this.parsedPath,r=i.objectName,o=i.propertyName,l=i.propertyIndex;if(e||(e=n.findNode(this.rootNode,i.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){Mt("PropertyBinding: No target node found for track: "+this.path+".");return}if(r){let g=i.objectIndex;switch(r){case"materials":if(!e.material){At("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){At("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){At("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let m=0;m<e.length;m++)if(e[m].name===g){g=m;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){At("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){At("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[r]===void 0){At("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[r]}if(g!==void 0){if(e[g]===void 0){At("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[g]}}let c=e[o];if(c===void 0){let g=i.nodeName;At("PropertyBinding: Trying to update property for track: "+g+"."+o+" but it wasn't found.",e);return}let f=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?f=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(f=this.Versioning.MatrixWorldNeedsUpdate);let p=this.BindingType.Direct;if(l!==void 0){if(o==="morphTargetInfluences"){if(!e.geometry){At("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){At("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[l]!==void 0&&(l=e.morphTargetDictionary[l])}p=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=l}else c.fromArray!==void 0&&c.toArray!==void 0?(p=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(p=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=o;this.getValue=this.GetterByBindingType[p],this.setValue=this.SetterByBindingTypeAndVersioning[p][f]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return n.Composite=Rb,n})();fi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};fi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};fi.prototype.GetterByBindingType=[fi.prototype._getValue_direct,fi.prototype._getValue_array,fi.prototype._getValue_arrayElement,fi.prototype._getValue_toArray];fi.prototype.SetterByBindingTypeAndVersioning=[[fi.prototype._setValue_direct,fi.prototype._setValue_direct_setNeedsUpdate,fi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[fi.prototype._setValue_array,fi.prototype._setValue_array_setNeedsUpdate,fi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[fi.prototype._setValue_arrayElement,fi.prototype._setValue_arrayElement_setNeedsUpdate,fi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[fi.prototype._setValue_fromArray,fi.prototype._setValue_fromArray_setNeedsUpdate,fi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var $le=new Float32Array(1);var fd=class{constructor(t=1,e=0,i=0){this.radius=t,this.phi=e,this.theta=i}set(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=on(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,e,i){return this.radius=Math.sqrt(t*t+e*e+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos(on(e/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}};var Vf=class extends g_{constructor(t=10,e=10,i=4473924,r=8947848){i=new Zt(i),r=new Zt(r);let o=e/2,l=t/e,c=t/2,f=[],p=[];for(let x=0,C=0,A=-c;x<=e;x++,A+=l){f.push(-c,0,A,c,0,A),f.push(A,0,-c,A,0,c);let O=x===o?i:r;O.toArray(p,C),C+=3,O.toArray(p,C),C+=3,O.toArray(p,C),C+=3,O.toArray(p,C),C+=3}let g=new Ur;g.setAttribute("position",new hi(f,3)),g.setAttribute("color",new hi(p,3));let m=new Of({vertexColors:!0,toneMapped:!1});super(g,m),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}};var Hf=class extends _s{constructor(t,e=null){super(),this.object=t,this.domElement=e,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(t){if(t===void 0){Mt("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=t}disconnect(){}dispose(){}update(){}};function uC(n,t,e,i){let r=p9(i);switch(e){case Zb:return n*t;case Kb:return n*t/r.components*r.byteLength;case $_:return n*t/r.components*r.byteLength;case mu:return n*t*2/r.components*r.byteLength;case Y_:return n*t*2/r.components*r.byteLength;case Jb:return n*t*3/r.components*r.byteLength;case Mo:return n*t*4/r.components*r.byteLength;case q_:return n*t*4/r.components*r.byteLength;case Gf:case $f:return Math.floor((n+3)/4)*Math.floor((t+3)/4)*8;case Yf:case qf:return Math.floor((n+3)/4)*Math.floor((t+3)/4)*16;case Z_:case K_:return Math.max(n,16)*Math.max(t,8)/4;case X_:case J_:return Math.max(n,8)*Math.max(t,8)/2;case Q_:case e1:case n1:case i1:return Math.floor((n+3)/4)*Math.floor((t+3)/4)*8;case t1:case r1:case o1:return Math.floor((n+3)/4)*Math.floor((t+3)/4)*16;case s1:return Math.floor((n+3)/4)*Math.floor((t+3)/4)*16;case a1:return Math.floor((n+4)/5)*Math.floor((t+3)/4)*16;case l1:return Math.floor((n+4)/5)*Math.floor((t+4)/5)*16;case u1:return Math.floor((n+5)/6)*Math.floor((t+4)/5)*16;case c1:return Math.floor((n+5)/6)*Math.floor((t+5)/6)*16;case d1:return Math.floor((n+7)/8)*Math.floor((t+4)/5)*16;case f1:return Math.floor((n+7)/8)*Math.floor((t+5)/6)*16;case h1:return Math.floor((n+7)/8)*Math.floor((t+7)/8)*16;case p1:return Math.floor((n+9)/10)*Math.floor((t+4)/5)*16;case m1:return Math.floor((n+9)/10)*Math.floor((t+5)/6)*16;case g1:return Math.floor((n+9)/10)*Math.floor((t+7)/8)*16;case _1:return Math.floor((n+9)/10)*Math.floor((t+9)/10)*16;case v1:return Math.floor((n+11)/12)*Math.floor((t+9)/10)*16;case y1:return Math.floor((n+11)/12)*Math.floor((t+11)/12)*16;case x1:case b1:case C1:return Math.ceil(n/4)*Math.ceil(t/4)*16;case E1:case w1:return Math.ceil(n/4)*Math.ceil(t/4)*8;case S1:case M1:return Math.ceil(n/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${e} format.`)}function p9(n){switch(n){case Lr:case $b:return{byteLength:1,components:1};case pd:case Yb:case xs:return{byteLength:2,components:1};case W_:case G_:return{byteLength:2,components:4};case qo:case j_:case Xo:return{byteLength:4,components:1};case qb:case Xb:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${n}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:I_}}));typeof window<"u"&&(window.__THREE__?Mt("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=I_);function QT(){let n=null,t=!1,e=null,i=null;function r(o,l){e(o,l),i=n.requestAnimationFrame(r)}return{start:function(){t!==!0&&e!==null&&(i=n.requestAnimationFrame(r),t=!0)},stop:function(){n.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(o){e=o},setContext:function(o){n=o}}}function m9(n){let t=new WeakMap;function e(c,f){let p=c.array,g=c.usage,m=p.byteLength,x=n.createBuffer();n.bindBuffer(f,x),n.bufferData(f,p,g),c.onUploadCallback();let C;if(p instanceof Float32Array)C=n.FLOAT;else if(typeof Float16Array<"u"&&p instanceof Float16Array)C=n.HALF_FLOAT;else if(p instanceof Uint16Array)c.isFloat16BufferAttribute?C=n.HALF_FLOAT:C=n.UNSIGNED_SHORT;else if(p instanceof Int16Array)C=n.SHORT;else if(p instanceof Uint32Array)C=n.UNSIGNED_INT;else if(p instanceof Int32Array)C=n.INT;else if(p instanceof Int8Array)C=n.BYTE;else if(p instanceof Uint8Array)C=n.UNSIGNED_BYTE;else if(p instanceof Uint8ClampedArray)C=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+p);return{buffer:x,type:C,bytesPerElement:p.BYTES_PER_ELEMENT,version:c.version,size:m}}function i(c,f,p){let g=f.array,m=f.updateRanges;if(n.bindBuffer(p,c),m.length===0)n.bufferSubData(p,0,g);else{m.sort((C,A)=>C.start-A.start);let x=0;for(let C=1;C<m.length;C++){let A=m[x],O=m[C];O.start<=A.start+A.count+1?A.count=Math.max(A.count,O.start+O.count-A.start):(++x,m[x]=O)}m.length=x+1;for(let C=0,A=m.length;C<A;C++){let O=m[C];n.bufferSubData(p,O.start*g.BYTES_PER_ELEMENT,g,O.start,O.count)}f.clearUpdateRanges()}f.onUploadCallback()}function r(c){return c.isInterleavedBufferAttribute&&(c=c.data),t.get(c)}function o(c){c.isInterleavedBufferAttribute&&(c=c.data);let f=t.get(c);f&&(n.deleteBuffer(f.buffer),t.delete(c))}function l(c,f){if(c.isInterleavedBufferAttribute&&(c=c.data),c.isGLBufferAttribute){let g=t.get(c);(!g||g.version<c.version)&&t.set(c,{buffer:c.buffer,type:c.type,bytesPerElement:c.elementSize,version:c.version});return}let p=t.get(c);if(p===void 0)t.set(c,e(c,f));else if(p.version<c.version){if(p.size!==c.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");i(p.buffer,c,f),p.version=c.version}}return{get:r,remove:o,update:l}}var g9=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,_9=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,v9=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,y9=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,x9=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,b9=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,C9=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,E9=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,w9=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,S9=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,M9=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,A9=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,T9=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,D9=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,P9=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,I9=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,O9=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,F9=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,R9=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,k9=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,N9=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,U9=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,L9=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,B9=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,V9=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,H9=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,z9=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,j9=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,W9=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,G9=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,$9="gl_FragColor = linearToOutputTexel( gl_FragColor );",Y9=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,q9=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,X9=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,Z9=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,J9=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,K9=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Q9=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,eB=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,tB=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,nB=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,iB=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,rB=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,oB=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,sB=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,aB=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,lB=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,uB=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,cB=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,dB=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,fB=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,hB=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,pB=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,mB=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,gB=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,_B=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,vB=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,yB=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,xB=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,bB=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,CB=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,EB=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,wB=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,SB=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,MB=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,AB=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,TB=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,DB=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,PB=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,IB=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,OB=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,FB=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,RB=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,kB=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,NB=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,UB=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,LB=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,BB=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,VB=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,HB=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,zB=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,jB=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,WB=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,GB=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,$B=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,YB=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,qB=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,XB=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,ZB=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,JB=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,KB=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,QB=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,eV=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,tV=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,nV=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,iV=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,rV=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,oV=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,sV=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,aV=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,lV=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,uV=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,cV=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,dV=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,fV=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,hV=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,pV=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,mV=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,gV=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,_V=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,vV=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,yV=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,xV=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,bV=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,CV=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,EV=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,wV=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,SV=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,MV=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,AV=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,TV=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,DV=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,PV=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,IV=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,OV=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,FV=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,RV=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,kV=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,NV=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,UV=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,LV=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,BV=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,VV=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,HV=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,zV=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,jV=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,WV=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,GV=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,$V=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,YV=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,qV=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Jt={alphahash_fragment:g9,alphahash_pars_fragment:_9,alphamap_fragment:v9,alphamap_pars_fragment:y9,alphatest_fragment:x9,alphatest_pars_fragment:b9,aomap_fragment:C9,aomap_pars_fragment:E9,batching_pars_vertex:w9,batching_vertex:S9,begin_vertex:M9,beginnormal_vertex:A9,bsdfs:T9,iridescence_fragment:D9,bumpmap_pars_fragment:P9,clipping_planes_fragment:I9,clipping_planes_pars_fragment:O9,clipping_planes_pars_vertex:F9,clipping_planes_vertex:R9,color_fragment:k9,color_pars_fragment:N9,color_pars_vertex:U9,color_vertex:L9,common:B9,cube_uv_reflection_fragment:V9,defaultnormal_vertex:H9,displacementmap_pars_vertex:z9,displacementmap_vertex:j9,emissivemap_fragment:W9,emissivemap_pars_fragment:G9,colorspace_fragment:$9,colorspace_pars_fragment:Y9,envmap_fragment:q9,envmap_common_pars_fragment:X9,envmap_pars_fragment:Z9,envmap_pars_vertex:J9,envmap_physical_pars_fragment:lB,envmap_vertex:K9,fog_vertex:Q9,fog_pars_vertex:eB,fog_fragment:tB,fog_pars_fragment:nB,gradientmap_pars_fragment:iB,lightmap_pars_fragment:rB,lights_lambert_fragment:oB,lights_lambert_pars_fragment:sB,lights_pars_begin:aB,lights_toon_fragment:uB,lights_toon_pars_fragment:cB,lights_phong_fragment:dB,lights_phong_pars_fragment:fB,lights_physical_fragment:hB,lights_physical_pars_fragment:pB,lights_fragment_begin:mB,lights_fragment_maps:gB,lights_fragment_end:_B,logdepthbuf_fragment:vB,logdepthbuf_pars_fragment:yB,logdepthbuf_pars_vertex:xB,logdepthbuf_vertex:bB,map_fragment:CB,map_pars_fragment:EB,map_particle_fragment:wB,map_particle_pars_fragment:SB,metalnessmap_fragment:MB,metalnessmap_pars_fragment:AB,morphinstance_vertex:TB,morphcolor_vertex:DB,morphnormal_vertex:PB,morphtarget_pars_vertex:IB,morphtarget_vertex:OB,normal_fragment_begin:FB,normal_fragment_maps:RB,normal_pars_fragment:kB,normal_pars_vertex:NB,normal_vertex:UB,normalmap_pars_fragment:LB,clearcoat_normal_fragment_begin:BB,clearcoat_normal_fragment_maps:VB,clearcoat_pars_fragment:HB,iridescence_pars_fragment:zB,opaque_fragment:jB,packing:WB,premultiplied_alpha_fragment:GB,project_vertex:$B,dithering_fragment:YB,dithering_pars_fragment:qB,roughnessmap_fragment:XB,roughnessmap_pars_fragment:ZB,shadowmap_pars_fragment:JB,shadowmap_pars_vertex:KB,shadowmap_vertex:QB,shadowmask_pars_fragment:eV,skinbase_vertex:tV,skinning_pars_vertex:nV,skinning_vertex:iV,skinnormal_vertex:rV,specularmap_fragment:oV,specularmap_pars_fragment:sV,tonemapping_fragment:aV,tonemapping_pars_fragment:lV,transmission_fragment:uV,transmission_pars_fragment:cV,uv_pars_fragment:dV,uv_pars_vertex:fV,uv_vertex:hV,worldpos_vertex:pV,background_vert:mV,background_frag:gV,backgroundCube_vert:_V,backgroundCube_frag:vV,cube_vert:yV,cube_frag:xV,depth_vert:bV,depth_frag:CV,distance_vert:EV,distance_frag:wV,equirect_vert:SV,equirect_frag:MV,linedashed_vert:AV,linedashed_frag:TV,meshbasic_vert:DV,meshbasic_frag:PV,meshlambert_vert:IV,meshlambert_frag:OV,meshmatcap_vert:FV,meshmatcap_frag:RV,meshnormal_vert:kV,meshnormal_frag:NV,meshphong_vert:UV,meshphong_frag:LV,meshphysical_vert:BV,meshphysical_frag:VV,meshtoon_vert:HV,meshtoon_frag:zV,points_vert:jV,points_frag:WV,shadow_vert:GV,shadow_frag:$V,sprite_vert:YV,sprite_frag:qV},Ke={common:{diffuse:{value:new Zt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new jt},alphaMap:{value:null},alphaMapTransform:{value:new jt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new jt}},envmap:{envMap:{value:null},envMapRotation:{value:new jt},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new jt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new jt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new jt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new jt},normalScale:{value:new Ft(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new jt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new jt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new jt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new jt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Zt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Zt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new jt},alphaTest:{value:0},uvTransform:{value:new jt}},sprite:{diffuse:{value:new Zt(16777215)},opacity:{value:1},center:{value:new Ft(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new jt},alphaMap:{value:null},alphaMapTransform:{value:new jt},alphaTest:{value:0}}},Cs={basic:{uniforms:rr([Ke.common,Ke.specularmap,Ke.envmap,Ke.aomap,Ke.lightmap,Ke.fog]),vertexShader:Jt.meshbasic_vert,fragmentShader:Jt.meshbasic_frag},lambert:{uniforms:rr([Ke.common,Ke.specularmap,Ke.envmap,Ke.aomap,Ke.lightmap,Ke.emissivemap,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,Ke.fog,Ke.lights,{emissive:{value:new Zt(0)}}]),vertexShader:Jt.meshlambert_vert,fragmentShader:Jt.meshlambert_frag},phong:{uniforms:rr([Ke.common,Ke.specularmap,Ke.envmap,Ke.aomap,Ke.lightmap,Ke.emissivemap,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,Ke.fog,Ke.lights,{emissive:{value:new Zt(0)},specular:{value:new Zt(1118481)},shininess:{value:30}}]),vertexShader:Jt.meshphong_vert,fragmentShader:Jt.meshphong_frag},standard:{uniforms:rr([Ke.common,Ke.envmap,Ke.aomap,Ke.lightmap,Ke.emissivemap,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,Ke.roughnessmap,Ke.metalnessmap,Ke.fog,Ke.lights,{emissive:{value:new Zt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Jt.meshphysical_vert,fragmentShader:Jt.meshphysical_frag},toon:{uniforms:rr([Ke.common,Ke.aomap,Ke.lightmap,Ke.emissivemap,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,Ke.gradientmap,Ke.fog,Ke.lights,{emissive:{value:new Zt(0)}}]),vertexShader:Jt.meshtoon_vert,fragmentShader:Jt.meshtoon_frag},matcap:{uniforms:rr([Ke.common,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,Ke.fog,{matcap:{value:null}}]),vertexShader:Jt.meshmatcap_vert,fragmentShader:Jt.meshmatcap_frag},points:{uniforms:rr([Ke.points,Ke.fog]),vertexShader:Jt.points_vert,fragmentShader:Jt.points_frag},dashed:{uniforms:rr([Ke.common,Ke.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Jt.linedashed_vert,fragmentShader:Jt.linedashed_frag},depth:{uniforms:rr([Ke.common,Ke.displacementmap]),vertexShader:Jt.depth_vert,fragmentShader:Jt.depth_frag},normal:{uniforms:rr([Ke.common,Ke.bumpmap,Ke.normalmap,Ke.displacementmap,{opacity:{value:1}}]),vertexShader:Jt.meshnormal_vert,fragmentShader:Jt.meshnormal_frag},sprite:{uniforms:rr([Ke.sprite,Ke.fog]),vertexShader:Jt.sprite_vert,fragmentShader:Jt.sprite_frag},background:{uniforms:{uvTransform:{value:new jt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Jt.background_vert,fragmentShader:Jt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new jt}},vertexShader:Jt.backgroundCube_vert,fragmentShader:Jt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Jt.cube_vert,fragmentShader:Jt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Jt.equirect_vert,fragmentShader:Jt.equirect_frag},distance:{uniforms:rr([Ke.common,Ke.displacementmap,{referencePosition:{value:new ae},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Jt.distance_vert,fragmentShader:Jt.distance_frag},shadow:{uniforms:rr([Ke.lights,Ke.fog,{color:{value:new Zt(0)},opacity:{value:1}}]),vertexShader:Jt.shadow_vert,fragmentShader:Jt.shadow_frag}};Cs.physical={uniforms:rr([Cs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new jt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new jt},clearcoatNormalScale:{value:new Ft(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new jt},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new jt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new jt},sheen:{value:0},sheenColor:{value:new Zt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new jt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new jt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new jt},transmissionSamplerSize:{value:new Ft},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new jt},attenuationDistance:{value:0},attenuationColor:{value:new Zt(0)},specularColor:{value:new Zt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new jt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new jt},anisotropyVector:{value:new Ft},anisotropyMap:{value:null},anisotropyMapTransform:{value:new jt}}]),vertexShader:Jt.meshphysical_vert,fragmentShader:Jt.meshphysical_frag};var D1={r:0,b:0,g:0},_u=new $a,XV=new li;function ZV(n,t,e,i,r,o,l){let c=new Zt(0),f=o===!0?0:1,p,g,m=null,x=0,C=null;function A(Y){let q=Y.isScene===!0?Y.background:null;return q&&q.isTexture&&(q=(Y.backgroundBlurriness>0?e:t).get(q)),q}function O(Y){let q=!1,X=A(Y);X===null?M(c,f):X&&X.isColor&&(M(X,1),q=!0);let Z=n.xr.getEnvironmentBlendMode();Z==="additive"?i.buffers.color.setClear(0,0,0,1,l):Z==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,l),(n.autoClear||q)&&(i.buffers.depth.setTest(!0),i.buffers.depth.setMask(!0),i.buffers.color.setMask(!0),n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil))}function T(Y,q){let X=A(q);X&&(X.isCubeTexture||X.mapping===jf)?(g===void 0&&(g=new gn(new pi(1,1,1),new ro({name:"BackgroundCubeMaterial",uniforms:gu(Cs.backgroundCube.uniforms),vertexShader:Cs.backgroundCube.vertexShader,fragmentShader:Cs.backgroundCube.fragmentShader,side:yr,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),g.geometry.deleteAttribute("normal"),g.geometry.deleteAttribute("uv"),g.onBeforeRender=function(Z,J,oe){this.matrixWorld.copyPosition(oe.matrixWorld)},Object.defineProperty(g.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(g)),_u.copy(q.backgroundRotation),_u.x*=-1,_u.y*=-1,_u.z*=-1,X.isCubeTexture&&X.isRenderTargetTexture===!1&&(_u.y*=-1,_u.z*=-1),g.material.uniforms.envMap.value=X,g.material.uniforms.flipEnvMap.value=X.isCubeTexture&&X.isRenderTargetTexture===!1?-1:1,g.material.uniforms.backgroundBlurriness.value=q.backgroundBlurriness,g.material.uniforms.backgroundIntensity.value=q.backgroundIntensity,g.material.uniforms.backgroundRotation.value.setFromMatrix4(XV.makeRotationFromEuler(_u)),g.material.toneMapped=yn.getTransfer(X.colorSpace)!==Pn,(m!==X||x!==X.version||C!==n.toneMapping)&&(g.material.needsUpdate=!0,m=X,x=X.version,C=n.toneMapping),g.layers.enableAll(),Y.unshift(g,g.geometry,g.material,0,0,null)):X&&X.isTexture&&(p===void 0&&(p=new gn(new vs(2,2),new ro({name:"BackgroundMaterial",uniforms:gu(Cs.background.uniforms),vertexShader:Cs.background.vertexShader,fragmentShader:Cs.background.fragmentShader,side:na,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(p)),p.material.uniforms.t2D.value=X,p.material.uniforms.backgroundIntensity.value=q.backgroundIntensity,p.material.toneMapped=yn.getTransfer(X.colorSpace)!==Pn,X.matrixAutoUpdate===!0&&X.updateMatrix(),p.material.uniforms.uvTransform.value.copy(X.matrix),(m!==X||x!==X.version||C!==n.toneMapping)&&(p.material.needsUpdate=!0,m=X,x=X.version,C=n.toneMapping),p.layers.enableAll(),Y.unshift(p,p.geometry,p.material,0,0,null))}function M(Y,q){Y.getRGB(D1,oC(n)),i.buffers.color.setClear(D1.r,D1.g,D1.b,q,l)}function G(){g!==void 0&&(g.geometry.dispose(),g.material.dispose(),g=void 0),p!==void 0&&(p.geometry.dispose(),p.material.dispose(),p=void 0)}return{getClearColor:function(){return c},setClearColor:function(Y,q=1){c.set(Y),f=q,M(c,f)},getClearAlpha:function(){return f},setClearAlpha:function(Y){f=Y,M(c,f)},render:O,addToRenderList:T,dispose:G}}function JV(n,t){let e=n.getParameter(n.MAX_VERTEX_ATTRIBS),i={},r=x(null),o=r,l=!1;function c(z,K,re,ce,we){let Ee=!1,xe=m(ce,re,K);o!==xe&&(o=xe,p(o.object)),Ee=C(z,ce,re,we),Ee&&A(z,ce,re,we),we!==null&&t.update(we,n.ELEMENT_ARRAY_BUFFER),(Ee||l)&&(l=!1,q(z,K,re,ce),we!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(we).buffer))}function f(){return n.createVertexArray()}function p(z){return n.bindVertexArray(z)}function g(z){return n.deleteVertexArray(z)}function m(z,K,re){let ce=re.wireframe===!0,we=i[z.id];we===void 0&&(we={},i[z.id]=we);let Ee=we[K.id];Ee===void 0&&(Ee={},we[K.id]=Ee);let xe=Ee[ce];return xe===void 0&&(xe=x(f()),Ee[ce]=xe),xe}function x(z){let K=[],re=[],ce=[];for(let we=0;we<e;we++)K[we]=0,re[we]=0,ce[we]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:K,enabledAttributes:re,attributeDivisors:ce,object:z,attributes:{},index:null}}function C(z,K,re,ce){let we=o.attributes,Ee=K.attributes,xe=0,me=re.getAttributes();for(let Me in me)if(me[Me].location>=0){let Be=we[Me],Xe=Ee[Me];if(Xe===void 0&&(Me==="instanceMatrix"&&z.instanceMatrix&&(Xe=z.instanceMatrix),Me==="instanceColor"&&z.instanceColor&&(Xe=z.instanceColor)),Be===void 0||Be.attribute!==Xe||Xe&&Be.data!==Xe.data)return!0;xe++}return o.attributesNum!==xe||o.index!==ce}function A(z,K,re,ce){let we={},Ee=K.attributes,xe=0,me=re.getAttributes();for(let Me in me)if(me[Me].location>=0){let Be=Ee[Me];Be===void 0&&(Me==="instanceMatrix"&&z.instanceMatrix&&(Be=z.instanceMatrix),Me==="instanceColor"&&z.instanceColor&&(Be=z.instanceColor));let Xe={};Xe.attribute=Be,Be&&Be.data&&(Xe.data=Be.data),we[Me]=Xe,xe++}o.attributes=we,o.attributesNum=xe,o.index=ce}function O(){let z=o.newAttributes;for(let K=0,re=z.length;K<re;K++)z[K]=0}function T(z){M(z,0)}function M(z,K){let re=o.newAttributes,ce=o.enabledAttributes,we=o.attributeDivisors;re[z]=1,ce[z]===0&&(n.enableVertexAttribArray(z),ce[z]=1),we[z]!==K&&(n.vertexAttribDivisor(z,K),we[z]=K)}function G(){let z=o.newAttributes,K=o.enabledAttributes;for(let re=0,ce=K.length;re<ce;re++)K[re]!==z[re]&&(n.disableVertexAttribArray(re),K[re]=0)}function Y(z,K,re,ce,we,Ee,xe){xe===!0?n.vertexAttribIPointer(z,K,re,we,Ee):n.vertexAttribPointer(z,K,re,ce,we,Ee)}function q(z,K,re,ce){O();let we=ce.attributes,Ee=re.getAttributes(),xe=K.defaultAttributeValues;for(let me in Ee){let Me=Ee[me];if(Me.location>=0){let qe=we[me];if(qe===void 0&&(me==="instanceMatrix"&&z.instanceMatrix&&(qe=z.instanceMatrix),me==="instanceColor"&&z.instanceColor&&(qe=z.instanceColor)),qe!==void 0){let Be=qe.normalized,Xe=qe.itemSize,Et=t.get(qe);if(Et===void 0)continue;let Re=Et.buffer,wn=Et.type,xn=Et.bytesPerElement,Se=wn===n.INT||wn===n.UNSIGNED_INT||qe.gpuType===j_;if(qe.isInterleavedBufferAttribute){let De=qe.data,rt=De.stride,Pt=qe.offset;if(De.isInstancedInterleavedBuffer){for(let ft=0;ft<Me.locationSize;ft++)M(Me.location+ft,De.meshPerAttribute);z.isInstancedMesh!==!0&&ce._maxInstanceCount===void 0&&(ce._maxInstanceCount=De.meshPerAttribute*De.count)}else for(let ft=0;ft<Me.locationSize;ft++)T(Me.location+ft);n.bindBuffer(n.ARRAY_BUFFER,Re);for(let ft=0;ft<Me.locationSize;ft++)Y(Me.location+ft,Xe/Me.locationSize,wn,Be,rt*xn,(Pt+Xe/Me.locationSize*ft)*xn,Se)}else{if(qe.isInstancedBufferAttribute){for(let De=0;De<Me.locationSize;De++)M(Me.location+De,qe.meshPerAttribute);z.isInstancedMesh!==!0&&ce._maxInstanceCount===void 0&&(ce._maxInstanceCount=qe.meshPerAttribute*qe.count)}else for(let De=0;De<Me.locationSize;De++)T(Me.location+De);n.bindBuffer(n.ARRAY_BUFFER,Re);for(let De=0;De<Me.locationSize;De++)Y(Me.location+De,Xe/Me.locationSize,wn,Be,Xe*xn,Xe/Me.locationSize*De*xn,Se)}}else if(xe!==void 0){let Be=xe[me];if(Be!==void 0)switch(Be.length){case 2:n.vertexAttrib2fv(Me.location,Be);break;case 3:n.vertexAttrib3fv(Me.location,Be);break;case 4:n.vertexAttrib4fv(Me.location,Be);break;default:n.vertexAttrib1fv(Me.location,Be)}}}}G()}function X(){oe();for(let z in i){let K=i[z];for(let re in K){let ce=K[re];for(let we in ce)g(ce[we].object),delete ce[we];delete K[re]}delete i[z]}}function Z(z){if(i[z.id]===void 0)return;let K=i[z.id];for(let re in K){let ce=K[re];for(let we in ce)g(ce[we].object),delete ce[we];delete K[re]}delete i[z.id]}function J(z){for(let K in i){let re=i[K];if(re[z.id]===void 0)continue;let ce=re[z.id];for(let we in ce)g(ce[we].object),delete ce[we];delete re[z.id]}}function oe(){L(),l=!0,o!==r&&(o=r,p(o.object))}function L(){r.geometry=null,r.program=null,r.wireframe=!1}return{setup:c,reset:oe,resetDefaultState:L,dispose:X,releaseStatesOfGeometry:Z,releaseStatesOfProgram:J,initAttributes:O,enableAttribute:T,disableUnusedAttributes:G}}function KV(n,t,e){let i;function r(p){i=p}function o(p,g){n.drawArrays(i,p,g),e.update(g,i,1)}function l(p,g,m){m!==0&&(n.drawArraysInstanced(i,p,g,m),e.update(g,i,m))}function c(p,g,m){if(m===0)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(i,p,0,g,0,m);let C=0;for(let A=0;A<m;A++)C+=g[A];e.update(C,i,1)}function f(p,g,m,x){if(m===0)return;let C=t.get("WEBGL_multi_draw");if(C===null)for(let A=0;A<p.length;A++)l(p[A],g[A],x[A]);else{C.multiDrawArraysInstancedWEBGL(i,p,0,g,0,x,0,m);let A=0;for(let O=0;O<m;O++)A+=g[O]*x[O];e.update(A,i,1)}}this.setMode=r,this.render=o,this.renderInstances=l,this.renderMultiDraw=c,this.renderMultiDrawInstances=f}function QV(n,t,e,i){let r;function o(){if(r!==void 0)return r;if(t.has("EXT_texture_filter_anisotropic")===!0){let J=t.get("EXT_texture_filter_anisotropic");r=n.getParameter(J.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r}function l(J){return!(J!==Mo&&i.convert(J)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_FORMAT))}function c(J){let oe=J===xs&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(J!==Lr&&i.convert(J)!==n.getParameter(n.IMPLEMENTATION_COLOR_READ_TYPE)&&J!==Xo&&!oe)}function f(J){if(J==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";J="mediump"}return J==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let p=e.precision!==void 0?e.precision:"highp",g=f(p);g!==p&&(Mt("WebGLRenderer:",p,"not supported, using",g,"instead."),p=g);let m=e.logarithmicDepthBuffer===!0,x=e.reversedDepthBuffer===!0&&t.has("EXT_clip_control"),C=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),A=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),O=n.getParameter(n.MAX_TEXTURE_SIZE),T=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),M=n.getParameter(n.MAX_VERTEX_ATTRIBS),G=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),Y=n.getParameter(n.MAX_VARYING_VECTORS),q=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),X=n.getParameter(n.MAX_SAMPLES),Z=n.getParameter(n.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:o,getMaxPrecision:f,textureFormatReadable:l,textureTypeReadable:c,precision:p,logarithmicDepthBuffer:m,reversedDepthBuffer:x,maxTextures:C,maxVertexTextures:A,maxTextureSize:O,maxCubemapSize:T,maxAttributes:M,maxVertexUniforms:G,maxVaryings:Y,maxFragmentUniforms:q,maxSamples:X,samples:Z}}function eH(n){let t=this,e=null,i=0,r=!1,o=!1,l=new Eo,c=new jt,f={value:null,needsUpdate:!1};this.uniform=f,this.numPlanes=0,this.numIntersection=0,this.init=function(m,x){let C=m.length!==0||x||i!==0||r;return r=x,i=m.length,C},this.beginShadows=function(){o=!0,g(null)},this.endShadows=function(){o=!1},this.setGlobalState=function(m,x){e=g(m,x,0)},this.setState=function(m,x,C){let A=m.clippingPlanes,O=m.clipIntersection,T=m.clipShadows,M=n.get(m);if(!r||A===null||A.length===0||o&&!T)o?g(null):p();else{let G=o?0:i,Y=G*4,q=M.clippingState||null;f.value=q,q=g(A,x,Y,C);for(let X=0;X!==Y;++X)q[X]=e[X];M.clippingState=q,this.numIntersection=O?this.numPlanes:0,this.numPlanes+=G}};function p(){f.value!==e&&(f.value=e,f.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function g(m,x,C,A){let O=m!==null?m.length:0,T=null;if(O!==0){if(T=f.value,A!==!0||T===null){let M=C+O*4,G=x.matrixWorldInverse;c.getNormalMatrix(G),(T===null||T.length<M)&&(T=new Float32Array(M));for(let Y=0,q=C;Y!==O;++Y,q+=4)l.copy(m[Y]).applyMatrix4(G,c),l.normal.toArray(T,q),T[q+3]=l.constant}f.value=T,f.needsUpdate=!0}return t.numPlanes=O,t.numIntersection=0,T}}function tH(n){let t=new WeakMap;function e(l,c){return c===V_?l.mapping=Qa:c===H_&&(l.mapping=pu),l}function i(l){if(l&&l.isTexture){let c=l.mapping;if(c===V_||c===H_)if(t.has(l)){let f=t.get(l).texture;return e(f,l.mapping)}else{let f=l.image;if(f&&f.height>0){let p=new Pf(f.height);return p.fromEquirectangularTexture(n,l),t.set(l,p),l.addEventListener("dispose",r),e(p.texture,l.mapping)}else return null}}return l}function r(l){let c=l.target;c.removeEventListener("dispose",r);let f=t.get(c);f!==void 0&&(t.delete(c),f.dispose())}function o(){t=new WeakMap}return{get:i,dispose:o}}var nl=4,IT=[.125,.215,.35,.446,.526,.582],yu=20,nH=256,Xf=new dd,OT=new Zt,cC=null,dC=0,fC=0,hC=!1,iH=new ae,I1=class{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(t,e=0,i=.1,r=100,o={}){let{size:l=256,position:c=iH}=o;cC=this._renderer.getRenderTarget(),dC=this._renderer.getActiveCubeFace(),fC=this._renderer.getActiveMipmapLevel(),hC=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(l);let f=this._allocateTargets();return f.depthBuffer=!0,this._sceneToCubeUV(t,i,r,f,c),e>0&&this._blur(f,0,0,e),this._applyPMREM(f),this._cleanup(f),f}fromEquirectangular(t,e=null){return this._fromTexture(t,e)}fromCubemap(t,e=null){return this._fromTexture(t,e)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=kT(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=RT(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodMeshes.length;t++)this._lodMeshes[t].geometry.dispose()}_cleanup(t){this._renderer.setRenderTarget(cC,dC,fC),this._renderer.xr.enabled=hC,t.scissorTest=!1,_d(t,0,0,t.width,t.height)}_fromTexture(t,e){t.mapping===Qa||t.mapping===pu?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),cC=this._renderer.getRenderTarget(),dC=this._renderer.getActiveCubeFace(),fC=this._renderer.getActiveMipmapLevel(),hC=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;let i=e||this._allocateTargets();return this._textureToCubeUV(t,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let t=3*Math.max(this._cubeSize,112),e=4*this._cubeSize,i={magFilter:qi,minFilter:qi,generateMipmaps:!1,type:xs,format:Mo,colorSpace:cu,depthBuffer:!1},r=FT(t,e,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==e){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=FT(t,e,i);let{_lodMax:o}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=rH(o)),this._blurMaterial=sH(o,t,e),this._ggxMaterial=oH(o,t,e)}return r}_compileMaterial(t){let e=new gn(new Ur,t);this._renderer.compile(e,Xf)}_sceneToCubeUV(t,e,i,r,o){let f=new ir(90,1,e,i),p=[1,-1,1,1,1,1],g=[1,1,1,-1,-1,-1],m=this._renderer,x=m.autoClear,C=m.toneMapping;m.getClearColor(OT),m.toneMapping=Yo,m.autoClear=!1,m.state.buffers.depth.getReversed()&&(m.setRenderTarget(r),m.clearDepth(),m.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new gn(new pi,new Ya({name:"PMREM.Background",side:yr,depthWrite:!1,depthTest:!1})));let O=this._backgroundBox,T=O.material,M=!1,G=t.background;G?G.isColor&&(T.color.copy(G),t.background=null,M=!0):(T.color.copy(OT),M=!0);for(let Y=0;Y<6;Y++){let q=Y%3;q===0?(f.up.set(0,p[Y],0),f.position.set(o.x,o.y,o.z),f.lookAt(o.x+g[Y],o.y,o.z)):q===1?(f.up.set(0,0,p[Y]),f.position.set(o.x,o.y,o.z),f.lookAt(o.x,o.y+g[Y],o.z)):(f.up.set(0,p[Y],0),f.position.set(o.x,o.y,o.z),f.lookAt(o.x,o.y,o.z+g[Y]));let X=this._cubeSize;_d(r,q*X,Y>2?X:0,X,X),m.setRenderTarget(r),M&&m.render(O,f),m.render(t,f)}m.toneMapping=C,m.autoClear=x,t.background=G}_textureToCubeUV(t,e){let i=this._renderer,r=t.mapping===Qa||t.mapping===pu;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=kT()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=RT());let o=r?this._cubemapMaterial:this._equirectMaterial,l=this._lodMeshes[0];l.material=o;let c=o.uniforms;c.envMap.value=t;let f=this._cubeSize;_d(e,0,0,3*f,2*f),i.setRenderTarget(e),i.render(l,Xf)}_applyPMREM(t){let e=this._renderer,i=e.autoClear;e.autoClear=!1;let r=this._lodMeshes.length;for(let o=1;o<r;o++)this._applyGGXFilter(t,o-1,o);e.autoClear=i}_applyGGXFilter(t,e,i){let r=this._renderer,o=this._pingPongRenderTarget,l=this._ggxMaterial,c=this._lodMeshes[i];c.material=l;let f=l.uniforms,p=i/(this._lodMeshes.length-1),g=e/(this._lodMeshes.length-1),m=Math.sqrt(p*p-g*g),x=0+p*1.25,C=m*x,{_lodMax:A}=this,O=this._sizeLods[i],T=3*O*(i>A-nl?i-A+nl:0),M=4*(this._cubeSize-O);f.envMap.value=t.texture,f.roughness.value=C,f.mipInt.value=A-e,_d(o,T,M,3*O,2*O),r.setRenderTarget(o),r.render(c,Xf),f.envMap.value=o.texture,f.roughness.value=0,f.mipInt.value=A-i,_d(t,T,M,3*O,2*O),r.setRenderTarget(t),r.render(c,Xf)}_blur(t,e,i,r,o){let l=this._pingPongRenderTarget;this._halfBlur(t,l,e,i,r,"latitudinal",o),this._halfBlur(l,t,i,i,r,"longitudinal",o)}_halfBlur(t,e,i,r,o,l,c){let f=this._renderer,p=this._blurMaterial;l!=="latitudinal"&&l!=="longitudinal"&&At("blur direction must be either latitudinal or longitudinal!");let g=3,m=this._lodMeshes[r];m.material=p;let x=p.uniforms,C=this._sizeLods[i]-1,A=isFinite(o)?Math.PI/(2*C):2*Math.PI/(2*yu-1),O=o/A,T=isFinite(o)?1+Math.floor(g*O):yu;T>yu&&Mt(`sigmaRadians, ${o}, is too large and will clip, as it requested ${T} samples when the maximum is set to ${yu}`);let M=[],G=0;for(let J=0;J<yu;++J){let oe=J/O,L=Math.exp(-oe*oe/2);M.push(L),J===0?G+=L:J<T&&(G+=2*L)}for(let J=0;J<M.length;J++)M[J]=M[J]/G;x.envMap.value=t.texture,x.samples.value=T,x.weights.value=M,x.latitudinal.value=l==="latitudinal",c&&(x.poleAxis.value=c);let{_lodMax:Y}=this;x.dTheta.value=A,x.mipInt.value=Y-i;let q=this._sizeLods[r],X=3*q*(r>Y-nl?r-Y+nl:0),Z=4*(this._cubeSize-q);_d(e,X,Z,3*q,2*q),f.setRenderTarget(e),f.render(m,Xf)}};function rH(n){let t=[],e=[],i=[],r=n,o=n-nl+1+IT.length;for(let l=0;l<o;l++){let c=Math.pow(2,r);t.push(c);let f=1/c;l>n-nl?f=IT[l-n+nl-1]:l===0&&(f=0),e.push(f);let p=1/(c-2),g=-p,m=1+p,x=[g,g,m,g,m,m,g,g,m,m,g,m],C=6,A=6,O=3,T=2,M=1,G=new Float32Array(O*A*C),Y=new Float32Array(T*A*C),q=new Float32Array(M*A*C);for(let Z=0;Z<C;Z++){let J=Z%3*2/3-1,oe=Z>2?0:-1,L=[J,oe,0,J+2/3,oe,0,J+2/3,oe+1,0,J,oe,0,J+2/3,oe+1,0,J,oe+1,0];G.set(L,O*A*Z),Y.set(x,T*A*Z);let z=[Z,Z,Z,Z,Z,Z];q.set(z,M*A*Z)}let X=new Ur;X.setAttribute("position",new no(G,O)),X.setAttribute("uv",new no(Y,T)),X.setAttribute("faceIndex",new no(q,M)),i.push(new gn(X,null)),r>nl&&r--}return{lodMeshes:i,sizeLods:t,sigmas:e}}function FT(n,t,e){let i=new io(n,t,e);return i.texture.mapping=jf,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function _d(n,t,e,i,r){n.viewport.set(t,e,i,r),n.scissor.set(t,e,i,r)}function oH(n,t,e){return new ro({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:nH,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/e,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:F1(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:ys,depthTest:!1,depthWrite:!1})}function sH(n,t,e){let i=new Float32Array(yu),r=new ae(0,1,0);return new ro({name:"SphericalGaussianBlur",defines:{n:yu,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/e,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:F1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:ys,depthTest:!1,depthWrite:!1})}function RT(){return new ro({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:F1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:ys,depthTest:!1,depthWrite:!1})}function kT(){return new ro({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:F1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:ys,depthTest:!1,depthWrite:!1})}function F1(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function aH(n){let t=new WeakMap,e=null;function i(c){if(c&&c.isTexture){let f=c.mapping,p=f===V_||f===H_,g=f===Qa||f===pu;if(p||g){let m=t.get(c),x=m!==void 0?m.texture.pmremVersion:0;if(c.isRenderTargetTexture&&c.pmremVersion!==x)return e===null&&(e=new I1(n)),m=p?e.fromEquirectangular(c,m):e.fromCubemap(c,m),m.texture.pmremVersion=c.pmremVersion,t.set(c,m),m.texture;if(m!==void 0)return m.texture;{let C=c.image;return p&&C&&C.height>0||g&&C&&r(C)?(e===null&&(e=new I1(n)),m=p?e.fromEquirectangular(c):e.fromCubemap(c),m.texture.pmremVersion=c.pmremVersion,t.set(c,m),c.addEventListener("dispose",o),m.texture):null}}}return c}function r(c){let f=0,p=6;for(let g=0;g<p;g++)c[g]!==void 0&&f++;return f===p}function o(c){let f=c.target;f.removeEventListener("dispose",o);let p=t.get(f);p!==void 0&&(t.delete(f),p.dispose())}function l(){t=new WeakMap,e!==null&&(e.dispose(),e=null)}return{get:i,dispose:l}}function lH(n){let t={};function e(i){if(t[i]!==void 0)return t[i];let r=n.getExtension(i);return t[i]=r,r}return{has:function(i){return e(i)!==null},init:function(){e("EXT_color_buffer_float"),e("WEBGL_clip_cull_distance"),e("OES_texture_float_linear"),e("EXT_color_buffer_half_float"),e("WEBGL_multisampled_render_to_texture"),e("WEBGL_render_shared_exponent")},get:function(i){let r=e(i);return r===null&&rd("WebGLRenderer: "+i+" extension not supported."),r}}}function uH(n,t,e,i){let r={},o=new WeakMap;function l(m){let x=m.target;x.index!==null&&t.remove(x.index);for(let A in x.attributes)t.remove(x.attributes[A]);x.removeEventListener("dispose",l),delete r[x.id];let C=o.get(x);C&&(t.remove(C),o.delete(x)),i.releaseStatesOfGeometry(x),x.isInstancedBufferGeometry===!0&&delete x._maxInstanceCount,e.memory.geometries--}function c(m,x){return r[x.id]===!0||(x.addEventListener("dispose",l),r[x.id]=!0,e.memory.geometries++),x}function f(m){let x=m.attributes;for(let C in x)t.update(x[C],n.ARRAY_BUFFER)}function p(m){let x=[],C=m.index,A=m.attributes.position,O=0;if(C!==null){let G=C.array;O=C.version;for(let Y=0,q=G.length;Y<q;Y+=3){let X=G[Y+0],Z=G[Y+1],J=G[Y+2];x.push(X,Z,Z,J,J,X)}}else if(A!==void 0){let G=A.array;O=A.version;for(let Y=0,q=G.length/3-1;Y<q;Y+=3){let X=Y+0,Z=Y+1,J=Y+2;x.push(X,Z,Z,J,J,X)}}else return;let T=new(tC(x)?Af:Mf)(x,1);T.version=O;let M=o.get(m);M&&t.remove(M),o.set(m,T)}function g(m){let x=o.get(m);if(x){let C=m.index;C!==null&&x.version<C.version&&p(m)}else p(m);return o.get(m)}return{get:c,update:f,getWireframeAttribute:g}}function cH(n,t,e){let i;function r(x){i=x}let o,l;function c(x){o=x.type,l=x.bytesPerElement}function f(x,C){n.drawElements(i,C,o,x*l),e.update(C,i,1)}function p(x,C,A){A!==0&&(n.drawElementsInstanced(i,C,o,x*l,A),e.update(C,i,A))}function g(x,C,A){if(A===0)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(i,C,0,o,x,0,A);let T=0;for(let M=0;M<A;M++)T+=C[M];e.update(T,i,1)}function m(x,C,A,O){if(A===0)return;let T=t.get("WEBGL_multi_draw");if(T===null)for(let M=0;M<x.length;M++)p(x[M]/l,C[M],O[M]);else{T.multiDrawElementsInstancedWEBGL(i,C,0,o,x,0,O,0,A);let M=0;for(let G=0;G<A;G++)M+=C[G]*O[G];e.update(M,i,1)}}this.setMode=r,this.setIndex=c,this.render=f,this.renderInstances=p,this.renderMultiDraw=g,this.renderMultiDrawInstances=m}function dH(n){let t={geometries:0,textures:0},e={frame:0,calls:0,triangles:0,points:0,lines:0};function i(o,l,c){switch(e.calls++,l){case n.TRIANGLES:e.triangles+=c*(o/3);break;case n.LINES:e.lines+=c*(o/2);break;case n.LINE_STRIP:e.lines+=c*(o-1);break;case n.LINE_LOOP:e.lines+=c*o;break;case n.POINTS:e.points+=c*o;break;default:At("WebGLInfo: Unknown draw mode:",l);break}}function r(){e.calls=0,e.triangles=0,e.points=0,e.lines=0}return{memory:t,render:e,programs:null,autoReset:!0,reset:r,update:i}}function fH(n,t,e){let i=new WeakMap,r=new ui;function o(l,c,f){let p=l.morphTargetInfluences,g=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,m=g!==void 0?g.length:0,x=i.get(c);if(x===void 0||x.count!==m){let z=function(){oe.dispose(),i.delete(c),c.removeEventListener("dispose",z)};var C=z;x!==void 0&&x.texture.dispose();let A=c.morphAttributes.position!==void 0,O=c.morphAttributes.normal!==void 0,T=c.morphAttributes.color!==void 0,M=c.morphAttributes.position||[],G=c.morphAttributes.normal||[],Y=c.morphAttributes.color||[],q=0;A===!0&&(q=1),O===!0&&(q=2),T===!0&&(q=3);let X=c.attributes.position.count*q,Z=1;X>t.maxTextureSize&&(Z=Math.ceil(X/t.maxTextureSize),X=t.maxTextureSize);let J=new Float32Array(X*Z*4*m),oe=new wf(J,X,Z,m);oe.type=Xo,oe.needsUpdate=!0;let L=q*4;for(let K=0;K<m;K++){let re=M[K],ce=G[K],we=Y[K],Ee=X*Z*4*K;for(let xe=0;xe<re.count;xe++){let me=xe*L;A===!0&&(r.fromBufferAttribute(re,xe),J[Ee+me+0]=r.x,J[Ee+me+1]=r.y,J[Ee+me+2]=r.z,J[Ee+me+3]=0),O===!0&&(r.fromBufferAttribute(ce,xe),J[Ee+me+4]=r.x,J[Ee+me+5]=r.y,J[Ee+me+6]=r.z,J[Ee+me+7]=0),T===!0&&(r.fromBufferAttribute(we,xe),J[Ee+me+8]=r.x,J[Ee+me+9]=r.y,J[Ee+me+10]=r.z,J[Ee+me+11]=we.itemSize===4?r.w:1)}}x={count:m,texture:oe,size:new Ft(X,Z)},i.set(c,x),c.addEventListener("dispose",z)}if(l.isInstancedMesh===!0&&l.morphTexture!==null)f.getUniforms().setValue(n,"morphTexture",l.morphTexture,e);else{let A=0;for(let T=0;T<p.length;T++)A+=p[T];let O=c.morphTargetsRelative?1:1-A;f.getUniforms().setValue(n,"morphTargetBaseInfluence",O),f.getUniforms().setValue(n,"morphTargetInfluences",p)}f.getUniforms().setValue(n,"morphTargetsTexture",x.texture,e),f.getUniforms().setValue(n,"morphTargetsTextureSize",x.size)}return{update:o}}function hH(n,t,e,i){let r=new WeakMap;function o(f){let p=i.render.frame,g=f.geometry,m=t.get(f,g);if(r.get(m)!==p&&(t.update(m),r.set(m,p)),f.isInstancedMesh&&(f.hasEventListener("dispose",c)===!1&&f.addEventListener("dispose",c),r.get(f)!==p&&(e.update(f.instanceMatrix,n.ARRAY_BUFFER),f.instanceColor!==null&&e.update(f.instanceColor,n.ARRAY_BUFFER),r.set(f,p))),f.isSkinnedMesh){let x=f.skeleton;r.get(x)!==p&&(x.update(),r.set(x,p))}return m}function l(){r=new WeakMap}function c(f){let p=f.target;p.removeEventListener("dispose",c),e.remove(p.instanceMatrix),p.instanceColor!==null&&e.remove(p.instanceColor)}return{update:o,dispose:l}}var pH={[Bb]:"LINEAR_TONE_MAPPING",[Vb]:"REINHARD_TONE_MAPPING",[Hb]:"CINEON_TONE_MAPPING",[zb]:"ACES_FILMIC_TONE_MAPPING",[Wb]:"AGX_TONE_MAPPING",[Gb]:"NEUTRAL_TONE_MAPPING",[jb]:"CUSTOM_TONE_MAPPING"};function mH(n,t,e,i,r){let o=new io(t,e,{type:n,depthBuffer:i,stencilBuffer:r}),l=new io(t,e,{type:xs,depthBuffer:!1,stencilBuffer:!1}),c=new Ur;c.setAttribute("position",new hi([-1,3,0,-1,-1,0,3,-1,0],3)),c.setAttribute("uv",new hi([0,2,0,0,2,0],2));let f=new v_({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),p=new gn(c,f),g=new dd(-1,1,1,-1,0,1),m=null,x=null,C=!1,A,O=null,T=[],M=!1;this.setSize=function(G,Y){o.setSize(G,Y),l.setSize(G,Y);for(let q=0;q<T.length;q++){let X=T[q];X.setSize&&X.setSize(G,Y)}},this.setEffects=function(G){T=G,M=T.length>0&&T[0].isRenderPass===!0;let Y=o.width,q=o.height;for(let X=0;X<T.length;X++){let Z=T[X];Z.setSize&&Z.setSize(Y,q)}},this.begin=function(G,Y){if(C||G.toneMapping===Yo&&T.length===0)return!1;if(O=Y,Y!==null){let q=Y.width,X=Y.height;(o.width!==q||o.height!==X)&&this.setSize(q,X)}return M===!1&&G.setRenderTarget(o),A=G.toneMapping,G.toneMapping=Yo,!0},this.hasRenderPass=function(){return M},this.end=function(G,Y){G.toneMapping=A,C=!0;let q=o,X=l;for(let Z=0;Z<T.length;Z++){let J=T[Z];if(J.enabled!==!1&&(J.render(G,X,q,Y),J.needsSwap!==!1)){let oe=q;q=X,X=oe}}if(m!==G.outputColorSpace||x!==G.toneMapping){m=G.outputColorSpace,x=G.toneMapping,f.defines={},yn.getTransfer(m)===Pn&&(f.defines.SRGB_TRANSFER="");let Z=pH[x];Z&&(f.defines[Z]=""),f.needsUpdate=!0}f.uniforms.tDiffuse.value=q.texture,G.setRenderTarget(O),G.render(p,g),O=null,C=!1},this.isCompositing=function(){return C},this.dispose=function(){o.dispose(),l.dispose(),c.dispose(),f.dispose()}}var eD=new Zo,gC=new qa(1,1),tD=new wf,nD=new c_,iD=new Df,NT=[],UT=[],LT=new Float32Array(16),BT=new Float32Array(9),VT=new Float32Array(4);function yd(n,t,e){let i=n[0];if(i<=0||i>0)return n;let r=t*e,o=NT[r];if(o===void 0&&(o=new Float32Array(r),NT[r]=o),t!==0){i.toArray(o,0);for(let l=1,c=0;l!==t;++l)c+=e,n[l].toArray(o,c)}return o}function Ni(n,t){if(n.length!==t.length)return!1;for(let e=0,i=n.length;e<i;e++)if(n[e]!==t[e])return!1;return!0}function Ui(n,t){for(let e=0,i=t.length;e<i;e++)n[e]=t[e]}function R1(n,t){let e=UT[t];e===void 0&&(e=new Int32Array(t),UT[t]=e);for(let i=0;i!==t;++i)e[i]=n.allocateTextureUnit();return e}function gH(n,t){let e=this.cache;e[0]!==t&&(n.uniform1f(this.addr,t),e[0]=t)}function _H(n,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y)&&(n.uniform2f(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(Ni(e,t))return;n.uniform2fv(this.addr,t),Ui(e,t)}}function vH(n,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(n.uniform3f(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else if(t.r!==void 0)(e[0]!==t.r||e[1]!==t.g||e[2]!==t.b)&&(n.uniform3f(this.addr,t.r,t.g,t.b),e[0]=t.r,e[1]=t.g,e[2]=t.b);else{if(Ni(e,t))return;n.uniform3fv(this.addr,t),Ui(e,t)}}function yH(n,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(n.uniform4f(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(Ni(e,t))return;n.uniform4fv(this.addr,t),Ui(e,t)}}function xH(n,t){let e=this.cache,i=t.elements;if(i===void 0){if(Ni(e,t))return;n.uniformMatrix2fv(this.addr,!1,t),Ui(e,t)}else{if(Ni(e,i))return;VT.set(i),n.uniformMatrix2fv(this.addr,!1,VT),Ui(e,i)}}function bH(n,t){let e=this.cache,i=t.elements;if(i===void 0){if(Ni(e,t))return;n.uniformMatrix3fv(this.addr,!1,t),Ui(e,t)}else{if(Ni(e,i))return;BT.set(i),n.uniformMatrix3fv(this.addr,!1,BT),Ui(e,i)}}function CH(n,t){let e=this.cache,i=t.elements;if(i===void 0){if(Ni(e,t))return;n.uniformMatrix4fv(this.addr,!1,t),Ui(e,t)}else{if(Ni(e,i))return;LT.set(i),n.uniformMatrix4fv(this.addr,!1,LT),Ui(e,i)}}function EH(n,t){let e=this.cache;e[0]!==t&&(n.uniform1i(this.addr,t),e[0]=t)}function wH(n,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y)&&(n.uniform2i(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(Ni(e,t))return;n.uniform2iv(this.addr,t),Ui(e,t)}}function SH(n,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(n.uniform3i(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else{if(Ni(e,t))return;n.uniform3iv(this.addr,t),Ui(e,t)}}function MH(n,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(n.uniform4i(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(Ni(e,t))return;n.uniform4iv(this.addr,t),Ui(e,t)}}function AH(n,t){let e=this.cache;e[0]!==t&&(n.uniform1ui(this.addr,t),e[0]=t)}function TH(n,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y)&&(n.uniform2ui(this.addr,t.x,t.y),e[0]=t.x,e[1]=t.y);else{if(Ni(e,t))return;n.uniform2uiv(this.addr,t),Ui(e,t)}}function DH(n,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z)&&(n.uniform3ui(this.addr,t.x,t.y,t.z),e[0]=t.x,e[1]=t.y,e[2]=t.z);else{if(Ni(e,t))return;n.uniform3uiv(this.addr,t),Ui(e,t)}}function PH(n,t){let e=this.cache;if(t.x!==void 0)(e[0]!==t.x||e[1]!==t.y||e[2]!==t.z||e[3]!==t.w)&&(n.uniform4ui(this.addr,t.x,t.y,t.z,t.w),e[0]=t.x,e[1]=t.y,e[2]=t.z,e[3]=t.w);else{if(Ni(e,t))return;n.uniform4uiv(this.addr,t),Ui(e,t)}}function IH(n,t,e){let i=this.cache,r=e.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);let o;this.type===n.SAMPLER_2D_SHADOW?(gC.compareFunction=e.isReversedDepthBuffer()?T1:A1,o=gC):o=eD,e.setTexture2D(t||o,r)}function OH(n,t,e){let i=this.cache,r=e.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),e.setTexture3D(t||nD,r)}function FH(n,t,e){let i=this.cache,r=e.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),e.setTextureCube(t||iD,r)}function RH(n,t,e){let i=this.cache,r=e.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),e.setTexture2DArray(t||tD,r)}function kH(n){switch(n){case 5126:return gH;case 35664:return _H;case 35665:return vH;case 35666:return yH;case 35674:return xH;case 35675:return bH;case 35676:return CH;case 5124:case 35670:return EH;case 35667:case 35671:return wH;case 35668:case 35672:return SH;case 35669:case 35673:return MH;case 5125:return AH;case 36294:return TH;case 36295:return DH;case 36296:return PH;case 35678:case 36198:case 36298:case 36306:case 35682:return IH;case 35679:case 36299:case 36307:return OH;case 35680:case 36300:case 36308:case 36293:return FH;case 36289:case 36303:case 36311:case 36292:return RH}}function NH(n,t){n.uniform1fv(this.addr,t)}function UH(n,t){let e=yd(t,this.size,2);n.uniform2fv(this.addr,e)}function LH(n,t){let e=yd(t,this.size,3);n.uniform3fv(this.addr,e)}function BH(n,t){let e=yd(t,this.size,4);n.uniform4fv(this.addr,e)}function VH(n,t){let e=yd(t,this.size,4);n.uniformMatrix2fv(this.addr,!1,e)}function HH(n,t){let e=yd(t,this.size,9);n.uniformMatrix3fv(this.addr,!1,e)}function zH(n,t){let e=yd(t,this.size,16);n.uniformMatrix4fv(this.addr,!1,e)}function jH(n,t){n.uniform1iv(this.addr,t)}function WH(n,t){n.uniform2iv(this.addr,t)}function GH(n,t){n.uniform3iv(this.addr,t)}function $H(n,t){n.uniform4iv(this.addr,t)}function YH(n,t){n.uniform1uiv(this.addr,t)}function qH(n,t){n.uniform2uiv(this.addr,t)}function XH(n,t){n.uniform3uiv(this.addr,t)}function ZH(n,t){n.uniform4uiv(this.addr,t)}function JH(n,t,e){let i=this.cache,r=t.length,o=R1(e,r);Ni(i,o)||(n.uniform1iv(this.addr,o),Ui(i,o));let l;this.type===n.SAMPLER_2D_SHADOW?l=gC:l=eD;for(let c=0;c!==r;++c)e.setTexture2D(t[c]||l,o[c])}function KH(n,t,e){let i=this.cache,r=t.length,o=R1(e,r);Ni(i,o)||(n.uniform1iv(this.addr,o),Ui(i,o));for(let l=0;l!==r;++l)e.setTexture3D(t[l]||nD,o[l])}function QH(n,t,e){let i=this.cache,r=t.length,o=R1(e,r);Ni(i,o)||(n.uniform1iv(this.addr,o),Ui(i,o));for(let l=0;l!==r;++l)e.setTextureCube(t[l]||iD,o[l])}function ez(n,t,e){let i=this.cache,r=t.length,o=R1(e,r);Ni(i,o)||(n.uniform1iv(this.addr,o),Ui(i,o));for(let l=0;l!==r;++l)e.setTexture2DArray(t[l]||tD,o[l])}function tz(n){switch(n){case 5126:return NH;case 35664:return UH;case 35665:return LH;case 35666:return BH;case 35674:return VH;case 35675:return HH;case 35676:return zH;case 5124:case 35670:return jH;case 35667:case 35671:return WH;case 35668:case 35672:return GH;case 35669:case 35673:return $H;case 5125:return YH;case 36294:return qH;case 36295:return XH;case 36296:return ZH;case 35678:case 36198:case 36298:case 36306:case 35682:return JH;case 35679:case 36299:case 36307:return KH;case 35680:case 36300:case 36308:case 36293:return QH;case 36289:case 36303:case 36311:case 36292:return ez}}var _C=class{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.type=e.type,this.setValue=kH(e.type)}},vC=class{constructor(t,e,i){this.id=t,this.addr=i,this.cache=[],this.type=e.type,this.size=e.size,this.setValue=tz(e.type)}},yC=class{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,e,i){let r=this.seq;for(let o=0,l=r.length;o!==l;++o){let c=r[o];c.setValue(t,e[c.id],i)}}},pC=/(\w+)(\])?(\[|\.)?/g;function HT(n,t){n.seq.push(t),n.map[t.id]=t}function nz(n,t,e){let i=n.name,r=i.length;for(pC.lastIndex=0;;){let o=pC.exec(i),l=pC.lastIndex,c=o[1],f=o[2]==="]",p=o[3];if(f&&(c=c|0),p===void 0||p==="["&&l+2===r){HT(e,p===void 0?new _C(c,n,t):new vC(c,n,t));break}else{let m=e.map[c];m===void 0&&(m=new yC(c),HT(e,m)),e=m}}}var vd=class{constructor(t,e){this.seq=[],this.map={};let i=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let l=0;l<i;++l){let c=t.getActiveUniform(e,l),f=t.getUniformLocation(e,c.name);nz(c,f,this)}let r=[],o=[];for(let l of this.seq)l.type===t.SAMPLER_2D_SHADOW||l.type===t.SAMPLER_CUBE_SHADOW||l.type===t.SAMPLER_2D_ARRAY_SHADOW?r.push(l):o.push(l);r.length>0&&(this.seq=r.concat(o))}setValue(t,e,i,r){let o=this.map[e];o!==void 0&&o.setValue(t,i,r)}setOptional(t,e,i){let r=e[i];r!==void 0&&this.setValue(t,i,r)}static upload(t,e,i,r){for(let o=0,l=e.length;o!==l;++o){let c=e[o],f=i[c.id];f.needsUpdate!==!1&&c.setValue(t,f.value,r)}}static seqWithValue(t,e){let i=[];for(let r=0,o=t.length;r!==o;++r){let l=t[r];l.id in e&&i.push(l)}return i}};function zT(n,t,e){let i=n.createShader(t);return n.shaderSource(i,e),n.compileShader(i),i}var iz=37297,rz=0;function oz(n,t){let e=n.split(`
`),i=[],r=Math.max(t-6,0),o=Math.min(t+6,e.length);for(let l=r;l<o;l++){let c=l+1;i.push(`${c===t?">":" "} ${c}: ${e[l]}`)}return i.join(`
`)}var jT=new jt;function sz(n){yn._getMatrix(jT,yn.workingColorSpace,n);let t=`mat3( ${jT.elements.map(e=>e.toFixed(4))} )`;switch(yn.getTransfer(n)){case Cf:return[t,"LinearTransferOETF"];case Pn:return[t,"sRGBTransferOETF"];default:return Mt("WebGLProgram: Unsupported color space: ",n),[t,"LinearTransferOETF"]}}function WT(n,t,e){let i=n.getShaderParameter(t,n.COMPILE_STATUS),o=(n.getShaderInfoLog(t)||"").trim();if(i&&o==="")return"";let l=/ERROR: 0:(\d+)/.exec(o);if(l){let c=parseInt(l[1]);return e.toUpperCase()+`

`+o+`

`+oz(n.getShaderSource(t),c)}else return o}function az(n,t){let e=sz(t);return[`vec4 ${n}( vec4 value ) {`,`	return ${e[1]}( vec4( value.rgb * ${e[0]}, value.a ) );`,"}"].join(`
`)}var lz={[Bb]:"Linear",[Vb]:"Reinhard",[Hb]:"Cineon",[zb]:"ACESFilmic",[Wb]:"AgX",[Gb]:"Neutral",[jb]:"Custom"};function uz(n,t){let e=lz[t];return e===void 0?(Mt("WebGLProgram: Unsupported toneMapping:",t),"vec3 "+n+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+n+"( vec3 color ) { return "+e+"ToneMapping( color ); }"}var P1=new ae;function cz(){yn.getLuminanceCoefficients(P1);let n=P1.x.toFixed(4),t=P1.y.toFixed(4),e=P1.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${n}, ${t}, ${e} );`,"	return dot( weights, rgb );","}"].join(`
`)}function dz(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",n.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(Jf).join(`
`)}function fz(n){let t=[];for(let e in n){let i=n[e];i!==!1&&t.push("#define "+e+" "+i)}return t.join(`
`)}function hz(n,t){let e={},i=n.getProgramParameter(t,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){let o=n.getActiveAttrib(t,r),l=o.name,c=1;o.type===n.FLOAT_MAT2&&(c=2),o.type===n.FLOAT_MAT3&&(c=3),o.type===n.FLOAT_MAT4&&(c=4),e[l]={type:o.type,location:n.getAttribLocation(t,l),locationSize:c}}return e}function Jf(n){return n!==""}function GT(n,t){let e=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,e).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function $T(n,t){return n.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var pz=/^[ \t]*#include +<([\w\d./]+)>/gm;function xC(n){return n.replace(pz,gz)}var mz=new Map;function gz(n,t){let e=Jt[t];if(e===void 0){let i=mz.get(t);if(i!==void 0)e=Jt[i],Mt('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,i);else throw new Error("Can not resolve #include <"+t+">")}return xC(e)}var _z=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function YT(n){return n.replace(_z,vz)}function vz(n,t,e,i){let r="";for(let o=parseInt(t);o<parseInt(e);o++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return r}function qT(n){let t=`precision ${n.precision} float;
	precision ${n.precision} int;
	precision ${n.precision} sampler2D;
	precision ${n.precision} samplerCube;
	precision ${n.precision} sampler3D;
	precision ${n.precision} sampler2DArray;
	precision ${n.precision} sampler2DShadow;
	precision ${n.precision} samplerCubeShadow;
	precision ${n.precision} sampler2DArrayShadow;
	precision ${n.precision} isampler2D;
	precision ${n.precision} isampler3D;
	precision ${n.precision} isamplerCube;
	precision ${n.precision} isampler2DArray;
	precision ${n.precision} usampler2D;
	precision ${n.precision} usampler3D;
	precision ${n.precision} usamplerCube;
	precision ${n.precision} usampler2DArray;
	`;return n.precision==="highp"?t+=`
#define HIGH_PRECISION`:n.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}var yz={[zf]:"SHADOWMAP_TYPE_PCF",[hd]:"SHADOWMAP_TYPE_VSM"};function xz(n){return yz[n.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}var bz={[Qa]:"ENVMAP_TYPE_CUBE",[pu]:"ENVMAP_TYPE_CUBE",[jf]:"ENVMAP_TYPE_CUBE_UV"};function Cz(n){return n.envMap===!1?"ENVMAP_TYPE_CUBE":bz[n.envMapMode]||"ENVMAP_TYPE_CUBE"}var Ez={[pu]:"ENVMAP_MODE_REFRACTION"};function wz(n){return n.envMap===!1?"ENVMAP_MODE_REFLECTION":Ez[n.envMapMode]||"ENVMAP_MODE_REFLECTION"}var Sz={[B_]:"ENVMAP_BLENDING_MULTIPLY",[mT]:"ENVMAP_BLENDING_MIX",[gT]:"ENVMAP_BLENDING_ADD"};function Mz(n){return n.envMap===!1?"ENVMAP_BLENDING_NONE":Sz[n.combine]||"ENVMAP_BLENDING_NONE"}function Az(n){let t=n.envMapCubeUVHeight;if(t===null)return null;let e=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,e),7*16)),texelHeight:i,maxMip:e}}function Tz(n,t,e,i){let r=n.getContext(),o=e.defines,l=e.vertexShader,c=e.fragmentShader,f=xz(e),p=Cz(e),g=wz(e),m=Mz(e),x=Az(e),C=dz(e),A=fz(o),O=r.createProgram(),T,M,G=e.glslVersion?"#version "+e.glslVersion+`
`:"";e.isRawShaderMaterial?(T=["#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,A].filter(Jf).join(`
`),T.length>0&&(T+=`
`),M=["#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,A].filter(Jf).join(`
`),M.length>0&&(M+=`
`)):(T=[qT(e),"#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,A,e.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",e.batching?"#define USE_BATCHING":"",e.batchingColor?"#define USE_BATCHING_COLOR":"",e.instancing?"#define USE_INSTANCING":"",e.instancingColor?"#define USE_INSTANCING_COLOR":"",e.instancingMorph?"#define USE_INSTANCING_MORPH":"",e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+g:"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",e.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",e.displacementMap?"#define USE_DISPLACEMENTMAP":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.anisotropy?"#define USE_ANISOTROPY":"",e.anisotropyMap?"#define USE_ANISOTROPYMAP":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",e.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",e.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.alphaHash?"#define USE_ALPHAHASH":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",e.mapUv?"#define MAP_UV "+e.mapUv:"",e.alphaMapUv?"#define ALPHAMAP_UV "+e.alphaMapUv:"",e.lightMapUv?"#define LIGHTMAP_UV "+e.lightMapUv:"",e.aoMapUv?"#define AOMAP_UV "+e.aoMapUv:"",e.emissiveMapUv?"#define EMISSIVEMAP_UV "+e.emissiveMapUv:"",e.bumpMapUv?"#define BUMPMAP_UV "+e.bumpMapUv:"",e.normalMapUv?"#define NORMALMAP_UV "+e.normalMapUv:"",e.displacementMapUv?"#define DISPLACEMENTMAP_UV "+e.displacementMapUv:"",e.metalnessMapUv?"#define METALNESSMAP_UV "+e.metalnessMapUv:"",e.roughnessMapUv?"#define ROUGHNESSMAP_UV "+e.roughnessMapUv:"",e.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+e.anisotropyMapUv:"",e.clearcoatMapUv?"#define CLEARCOATMAP_UV "+e.clearcoatMapUv:"",e.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+e.clearcoatNormalMapUv:"",e.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+e.clearcoatRoughnessMapUv:"",e.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+e.iridescenceMapUv:"",e.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+e.iridescenceThicknessMapUv:"",e.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+e.sheenColorMapUv:"",e.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+e.sheenRoughnessMapUv:"",e.specularMapUv?"#define SPECULARMAP_UV "+e.specularMapUv:"",e.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+e.specularColorMapUv:"",e.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+e.specularIntensityMapUv:"",e.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+e.transmissionMapUv:"",e.thicknessMapUv?"#define THICKNESSMAP_UV "+e.thicknessMapUv:"",e.vertexTangents&&e.flatShading===!1?"#define USE_TANGENT":"",e.vertexColors?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUv1s?"#define USE_UV1":"",e.vertexUv2s?"#define USE_UV2":"",e.vertexUv3s?"#define USE_UV3":"",e.pointsUvs?"#define USE_POINTS_UV":"",e.flatShading?"#define FLAT_SHADED":"",e.skinning?"#define USE_SKINNING":"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals&&e.flatShading===!1?"#define USE_MORPHNORMALS":"",e.morphColors?"#define USE_MORPHCOLORS":"",e.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+e.morphTextureStride:"",e.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+e.morphTargetsCount:"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+f:"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"",e.numLightProbes>0?"#define USE_LIGHT_PROBES":"",e.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",e.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Jf).join(`
`),M=[qT(e),"#define SHADER_TYPE "+e.shaderType,"#define SHADER_NAME "+e.shaderName,A,e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp2?"#define FOG_EXP2":"",e.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",e.map?"#define USE_MAP":"",e.matcap?"#define USE_MATCAP":"",e.envMap?"#define USE_ENVMAP":"",e.envMap?"#define "+p:"",e.envMap?"#define "+g:"",e.envMap?"#define "+m:"",x?"#define CUBEUV_TEXEL_WIDTH "+x.texelWidth:"",x?"#define CUBEUV_TEXEL_HEIGHT "+x.texelHeight:"",x?"#define CUBEUV_MAX_MIP "+x.maxMip+".0":"",e.lightMap?"#define USE_LIGHTMAP":"",e.aoMap?"#define USE_AOMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",e.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",e.emissiveMap?"#define USE_EMISSIVEMAP":"",e.anisotropy?"#define USE_ANISOTROPY":"",e.anisotropyMap?"#define USE_ANISOTROPYMAP":"",e.clearcoat?"#define USE_CLEARCOAT":"",e.clearcoatMap?"#define USE_CLEARCOATMAP":"",e.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",e.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",e.dispersion?"#define USE_DISPERSION":"",e.iridescence?"#define USE_IRIDESCENCE":"",e.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",e.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",e.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",e.roughnessMap?"#define USE_ROUGHNESSMAP":"",e.metalnessMap?"#define USE_METALNESSMAP":"",e.alphaMap?"#define USE_ALPHAMAP":"",e.alphaTest?"#define USE_ALPHATEST":"",e.alphaHash?"#define USE_ALPHAHASH":"",e.sheen?"#define USE_SHEEN":"",e.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",e.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",e.transmission?"#define USE_TRANSMISSION":"",e.transmissionMap?"#define USE_TRANSMISSIONMAP":"",e.thicknessMap?"#define USE_THICKNESSMAP":"",e.vertexTangents&&e.flatShading===!1?"#define USE_TANGENT":"",e.vertexColors||e.instancingColor||e.batchingColor?"#define USE_COLOR":"",e.vertexAlphas?"#define USE_COLOR_ALPHA":"",e.vertexUv1s?"#define USE_UV1":"",e.vertexUv2s?"#define USE_UV2":"",e.vertexUv3s?"#define USE_UV3":"",e.pointsUvs?"#define USE_POINTS_UV":"",e.gradientMap?"#define USE_GRADIENTMAP":"",e.flatShading?"#define FLAT_SHADED":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+f:"",e.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",e.numLightProbes>0?"#define USE_LIGHT_PROBES":"",e.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",e.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",e.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",e.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",e.toneMapping!==Yo?"#define TONE_MAPPING":"",e.toneMapping!==Yo?Jt.tonemapping_pars_fragment:"",e.toneMapping!==Yo?uz("toneMapping",e.toneMapping):"",e.dithering?"#define DITHERING":"",e.opaque?"#define OPAQUE":"",Jt.colorspace_pars_fragment,az("linearToOutputTexel",e.outputColorSpace),cz(),e.useDepthPacking?"#define DEPTH_PACKING "+e.depthPacking:"",`
`].filter(Jf).join(`
`)),l=xC(l),l=GT(l,e),l=$T(l,e),c=xC(c),c=GT(c,e),c=$T(c,e),l=YT(l),c=YT(c),e.isRawShaderMaterial!==!0&&(G=`#version 300 es
`,T=[C,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+T,M=["#define varying in",e.glslVersion===eC?"":"layout(location = 0) out highp vec4 pc_fragColor;",e.glslVersion===eC?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+M);let Y=G+T+l,q=G+M+c,X=zT(r,r.VERTEX_SHADER,Y),Z=zT(r,r.FRAGMENT_SHADER,q);r.attachShader(O,X),r.attachShader(O,Z),e.index0AttributeName!==void 0?r.bindAttribLocation(O,0,e.index0AttributeName):e.morphTargets===!0&&r.bindAttribLocation(O,0,"position"),r.linkProgram(O);function J(K){if(n.debug.checkShaderErrors){let re=r.getProgramInfoLog(O)||"",ce=r.getShaderInfoLog(X)||"",we=r.getShaderInfoLog(Z)||"",Ee=re.trim(),xe=ce.trim(),me=we.trim(),Me=!0,qe=!0;if(r.getProgramParameter(O,r.LINK_STATUS)===!1)if(Me=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,O,X,Z);else{let Be=WT(r,X,"vertex"),Xe=WT(r,Z,"fragment");At("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(O,r.VALIDATE_STATUS)+`

Material Name: `+K.name+`
Material Type: `+K.type+`

Program Info Log: `+Ee+`
`+Be+`
`+Xe)}else Ee!==""?Mt("WebGLProgram: Program Info Log:",Ee):(xe===""||me==="")&&(qe=!1);qe&&(K.diagnostics={runnable:Me,programLog:Ee,vertexShader:{log:xe,prefix:T},fragmentShader:{log:me,prefix:M}})}r.deleteShader(X),r.deleteShader(Z),oe=new vd(r,O),L=hz(r,O)}let oe;this.getUniforms=function(){return oe===void 0&&J(this),oe};let L;this.getAttributes=function(){return L===void 0&&J(this),L};let z=e.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return z===!1&&(z=r.getProgramParameter(O,iz)),z},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(O),this.program=void 0},this.type=e.shaderType,this.name=e.shaderName,this.id=rz++,this.cacheKey=t,this.usedTimes=1,this.program=O,this.vertexShader=X,this.fragmentShader=Z,this}var Dz=0,bC=class{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){let e=t.vertexShader,i=t.fragmentShader,r=this._getShaderStage(e),o=this._getShaderStage(i),l=this._getShaderCacheForMaterial(t);return l.has(r)===!1&&(l.add(r),r.usedTimes++),l.has(o)===!1&&(l.add(o),o.usedTimes++),this}remove(t){let e=this.materialCache.get(t);for(let i of e)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){let e=this.materialCache,i=e.get(t);return i===void 0&&(i=new Set,e.set(t,i)),i}_getShaderStage(t){let e=this.shaderCache,i=e.get(t);return i===void 0&&(i=new CC(t),e.set(t,i)),i}},CC=class{constructor(t){this.id=Dz++,this.code=t,this.usedTimes=0}};function Pz(n,t,e,i,r,o,l){let c=new Sf,f=new bC,p=new Set,g=[],m=new Map,x=r.logarithmicDepthBuffer,C=r.precision,A={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function O(L){return p.add(L),L===0?"uv":`uv${L}`}function T(L,z,K,re,ce){let we=re.fog,Ee=ce.geometry,xe=L.isMeshStandardMaterial?re.environment:null,me=(L.isMeshStandardMaterial?e:t).get(L.envMap||xe),Me=me&&me.mapping===jf?me.image.height:null,qe=A[L.type];L.precision!==null&&(C=r.getMaxPrecision(L.precision),C!==L.precision&&Mt("WebGLProgram.getParameters:",L.precision,"not supported, using",C,"instead."));let Be=Ee.morphAttributes.position||Ee.morphAttributes.normal||Ee.morphAttributes.color,Xe=Be!==void 0?Be.length:0,Et=0;Ee.morphAttributes.position!==void 0&&(Et=1),Ee.morphAttributes.normal!==void 0&&(Et=2),Ee.morphAttributes.color!==void 0&&(Et=3);let Re,wn,xn,Se;if(qe){let st=Cs[qe];Re=st.vertexShader,wn=st.fragmentShader}else Re=L.vertexShader,wn=L.fragmentShader,f.update(L),xn=f.getVertexShaderID(L),Se=f.getFragmentShaderID(L);let De=n.getRenderTarget(),rt=n.state.buffers.depth.getReversed(),Pt=ce.isInstancedMesh===!0,ft=ce.isBatchedMesh===!0,tn=!!L.map,Xn=!!L.matcap,sn=!!me,It=!!L.aoMap,Kt=!!L.lightMap,Nt=!!L.bumpMap,un=!!L.normalMap,Q=!!L.displacementMap,cn=!!L.emissiveMap,an=!!L.metalnessMap,gt=!!L.roughnessMap,Qe=L.anisotropy>0,W=L.clearcoat>0,k=L.dispersion>0,te=L.iridescence>0,ge=L.sheen>0,Ae=L.transmission>0,de=Qe&&!!L.anisotropyMap,ct=W&&!!L.clearcoatMap,ke=W&&!!L.clearcoatNormalMap,dt=W&&!!L.clearcoatRoughnessMap,xt=te&&!!L.iridescenceMap,Fe=te&&!!L.iridescenceThicknessMap,He=ge&&!!L.sheenColorMap,tt=ge&&!!L.sheenRoughnessMap,ht=!!L.specularMap,je=!!L.specularColorMap,Ut=!!L.specularIntensityMap,ne=Ae&&!!L.transmissionMap,ze=Ae&&!!L.thicknessMap,Ue=!!L.gradientMap,Je=!!L.alphaMap,ue=L.alphaTest>0,Te=!!L.alphaHash,Ge=!!L.extensions,vt=Yo;L.toneMapped&&(De===null||De.isXRRenderTarget===!0)&&(vt=n.toneMapping);let Wt={shaderID:qe,shaderType:L.type,shaderName:L.name,vertexShader:Re,fragmentShader:wn,defines:L.defines,customVertexShaderID:xn,customFragmentShaderID:Se,isRawShaderMaterial:L.isRawShaderMaterial===!0,glslVersion:L.glslVersion,precision:C,batching:ft,batchingColor:ft&&ce._colorsTexture!==null,instancing:Pt,instancingColor:Pt&&ce.instanceColor!==null,instancingMorph:Pt&&ce.morphTexture!==null,outputColorSpace:De===null?n.outputColorSpace:De.isXRRenderTarget===!0?De.texture.colorSpace:cu,alphaToCoverage:!!L.alphaToCoverage,map:tn,matcap:Xn,envMap:sn,envMapMode:sn&&me.mapping,envMapCubeUVHeight:Me,aoMap:It,lightMap:Kt,bumpMap:Nt,normalMap:un,displacementMap:Q,emissiveMap:cn,normalMapObjectSpace:un&&L.normalMapType===yT,normalMapTangentSpace:un&&L.normalMapType===Qb,metalnessMap:an,roughnessMap:gt,anisotropy:Qe,anisotropyMap:de,clearcoat:W,clearcoatMap:ct,clearcoatNormalMap:ke,clearcoatRoughnessMap:dt,dispersion:k,iridescence:te,iridescenceMap:xt,iridescenceThicknessMap:Fe,sheen:ge,sheenColorMap:He,sheenRoughnessMap:tt,specularMap:ht,specularColorMap:je,specularIntensityMap:Ut,transmission:Ae,transmissionMap:ne,thicknessMap:ze,gradientMap:Ue,opaque:L.transparent===!1&&L.blending===au&&L.alphaToCoverage===!1,alphaMap:Je,alphaTest:ue,alphaHash:Te,combine:L.combine,mapUv:tn&&O(L.map.channel),aoMapUv:It&&O(L.aoMap.channel),lightMapUv:Kt&&O(L.lightMap.channel),bumpMapUv:Nt&&O(L.bumpMap.channel),normalMapUv:un&&O(L.normalMap.channel),displacementMapUv:Q&&O(L.displacementMap.channel),emissiveMapUv:cn&&O(L.emissiveMap.channel),metalnessMapUv:an&&O(L.metalnessMap.channel),roughnessMapUv:gt&&O(L.roughnessMap.channel),anisotropyMapUv:de&&O(L.anisotropyMap.channel),clearcoatMapUv:ct&&O(L.clearcoatMap.channel),clearcoatNormalMapUv:ke&&O(L.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:dt&&O(L.clearcoatRoughnessMap.channel),iridescenceMapUv:xt&&O(L.iridescenceMap.channel),iridescenceThicknessMapUv:Fe&&O(L.iridescenceThicknessMap.channel),sheenColorMapUv:He&&O(L.sheenColorMap.channel),sheenRoughnessMapUv:tt&&O(L.sheenRoughnessMap.channel),specularMapUv:ht&&O(L.specularMap.channel),specularColorMapUv:je&&O(L.specularColorMap.channel),specularIntensityMapUv:Ut&&O(L.specularIntensityMap.channel),transmissionMapUv:ne&&O(L.transmissionMap.channel),thicknessMapUv:ze&&O(L.thicknessMap.channel),alphaMapUv:Je&&O(L.alphaMap.channel),vertexTangents:!!Ee.attributes.tangent&&(un||Qe),vertexColors:L.vertexColors,vertexAlphas:L.vertexColors===!0&&!!Ee.attributes.color&&Ee.attributes.color.itemSize===4,pointsUvs:ce.isPoints===!0&&!!Ee.attributes.uv&&(tn||Je),fog:!!we,useFog:L.fog===!0,fogExp2:!!we&&we.isFogExp2,flatShading:L.flatShading===!0&&L.wireframe===!1,sizeAttenuation:L.sizeAttenuation===!0,logarithmicDepthBuffer:x,reversedDepthBuffer:rt,skinning:ce.isSkinnedMesh===!0,morphTargets:Ee.morphAttributes.position!==void 0,morphNormals:Ee.morphAttributes.normal!==void 0,morphColors:Ee.morphAttributes.color!==void 0,morphTargetsCount:Xe,morphTextureStride:Et,numDirLights:z.directional.length,numPointLights:z.point.length,numSpotLights:z.spot.length,numSpotLightMaps:z.spotLightMap.length,numRectAreaLights:z.rectArea.length,numHemiLights:z.hemi.length,numDirLightShadows:z.directionalShadowMap.length,numPointLightShadows:z.pointShadowMap.length,numSpotLightShadows:z.spotShadowMap.length,numSpotLightShadowsWithMaps:z.numSpotLightShadowsWithMaps,numLightProbes:z.numLightProbes,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:L.dithering,shadowMapEnabled:n.shadowMap.enabled&&K.length>0,shadowMapType:n.shadowMap.type,toneMapping:vt,decodeVideoTexture:tn&&L.map.isVideoTexture===!0&&yn.getTransfer(L.map.colorSpace)===Pn,decodeVideoTextureEmissive:cn&&L.emissiveMap.isVideoTexture===!0&&yn.getTransfer(L.emissiveMap.colorSpace)===Pn,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===so,flipSided:L.side===yr,useDepthPacking:L.depthPacking>=0,depthPacking:L.depthPacking||0,index0AttributeName:L.index0AttributeName,extensionClipCullDistance:Ge&&L.extensions.clipCullDistance===!0&&i.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Ge&&L.extensions.multiDraw===!0||ft)&&i.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:L.customProgramCacheKey()};return Wt.vertexUv1s=p.has(1),Wt.vertexUv2s=p.has(2),Wt.vertexUv3s=p.has(3),p.clear(),Wt}function M(L){let z=[];if(L.shaderID?z.push(L.shaderID):(z.push(L.customVertexShaderID),z.push(L.customFragmentShaderID)),L.defines!==void 0)for(let K in L.defines)z.push(K),z.push(L.defines[K]);return L.isRawShaderMaterial===!1&&(G(z,L),Y(z,L),z.push(n.outputColorSpace)),z.push(L.customProgramCacheKey),z.join()}function G(L,z){L.push(z.precision),L.push(z.outputColorSpace),L.push(z.envMapMode),L.push(z.envMapCubeUVHeight),L.push(z.mapUv),L.push(z.alphaMapUv),L.push(z.lightMapUv),L.push(z.aoMapUv),L.push(z.bumpMapUv),L.push(z.normalMapUv),L.push(z.displacementMapUv),L.push(z.emissiveMapUv),L.push(z.metalnessMapUv),L.push(z.roughnessMapUv),L.push(z.anisotropyMapUv),L.push(z.clearcoatMapUv),L.push(z.clearcoatNormalMapUv),L.push(z.clearcoatRoughnessMapUv),L.push(z.iridescenceMapUv),L.push(z.iridescenceThicknessMapUv),L.push(z.sheenColorMapUv),L.push(z.sheenRoughnessMapUv),L.push(z.specularMapUv),L.push(z.specularColorMapUv),L.push(z.specularIntensityMapUv),L.push(z.transmissionMapUv),L.push(z.thicknessMapUv),L.push(z.combine),L.push(z.fogExp2),L.push(z.sizeAttenuation),L.push(z.morphTargetsCount),L.push(z.morphAttributeCount),L.push(z.numDirLights),L.push(z.numPointLights),L.push(z.numSpotLights),L.push(z.numSpotLightMaps),L.push(z.numHemiLights),L.push(z.numRectAreaLights),L.push(z.numDirLightShadows),L.push(z.numPointLightShadows),L.push(z.numSpotLightShadows),L.push(z.numSpotLightShadowsWithMaps),L.push(z.numLightProbes),L.push(z.shadowMapType),L.push(z.toneMapping),L.push(z.numClippingPlanes),L.push(z.numClipIntersection),L.push(z.depthPacking)}function Y(L,z){c.disableAll(),z.instancing&&c.enable(0),z.instancingColor&&c.enable(1),z.instancingMorph&&c.enable(2),z.matcap&&c.enable(3),z.envMap&&c.enable(4),z.normalMapObjectSpace&&c.enable(5),z.normalMapTangentSpace&&c.enable(6),z.clearcoat&&c.enable(7),z.iridescence&&c.enable(8),z.alphaTest&&c.enable(9),z.vertexColors&&c.enable(10),z.vertexAlphas&&c.enable(11),z.vertexUv1s&&c.enable(12),z.vertexUv2s&&c.enable(13),z.vertexUv3s&&c.enable(14),z.vertexTangents&&c.enable(15),z.anisotropy&&c.enable(16),z.alphaHash&&c.enable(17),z.batching&&c.enable(18),z.dispersion&&c.enable(19),z.batchingColor&&c.enable(20),z.gradientMap&&c.enable(21),L.push(c.mask),c.disableAll(),z.fog&&c.enable(0),z.useFog&&c.enable(1),z.flatShading&&c.enable(2),z.logarithmicDepthBuffer&&c.enable(3),z.reversedDepthBuffer&&c.enable(4),z.skinning&&c.enable(5),z.morphTargets&&c.enable(6),z.morphNormals&&c.enable(7),z.morphColors&&c.enable(8),z.premultipliedAlpha&&c.enable(9),z.shadowMapEnabled&&c.enable(10),z.doubleSided&&c.enable(11),z.flipSided&&c.enable(12),z.useDepthPacking&&c.enable(13),z.dithering&&c.enable(14),z.transmission&&c.enable(15),z.sheen&&c.enable(16),z.opaque&&c.enable(17),z.pointsUvs&&c.enable(18),z.decodeVideoTexture&&c.enable(19),z.decodeVideoTextureEmissive&&c.enable(20),z.alphaToCoverage&&c.enable(21),L.push(c.mask)}function q(L){let z=A[L.type],K;if(z){let re=Cs[z];K=DT.clone(re.uniforms)}else K=L.uniforms;return K}function X(L,z){let K=m.get(z);return K!==void 0?++K.usedTimes:(K=new Tz(n,z,L,o),g.push(K),m.set(z,K)),K}function Z(L){if(--L.usedTimes===0){let z=g.indexOf(L);g[z]=g[g.length-1],g.pop(),m.delete(L.cacheKey),L.destroy()}}function J(L){f.remove(L)}function oe(){f.dispose()}return{getParameters:T,getProgramCacheKey:M,getUniforms:q,acquireProgram:X,releaseProgram:Z,releaseShaderCache:J,programs:g,dispose:oe}}function Iz(){let n=new WeakMap;function t(l){return n.has(l)}function e(l){let c=n.get(l);return c===void 0&&(c={},n.set(l,c)),c}function i(l){n.delete(l)}function r(l,c,f){n.get(l)[c]=f}function o(){n=new WeakMap}return{has:t,get:e,remove:i,update:r,dispose:o}}function Oz(n,t){return n.groupOrder!==t.groupOrder?n.groupOrder-t.groupOrder:n.renderOrder!==t.renderOrder?n.renderOrder-t.renderOrder:n.material.id!==t.material.id?n.material.id-t.material.id:n.z!==t.z?n.z-t.z:n.id-t.id}function XT(n,t){return n.groupOrder!==t.groupOrder?n.groupOrder-t.groupOrder:n.renderOrder!==t.renderOrder?n.renderOrder-t.renderOrder:n.z!==t.z?t.z-n.z:n.id-t.id}function ZT(){let n=[],t=0,e=[],i=[],r=[];function o(){t=0,e.length=0,i.length=0,r.length=0}function l(m,x,C,A,O,T){let M=n[t];return M===void 0?(M={id:m.id,object:m,geometry:x,material:C,groupOrder:A,renderOrder:m.renderOrder,z:O,group:T},n[t]=M):(M.id=m.id,M.object=m,M.geometry=x,M.material=C,M.groupOrder=A,M.renderOrder=m.renderOrder,M.z=O,M.group=T),t++,M}function c(m,x,C,A,O,T){let M=l(m,x,C,A,O,T);C.transmission>0?i.push(M):C.transparent===!0?r.push(M):e.push(M)}function f(m,x,C,A,O,T){let M=l(m,x,C,A,O,T);C.transmission>0?i.unshift(M):C.transparent===!0?r.unshift(M):e.unshift(M)}function p(m,x){e.length>1&&e.sort(m||Oz),i.length>1&&i.sort(x||XT),r.length>1&&r.sort(x||XT)}function g(){for(let m=t,x=n.length;m<x;m++){let C=n[m];if(C.id===null)break;C.id=null,C.object=null,C.geometry=null,C.material=null,C.group=null}}return{opaque:e,transmissive:i,transparent:r,init:o,push:c,unshift:f,finish:g,sort:p}}function Fz(){let n=new WeakMap;function t(i,r){let o=n.get(i),l;return o===void 0?(l=new ZT,n.set(i,[l])):r>=o.length?(l=new ZT,o.push(l)):l=o[r],l}function e(){n=new WeakMap}return{get:t,dispose:e}}function Rz(){let n={};return{get:function(t){if(n[t.id]!==void 0)return n[t.id];let e;switch(t.type){case"DirectionalLight":e={direction:new ae,color:new Zt};break;case"SpotLight":e={position:new ae,direction:new ae,color:new Zt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":e={position:new ae,color:new Zt,distance:0,decay:0};break;case"HemisphereLight":e={direction:new ae,skyColor:new Zt,groundColor:new Zt};break;case"RectAreaLight":e={color:new Zt,position:new ae,halfWidth:new ae,halfHeight:new ae};break}return n[t.id]=e,e}}}function kz(){let n={};return{get:function(t){if(n[t.id]!==void 0)return n[t.id];let e;switch(t.type){case"DirectionalLight":e={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ft};break;case"SpotLight":e={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ft};break;case"PointLight":e={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Ft,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[t.id]=e,e}}}var Nz=0;function Uz(n,t){return(t.castShadow?2:0)-(n.castShadow?2:0)+(t.map?1:0)-(n.map?1:0)}function Lz(n){let t=new Rz,e=kz(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let p=0;p<9;p++)i.probe.push(new ae);let r=new ae,o=new li,l=new li;function c(p){let g=0,m=0,x=0;for(let L=0;L<9;L++)i.probe[L].set(0,0,0);let C=0,A=0,O=0,T=0,M=0,G=0,Y=0,q=0,X=0,Z=0,J=0;p.sort(Uz);for(let L=0,z=p.length;L<z;L++){let K=p[L],re=K.color,ce=K.intensity,we=K.distance,Ee=null;if(K.shadow&&K.shadow.map&&(K.shadow.map.texture.format===mu?Ee=K.shadow.map.texture:Ee=K.shadow.map.depthTexture||K.shadow.map.texture),K.isAmbientLight)g+=re.r*ce,m+=re.g*ce,x+=re.b*ce;else if(K.isLightProbe){for(let xe=0;xe<9;xe++)i.probe[xe].addScaledVector(K.sh.coefficients[xe],ce);J++}else if(K.isDirectionalLight){let xe=t.get(K);if(xe.color.copy(K.color).multiplyScalar(K.intensity),K.castShadow){let me=K.shadow,Me=e.get(K);Me.shadowIntensity=me.intensity,Me.shadowBias=me.bias,Me.shadowNormalBias=me.normalBias,Me.shadowRadius=me.radius,Me.shadowMapSize=me.mapSize,i.directionalShadow[C]=Me,i.directionalShadowMap[C]=Ee,i.directionalShadowMatrix[C]=K.shadow.matrix,G++}i.directional[C]=xe,C++}else if(K.isSpotLight){let xe=t.get(K);xe.position.setFromMatrixPosition(K.matrixWorld),xe.color.copy(re).multiplyScalar(ce),xe.distance=we,xe.coneCos=Math.cos(K.angle),xe.penumbraCos=Math.cos(K.angle*(1-K.penumbra)),xe.decay=K.decay,i.spot[O]=xe;let me=K.shadow;if(K.map&&(i.spotLightMap[X]=K.map,X++,me.updateMatrices(K),K.castShadow&&Z++),i.spotLightMatrix[O]=me.matrix,K.castShadow){let Me=e.get(K);Me.shadowIntensity=me.intensity,Me.shadowBias=me.bias,Me.shadowNormalBias=me.normalBias,Me.shadowRadius=me.radius,Me.shadowMapSize=me.mapSize,i.spotShadow[O]=Me,i.spotShadowMap[O]=Ee,q++}O++}else if(K.isRectAreaLight){let xe=t.get(K);xe.color.copy(re).multiplyScalar(ce),xe.halfWidth.set(K.width*.5,0,0),xe.halfHeight.set(0,K.height*.5,0),i.rectArea[T]=xe,T++}else if(K.isPointLight){let xe=t.get(K);if(xe.color.copy(K.color).multiplyScalar(K.intensity),xe.distance=K.distance,xe.decay=K.decay,K.castShadow){let me=K.shadow,Me=e.get(K);Me.shadowIntensity=me.intensity,Me.shadowBias=me.bias,Me.shadowNormalBias=me.normalBias,Me.shadowRadius=me.radius,Me.shadowMapSize=me.mapSize,Me.shadowCameraNear=me.camera.near,Me.shadowCameraFar=me.camera.far,i.pointShadow[A]=Me,i.pointShadowMap[A]=Ee,i.pointShadowMatrix[A]=K.shadow.matrix,Y++}i.point[A]=xe,A++}else if(K.isHemisphereLight){let xe=t.get(K);xe.skyColor.copy(K.color).multiplyScalar(ce),xe.groundColor.copy(K.groundColor).multiplyScalar(ce),i.hemi[M]=xe,M++}}T>0&&(n.has("OES_texture_float_linear")===!0?(i.rectAreaLTC1=Ke.LTC_FLOAT_1,i.rectAreaLTC2=Ke.LTC_FLOAT_2):(i.rectAreaLTC1=Ke.LTC_HALF_1,i.rectAreaLTC2=Ke.LTC_HALF_2)),i.ambient[0]=g,i.ambient[1]=m,i.ambient[2]=x;let oe=i.hash;(oe.directionalLength!==C||oe.pointLength!==A||oe.spotLength!==O||oe.rectAreaLength!==T||oe.hemiLength!==M||oe.numDirectionalShadows!==G||oe.numPointShadows!==Y||oe.numSpotShadows!==q||oe.numSpotMaps!==X||oe.numLightProbes!==J)&&(i.directional.length=C,i.spot.length=O,i.rectArea.length=T,i.point.length=A,i.hemi.length=M,i.directionalShadow.length=G,i.directionalShadowMap.length=G,i.pointShadow.length=Y,i.pointShadowMap.length=Y,i.spotShadow.length=q,i.spotShadowMap.length=q,i.directionalShadowMatrix.length=G,i.pointShadowMatrix.length=Y,i.spotLightMatrix.length=q+X-Z,i.spotLightMap.length=X,i.numSpotLightShadowsWithMaps=Z,i.numLightProbes=J,oe.directionalLength=C,oe.pointLength=A,oe.spotLength=O,oe.rectAreaLength=T,oe.hemiLength=M,oe.numDirectionalShadows=G,oe.numPointShadows=Y,oe.numSpotShadows=q,oe.numSpotMaps=X,oe.numLightProbes=J,i.version=Nz++)}function f(p,g){let m=0,x=0,C=0,A=0,O=0,T=g.matrixWorldInverse;for(let M=0,G=p.length;M<G;M++){let Y=p[M];if(Y.isDirectionalLight){let q=i.directional[m];q.direction.setFromMatrixPosition(Y.matrixWorld),r.setFromMatrixPosition(Y.target.matrixWorld),q.direction.sub(r),q.direction.transformDirection(T),m++}else if(Y.isSpotLight){let q=i.spot[C];q.position.setFromMatrixPosition(Y.matrixWorld),q.position.applyMatrix4(T),q.direction.setFromMatrixPosition(Y.matrixWorld),r.setFromMatrixPosition(Y.target.matrixWorld),q.direction.sub(r),q.direction.transformDirection(T),C++}else if(Y.isRectAreaLight){let q=i.rectArea[A];q.position.setFromMatrixPosition(Y.matrixWorld),q.position.applyMatrix4(T),l.identity(),o.copy(Y.matrixWorld),o.premultiply(T),l.extractRotation(o),q.halfWidth.set(Y.width*.5,0,0),q.halfHeight.set(0,Y.height*.5,0),q.halfWidth.applyMatrix4(l),q.halfHeight.applyMatrix4(l),A++}else if(Y.isPointLight){let q=i.point[x];q.position.setFromMatrixPosition(Y.matrixWorld),q.position.applyMatrix4(T),x++}else if(Y.isHemisphereLight){let q=i.hemi[O];q.direction.setFromMatrixPosition(Y.matrixWorld),q.direction.transformDirection(T),O++}}}return{setup:c,setupView:f,state:i}}function JT(n){let t=new Lz(n),e=[],i=[];function r(g){p.camera=g,e.length=0,i.length=0}function o(g){e.push(g)}function l(g){i.push(g)}function c(){t.setup(e)}function f(g){t.setupView(e,g)}let p={lightsArray:e,shadowsArray:i,camera:null,lights:t,transmissionRenderTarget:{}};return{init:r,state:p,setupLights:c,setupLightsView:f,pushLight:o,pushShadow:l}}function Bz(n){let t=new WeakMap;function e(r,o=0){let l=t.get(r),c;return l===void 0?(c=new JT(n),t.set(r,[c])):o>=l.length?(c=new JT(n),l.push(c)):c=l[o],c}function i(){t=new WeakMap}return{get:e,dispose:i}}var Vz=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,Hz=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,zz=[new ae(1,0,0),new ae(-1,0,0),new ae(0,1,0),new ae(0,-1,0),new ae(0,0,1),new ae(0,0,-1)],jz=[new ae(0,-1,0),new ae(0,-1,0),new ae(0,0,1),new ae(0,0,-1),new ae(0,-1,0),new ae(0,-1,0)],KT=new li,Zf=new ae,mC=new ae;function Wz(n,t,e){let i=new ld,r=new Ft,o=new Ft,l=new ui,c=new y_,f=new x_,p={},g=e.maxTextureSize,m={[na]:yr,[yr]:na,[so]:so},x=new ro({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new Ft},radius:{value:4}},vertexShader:Vz,fragmentShader:Hz}),C=x.clone();C.defines.HORIZONTAL_PASS=1;let A=new Ur;A.setAttribute("position",new no(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let O=new gn(A,x),T=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=zf;let M=this.type;this.render=function(Z,J,oe){if(T.enabled===!1||T.autoUpdate===!1&&T.needsUpdate===!1||Z.length===0)return;Z.type===ZA&&(Mt("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),Z.type=zf);let L=n.getRenderTarget(),z=n.getActiveCubeFace(),K=n.getActiveMipmapLevel(),re=n.state;re.setBlending(ys),re.buffers.depth.getReversed()===!0?re.buffers.color.setClear(0,0,0,0):re.buffers.color.setClear(1,1,1,1),re.buffers.depth.setTest(!0),re.setScissorTest(!1);let ce=M!==this.type;ce&&J.traverse(function(we){we.material&&(Array.isArray(we.material)?we.material.forEach(Ee=>Ee.needsUpdate=!0):we.material.needsUpdate=!0)});for(let we=0,Ee=Z.length;we<Ee;we++){let xe=Z[we],me=xe.shadow;if(me===void 0){Mt("WebGLShadowMap:",xe,"has no shadow.");continue}if(me.autoUpdate===!1&&me.needsUpdate===!1)continue;r.copy(me.mapSize);let Me=me.getFrameExtents();if(r.multiply(Me),o.copy(me.mapSize),(r.x>g||r.y>g)&&(r.x>g&&(o.x=Math.floor(g/Me.x),r.x=o.x*Me.x,me.mapSize.x=o.x),r.y>g&&(o.y=Math.floor(g/Me.y),r.y=o.y*Me.y,me.mapSize.y=o.y)),me.map===null||ce===!0){if(me.map!==null&&(me.map.depthTexture!==null&&(me.map.depthTexture.dispose(),me.map.depthTexture=null),me.map.dispose()),this.type===hd){if(xe.isPointLight){Mt("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}me.map=new io(r.x,r.y,{format:mu,type:xs,minFilter:qi,magFilter:qi,generateMipmaps:!1}),me.map.texture.name=xe.name+".shadowMap",me.map.depthTexture=new qa(r.x,r.y,Xo),me.map.depthTexture.name=xe.name+".shadowMapDepth",me.map.depthTexture.format=gs,me.map.depthTexture.compareFunction=null,me.map.depthTexture.minFilter=zi,me.map.depthTexture.magFilter=zi}else{xe.isPointLight?(me.map=new Pf(r.x),me.map.depthTexture=new __(r.x,qo)):(me.map=new io(r.x,r.y),me.map.depthTexture=new qa(r.x,r.y,qo)),me.map.depthTexture.name=xe.name+".shadowMap",me.map.depthTexture.format=gs;let Be=n.state.buffers.depth.getReversed();this.type===zf?(me.map.depthTexture.compareFunction=Be?T1:A1,me.map.depthTexture.minFilter=qi,me.map.depthTexture.magFilter=qi):(me.map.depthTexture.compareFunction=null,me.map.depthTexture.minFilter=zi,me.map.depthTexture.magFilter=zi)}me.camera.updateProjectionMatrix()}let qe=me.map.isWebGLCubeRenderTarget?6:1;for(let Be=0;Be<qe;Be++){if(me.map.isWebGLCubeRenderTarget)n.setRenderTarget(me.map,Be),n.clear();else{Be===0&&(n.setRenderTarget(me.map),n.clear());let Xe=me.getViewport(Be);l.set(o.x*Xe.x,o.y*Xe.y,o.x*Xe.z,o.y*Xe.w),re.viewport(l)}if(xe.isPointLight){let Xe=me.camera,Et=me.matrix,Re=xe.distance||Xe.far;Re!==Xe.far&&(Xe.far=Re,Xe.updateProjectionMatrix()),Zf.setFromMatrixPosition(xe.matrixWorld),Xe.position.copy(Zf),mC.copy(Xe.position),mC.add(zz[Be]),Xe.up.copy(jz[Be]),Xe.lookAt(mC),Xe.updateMatrixWorld(),Et.makeTranslation(-Zf.x,-Zf.y,-Zf.z),KT.multiplyMatrices(Xe.projectionMatrix,Xe.matrixWorldInverse),me._frustum.setFromProjectionMatrix(KT,Xe.coordinateSystem,Xe.reversedDepth)}else me.updateMatrices(xe);i=me.getFrustum(),q(J,oe,me.camera,xe,this.type)}me.isPointLightShadow!==!0&&this.type===hd&&G(me,oe),me.needsUpdate=!1}M=this.type,T.needsUpdate=!1,n.setRenderTarget(L,z,K)};function G(Z,J){let oe=t.update(O);x.defines.VSM_SAMPLES!==Z.blurSamples&&(x.defines.VSM_SAMPLES=Z.blurSamples,C.defines.VSM_SAMPLES=Z.blurSamples,x.needsUpdate=!0,C.needsUpdate=!0),Z.mapPass===null&&(Z.mapPass=new io(r.x,r.y,{format:mu,type:xs})),x.uniforms.shadow_pass.value=Z.map.depthTexture,x.uniforms.resolution.value=Z.mapSize,x.uniforms.radius.value=Z.radius,n.setRenderTarget(Z.mapPass),n.clear(),n.renderBufferDirect(J,null,oe,x,O,null),C.uniforms.shadow_pass.value=Z.mapPass.texture,C.uniforms.resolution.value=Z.mapSize,C.uniforms.radius.value=Z.radius,n.setRenderTarget(Z.map),n.clear(),n.renderBufferDirect(J,null,oe,C,O,null)}function Y(Z,J,oe,L){let z=null,K=oe.isPointLight===!0?Z.customDistanceMaterial:Z.customDepthMaterial;if(K!==void 0)z=K;else if(z=oe.isPointLight===!0?f:c,n.localClippingEnabled&&J.clipShadows===!0&&Array.isArray(J.clippingPlanes)&&J.clippingPlanes.length!==0||J.displacementMap&&J.displacementScale!==0||J.alphaMap&&J.alphaTest>0||J.map&&J.alphaTest>0||J.alphaToCoverage===!0){let re=z.uuid,ce=J.uuid,we=p[re];we===void 0&&(we={},p[re]=we);let Ee=we[ce];Ee===void 0&&(Ee=z.clone(),we[ce]=Ee,J.addEventListener("dispose",X)),z=Ee}if(z.visible=J.visible,z.wireframe=J.wireframe,L===hd?z.side=J.shadowSide!==null?J.shadowSide:J.side:z.side=J.shadowSide!==null?J.shadowSide:m[J.side],z.alphaMap=J.alphaMap,z.alphaTest=J.alphaToCoverage===!0?.5:J.alphaTest,z.map=J.map,z.clipShadows=J.clipShadows,z.clippingPlanes=J.clippingPlanes,z.clipIntersection=J.clipIntersection,z.displacementMap=J.displacementMap,z.displacementScale=J.displacementScale,z.displacementBias=J.displacementBias,z.wireframeLinewidth=J.wireframeLinewidth,z.linewidth=J.linewidth,oe.isPointLight===!0&&z.isMeshDistanceMaterial===!0){let re=n.properties.get(z);re.light=oe}return z}function q(Z,J,oe,L,z){if(Z.visible===!1)return;if(Z.layers.test(J.layers)&&(Z.isMesh||Z.isLine||Z.isPoints)&&(Z.castShadow||Z.receiveShadow&&z===hd)&&(!Z.frustumCulled||i.intersectsObject(Z))){Z.modelViewMatrix.multiplyMatrices(oe.matrixWorldInverse,Z.matrixWorld);let ce=t.update(Z),we=Z.material;if(Array.isArray(we)){let Ee=ce.groups;for(let xe=0,me=Ee.length;xe<me;xe++){let Me=Ee[xe],qe=we[Me.materialIndex];if(qe&&qe.visible){let Be=Y(Z,qe,L,z);Z.onBeforeShadow(n,Z,J,oe,ce,Be,Me),n.renderBufferDirect(oe,null,ce,Be,Z,Me),Z.onAfterShadow(n,Z,J,oe,ce,Be,Me)}}}else if(we.visible){let Ee=Y(Z,we,L,z);Z.onBeforeShadow(n,Z,J,oe,ce,Ee,null),n.renderBufferDirect(oe,null,ce,Ee,Z,null),Z.onAfterShadow(n,Z,J,oe,ce,Ee,null)}}let re=Z.children;for(let ce=0,we=re.length;ce<we;ce++)q(re[ce],J,oe,L,z)}function X(Z){Z.target.removeEventListener("dispose",X);for(let oe in p){let L=p[oe],z=Z.target.uuid;z in L&&(L[z].dispose(),delete L[z])}}}var Gz={[O_]:F_,[R_]:U_,[k_]:L_,[lu]:N_,[F_]:O_,[U_]:R_,[L_]:k_,[N_]:lu};function $z(n,t){function e(){let ne=!1,ze=new ui,Ue=null,Je=new ui(0,0,0,0);return{setMask:function(ue){Ue!==ue&&!ne&&(n.colorMask(ue,ue,ue,ue),Ue=ue)},setLocked:function(ue){ne=ue},setClear:function(ue,Te,Ge,vt,Wt){Wt===!0&&(ue*=vt,Te*=vt,Ge*=vt),ze.set(ue,Te,Ge,vt),Je.equals(ze)===!1&&(n.clearColor(ue,Te,Ge,vt),Je.copy(ze))},reset:function(){ne=!1,Ue=null,Je.set(-1,0,0,0)}}}function i(){let ne=!1,ze=!1,Ue=null,Je=null,ue=null;return{setReversed:function(Te){if(ze!==Te){let Ge=t.get("EXT_clip_control");Te?Ge.clipControlEXT(Ge.LOWER_LEFT_EXT,Ge.ZERO_TO_ONE_EXT):Ge.clipControlEXT(Ge.LOWER_LEFT_EXT,Ge.NEGATIVE_ONE_TO_ONE_EXT),ze=Te;let vt=ue;ue=null,this.setClear(vt)}},getReversed:function(){return ze},setTest:function(Te){Te?De(n.DEPTH_TEST):rt(n.DEPTH_TEST)},setMask:function(Te){Ue!==Te&&!ne&&(n.depthMask(Te),Ue=Te)},setFunc:function(Te){if(ze&&(Te=Gz[Te]),Je!==Te){switch(Te){case O_:n.depthFunc(n.NEVER);break;case F_:n.depthFunc(n.ALWAYS);break;case R_:n.depthFunc(n.LESS);break;case lu:n.depthFunc(n.LEQUAL);break;case k_:n.depthFunc(n.EQUAL);break;case N_:n.depthFunc(n.GEQUAL);break;case U_:n.depthFunc(n.GREATER);break;case L_:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}Je=Te}},setLocked:function(Te){ne=Te},setClear:function(Te){ue!==Te&&(ze&&(Te=1-Te),n.clearDepth(Te),ue=Te)},reset:function(){ne=!1,Ue=null,Je=null,ue=null,ze=!1}}}function r(){let ne=!1,ze=null,Ue=null,Je=null,ue=null,Te=null,Ge=null,vt=null,Wt=null;return{setTest:function(st){ne||(st?De(n.STENCIL_TEST):rt(n.STENCIL_TEST))},setMask:function(st){ze!==st&&!ne&&(n.stencilMask(st),ze=st)},setFunc:function(st,Xi,$t){(Ue!==st||Je!==Xi||ue!==$t)&&(n.stencilFunc(st,Xi,$t),Ue=st,Je=Xi,ue=$t)},setOp:function(st,Xi,$t){(Te!==st||Ge!==Xi||vt!==$t)&&(n.stencilOp(st,Xi,$t),Te=st,Ge=Xi,vt=$t)},setLocked:function(st){ne=st},setClear:function(st){Wt!==st&&(n.clearStencil(st),Wt=st)},reset:function(){ne=!1,ze=null,Ue=null,Je=null,ue=null,Te=null,Ge=null,vt=null,Wt=null}}}let o=new e,l=new i,c=new r,f=new WeakMap,p=new WeakMap,g={},m={},x=new WeakMap,C=[],A=null,O=!1,T=null,M=null,G=null,Y=null,q=null,X=null,Z=null,J=new Zt(0,0,0),oe=0,L=!1,z=null,K=null,re=null,ce=null,we=null,Ee=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS),xe=!1,me=0,Me=n.getParameter(n.VERSION);Me.indexOf("WebGL")!==-1?(me=parseFloat(/^WebGL (\d)/.exec(Me)[1]),xe=me>=1):Me.indexOf("OpenGL ES")!==-1&&(me=parseFloat(/^OpenGL ES (\d)/.exec(Me)[1]),xe=me>=2);let qe=null,Be={},Xe=n.getParameter(n.SCISSOR_BOX),Et=n.getParameter(n.VIEWPORT),Re=new ui().fromArray(Xe),wn=new ui().fromArray(Et);function xn(ne,ze,Ue,Je){let ue=new Uint8Array(4),Te=n.createTexture();n.bindTexture(ne,Te),n.texParameteri(ne,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(ne,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let Ge=0;Ge<Ue;Ge++)ne===n.TEXTURE_3D||ne===n.TEXTURE_2D_ARRAY?n.texImage3D(ze,0,n.RGBA,1,1,Je,0,n.RGBA,n.UNSIGNED_BYTE,ue):n.texImage2D(ze+Ge,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ue);return Te}let Se={};Se[n.TEXTURE_2D]=xn(n.TEXTURE_2D,n.TEXTURE_2D,1),Se[n.TEXTURE_CUBE_MAP]=xn(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),Se[n.TEXTURE_2D_ARRAY]=xn(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Se[n.TEXTURE_3D]=xn(n.TEXTURE_3D,n.TEXTURE_3D,1,1),o.setClear(0,0,0,1),l.setClear(1),c.setClear(0),De(n.DEPTH_TEST),l.setFunc(lu),Nt(!1),un(kb),De(n.CULL_FACE),It(ys);function De(ne){g[ne]!==!0&&(n.enable(ne),g[ne]=!0)}function rt(ne){g[ne]!==!1&&(n.disable(ne),g[ne]=!1)}function Pt(ne,ze){return m[ne]!==ze?(n.bindFramebuffer(ne,ze),m[ne]=ze,ne===n.DRAW_FRAMEBUFFER&&(m[n.FRAMEBUFFER]=ze),ne===n.FRAMEBUFFER&&(m[n.DRAW_FRAMEBUFFER]=ze),!0):!1}function ft(ne,ze){let Ue=C,Je=!1;if(ne){Ue=x.get(ze),Ue===void 0&&(Ue=[],x.set(ze,Ue));let ue=ne.textures;if(Ue.length!==ue.length||Ue[0]!==n.COLOR_ATTACHMENT0){for(let Te=0,Ge=ue.length;Te<Ge;Te++)Ue[Te]=n.COLOR_ATTACHMENT0+Te;Ue.length=ue.length,Je=!0}}else Ue[0]!==n.BACK&&(Ue[0]=n.BACK,Je=!0);Je&&n.drawBuffers(Ue)}function tn(ne){return A!==ne?(n.useProgram(ne),A=ne,!0):!1}let Xn={[Wa]:n.FUNC_ADD,[KA]:n.FUNC_SUBTRACT,[QA]:n.FUNC_REVERSE_SUBTRACT};Xn[eT]=n.MIN,Xn[tT]=n.MAX;let sn={[nT]:n.ZERO,[iT]:n.ONE,[rT]:n.SRC_COLOR,[r_]:n.SRC_ALPHA,[cT]:n.SRC_ALPHA_SATURATE,[lT]:n.DST_COLOR,[sT]:n.DST_ALPHA,[oT]:n.ONE_MINUS_SRC_COLOR,[o_]:n.ONE_MINUS_SRC_ALPHA,[uT]:n.ONE_MINUS_DST_COLOR,[aT]:n.ONE_MINUS_DST_ALPHA,[dT]:n.CONSTANT_COLOR,[fT]:n.ONE_MINUS_CONSTANT_COLOR,[hT]:n.CONSTANT_ALPHA,[pT]:n.ONE_MINUS_CONSTANT_ALPHA};function It(ne,ze,Ue,Je,ue,Te,Ge,vt,Wt,st){if(ne===ys){O===!0&&(rt(n.BLEND),O=!1);return}if(O===!1&&(De(n.BLEND),O=!0),ne!==JA){if(ne!==T||st!==L){if((M!==Wa||q!==Wa)&&(n.blendEquation(n.FUNC_ADD),M=Wa,q=Wa),st)switch(ne){case au:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Nb:n.blendFunc(n.ONE,n.ONE);break;case Ub:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case Lb:n.blendFuncSeparate(n.DST_COLOR,n.ONE_MINUS_SRC_ALPHA,n.ZERO,n.ONE);break;default:At("WebGLState: Invalid blending: ",ne);break}else switch(ne){case au:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Nb:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE,n.ONE,n.ONE);break;case Ub:At("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case Lb:At("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:At("WebGLState: Invalid blending: ",ne);break}G=null,Y=null,X=null,Z=null,J.set(0,0,0),oe=0,T=ne,L=st}return}ue=ue||ze,Te=Te||Ue,Ge=Ge||Je,(ze!==M||ue!==q)&&(n.blendEquationSeparate(Xn[ze],Xn[ue]),M=ze,q=ue),(Ue!==G||Je!==Y||Te!==X||Ge!==Z)&&(n.blendFuncSeparate(sn[Ue],sn[Je],sn[Te],sn[Ge]),G=Ue,Y=Je,X=Te,Z=Ge),(vt.equals(J)===!1||Wt!==oe)&&(n.blendColor(vt.r,vt.g,vt.b,Wt),J.copy(vt),oe=Wt),T=ne,L=!1}function Kt(ne,ze){ne.side===so?rt(n.CULL_FACE):De(n.CULL_FACE);let Ue=ne.side===yr;ze&&(Ue=!Ue),Nt(Ue),ne.blending===au&&ne.transparent===!1?It(ys):It(ne.blending,ne.blendEquation,ne.blendSrc,ne.blendDst,ne.blendEquationAlpha,ne.blendSrcAlpha,ne.blendDstAlpha,ne.blendColor,ne.blendAlpha,ne.premultipliedAlpha),l.setFunc(ne.depthFunc),l.setTest(ne.depthTest),l.setMask(ne.depthWrite),o.setMask(ne.colorWrite);let Je=ne.stencilWrite;c.setTest(Je),Je&&(c.setMask(ne.stencilWriteMask),c.setFunc(ne.stencilFunc,ne.stencilRef,ne.stencilFuncMask),c.setOp(ne.stencilFail,ne.stencilZFail,ne.stencilZPass)),cn(ne.polygonOffset,ne.polygonOffsetFactor,ne.polygonOffsetUnits),ne.alphaToCoverage===!0?De(n.SAMPLE_ALPHA_TO_COVERAGE):rt(n.SAMPLE_ALPHA_TO_COVERAGE)}function Nt(ne){z!==ne&&(ne?n.frontFace(n.CW):n.frontFace(n.CCW),z=ne)}function un(ne){ne!==qA?(De(n.CULL_FACE),ne!==K&&(ne===kb?n.cullFace(n.BACK):ne===XA?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):rt(n.CULL_FACE),K=ne}function Q(ne){ne!==re&&(xe&&n.lineWidth(ne),re=ne)}function cn(ne,ze,Ue){ne?(De(n.POLYGON_OFFSET_FILL),(ce!==ze||we!==Ue)&&(n.polygonOffset(ze,Ue),ce=ze,we=Ue)):rt(n.POLYGON_OFFSET_FILL)}function an(ne){ne?De(n.SCISSOR_TEST):rt(n.SCISSOR_TEST)}function gt(ne){ne===void 0&&(ne=n.TEXTURE0+Ee-1),qe!==ne&&(n.activeTexture(ne),qe=ne)}function Qe(ne,ze,Ue){Ue===void 0&&(qe===null?Ue=n.TEXTURE0+Ee-1:Ue=qe);let Je=Be[Ue];Je===void 0&&(Je={type:void 0,texture:void 0},Be[Ue]=Je),(Je.type!==ne||Je.texture!==ze)&&(qe!==Ue&&(n.activeTexture(Ue),qe=Ue),n.bindTexture(ne,ze||Se[ne]),Je.type=ne,Je.texture=ze)}function W(){let ne=Be[qe];ne!==void 0&&ne.type!==void 0&&(n.bindTexture(ne.type,null),ne.type=void 0,ne.texture=void 0)}function k(){try{n.compressedTexImage2D(...arguments)}catch(ne){At("WebGLState:",ne)}}function te(){try{n.compressedTexImage3D(...arguments)}catch(ne){At("WebGLState:",ne)}}function ge(){try{n.texSubImage2D(...arguments)}catch(ne){At("WebGLState:",ne)}}function Ae(){try{n.texSubImage3D(...arguments)}catch(ne){At("WebGLState:",ne)}}function de(){try{n.compressedTexSubImage2D(...arguments)}catch(ne){At("WebGLState:",ne)}}function ct(){try{n.compressedTexSubImage3D(...arguments)}catch(ne){At("WebGLState:",ne)}}function ke(){try{n.texStorage2D(...arguments)}catch(ne){At("WebGLState:",ne)}}function dt(){try{n.texStorage3D(...arguments)}catch(ne){At("WebGLState:",ne)}}function xt(){try{n.texImage2D(...arguments)}catch(ne){At("WebGLState:",ne)}}function Fe(){try{n.texImage3D(...arguments)}catch(ne){At("WebGLState:",ne)}}function He(ne){Re.equals(ne)===!1&&(n.scissor(ne.x,ne.y,ne.z,ne.w),Re.copy(ne))}function tt(ne){wn.equals(ne)===!1&&(n.viewport(ne.x,ne.y,ne.z,ne.w),wn.copy(ne))}function ht(ne,ze){let Ue=p.get(ze);Ue===void 0&&(Ue=new WeakMap,p.set(ze,Ue));let Je=Ue.get(ne);Je===void 0&&(Je=n.getUniformBlockIndex(ze,ne.name),Ue.set(ne,Je))}function je(ne,ze){let Je=p.get(ze).get(ne);f.get(ze)!==Je&&(n.uniformBlockBinding(ze,Je,ne.__bindingPointIndex),f.set(ze,Je))}function Ut(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),l.setReversed(!1),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),g={},qe=null,Be={},m={},x=new WeakMap,C=[],A=null,O=!1,T=null,M=null,G=null,Y=null,q=null,X=null,Z=null,J=new Zt(0,0,0),oe=0,L=!1,z=null,K=null,re=null,ce=null,we=null,Re.set(0,0,n.canvas.width,n.canvas.height),wn.set(0,0,n.canvas.width,n.canvas.height),o.reset(),l.reset(),c.reset()}return{buffers:{color:o,depth:l,stencil:c},enable:De,disable:rt,bindFramebuffer:Pt,drawBuffers:ft,useProgram:tn,setBlending:It,setMaterial:Kt,setFlipSided:Nt,setCullFace:un,setLineWidth:Q,setPolygonOffset:cn,setScissorTest:an,activeTexture:gt,bindTexture:Qe,unbindTexture:W,compressedTexImage2D:k,compressedTexImage3D:te,texImage2D:xt,texImage3D:Fe,updateUBOMapping:ht,uniformBlockBinding:je,texStorage2D:ke,texStorage3D:dt,texSubImage2D:ge,texSubImage3D:Ae,compressedTexSubImage2D:de,compressedTexSubImage3D:ct,scissor:He,viewport:tt,reset:Ut}}function Yz(n,t,e,i,r,o,l){let c=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),p=new Ft,g=new WeakMap,m,x=new WeakMap,C=!1;try{C=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function A(W,k){return C?new OffscreenCanvas(W,k):nd("canvas")}function O(W,k,te){let ge=1,Ae=Qe(W);if((Ae.width>te||Ae.height>te)&&(ge=te/Math.max(Ae.width,Ae.height)),ge<1)if(typeof HTMLImageElement<"u"&&W instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&W instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&W instanceof ImageBitmap||typeof VideoFrame<"u"&&W instanceof VideoFrame){let de=Math.floor(ge*Ae.width),ct=Math.floor(ge*Ae.height);m===void 0&&(m=A(de,ct));let ke=k?A(de,ct):m;return ke.width=de,ke.height=ct,ke.getContext("2d").drawImage(W,0,0,de,ct),Mt("WebGLRenderer: Texture has been resized from ("+Ae.width+"x"+Ae.height+") to ("+de+"x"+ct+")."),ke}else return"data"in W&&Mt("WebGLRenderer: Image in DataTexture is too big ("+Ae.width+"x"+Ae.height+")."),W;return W}function T(W){return W.generateMipmaps}function M(W){n.generateMipmap(W)}function G(W){return W.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:W.isWebGL3DRenderTarget?n.TEXTURE_3D:W.isWebGLArrayRenderTarget||W.isCompressedArrayTexture?n.TEXTURE_2D_ARRAY:n.TEXTURE_2D}function Y(W,k,te,ge,Ae=!1){if(W!==null){if(n[W]!==void 0)return n[W];Mt("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+W+"'")}let de=k;if(k===n.RED&&(te===n.FLOAT&&(de=n.R32F),te===n.HALF_FLOAT&&(de=n.R16F),te===n.UNSIGNED_BYTE&&(de=n.R8)),k===n.RED_INTEGER&&(te===n.UNSIGNED_BYTE&&(de=n.R8UI),te===n.UNSIGNED_SHORT&&(de=n.R16UI),te===n.UNSIGNED_INT&&(de=n.R32UI),te===n.BYTE&&(de=n.R8I),te===n.SHORT&&(de=n.R16I),te===n.INT&&(de=n.R32I)),k===n.RG&&(te===n.FLOAT&&(de=n.RG32F),te===n.HALF_FLOAT&&(de=n.RG16F),te===n.UNSIGNED_BYTE&&(de=n.RG8)),k===n.RG_INTEGER&&(te===n.UNSIGNED_BYTE&&(de=n.RG8UI),te===n.UNSIGNED_SHORT&&(de=n.RG16UI),te===n.UNSIGNED_INT&&(de=n.RG32UI),te===n.BYTE&&(de=n.RG8I),te===n.SHORT&&(de=n.RG16I),te===n.INT&&(de=n.RG32I)),k===n.RGB_INTEGER&&(te===n.UNSIGNED_BYTE&&(de=n.RGB8UI),te===n.UNSIGNED_SHORT&&(de=n.RGB16UI),te===n.UNSIGNED_INT&&(de=n.RGB32UI),te===n.BYTE&&(de=n.RGB8I),te===n.SHORT&&(de=n.RGB16I),te===n.INT&&(de=n.RGB32I)),k===n.RGBA_INTEGER&&(te===n.UNSIGNED_BYTE&&(de=n.RGBA8UI),te===n.UNSIGNED_SHORT&&(de=n.RGBA16UI),te===n.UNSIGNED_INT&&(de=n.RGBA32UI),te===n.BYTE&&(de=n.RGBA8I),te===n.SHORT&&(de=n.RGBA16I),te===n.INT&&(de=n.RGBA32I)),k===n.RGB&&(te===n.UNSIGNED_INT_5_9_9_9_REV&&(de=n.RGB9_E5),te===n.UNSIGNED_INT_10F_11F_11F_REV&&(de=n.R11F_G11F_B10F)),k===n.RGBA){let ct=Ae?Cf:yn.getTransfer(ge);te===n.FLOAT&&(de=n.RGBA32F),te===n.HALF_FLOAT&&(de=n.RGBA16F),te===n.UNSIGNED_BYTE&&(de=ct===Pn?n.SRGB8_ALPHA8:n.RGBA8),te===n.UNSIGNED_SHORT_4_4_4_4&&(de=n.RGBA4),te===n.UNSIGNED_SHORT_5_5_5_1&&(de=n.RGB5_A1)}return(de===n.R16F||de===n.R32F||de===n.RG16F||de===n.RG32F||de===n.RGBA16F||de===n.RGBA32F)&&t.get("EXT_color_buffer_float"),de}function q(W,k){let te;return W?k===null||k===qo||k===md?te=n.DEPTH24_STENCIL8:k===Xo?te=n.DEPTH32F_STENCIL8:k===pd&&(te=n.DEPTH24_STENCIL8,Mt("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):k===null||k===qo||k===md?te=n.DEPTH_COMPONENT24:k===Xo?te=n.DEPTH_COMPONENT32F:k===pd&&(te=n.DEPTH_COMPONENT16),te}function X(W,k){return T(W)===!0||W.isFramebufferTexture&&W.minFilter!==zi&&W.minFilter!==qi?Math.log2(Math.max(k.width,k.height))+1:W.mipmaps!==void 0&&W.mipmaps.length>0?W.mipmaps.length:W.isCompressedTexture&&Array.isArray(W.image)?k.mipmaps.length:1}function Z(W){let k=W.target;k.removeEventListener("dispose",Z),oe(k),k.isVideoTexture&&g.delete(k)}function J(W){let k=W.target;k.removeEventListener("dispose",J),z(k)}function oe(W){let k=i.get(W);if(k.__webglInit===void 0)return;let te=W.source,ge=x.get(te);if(ge){let Ae=ge[k.__cacheKey];Ae.usedTimes--,Ae.usedTimes===0&&L(W),Object.keys(ge).length===0&&x.delete(te)}i.remove(W)}function L(W){let k=i.get(W);n.deleteTexture(k.__webglTexture);let te=W.source,ge=x.get(te);delete ge[k.__cacheKey],l.memory.textures--}function z(W){let k=i.get(W);if(W.depthTexture&&(W.depthTexture.dispose(),i.remove(W.depthTexture)),W.isWebGLCubeRenderTarget)for(let ge=0;ge<6;ge++){if(Array.isArray(k.__webglFramebuffer[ge]))for(let Ae=0;Ae<k.__webglFramebuffer[ge].length;Ae++)n.deleteFramebuffer(k.__webglFramebuffer[ge][Ae]);else n.deleteFramebuffer(k.__webglFramebuffer[ge]);k.__webglDepthbuffer&&n.deleteRenderbuffer(k.__webglDepthbuffer[ge])}else{if(Array.isArray(k.__webglFramebuffer))for(let ge=0;ge<k.__webglFramebuffer.length;ge++)n.deleteFramebuffer(k.__webglFramebuffer[ge]);else n.deleteFramebuffer(k.__webglFramebuffer);if(k.__webglDepthbuffer&&n.deleteRenderbuffer(k.__webglDepthbuffer),k.__webglMultisampledFramebuffer&&n.deleteFramebuffer(k.__webglMultisampledFramebuffer),k.__webglColorRenderbuffer)for(let ge=0;ge<k.__webglColorRenderbuffer.length;ge++)k.__webglColorRenderbuffer[ge]&&n.deleteRenderbuffer(k.__webglColorRenderbuffer[ge]);k.__webglDepthRenderbuffer&&n.deleteRenderbuffer(k.__webglDepthRenderbuffer)}let te=W.textures;for(let ge=0,Ae=te.length;ge<Ae;ge++){let de=i.get(te[ge]);de.__webglTexture&&(n.deleteTexture(de.__webglTexture),l.memory.textures--),i.remove(te[ge])}i.remove(W)}let K=0;function re(){K=0}function ce(){let W=K;return W>=r.maxTextures&&Mt("WebGLTextures: Trying to use "+W+" texture units while this GPU supports only "+r.maxTextures),K+=1,W}function we(W){let k=[];return k.push(W.wrapS),k.push(W.wrapT),k.push(W.wrapR||0),k.push(W.magFilter),k.push(W.minFilter),k.push(W.anisotropy),k.push(W.internalFormat),k.push(W.format),k.push(W.type),k.push(W.generateMipmaps),k.push(W.premultiplyAlpha),k.push(W.flipY),k.push(W.unpackAlignment),k.push(W.colorSpace),k.join()}function Ee(W,k){let te=i.get(W);if(W.isVideoTexture&&an(W),W.isRenderTargetTexture===!1&&W.isExternalTexture!==!0&&W.version>0&&te.__version!==W.version){let ge=W.image;if(ge===null)Mt("WebGLRenderer: Texture marked for update but no image data found.");else if(ge.complete===!1)Mt("WebGLRenderer: Texture marked for update but image is incomplete");else{Se(te,W,k);return}}else W.isExternalTexture&&(te.__webglTexture=W.sourceTexture?W.sourceTexture:null);e.bindTexture(n.TEXTURE_2D,te.__webglTexture,n.TEXTURE0+k)}function xe(W,k){let te=i.get(W);if(W.isRenderTargetTexture===!1&&W.version>0&&te.__version!==W.version){Se(te,W,k);return}else W.isExternalTexture&&(te.__webglTexture=W.sourceTexture?W.sourceTexture:null);e.bindTexture(n.TEXTURE_2D_ARRAY,te.__webglTexture,n.TEXTURE0+k)}function me(W,k){let te=i.get(W);if(W.isRenderTargetTexture===!1&&W.version>0&&te.__version!==W.version){Se(te,W,k);return}e.bindTexture(n.TEXTURE_3D,te.__webglTexture,n.TEXTURE0+k)}function Me(W,k){let te=i.get(W);if(W.isCubeDepthTexture!==!0&&W.version>0&&te.__version!==W.version){De(te,W,k);return}e.bindTexture(n.TEXTURE_CUBE_MAP,te.__webglTexture,n.TEXTURE0+k)}let qe={[uu]:n.REPEAT,[ms]:n.CLAMP_TO_EDGE,[s_]:n.MIRRORED_REPEAT},Be={[zi]:n.NEAREST,[_T]:n.NEAREST_MIPMAP_NEAREST,[Wf]:n.NEAREST_MIPMAP_LINEAR,[qi]:n.LINEAR,[z_]:n.LINEAR_MIPMAP_NEAREST,[el]:n.LINEAR_MIPMAP_LINEAR},Xe={[xT]:n.NEVER,[ST]:n.ALWAYS,[bT]:n.LESS,[A1]:n.LEQUAL,[CT]:n.EQUAL,[T1]:n.GEQUAL,[ET]:n.GREATER,[wT]:n.NOTEQUAL};function Et(W,k){if(k.type===Xo&&t.has("OES_texture_float_linear")===!1&&(k.magFilter===qi||k.magFilter===z_||k.magFilter===Wf||k.magFilter===el||k.minFilter===qi||k.minFilter===z_||k.minFilter===Wf||k.minFilter===el)&&Mt("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),n.texParameteri(W,n.TEXTURE_WRAP_S,qe[k.wrapS]),n.texParameteri(W,n.TEXTURE_WRAP_T,qe[k.wrapT]),(W===n.TEXTURE_3D||W===n.TEXTURE_2D_ARRAY)&&n.texParameteri(W,n.TEXTURE_WRAP_R,qe[k.wrapR]),n.texParameteri(W,n.TEXTURE_MAG_FILTER,Be[k.magFilter]),n.texParameteri(W,n.TEXTURE_MIN_FILTER,Be[k.minFilter]),k.compareFunction&&(n.texParameteri(W,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(W,n.TEXTURE_COMPARE_FUNC,Xe[k.compareFunction])),t.has("EXT_texture_filter_anisotropic")===!0){if(k.magFilter===zi||k.minFilter!==Wf&&k.minFilter!==el||k.type===Xo&&t.has("OES_texture_float_linear")===!1)return;if(k.anisotropy>1||i.get(k).__currentAnisotropy){let te=t.get("EXT_texture_filter_anisotropic");n.texParameterf(W,te.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(k.anisotropy,r.getMaxAnisotropy())),i.get(k).__currentAnisotropy=k.anisotropy}}}function Re(W,k){let te=!1;W.__webglInit===void 0&&(W.__webglInit=!0,k.addEventListener("dispose",Z));let ge=k.source,Ae=x.get(ge);Ae===void 0&&(Ae={},x.set(ge,Ae));let de=we(k);if(de!==W.__cacheKey){Ae[de]===void 0&&(Ae[de]={texture:n.createTexture(),usedTimes:0},l.memory.textures++,te=!0),Ae[de].usedTimes++;let ct=Ae[W.__cacheKey];ct!==void 0&&(Ae[W.__cacheKey].usedTimes--,ct.usedTimes===0&&L(k)),W.__cacheKey=de,W.__webglTexture=Ae[de].texture}return te}function wn(W,k,te){return Math.floor(Math.floor(W/te)/k)}function xn(W,k,te,ge){let de=W.updateRanges;if(de.length===0)e.texSubImage2D(n.TEXTURE_2D,0,0,0,k.width,k.height,te,ge,k.data);else{de.sort((Fe,He)=>Fe.start-He.start);let ct=0;for(let Fe=1;Fe<de.length;Fe++){let He=de[ct],tt=de[Fe],ht=He.start+He.count,je=wn(tt.start,k.width,4),Ut=wn(He.start,k.width,4);tt.start<=ht+1&&je===Ut&&wn(tt.start+tt.count-1,k.width,4)===je?He.count=Math.max(He.count,tt.start+tt.count-He.start):(++ct,de[ct]=tt)}de.length=ct+1;let ke=n.getParameter(n.UNPACK_ROW_LENGTH),dt=n.getParameter(n.UNPACK_SKIP_PIXELS),xt=n.getParameter(n.UNPACK_SKIP_ROWS);n.pixelStorei(n.UNPACK_ROW_LENGTH,k.width);for(let Fe=0,He=de.length;Fe<He;Fe++){let tt=de[Fe],ht=Math.floor(tt.start/4),je=Math.ceil(tt.count/4),Ut=ht%k.width,ne=Math.floor(ht/k.width),ze=je,Ue=1;n.pixelStorei(n.UNPACK_SKIP_PIXELS,Ut),n.pixelStorei(n.UNPACK_SKIP_ROWS,ne),e.texSubImage2D(n.TEXTURE_2D,0,Ut,ne,ze,Ue,te,ge,k.data)}W.clearUpdateRanges(),n.pixelStorei(n.UNPACK_ROW_LENGTH,ke),n.pixelStorei(n.UNPACK_SKIP_PIXELS,dt),n.pixelStorei(n.UNPACK_SKIP_ROWS,xt)}}function Se(W,k,te){let ge=n.TEXTURE_2D;(k.isDataArrayTexture||k.isCompressedArrayTexture)&&(ge=n.TEXTURE_2D_ARRAY),k.isData3DTexture&&(ge=n.TEXTURE_3D);let Ae=Re(W,k),de=k.source;e.bindTexture(ge,W.__webglTexture,n.TEXTURE0+te);let ct=i.get(de);if(de.version!==ct.__version||Ae===!0){e.activeTexture(n.TEXTURE0+te);let ke=yn.getPrimaries(yn.workingColorSpace),dt=k.colorSpace===ra?null:yn.getPrimaries(k.colorSpace),xt=k.colorSpace===ra||ke===dt?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,k.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,k.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,xt);let Fe=O(k.image,!1,r.maxTextureSize);Fe=gt(k,Fe);let He=o.convert(k.format,k.colorSpace),tt=o.convert(k.type),ht=Y(k.internalFormat,He,tt,k.colorSpace,k.isVideoTexture);Et(ge,k);let je,Ut=k.mipmaps,ne=k.isVideoTexture!==!0,ze=ct.__version===void 0||Ae===!0,Ue=de.dataReady,Je=X(k,Fe);if(k.isDepthTexture)ht=q(k.format===tl,k.type),ze&&(ne?e.texStorage2D(n.TEXTURE_2D,1,ht,Fe.width,Fe.height):e.texImage2D(n.TEXTURE_2D,0,ht,Fe.width,Fe.height,0,He,tt,null));else if(k.isDataTexture)if(Ut.length>0){ne&&ze&&e.texStorage2D(n.TEXTURE_2D,Je,ht,Ut[0].width,Ut[0].height);for(let ue=0,Te=Ut.length;ue<Te;ue++)je=Ut[ue],ne?Ue&&e.texSubImage2D(n.TEXTURE_2D,ue,0,0,je.width,je.height,He,tt,je.data):e.texImage2D(n.TEXTURE_2D,ue,ht,je.width,je.height,0,He,tt,je.data);k.generateMipmaps=!1}else ne?(ze&&e.texStorage2D(n.TEXTURE_2D,Je,ht,Fe.width,Fe.height),Ue&&xn(k,Fe,He,tt)):e.texImage2D(n.TEXTURE_2D,0,ht,Fe.width,Fe.height,0,He,tt,Fe.data);else if(k.isCompressedTexture)if(k.isCompressedArrayTexture){ne&&ze&&e.texStorage3D(n.TEXTURE_2D_ARRAY,Je,ht,Ut[0].width,Ut[0].height,Fe.depth);for(let ue=0,Te=Ut.length;ue<Te;ue++)if(je=Ut[ue],k.format!==Mo)if(He!==null)if(ne){if(Ue)if(k.layerUpdates.size>0){let Ge=uC(je.width,je.height,k.format,k.type);for(let vt of k.layerUpdates){let Wt=je.data.subarray(vt*Ge/je.data.BYTES_PER_ELEMENT,(vt+1)*Ge/je.data.BYTES_PER_ELEMENT);e.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,ue,0,0,vt,je.width,je.height,1,He,Wt)}k.clearLayerUpdates()}else e.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,ue,0,0,0,je.width,je.height,Fe.depth,He,je.data)}else e.compressedTexImage3D(n.TEXTURE_2D_ARRAY,ue,ht,je.width,je.height,Fe.depth,0,je.data,0,0);else Mt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else ne?Ue&&e.texSubImage3D(n.TEXTURE_2D_ARRAY,ue,0,0,0,je.width,je.height,Fe.depth,He,tt,je.data):e.texImage3D(n.TEXTURE_2D_ARRAY,ue,ht,je.width,je.height,Fe.depth,0,He,tt,je.data)}else{ne&&ze&&e.texStorage2D(n.TEXTURE_2D,Je,ht,Ut[0].width,Ut[0].height);for(let ue=0,Te=Ut.length;ue<Te;ue++)je=Ut[ue],k.format!==Mo?He!==null?ne?Ue&&e.compressedTexSubImage2D(n.TEXTURE_2D,ue,0,0,je.width,je.height,He,je.data):e.compressedTexImage2D(n.TEXTURE_2D,ue,ht,je.width,je.height,0,je.data):Mt("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ne?Ue&&e.texSubImage2D(n.TEXTURE_2D,ue,0,0,je.width,je.height,He,tt,je.data):e.texImage2D(n.TEXTURE_2D,ue,ht,je.width,je.height,0,He,tt,je.data)}else if(k.isDataArrayTexture)if(ne){if(ze&&e.texStorage3D(n.TEXTURE_2D_ARRAY,Je,ht,Fe.width,Fe.height,Fe.depth),Ue)if(k.layerUpdates.size>0){let ue=uC(Fe.width,Fe.height,k.format,k.type);for(let Te of k.layerUpdates){let Ge=Fe.data.subarray(Te*ue/Fe.data.BYTES_PER_ELEMENT,(Te+1)*ue/Fe.data.BYTES_PER_ELEMENT);e.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,Te,Fe.width,Fe.height,1,He,tt,Ge)}k.clearLayerUpdates()}else e.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Fe.width,Fe.height,Fe.depth,He,tt,Fe.data)}else e.texImage3D(n.TEXTURE_2D_ARRAY,0,ht,Fe.width,Fe.height,Fe.depth,0,He,tt,Fe.data);else if(k.isData3DTexture)ne?(ze&&e.texStorage3D(n.TEXTURE_3D,Je,ht,Fe.width,Fe.height,Fe.depth),Ue&&e.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Fe.width,Fe.height,Fe.depth,He,tt,Fe.data)):e.texImage3D(n.TEXTURE_3D,0,ht,Fe.width,Fe.height,Fe.depth,0,He,tt,Fe.data);else if(k.isFramebufferTexture){if(ze)if(ne)e.texStorage2D(n.TEXTURE_2D,Je,ht,Fe.width,Fe.height);else{let ue=Fe.width,Te=Fe.height;for(let Ge=0;Ge<Je;Ge++)e.texImage2D(n.TEXTURE_2D,Ge,ht,ue,Te,0,He,tt,null),ue>>=1,Te>>=1}}else if(Ut.length>0){if(ne&&ze){let ue=Qe(Ut[0]);e.texStorage2D(n.TEXTURE_2D,Je,ht,ue.width,ue.height)}for(let ue=0,Te=Ut.length;ue<Te;ue++)je=Ut[ue],ne?Ue&&e.texSubImage2D(n.TEXTURE_2D,ue,0,0,He,tt,je):e.texImage2D(n.TEXTURE_2D,ue,ht,He,tt,je);k.generateMipmaps=!1}else if(ne){if(ze){let ue=Qe(Fe);e.texStorage2D(n.TEXTURE_2D,Je,ht,ue.width,ue.height)}Ue&&e.texSubImage2D(n.TEXTURE_2D,0,0,0,He,tt,Fe)}else e.texImage2D(n.TEXTURE_2D,0,ht,He,tt,Fe);T(k)&&M(ge),ct.__version=de.version,k.onUpdate&&k.onUpdate(k)}W.__version=k.version}function De(W,k,te){if(k.image.length!==6)return;let ge=Re(W,k),Ae=k.source;e.bindTexture(n.TEXTURE_CUBE_MAP,W.__webglTexture,n.TEXTURE0+te);let de=i.get(Ae);if(Ae.version!==de.__version||ge===!0){e.activeTexture(n.TEXTURE0+te);let ct=yn.getPrimaries(yn.workingColorSpace),ke=k.colorSpace===ra?null:yn.getPrimaries(k.colorSpace),dt=k.colorSpace===ra||ct===ke?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,k.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,k.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,dt);let xt=k.isCompressedTexture||k.image[0].isCompressedTexture,Fe=k.image[0]&&k.image[0].isDataTexture,He=[];for(let Te=0;Te<6;Te++)!xt&&!Fe?He[Te]=O(k.image[Te],!0,r.maxCubemapSize):He[Te]=Fe?k.image[Te].image:k.image[Te],He[Te]=gt(k,He[Te]);let tt=He[0],ht=o.convert(k.format,k.colorSpace),je=o.convert(k.type),Ut=Y(k.internalFormat,ht,je,k.colorSpace),ne=k.isVideoTexture!==!0,ze=de.__version===void 0||ge===!0,Ue=Ae.dataReady,Je=X(k,tt);Et(n.TEXTURE_CUBE_MAP,k);let ue;if(xt){ne&&ze&&e.texStorage2D(n.TEXTURE_CUBE_MAP,Je,Ut,tt.width,tt.height);for(let Te=0;Te<6;Te++){ue=He[Te].mipmaps;for(let Ge=0;Ge<ue.length;Ge++){let vt=ue[Ge];k.format!==Mo?ht!==null?ne?Ue&&e.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ge,0,0,vt.width,vt.height,ht,vt.data):e.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ge,Ut,vt.width,vt.height,0,vt.data):Mt("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):ne?Ue&&e.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ge,0,0,vt.width,vt.height,ht,je,vt.data):e.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ge,Ut,vt.width,vt.height,0,ht,je,vt.data)}}}else{if(ue=k.mipmaps,ne&&ze){ue.length>0&&Je++;let Te=Qe(He[0]);e.texStorage2D(n.TEXTURE_CUBE_MAP,Je,Ut,Te.width,Te.height)}for(let Te=0;Te<6;Te++)if(Fe){ne?Ue&&e.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,0,0,He[Te].width,He[Te].height,ht,je,He[Te].data):e.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,Ut,He[Te].width,He[Te].height,0,ht,je,He[Te].data);for(let Ge=0;Ge<ue.length;Ge++){let Wt=ue[Ge].image[Te].image;ne?Ue&&e.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ge+1,0,0,Wt.width,Wt.height,ht,je,Wt.data):e.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ge+1,Ut,Wt.width,Wt.height,0,ht,je,Wt.data)}}else{ne?Ue&&e.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,0,0,ht,je,He[Te]):e.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,Ut,ht,je,He[Te]);for(let Ge=0;Ge<ue.length;Ge++){let vt=ue[Ge];ne?Ue&&e.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ge+1,0,0,ht,je,vt.image[Te]):e.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+Te,Ge+1,Ut,ht,je,vt.image[Te])}}}T(k)&&M(n.TEXTURE_CUBE_MAP),de.__version=Ae.version,k.onUpdate&&k.onUpdate(k)}W.__version=k.version}function rt(W,k,te,ge,Ae,de){let ct=o.convert(te.format,te.colorSpace),ke=o.convert(te.type),dt=Y(te.internalFormat,ct,ke,te.colorSpace),xt=i.get(k),Fe=i.get(te);if(Fe.__renderTarget=k,!xt.__hasExternalTextures){let He=Math.max(1,k.width>>de),tt=Math.max(1,k.height>>de);Ae===n.TEXTURE_3D||Ae===n.TEXTURE_2D_ARRAY?e.texImage3D(Ae,de,dt,He,tt,k.depth,0,ct,ke,null):e.texImage2D(Ae,de,dt,He,tt,0,ct,ke,null)}e.bindFramebuffer(n.FRAMEBUFFER,W),cn(k)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,ge,Ae,Fe.__webglTexture,0,Q(k)):(Ae===n.TEXTURE_2D||Ae>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&Ae<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,ge,Ae,Fe.__webglTexture,de),e.bindFramebuffer(n.FRAMEBUFFER,null)}function Pt(W,k,te){if(n.bindRenderbuffer(n.RENDERBUFFER,W),k.depthBuffer){let ge=k.depthTexture,Ae=ge&&ge.isDepthTexture?ge.type:null,de=q(k.stencilBuffer,Ae),ct=k.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;cn(k)?c.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Q(k),de,k.width,k.height):te?n.renderbufferStorageMultisample(n.RENDERBUFFER,Q(k),de,k.width,k.height):n.renderbufferStorage(n.RENDERBUFFER,de,k.width,k.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,ct,n.RENDERBUFFER,W)}else{let ge=k.textures;for(let Ae=0;Ae<ge.length;Ae++){let de=ge[Ae],ct=o.convert(de.format,de.colorSpace),ke=o.convert(de.type),dt=Y(de.internalFormat,ct,ke,de.colorSpace);cn(k)?c.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Q(k),dt,k.width,k.height):te?n.renderbufferStorageMultisample(n.RENDERBUFFER,Q(k),dt,k.width,k.height):n.renderbufferStorage(n.RENDERBUFFER,dt,k.width,k.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function ft(W,k,te){let ge=k.isWebGLCubeRenderTarget===!0;if(e.bindFramebuffer(n.FRAMEBUFFER,W),!(k.depthTexture&&k.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");let Ae=i.get(k.depthTexture);if(Ae.__renderTarget=k,(!Ae.__webglTexture||k.depthTexture.image.width!==k.width||k.depthTexture.image.height!==k.height)&&(k.depthTexture.image.width=k.width,k.depthTexture.image.height=k.height,k.depthTexture.needsUpdate=!0),ge){if(Ae.__webglInit===void 0&&(Ae.__webglInit=!0,k.depthTexture.addEventListener("dispose",Z)),Ae.__webglTexture===void 0){Ae.__webglTexture=n.createTexture(),e.bindTexture(n.TEXTURE_CUBE_MAP,Ae.__webglTexture),Et(n.TEXTURE_CUBE_MAP,k.depthTexture);let xt=o.convert(k.depthTexture.format),Fe=o.convert(k.depthTexture.type),He;k.depthTexture.format===gs?He=n.DEPTH_COMPONENT24:k.depthTexture.format===tl&&(He=n.DEPTH24_STENCIL8);for(let tt=0;tt<6;tt++)n.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+tt,0,He,k.width,k.height,0,xt,Fe,null)}}else Ee(k.depthTexture,0);let de=Ae.__webglTexture,ct=Q(k),ke=ge?n.TEXTURE_CUBE_MAP_POSITIVE_X+te:n.TEXTURE_2D,dt=k.depthTexture.format===tl?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;if(k.depthTexture.format===gs)cn(k)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,dt,ke,de,0,ct):n.framebufferTexture2D(n.FRAMEBUFFER,dt,ke,de,0);else if(k.depthTexture.format===tl)cn(k)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,dt,ke,de,0,ct):n.framebufferTexture2D(n.FRAMEBUFFER,dt,ke,de,0);else throw new Error("Unknown depthTexture format")}function tn(W){let k=i.get(W),te=W.isWebGLCubeRenderTarget===!0;if(k.__boundDepthTexture!==W.depthTexture){let ge=W.depthTexture;if(k.__depthDisposeCallback&&k.__depthDisposeCallback(),ge){let Ae=()=>{delete k.__boundDepthTexture,delete k.__depthDisposeCallback,ge.removeEventListener("dispose",Ae)};ge.addEventListener("dispose",Ae),k.__depthDisposeCallback=Ae}k.__boundDepthTexture=ge}if(W.depthTexture&&!k.__autoAllocateDepthBuffer)if(te)for(let ge=0;ge<6;ge++)ft(k.__webglFramebuffer[ge],W,ge);else{let ge=W.texture.mipmaps;ge&&ge.length>0?ft(k.__webglFramebuffer[0],W,0):ft(k.__webglFramebuffer,W,0)}else if(te){k.__webglDepthbuffer=[];for(let ge=0;ge<6;ge++)if(e.bindFramebuffer(n.FRAMEBUFFER,k.__webglFramebuffer[ge]),k.__webglDepthbuffer[ge]===void 0)k.__webglDepthbuffer[ge]=n.createRenderbuffer(),Pt(k.__webglDepthbuffer[ge],W,!1);else{let Ae=W.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,de=k.__webglDepthbuffer[ge];n.bindRenderbuffer(n.RENDERBUFFER,de),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ae,n.RENDERBUFFER,de)}}else{let ge=W.texture.mipmaps;if(ge&&ge.length>0?e.bindFramebuffer(n.FRAMEBUFFER,k.__webglFramebuffer[0]):e.bindFramebuffer(n.FRAMEBUFFER,k.__webglFramebuffer),k.__webglDepthbuffer===void 0)k.__webglDepthbuffer=n.createRenderbuffer(),Pt(k.__webglDepthbuffer,W,!1);else{let Ae=W.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,de=k.__webglDepthbuffer;n.bindRenderbuffer(n.RENDERBUFFER,de),n.framebufferRenderbuffer(n.FRAMEBUFFER,Ae,n.RENDERBUFFER,de)}}e.bindFramebuffer(n.FRAMEBUFFER,null)}function Xn(W,k,te){let ge=i.get(W);k!==void 0&&rt(ge.__webglFramebuffer,W,W.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),te!==void 0&&tn(W)}function sn(W){let k=W.texture,te=i.get(W),ge=i.get(k);W.addEventListener("dispose",J);let Ae=W.textures,de=W.isWebGLCubeRenderTarget===!0,ct=Ae.length>1;if(ct||(ge.__webglTexture===void 0&&(ge.__webglTexture=n.createTexture()),ge.__version=k.version,l.memory.textures++),de){te.__webglFramebuffer=[];for(let ke=0;ke<6;ke++)if(k.mipmaps&&k.mipmaps.length>0){te.__webglFramebuffer[ke]=[];for(let dt=0;dt<k.mipmaps.length;dt++)te.__webglFramebuffer[ke][dt]=n.createFramebuffer()}else te.__webglFramebuffer[ke]=n.createFramebuffer()}else{if(k.mipmaps&&k.mipmaps.length>0){te.__webglFramebuffer=[];for(let ke=0;ke<k.mipmaps.length;ke++)te.__webglFramebuffer[ke]=n.createFramebuffer()}else te.__webglFramebuffer=n.createFramebuffer();if(ct)for(let ke=0,dt=Ae.length;ke<dt;ke++){let xt=i.get(Ae[ke]);xt.__webglTexture===void 0&&(xt.__webglTexture=n.createTexture(),l.memory.textures++)}if(W.samples>0&&cn(W)===!1){te.__webglMultisampledFramebuffer=n.createFramebuffer(),te.__webglColorRenderbuffer=[],e.bindFramebuffer(n.FRAMEBUFFER,te.__webglMultisampledFramebuffer);for(let ke=0;ke<Ae.length;ke++){let dt=Ae[ke];te.__webglColorRenderbuffer[ke]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,te.__webglColorRenderbuffer[ke]);let xt=o.convert(dt.format,dt.colorSpace),Fe=o.convert(dt.type),He=Y(dt.internalFormat,xt,Fe,dt.colorSpace,W.isXRRenderTarget===!0),tt=Q(W);n.renderbufferStorageMultisample(n.RENDERBUFFER,tt,He,W.width,W.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+ke,n.RENDERBUFFER,te.__webglColorRenderbuffer[ke])}n.bindRenderbuffer(n.RENDERBUFFER,null),W.depthBuffer&&(te.__webglDepthRenderbuffer=n.createRenderbuffer(),Pt(te.__webglDepthRenderbuffer,W,!0)),e.bindFramebuffer(n.FRAMEBUFFER,null)}}if(de){e.bindTexture(n.TEXTURE_CUBE_MAP,ge.__webglTexture),Et(n.TEXTURE_CUBE_MAP,k);for(let ke=0;ke<6;ke++)if(k.mipmaps&&k.mipmaps.length>0)for(let dt=0;dt<k.mipmaps.length;dt++)rt(te.__webglFramebuffer[ke][dt],W,k,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,dt);else rt(te.__webglFramebuffer[ke],W,k,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+ke,0);T(k)&&M(n.TEXTURE_CUBE_MAP),e.unbindTexture()}else if(ct){for(let ke=0,dt=Ae.length;ke<dt;ke++){let xt=Ae[ke],Fe=i.get(xt),He=n.TEXTURE_2D;(W.isWebGL3DRenderTarget||W.isWebGLArrayRenderTarget)&&(He=W.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),e.bindTexture(He,Fe.__webglTexture),Et(He,xt),rt(te.__webglFramebuffer,W,xt,n.COLOR_ATTACHMENT0+ke,He,0),T(xt)&&M(He)}e.unbindTexture()}else{let ke=n.TEXTURE_2D;if((W.isWebGL3DRenderTarget||W.isWebGLArrayRenderTarget)&&(ke=W.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY),e.bindTexture(ke,ge.__webglTexture),Et(ke,k),k.mipmaps&&k.mipmaps.length>0)for(let dt=0;dt<k.mipmaps.length;dt++)rt(te.__webglFramebuffer[dt],W,k,n.COLOR_ATTACHMENT0,ke,dt);else rt(te.__webglFramebuffer,W,k,n.COLOR_ATTACHMENT0,ke,0);T(k)&&M(ke),e.unbindTexture()}W.depthBuffer&&tn(W)}function It(W){let k=W.textures;for(let te=0,ge=k.length;te<ge;te++){let Ae=k[te];if(T(Ae)){let de=G(W),ct=i.get(Ae).__webglTexture;e.bindTexture(de,ct),M(de),e.unbindTexture()}}}let Kt=[],Nt=[];function un(W){if(W.samples>0){if(cn(W)===!1){let k=W.textures,te=W.width,ge=W.height,Ae=n.COLOR_BUFFER_BIT,de=W.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,ct=i.get(W),ke=k.length>1;if(ke)for(let xt=0;xt<k.length;xt++)e.bindFramebuffer(n.FRAMEBUFFER,ct.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+xt,n.RENDERBUFFER,null),e.bindFramebuffer(n.FRAMEBUFFER,ct.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+xt,n.TEXTURE_2D,null,0);e.bindFramebuffer(n.READ_FRAMEBUFFER,ct.__webglMultisampledFramebuffer);let dt=W.texture.mipmaps;dt&&dt.length>0?e.bindFramebuffer(n.DRAW_FRAMEBUFFER,ct.__webglFramebuffer[0]):e.bindFramebuffer(n.DRAW_FRAMEBUFFER,ct.__webglFramebuffer);for(let xt=0;xt<k.length;xt++){if(W.resolveDepthBuffer&&(W.depthBuffer&&(Ae|=n.DEPTH_BUFFER_BIT),W.stencilBuffer&&W.resolveStencilBuffer&&(Ae|=n.STENCIL_BUFFER_BIT)),ke){n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,ct.__webglColorRenderbuffer[xt]);let Fe=i.get(k[xt]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Fe,0)}n.blitFramebuffer(0,0,te,ge,0,0,te,ge,Ae,n.NEAREST),f===!0&&(Kt.length=0,Nt.length=0,Kt.push(n.COLOR_ATTACHMENT0+xt),W.depthBuffer&&W.resolveDepthBuffer===!1&&(Kt.push(de),Nt.push(de),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,Nt)),n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Kt))}if(e.bindFramebuffer(n.READ_FRAMEBUFFER,null),e.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),ke)for(let xt=0;xt<k.length;xt++){e.bindFramebuffer(n.FRAMEBUFFER,ct.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+xt,n.RENDERBUFFER,ct.__webglColorRenderbuffer[xt]);let Fe=i.get(k[xt]).__webglTexture;e.bindFramebuffer(n.FRAMEBUFFER,ct.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+xt,n.TEXTURE_2D,Fe,0)}e.bindFramebuffer(n.DRAW_FRAMEBUFFER,ct.__webglMultisampledFramebuffer)}else if(W.depthBuffer&&W.resolveDepthBuffer===!1&&f){let k=W.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT;n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[k])}}}function Q(W){return Math.min(r.maxSamples,W.samples)}function cn(W){let k=i.get(W);return W.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&k.__useRenderToTexture!==!1}function an(W){let k=l.render.frame;g.get(W)!==k&&(g.set(W,k),W.update())}function gt(W,k){let te=W.colorSpace,ge=W.format,Ae=W.type;return W.isCompressedTexture===!0||W.isVideoTexture===!0||te!==cu&&te!==ra&&(yn.getTransfer(te)===Pn?(ge!==Mo||Ae!==Lr)&&Mt("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):At("WebGLTextures: Unsupported texture color space:",te)),k}function Qe(W){return typeof HTMLImageElement<"u"&&W instanceof HTMLImageElement?(p.width=W.naturalWidth||W.width,p.height=W.naturalHeight||W.height):typeof VideoFrame<"u"&&W instanceof VideoFrame?(p.width=W.displayWidth,p.height=W.displayHeight):(p.width=W.width,p.height=W.height),p}this.allocateTextureUnit=ce,this.resetTextureUnits=re,this.setTexture2D=Ee,this.setTexture2DArray=xe,this.setTexture3D=me,this.setTextureCube=Me,this.rebindTextures=Xn,this.setupRenderTarget=sn,this.updateRenderTargetMipmap=It,this.updateMultisampleRenderTarget=un,this.setupDepthRenderbuffer=tn,this.setupFrameBufferTexture=rt,this.useMultisampledRTT=cn,this.isReversedDepthBuffer=function(){return e.buffers.depth.getReversed()}}function qz(n,t){function e(i,r=ra){let o,l=yn.getTransfer(r);if(i===Lr)return n.UNSIGNED_BYTE;if(i===W_)return n.UNSIGNED_SHORT_4_4_4_4;if(i===G_)return n.UNSIGNED_SHORT_5_5_5_1;if(i===qb)return n.UNSIGNED_INT_5_9_9_9_REV;if(i===Xb)return n.UNSIGNED_INT_10F_11F_11F_REV;if(i===$b)return n.BYTE;if(i===Yb)return n.SHORT;if(i===pd)return n.UNSIGNED_SHORT;if(i===j_)return n.INT;if(i===qo)return n.UNSIGNED_INT;if(i===Xo)return n.FLOAT;if(i===xs)return n.HALF_FLOAT;if(i===Zb)return n.ALPHA;if(i===Jb)return n.RGB;if(i===Mo)return n.RGBA;if(i===gs)return n.DEPTH_COMPONENT;if(i===tl)return n.DEPTH_STENCIL;if(i===Kb)return n.RED;if(i===$_)return n.RED_INTEGER;if(i===mu)return n.RG;if(i===Y_)return n.RG_INTEGER;if(i===q_)return n.RGBA_INTEGER;if(i===Gf||i===$f||i===Yf||i===qf)if(l===Pn)if(o=t.get("WEBGL_compressed_texture_s3tc_srgb"),o!==null){if(i===Gf)return o.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===$f)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===Yf)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===qf)return o.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(o=t.get("WEBGL_compressed_texture_s3tc"),o!==null){if(i===Gf)return o.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===$f)return o.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Yf)return o.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===qf)return o.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(i===X_||i===Z_||i===J_||i===K_)if(o=t.get("WEBGL_compressed_texture_pvrtc"),o!==null){if(i===X_)return o.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Z_)return o.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===J_)return o.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===K_)return o.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(i===Q_||i===e1||i===t1||i===n1||i===i1||i===r1||i===o1)if(o=t.get("WEBGL_compressed_texture_etc"),o!==null){if(i===Q_||i===e1)return l===Pn?o.COMPRESSED_SRGB8_ETC2:o.COMPRESSED_RGB8_ETC2;if(i===t1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:o.COMPRESSED_RGBA8_ETC2_EAC;if(i===n1)return o.COMPRESSED_R11_EAC;if(i===i1)return o.COMPRESSED_SIGNED_R11_EAC;if(i===r1)return o.COMPRESSED_RG11_EAC;if(i===o1)return o.COMPRESSED_SIGNED_RG11_EAC}else return null;if(i===s1||i===a1||i===l1||i===u1||i===c1||i===d1||i===f1||i===h1||i===p1||i===m1||i===g1||i===_1||i===v1||i===y1)if(o=t.get("WEBGL_compressed_texture_astc"),o!==null){if(i===s1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:o.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===a1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:o.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===l1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:o.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===u1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:o.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===c1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:o.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===d1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:o.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===f1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:o.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===h1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:o.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===p1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:o.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===m1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:o.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===g1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:o.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===_1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:o.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===v1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:o.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===y1)return l===Pn?o.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:o.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(i===x1||i===b1||i===C1)if(o=t.get("EXT_texture_compression_bptc"),o!==null){if(i===x1)return l===Pn?o.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:o.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===b1)return o.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===C1)return o.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(i===E1||i===w1||i===S1||i===M1)if(o=t.get("EXT_texture_compression_rgtc"),o!==null){if(i===E1)return o.COMPRESSED_RED_RGTC1_EXT;if(i===w1)return o.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===S1)return o.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===M1)return o.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return i===md?n.UNSIGNED_INT_24_8:n[i]!==void 0?n[i]:null}return{convert:e}}var Xz=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Zz=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`,EC=class{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(t,e){if(this.texture===null){let i=new Ff(t.texture);(t.depthNear!==e.depthNear||t.depthFar!==e.depthFar)&&(this.depthNear=t.depthNear,this.depthFar=t.depthFar),this.texture=i}}getMesh(t){if(this.texture!==null&&this.mesh===null){let e=t.cameras[0].viewport,i=new ro({vertexShader:Xz,fragmentShader:Zz,uniforms:{depthColor:{value:this.texture},depthWidth:{value:e.z},depthHeight:{value:e.w}}});this.mesh=new gn(new vs(20,20),i)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}},wC=class extends _s{constructor(t,e){super();let i=this,r=null,o=1,l=null,c="local-floor",f=1,p=null,g=null,m=null,x=null,C=null,A=null,O=typeof XRWebGLBinding<"u",T=new EC,M={},G=e.getContextAttributes(),Y=null,q=null,X=[],Z=[],J=new Ft,oe=null,L=new ir;L.viewport=new ui;let z=new ir;z.viewport=new ui;let K=[L,z],re=new P_,ce=null,we=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Se){let De=X[Se];return De===void 0&&(De=new ad,X[Se]=De),De.getTargetRaySpace()},this.getControllerGrip=function(Se){let De=X[Se];return De===void 0&&(De=new ad,X[Se]=De),De.getGripSpace()},this.getHand=function(Se){let De=X[Se];return De===void 0&&(De=new ad,X[Se]=De),De.getHandSpace()};function Ee(Se){let De=Z.indexOf(Se.inputSource);if(De===-1)return;let rt=X[De];rt!==void 0&&(rt.update(Se.inputSource,Se.frame,p||l),rt.dispatchEvent({type:Se.type,data:Se.inputSource}))}function xe(){r.removeEventListener("select",Ee),r.removeEventListener("selectstart",Ee),r.removeEventListener("selectend",Ee),r.removeEventListener("squeeze",Ee),r.removeEventListener("squeezestart",Ee),r.removeEventListener("squeezeend",Ee),r.removeEventListener("end",xe),r.removeEventListener("inputsourceschange",me);for(let Se=0;Se<X.length;Se++){let De=Z[Se];De!==null&&(Z[Se]=null,X[Se].disconnect(De))}ce=null,we=null,T.reset();for(let Se in M)delete M[Se];t.setRenderTarget(Y),C=null,x=null,m=null,r=null,q=null,xn.stop(),i.isPresenting=!1,t.setPixelRatio(oe),t.setSize(J.width,J.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Se){o=Se,i.isPresenting===!0&&Mt("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Se){c=Se,i.isPresenting===!0&&Mt("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return p||l},this.setReferenceSpace=function(Se){p=Se},this.getBaseLayer=function(){return x!==null?x:C},this.getBinding=function(){return m===null&&O&&(m=new XRWebGLBinding(r,e)),m},this.getFrame=function(){return A},this.getSession=function(){return r},this.setSession=function(Se){return wt(this,null,function*(){if(r=Se,r!==null){if(Y=t.getRenderTarget(),r.addEventListener("select",Ee),r.addEventListener("selectstart",Ee),r.addEventListener("selectend",Ee),r.addEventListener("squeeze",Ee),r.addEventListener("squeezestart",Ee),r.addEventListener("squeezeend",Ee),r.addEventListener("end",xe),r.addEventListener("inputsourceschange",me),G.xrCompatible!==!0&&(yield e.makeXRCompatible()),oe=t.getPixelRatio(),t.getSize(J),O&&"createProjectionLayer"in XRWebGLBinding.prototype){let rt=null,Pt=null,ft=null;G.depth&&(ft=G.stencil?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT24,rt=G.stencil?tl:gs,Pt=G.stencil?md:qo);let tn={colorFormat:e.RGBA8,depthFormat:ft,scaleFactor:o};m=this.getBinding(),x=m.createProjectionLayer(tn),r.updateRenderState({layers:[x]}),t.setPixelRatio(1),t.setSize(x.textureWidth,x.textureHeight,!1),q=new io(x.textureWidth,x.textureHeight,{format:Mo,type:Lr,depthTexture:new qa(x.textureWidth,x.textureHeight,Pt,void 0,void 0,void 0,void 0,void 0,void 0,rt),stencilBuffer:G.stencil,colorSpace:t.outputColorSpace,samples:G.antialias?4:0,resolveDepthBuffer:x.ignoreDepthValues===!1,resolveStencilBuffer:x.ignoreDepthValues===!1})}else{let rt={antialias:G.antialias,alpha:!0,depth:G.depth,stencil:G.stencil,framebufferScaleFactor:o};C=new XRWebGLLayer(r,e,rt),r.updateRenderState({baseLayer:C}),t.setPixelRatio(1),t.setSize(C.framebufferWidth,C.framebufferHeight,!1),q=new io(C.framebufferWidth,C.framebufferHeight,{format:Mo,type:Lr,colorSpace:t.outputColorSpace,stencilBuffer:G.stencil,resolveDepthBuffer:C.ignoreDepthValues===!1,resolveStencilBuffer:C.ignoreDepthValues===!1})}q.isXRRenderTarget=!0,this.setFoveation(f),p=null,l=yield r.requestReferenceSpace(c),xn.setContext(r),xn.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}})},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode},this.getDepthTexture=function(){return T.getDepthTexture()};function me(Se){for(let De=0;De<Se.removed.length;De++){let rt=Se.removed[De],Pt=Z.indexOf(rt);Pt>=0&&(Z[Pt]=null,X[Pt].disconnect(rt))}for(let De=0;De<Se.added.length;De++){let rt=Se.added[De],Pt=Z.indexOf(rt);if(Pt===-1){for(let tn=0;tn<X.length;tn++)if(tn>=Z.length){Z.push(rt),Pt=tn;break}else if(Z[tn]===null){Z[tn]=rt,Pt=tn;break}if(Pt===-1)break}let ft=X[Pt];ft&&ft.connect(rt)}}let Me=new ae,qe=new ae;function Be(Se,De,rt){Me.setFromMatrixPosition(De.matrixWorld),qe.setFromMatrixPosition(rt.matrixWorld);let Pt=Me.distanceTo(qe),ft=De.projectionMatrix.elements,tn=rt.projectionMatrix.elements,Xn=ft[14]/(ft[10]-1),sn=ft[14]/(ft[10]+1),It=(ft[9]+1)/ft[5],Kt=(ft[9]-1)/ft[5],Nt=(ft[8]-1)/ft[0],un=(tn[8]+1)/tn[0],Q=Xn*Nt,cn=Xn*un,an=Pt/(-Nt+un),gt=an*-Nt;if(De.matrixWorld.decompose(Se.position,Se.quaternion,Se.scale),Se.translateX(gt),Se.translateZ(an),Se.matrixWorld.compose(Se.position,Se.quaternion,Se.scale),Se.matrixWorldInverse.copy(Se.matrixWorld).invert(),ft[10]===-1)Se.projectionMatrix.copy(De.projectionMatrix),Se.projectionMatrixInverse.copy(De.projectionMatrixInverse);else{let Qe=Xn+an,W=sn+an,k=Q-gt,te=cn+(Pt-gt),ge=It*sn/W*Qe,Ae=Kt*sn/W*Qe;Se.projectionMatrix.makePerspective(k,te,ge,Ae,Qe,W),Se.projectionMatrixInverse.copy(Se.projectionMatrix).invert()}}function Xe(Se,De){De===null?Se.matrixWorld.copy(Se.matrix):Se.matrixWorld.multiplyMatrices(De.matrixWorld,Se.matrix),Se.matrixWorldInverse.copy(Se.matrixWorld).invert()}this.updateCamera=function(Se){if(r===null)return;let De=Se.near,rt=Se.far;T.texture!==null&&(T.depthNear>0&&(De=T.depthNear),T.depthFar>0&&(rt=T.depthFar)),re.near=z.near=L.near=De,re.far=z.far=L.far=rt,(ce!==re.near||we!==re.far)&&(r.updateRenderState({depthNear:re.near,depthFar:re.far}),ce=re.near,we=re.far),re.layers.mask=Se.layers.mask|6,L.layers.mask=re.layers.mask&3,z.layers.mask=re.layers.mask&5;let Pt=Se.parent,ft=re.cameras;Xe(re,Pt);for(let tn=0;tn<ft.length;tn++)Xe(ft[tn],Pt);ft.length===2?Be(re,L,z):re.projectionMatrix.copy(L.projectionMatrix),Et(Se,re,Pt)};function Et(Se,De,rt){rt===null?Se.matrix.copy(De.matrixWorld):(Se.matrix.copy(rt.matrixWorld),Se.matrix.invert(),Se.matrix.multiply(De.matrixWorld)),Se.matrix.decompose(Se.position,Se.quaternion,Se.scale),Se.updateMatrixWorld(!0),Se.projectionMatrix.copy(De.projectionMatrix),Se.projectionMatrixInverse.copy(De.projectionMatrixInverse),Se.isPerspectiveCamera&&(Se.fov=od*2*Math.atan(1/Se.projectionMatrix.elements[5]),Se.zoom=1)}this.getCamera=function(){return re},this.getFoveation=function(){if(!(x===null&&C===null))return f},this.setFoveation=function(Se){f=Se,x!==null&&(x.fixedFoveation=Se),C!==null&&C.fixedFoveation!==void 0&&(C.fixedFoveation=Se)},this.hasDepthSensing=function(){return T.texture!==null},this.getDepthSensingMesh=function(){return T.getMesh(re)},this.getCameraTexture=function(Se){return M[Se]};let Re=null;function wn(Se,De){if(g=De.getViewerPose(p||l),A=De,g!==null){let rt=g.views;C!==null&&(t.setRenderTargetFramebuffer(q,C.framebuffer),t.setRenderTarget(q));let Pt=!1;rt.length!==re.cameras.length&&(re.cameras.length=0,Pt=!0);for(let sn=0;sn<rt.length;sn++){let It=rt[sn],Kt=null;if(C!==null)Kt=C.getViewport(It);else{let un=m.getViewSubImage(x,It);Kt=un.viewport,sn===0&&(t.setRenderTargetTextures(q,un.colorTexture,un.depthStencilTexture),t.setRenderTarget(q))}let Nt=K[sn];Nt===void 0&&(Nt=new ir,Nt.layers.enable(sn),Nt.viewport=new ui,K[sn]=Nt),Nt.matrix.fromArray(It.transform.matrix),Nt.matrix.decompose(Nt.position,Nt.quaternion,Nt.scale),Nt.projectionMatrix.fromArray(It.projectionMatrix),Nt.projectionMatrixInverse.copy(Nt.projectionMatrix).invert(),Nt.viewport.set(Kt.x,Kt.y,Kt.width,Kt.height),sn===0&&(re.matrix.copy(Nt.matrix),re.matrix.decompose(re.position,re.quaternion,re.scale)),Pt===!0&&re.cameras.push(Nt)}let ft=r.enabledFeatures;if(ft&&ft.includes("depth-sensing")&&r.depthUsage=="gpu-optimized"&&O){m=i.getBinding();let sn=m.getDepthInformation(rt[0]);sn&&sn.isValid&&sn.texture&&T.init(sn,r.renderState)}if(ft&&ft.includes("camera-access")&&O){t.state.unbindTexture(),m=i.getBinding();for(let sn=0;sn<rt.length;sn++){let It=rt[sn].camera;if(It){let Kt=M[It];Kt||(Kt=new Ff,M[It]=Kt);let Nt=m.getCameraImage(It);Kt.sourceTexture=Nt}}}}for(let rt=0;rt<X.length;rt++){let Pt=Z[rt],ft=X[rt];Pt!==null&&ft!==void 0&&ft.update(Pt,De,p||l)}Re&&Re(Se,De),De.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:De}),A=null}let xn=new QT;xn.setAnimationLoop(wn),this.setAnimationLoop=function(Se){Re=Se},this.dispose=function(){}}},vu=new $a,Jz=new li;function Kz(n,t){function e(T,M){T.matrixAutoUpdate===!0&&T.updateMatrix(),M.value.copy(T.matrix)}function i(T,M){M.color.getRGB(T.fogColor.value,oC(n)),M.isFog?(T.fogNear.value=M.near,T.fogFar.value=M.far):M.isFogExp2&&(T.fogDensity.value=M.density)}function r(T,M,G,Y,q){M.isMeshBasicMaterial||M.isMeshLambertMaterial?o(T,M):M.isMeshToonMaterial?(o(T,M),m(T,M)):M.isMeshPhongMaterial?(o(T,M),g(T,M)):M.isMeshStandardMaterial?(o(T,M),x(T,M),M.isMeshPhysicalMaterial&&C(T,M,q)):M.isMeshMatcapMaterial?(o(T,M),A(T,M)):M.isMeshDepthMaterial?o(T,M):M.isMeshDistanceMaterial?(o(T,M),O(T,M)):M.isMeshNormalMaterial?o(T,M):M.isLineBasicMaterial?(l(T,M),M.isLineDashedMaterial&&c(T,M)):M.isPointsMaterial?f(T,M,G,Y):M.isSpriteMaterial?p(T,M):M.isShadowMaterial?(T.color.value.copy(M.color),T.opacity.value=M.opacity):M.isShaderMaterial&&(M.uniformsNeedUpdate=!1)}function o(T,M){T.opacity.value=M.opacity,M.color&&T.diffuse.value.copy(M.color),M.emissive&&T.emissive.value.copy(M.emissive).multiplyScalar(M.emissiveIntensity),M.map&&(T.map.value=M.map,e(M.map,T.mapTransform)),M.alphaMap&&(T.alphaMap.value=M.alphaMap,e(M.alphaMap,T.alphaMapTransform)),M.bumpMap&&(T.bumpMap.value=M.bumpMap,e(M.bumpMap,T.bumpMapTransform),T.bumpScale.value=M.bumpScale,M.side===yr&&(T.bumpScale.value*=-1)),M.normalMap&&(T.normalMap.value=M.normalMap,e(M.normalMap,T.normalMapTransform),T.normalScale.value.copy(M.normalScale),M.side===yr&&T.normalScale.value.negate()),M.displacementMap&&(T.displacementMap.value=M.displacementMap,e(M.displacementMap,T.displacementMapTransform),T.displacementScale.value=M.displacementScale,T.displacementBias.value=M.displacementBias),M.emissiveMap&&(T.emissiveMap.value=M.emissiveMap,e(M.emissiveMap,T.emissiveMapTransform)),M.specularMap&&(T.specularMap.value=M.specularMap,e(M.specularMap,T.specularMapTransform)),M.alphaTest>0&&(T.alphaTest.value=M.alphaTest);let G=t.get(M),Y=G.envMap,q=G.envMapRotation;Y&&(T.envMap.value=Y,vu.copy(q),vu.x*=-1,vu.y*=-1,vu.z*=-1,Y.isCubeTexture&&Y.isRenderTargetTexture===!1&&(vu.y*=-1,vu.z*=-1),T.envMapRotation.value.setFromMatrix4(Jz.makeRotationFromEuler(vu)),T.flipEnvMap.value=Y.isCubeTexture&&Y.isRenderTargetTexture===!1?-1:1,T.reflectivity.value=M.reflectivity,T.ior.value=M.ior,T.refractionRatio.value=M.refractionRatio),M.lightMap&&(T.lightMap.value=M.lightMap,T.lightMapIntensity.value=M.lightMapIntensity,e(M.lightMap,T.lightMapTransform)),M.aoMap&&(T.aoMap.value=M.aoMap,T.aoMapIntensity.value=M.aoMapIntensity,e(M.aoMap,T.aoMapTransform))}function l(T,M){T.diffuse.value.copy(M.color),T.opacity.value=M.opacity,M.map&&(T.map.value=M.map,e(M.map,T.mapTransform))}function c(T,M){T.dashSize.value=M.dashSize,T.totalSize.value=M.dashSize+M.gapSize,T.scale.value=M.scale}function f(T,M,G,Y){T.diffuse.value.copy(M.color),T.opacity.value=M.opacity,T.size.value=M.size*G,T.scale.value=Y*.5,M.map&&(T.map.value=M.map,e(M.map,T.uvTransform)),M.alphaMap&&(T.alphaMap.value=M.alphaMap,e(M.alphaMap,T.alphaMapTransform)),M.alphaTest>0&&(T.alphaTest.value=M.alphaTest)}function p(T,M){T.diffuse.value.copy(M.color),T.opacity.value=M.opacity,T.rotation.value=M.rotation,M.map&&(T.map.value=M.map,e(M.map,T.mapTransform)),M.alphaMap&&(T.alphaMap.value=M.alphaMap,e(M.alphaMap,T.alphaMapTransform)),M.alphaTest>0&&(T.alphaTest.value=M.alphaTest)}function g(T,M){T.specular.value.copy(M.specular),T.shininess.value=Math.max(M.shininess,1e-4)}function m(T,M){M.gradientMap&&(T.gradientMap.value=M.gradientMap)}function x(T,M){T.metalness.value=M.metalness,M.metalnessMap&&(T.metalnessMap.value=M.metalnessMap,e(M.metalnessMap,T.metalnessMapTransform)),T.roughness.value=M.roughness,M.roughnessMap&&(T.roughnessMap.value=M.roughnessMap,e(M.roughnessMap,T.roughnessMapTransform)),M.envMap&&(T.envMapIntensity.value=M.envMapIntensity)}function C(T,M,G){T.ior.value=M.ior,M.sheen>0&&(T.sheenColor.value.copy(M.sheenColor).multiplyScalar(M.sheen),T.sheenRoughness.value=M.sheenRoughness,M.sheenColorMap&&(T.sheenColorMap.value=M.sheenColorMap,e(M.sheenColorMap,T.sheenColorMapTransform)),M.sheenRoughnessMap&&(T.sheenRoughnessMap.value=M.sheenRoughnessMap,e(M.sheenRoughnessMap,T.sheenRoughnessMapTransform))),M.clearcoat>0&&(T.clearcoat.value=M.clearcoat,T.clearcoatRoughness.value=M.clearcoatRoughness,M.clearcoatMap&&(T.clearcoatMap.value=M.clearcoatMap,e(M.clearcoatMap,T.clearcoatMapTransform)),M.clearcoatRoughnessMap&&(T.clearcoatRoughnessMap.value=M.clearcoatRoughnessMap,e(M.clearcoatRoughnessMap,T.clearcoatRoughnessMapTransform)),M.clearcoatNormalMap&&(T.clearcoatNormalMap.value=M.clearcoatNormalMap,e(M.clearcoatNormalMap,T.clearcoatNormalMapTransform),T.clearcoatNormalScale.value.copy(M.clearcoatNormalScale),M.side===yr&&T.clearcoatNormalScale.value.negate())),M.dispersion>0&&(T.dispersion.value=M.dispersion),M.iridescence>0&&(T.iridescence.value=M.iridescence,T.iridescenceIOR.value=M.iridescenceIOR,T.iridescenceThicknessMinimum.value=M.iridescenceThicknessRange[0],T.iridescenceThicknessMaximum.value=M.iridescenceThicknessRange[1],M.iridescenceMap&&(T.iridescenceMap.value=M.iridescenceMap,e(M.iridescenceMap,T.iridescenceMapTransform)),M.iridescenceThicknessMap&&(T.iridescenceThicknessMap.value=M.iridescenceThicknessMap,e(M.iridescenceThicknessMap,T.iridescenceThicknessMapTransform))),M.transmission>0&&(T.transmission.value=M.transmission,T.transmissionSamplerMap.value=G.texture,T.transmissionSamplerSize.value.set(G.width,G.height),M.transmissionMap&&(T.transmissionMap.value=M.transmissionMap,e(M.transmissionMap,T.transmissionMapTransform)),T.thickness.value=M.thickness,M.thicknessMap&&(T.thicknessMap.value=M.thicknessMap,e(M.thicknessMap,T.thicknessMapTransform)),T.attenuationDistance.value=M.attenuationDistance,T.attenuationColor.value.copy(M.attenuationColor)),M.anisotropy>0&&(T.anisotropyVector.value.set(M.anisotropy*Math.cos(M.anisotropyRotation),M.anisotropy*Math.sin(M.anisotropyRotation)),M.anisotropyMap&&(T.anisotropyMap.value=M.anisotropyMap,e(M.anisotropyMap,T.anisotropyMapTransform))),T.specularIntensity.value=M.specularIntensity,T.specularColor.value.copy(M.specularColor),M.specularColorMap&&(T.specularColorMap.value=M.specularColorMap,e(M.specularColorMap,T.specularColorMapTransform)),M.specularIntensityMap&&(T.specularIntensityMap.value=M.specularIntensityMap,e(M.specularIntensityMap,T.specularIntensityMapTransform))}function A(T,M){M.matcap&&(T.matcap.value=M.matcap)}function O(T,M){let G=t.get(M).light;T.referencePosition.value.setFromMatrixPosition(G.matrixWorld),T.nearDistance.value=G.shadow.camera.near,T.farDistance.value=G.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function Qz(n,t,e,i){let r={},o={},l=[],c=n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS);function f(G,Y){let q=Y.program;i.uniformBlockBinding(G,q)}function p(G,Y){let q=r[G.id];q===void 0&&(A(G),q=g(G),r[G.id]=q,G.addEventListener("dispose",T));let X=Y.program;i.updateUBOMapping(G,X);let Z=t.render.frame;o[G.id]!==Z&&(x(G),o[G.id]=Z)}function g(G){let Y=m();G.__bindingPointIndex=Y;let q=n.createBuffer(),X=G.__size,Z=G.usage;return n.bindBuffer(n.UNIFORM_BUFFER,q),n.bufferData(n.UNIFORM_BUFFER,X,Z),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,Y,q),q}function m(){for(let G=0;G<c;G++)if(l.indexOf(G)===-1)return l.push(G),G;return At("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function x(G){let Y=r[G.id],q=G.uniforms,X=G.__cache;n.bindBuffer(n.UNIFORM_BUFFER,Y);for(let Z=0,J=q.length;Z<J;Z++){let oe=Array.isArray(q[Z])?q[Z]:[q[Z]];for(let L=0,z=oe.length;L<z;L++){let K=oe[L];if(C(K,Z,L,X)===!0){let re=K.__offset,ce=Array.isArray(K.value)?K.value:[K.value],we=0;for(let Ee=0;Ee<ce.length;Ee++){let xe=ce[Ee],me=O(xe);typeof xe=="number"||typeof xe=="boolean"?(K.__data[0]=xe,n.bufferSubData(n.UNIFORM_BUFFER,re+we,K.__data)):xe.isMatrix3?(K.__data[0]=xe.elements[0],K.__data[1]=xe.elements[1],K.__data[2]=xe.elements[2],K.__data[3]=0,K.__data[4]=xe.elements[3],K.__data[5]=xe.elements[4],K.__data[6]=xe.elements[5],K.__data[7]=0,K.__data[8]=xe.elements[6],K.__data[9]=xe.elements[7],K.__data[10]=xe.elements[8],K.__data[11]=0):(xe.toArray(K.__data,we),we+=me.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,re,K.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function C(G,Y,q,X){let Z=G.value,J=Y+"_"+q;if(X[J]===void 0)return typeof Z=="number"||typeof Z=="boolean"?X[J]=Z:X[J]=Z.clone(),!0;{let oe=X[J];if(typeof Z=="number"||typeof Z=="boolean"){if(oe!==Z)return X[J]=Z,!0}else if(oe.equals(Z)===!1)return oe.copy(Z),!0}return!1}function A(G){let Y=G.uniforms,q=0,X=16;for(let J=0,oe=Y.length;J<oe;J++){let L=Array.isArray(Y[J])?Y[J]:[Y[J]];for(let z=0,K=L.length;z<K;z++){let re=L[z],ce=Array.isArray(re.value)?re.value:[re.value];for(let we=0,Ee=ce.length;we<Ee;we++){let xe=ce[we],me=O(xe),Me=q%X,qe=Me%me.boundary,Be=Me+qe;q+=qe,Be!==0&&X-Be<me.storage&&(q+=X-Be),re.__data=new Float32Array(me.storage/Float32Array.BYTES_PER_ELEMENT),re.__offset=q,q+=me.storage}}}let Z=q%X;return Z>0&&(q+=X-Z),G.__size=q,G.__cache={},this}function O(G){let Y={boundary:0,storage:0};return typeof G=="number"||typeof G=="boolean"?(Y.boundary=4,Y.storage=4):G.isVector2?(Y.boundary=8,Y.storage=8):G.isVector3||G.isColor?(Y.boundary=16,Y.storage=12):G.isVector4?(Y.boundary=16,Y.storage=16):G.isMatrix3?(Y.boundary=48,Y.storage=48):G.isMatrix4?(Y.boundary=64,Y.storage=64):G.isTexture?Mt("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Mt("WebGLRenderer: Unsupported uniform value type.",G),Y}function T(G){let Y=G.target;Y.removeEventListener("dispose",T);let q=l.indexOf(Y.__bindingPointIndex);l.splice(q,1),n.deleteBuffer(r[Y.id]),delete r[Y.id],delete o[Y.id]}function M(){for(let G in r)n.deleteBuffer(r[G]);l=[],r={},o={}}return{bind:f,update:p,dispose:M}}var ej=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]),bs=null;function tj(){return bs===null&&(bs=new f_(ej,16,16,mu,xs),bs.name="DFG_LUT",bs.minFilter=qi,bs.magFilter=qi,bs.wrapS=ms,bs.wrapT=ms,bs.generateMipmaps=!1,bs.needsUpdate=!0),bs}var O1=class{constructor(t={}){let{canvas:e=MT(),context:i=null,depth:r=!0,stencil:o=!1,alpha:l=!1,antialias:c=!1,premultipliedAlpha:f=!0,preserveDrawingBuffer:p=!1,powerPreference:g="default",failIfMajorPerformanceCaveat:m=!1,reversedDepthBuffer:x=!1,outputBufferType:C=Lr}=t;this.isWebGLRenderer=!0;let A;if(i!==null){if(typeof WebGLRenderingContext<"u"&&i instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");A=i.getContextAttributes().alpha}else A=l;let O=C,T=new Set([q_,Y_,$_]),M=new Set([Lr,qo,pd,md,W_,G_]),G=new Uint32Array(4),Y=new Int32Array(4),q=null,X=null,Z=[],J=[],oe=null;this.domElement=e,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=Yo,this.toneMappingExposure=1,this.transmissionResolutionScale=1;let L=this,z=!1;this._outputColorSpace=to;let K=0,re=0,ce=null,we=-1,Ee=null,xe=new ui,me=new ui,Me=null,qe=new Zt(0),Be=0,Xe=e.width,Et=e.height,Re=1,wn=null,xn=null,Se=new ui(0,0,Xe,Et),De=new ui(0,0,Xe,Et),rt=!1,Pt=new ld,ft=!1,tn=!1,Xn=new li,sn=new ae,It=new ui,Kt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0},Nt=!1;function un(){return ce===null?Re:1}let Q=i;function cn(N,ie){return e.getContext(N,ie)}try{let N={alpha:!0,depth:r,stencil:o,antialias:c,premultipliedAlpha:f,preserveDrawingBuffer:p,powerPreference:g,failIfMajorPerformanceCaveat:m};if("setAttribute"in e&&e.setAttribute("data-engine",`three.js r${I_}`),e.addEventListener("webglcontextlost",vt,!1),e.addEventListener("webglcontextrestored",Wt,!1),e.addEventListener("webglcontextcreationerror",st,!1),Q===null){let ie="webgl2";if(Q=cn(ie,N),Q===null)throw cn(ie)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(N){throw At("WebGLRenderer: "+N.message),N}let an,gt,Qe,W,k,te,ge,Ae,de,ct,ke,dt,xt,Fe,He,tt,ht,je,Ut,ne,ze,Ue,Je,ue;function Te(){an=new lH(Q),an.init(),Ue=new qz(Q,an),gt=new QV(Q,an,t,Ue),Qe=new $z(Q,an),gt.reversedDepthBuffer&&x&&Qe.buffers.depth.setReversed(!0),W=new dH(Q),k=new Iz,te=new Yz(Q,an,Qe,k,gt,Ue,W),ge=new tH(L),Ae=new aH(L),de=new m9(Q),Je=new JV(Q,de),ct=new uH(Q,de,W,Je),ke=new hH(Q,ct,de,W),Ut=new fH(Q,gt,te),tt=new eH(k),dt=new Pz(L,ge,Ae,an,gt,Je,tt),xt=new Kz(L,k),Fe=new Fz,He=new Bz(an),je=new ZV(L,ge,Ae,Qe,ke,A,f),ht=new Wz(L,ke,gt),ue=new Qz(Q,W,gt,Qe),ne=new KV(Q,an,W),ze=new cH(Q,an,W),W.programs=dt.programs,L.capabilities=gt,L.extensions=an,L.properties=k,L.renderLists=Fe,L.shadowMap=ht,L.state=Qe,L.info=W}Te(),O!==Lr&&(oe=new mH(O,e.width,e.height,r,o));let Ge=new wC(L,Q);this.xr=Ge,this.getContext=function(){return Q},this.getContextAttributes=function(){return Q.getContextAttributes()},this.forceContextLoss=function(){let N=an.get("WEBGL_lose_context");N&&N.loseContext()},this.forceContextRestore=function(){let N=an.get("WEBGL_lose_context");N&&N.restoreContext()},this.getPixelRatio=function(){return Re},this.setPixelRatio=function(N){N!==void 0&&(Re=N,this.setSize(Xe,Et,!1))},this.getSize=function(N){return N.set(Xe,Et)},this.setSize=function(N,ie,pe=!0){if(Ge.isPresenting){Mt("WebGLRenderer: Can't change size while VR device is presenting.");return}Xe=N,Et=ie,e.width=Math.floor(N*Re),e.height=Math.floor(ie*Re),pe===!0&&(e.style.width=N+"px",e.style.height=ie+"px"),oe!==null&&oe.setSize(e.width,e.height),this.setViewport(0,0,N,ie)},this.getDrawingBufferSize=function(N){return N.set(Xe*Re,Et*Re).floor()},this.setDrawingBufferSize=function(N,ie,pe){Xe=N,Et=ie,Re=pe,e.width=Math.floor(N*pe),e.height=Math.floor(ie*pe),this.setViewport(0,0,N,ie)},this.setEffects=function(N){if(O===Lr){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if(N){for(let ie=0;ie<N.length;ie++)if(N[ie].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}oe.setEffects(N||[])},this.getCurrentViewport=function(N){return N.copy(xe)},this.getViewport=function(N){return N.copy(Se)},this.setViewport=function(N,ie,pe,fe){N.isVector4?Se.set(N.x,N.y,N.z,N.w):Se.set(N,ie,pe,fe),Qe.viewport(xe.copy(Se).multiplyScalar(Re).round())},this.getScissor=function(N){return N.copy(De)},this.setScissor=function(N,ie,pe,fe){N.isVector4?De.set(N.x,N.y,N.z,N.w):De.set(N,ie,pe,fe),Qe.scissor(me.copy(De).multiplyScalar(Re).round())},this.getScissorTest=function(){return rt},this.setScissorTest=function(N){Qe.setScissorTest(rt=N)},this.setOpaqueSort=function(N){wn=N},this.setTransparentSort=function(N){xn=N},this.getClearColor=function(N){return N.copy(je.getClearColor())},this.setClearColor=function(){je.setClearColor(...arguments)},this.getClearAlpha=function(){return je.getClearAlpha()},this.setClearAlpha=function(){je.setClearAlpha(...arguments)},this.clear=function(N=!0,ie=!0,pe=!0){let fe=0;if(N){let le=!1;if(ce!==null){let Ye=ce.texture.format;le=T.has(Ye)}if(le){let Ye=ce.texture.type,nt=M.has(Ye),Ze=je.getClearColor(),at=je.getClearAlpha(),mt=Ze.r,Ct=Ze.g,yt=Ze.b;nt?(G[0]=mt,G[1]=Ct,G[2]=yt,G[3]=at,Q.clearBufferuiv(Q.COLOR,0,G)):(Y[0]=mt,Y[1]=Ct,Y[2]=yt,Y[3]=at,Q.clearBufferiv(Q.COLOR,0,Y))}else fe|=Q.COLOR_BUFFER_BIT}ie&&(fe|=Q.DEPTH_BUFFER_BIT),pe&&(fe|=Q.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),Q.clear(fe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){e.removeEventListener("webglcontextlost",vt,!1),e.removeEventListener("webglcontextrestored",Wt,!1),e.removeEventListener("webglcontextcreationerror",st,!1),je.dispose(),Fe.dispose(),He.dispose(),k.dispose(),ge.dispose(),Ae.dispose(),ke.dispose(),Je.dispose(),ue.dispose(),dt.dispose(),Ge.dispose(),Ge.removeEventListener("sessionstart",xr),Ge.removeEventListener("sessionend",or),In.stop()};function vt(N){N.preventDefault(),nC("WebGLRenderer: Context Lost."),z=!0}function Wt(){nC("WebGLRenderer: Context Restored."),z=!1;let N=W.autoReset,ie=ht.enabled,pe=ht.autoUpdate,fe=ht.needsUpdate,le=ht.type;Te(),W.autoReset=N,ht.enabled=ie,ht.autoUpdate=pe,ht.needsUpdate=fe,ht.type=le}function st(N){At("WebGLRenderer: A WebGL context could not be created. Reason: ",N.statusMessage)}function Xi(N){let ie=N.target;ie.removeEventListener("dispose",Xi),$t(ie)}function $t(N){Es(N),k.remove(N)}function Es(N){let ie=k.get(N).programs;ie!==void 0&&(ie.forEach(function(pe){dt.releaseProgram(pe)}),N.isShaderMaterial&&dt.releaseShaderCache(N))}this.renderBufferDirect=function(N,ie,pe,fe,le,Ye){ie===null&&(ie=Kt);let nt=le.isMesh&&le.matrixWorld.determinant()<0,Ze=co(N,ie,pe,fe,le);Qe.setMaterial(fe,nt);let at=pe.index,mt=1;if(fe.wireframe===!0){if(at=ct.getWireframeAttribute(pe),at===void 0)return;mt=2}let Ct=pe.drawRange,yt=pe.attributes.position,Rt=Ct.start*mt,bn=(Ct.start+Ct.count)*mt;Ye!==null&&(Rt=Math.max(Rt,Ye.start*mt),bn=Math.min(bn,(Ye.start+Ye.count)*mt)),at!==null?(Rt=Math.max(Rt,0),bn=Math.min(bn,at.count)):yt!=null&&(Rt=Math.max(Rt,0),bn=Math.min(bn,yt.count));let Bn=bn-Rt;if(Bn<0||Bn===1/0)return;Je.setup(le,fe,Ze,pe,at);let zn,Sn=ne;if(at!==null&&(zn=de.get(at),Sn=ze,Sn.setIndex(zn)),le.isMesh)fe.wireframe===!0?(Qe.setLineWidth(fe.wireframeLinewidth*un()),Sn.setMode(Q.LINES)):Sn.setMode(Q.TRIANGLES);else if(le.isLine){let _t=fe.linewidth;_t===void 0&&(_t=1),Qe.setLineWidth(_t*un()),le.isLineSegments?Sn.setMode(Q.LINES):le.isLineLoop?Sn.setMode(Q.LINE_LOOP):Sn.setMode(Q.LINE_STRIP)}else le.isPoints?Sn.setMode(Q.POINTS):le.isSprite&&Sn.setMode(Q.TRIANGLES);if(le.isBatchedMesh)if(le._multiDrawInstances!==null)rd("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Sn.renderMultiDrawInstances(le._multiDrawStarts,le._multiDrawCounts,le._multiDrawCount,le._multiDrawInstances);else if(an.get("WEBGL_multi_draw"))Sn.renderMultiDraw(le._multiDrawStarts,le._multiDrawCounts,le._multiDrawCount);else{let _t=le._multiDrawStarts,Yt=le._multiDrawCounts,Vt=le._multiDrawCount,Oi=at?de.get(at).bytesPerElement:1,br=k.get(fe).currentProgram.getUniforms();for(let Jn=0;Jn<Vt;Jn++)br.setValue(Q,"_gl_DrawID",Jn),Sn.render(_t[Jn]/Oi,Yt[Jn])}else if(le.isInstancedMesh)Sn.renderInstances(Rt,Bn,le.count);else if(pe.isInstancedBufferGeometry){let _t=pe._maxInstanceCount!==void 0?pe._maxInstanceCount:1/0,Yt=Math.min(pe.instanceCount,_t);Sn.renderInstances(Rt,Bn,Yt)}else Sn.render(Rt,Bn)};function sa(N,ie,pe){N.transparent===!0&&N.side===so&&N.forceSinglePass===!1?(N.side=yr,N.needsUpdate=!0,uo(N,ie,pe),N.side=na,N.needsUpdate=!0,uo(N,ie,pe),N.side=so):uo(N,ie,pe)}this.compile=function(N,ie,pe=null){pe===null&&(pe=N),X=He.get(pe),X.init(ie),J.push(X),pe.traverseVisible(function(le){le.isLight&&le.layers.test(ie.layers)&&(X.pushLight(le),le.castShadow&&X.pushShadow(le))}),N!==pe&&N.traverseVisible(function(le){le.isLight&&le.layers.test(ie.layers)&&(X.pushLight(le),le.castShadow&&X.pushShadow(le))}),X.setupLights();let fe=new Set;return N.traverse(function(le){if(!(le.isMesh||le.isPoints||le.isLine||le.isSprite))return;let Ye=le.material;if(Ye)if(Array.isArray(Ye))for(let nt=0;nt<Ye.length;nt++){let Ze=Ye[nt];sa(Ze,pe,le),fe.add(Ze)}else sa(Ye,pe,le),fe.add(Ye)}),X=J.pop(),fe},this.compileAsync=function(N,ie,pe=null){let fe=this.compile(N,ie,pe);return new Promise(le=>{function Ye(){if(fe.forEach(function(nt){k.get(nt).currentProgram.isReady()&&fe.delete(nt)}),fe.size===0){le(N);return}setTimeout(Ye,10)}an.get("KHR_parallel_shader_compile")!==null?Ye():setTimeout(Ye,10)})};let ao=null;function vi(N){ao&&ao(N)}function xr(){In.stop()}function or(){In.start()}let In=new QT;In.setAnimationLoop(vi),typeof self<"u"&&In.setContext(self),this.setAnimationLoop=function(N){ao=N,Ge.setAnimationLoop(N),N===null?In.stop():In.start()},Ge.addEventListener("sessionstart",xr),Ge.addEventListener("sessionend",or),this.render=function(N,ie){if(ie!==void 0&&ie.isCamera!==!0){At("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(z===!0)return;let pe=Ge.enabled===!0&&Ge.isPresenting===!0,fe=oe!==null&&(ce===null||pe)&&oe.begin(L,ce);if(N.matrixWorldAutoUpdate===!0&&N.updateMatrixWorld(),ie.parent===null&&ie.matrixWorldAutoUpdate===!0&&ie.updateMatrixWorld(),Ge.enabled===!0&&Ge.isPresenting===!0&&(oe===null||oe.isCompositing()===!1)&&(Ge.cameraAutoUpdate===!0&&Ge.updateCamera(ie),ie=Ge.getCamera()),N.isScene===!0&&N.onBeforeRender(L,N,ie,ce),X=He.get(N,J.length),X.init(ie),J.push(X),Xn.multiplyMatrices(ie.projectionMatrix,ie.matrixWorldInverse),Pt.setFromProjectionMatrix(Xn,Go,ie.reversedDepth),tn=this.localClippingEnabled,ft=tt.init(this.clippingPlanes,tn),q=Fe.get(N,Z.length),q.init(),Z.push(q),Ge.enabled===!0&&Ge.isPresenting===!0){let nt=L.xr.getDepthSensingMesh();nt!==null&&ji(nt,ie,-1/0,L.sortObjects)}ji(N,ie,0,L.sortObjects),q.finish(),L.sortObjects===!0&&q.sort(wn,xn),Nt=Ge.enabled===!1||Ge.isPresenting===!1||Ge.hasDepthSensing()===!1,Nt&&je.addToRenderList(q,N),this.info.render.frame++,ft===!0&&tt.beginShadows();let le=X.state.shadowsArray;if(ht.render(le,N,ie),ft===!0&&tt.endShadows(),this.info.autoReset===!0&&this.info.reset(),(fe&&oe.hasRenderPass())===!1){let nt=q.opaque,Ze=q.transmissive;if(X.setupLights(),ie.isArrayCamera){let at=ie.cameras;if(Ze.length>0)for(let mt=0,Ct=at.length;mt<Ct;mt++){let yt=at[mt];lo(nt,Ze,N,yt)}Nt&&je.render(N);for(let mt=0,Ct=at.length;mt<Ct;mt++){let yt=at[mt];Qt(q,N,yt,yt.viewport)}}else Ze.length>0&&lo(nt,Ze,N,ie),Nt&&je.render(N),Qt(q,N,ie)}ce!==null&&re===0&&(te.updateMultisampleRenderTarget(ce),te.updateRenderTargetMipmap(ce)),fe&&oe.end(L),N.isScene===!0&&N.onAfterRender(L,N,ie),Je.resetDefaultState(),we=-1,Ee=null,J.pop(),J.length>0?(X=J[J.length-1],ft===!0&&tt.setGlobalState(L.clippingPlanes,X.state.camera)):X=null,Z.pop(),Z.length>0?q=Z[Z.length-1]:q=null};function ji(N,ie,pe,fe){if(N.visible===!1)return;if(N.layers.test(ie.layers)){if(N.isGroup)pe=N.renderOrder;else if(N.isLOD)N.autoUpdate===!0&&N.update(ie);else if(N.isLight)X.pushLight(N),N.castShadow&&X.pushShadow(N);else if(N.isSprite){if(!N.frustumCulled||Pt.intersectsSprite(N)){fe&&It.setFromMatrixPosition(N.matrixWorld).applyMatrix4(Xn);let nt=ke.update(N),Ze=N.material;Ze.visible&&q.push(N,nt,Ze,pe,It.z,null)}}else if((N.isMesh||N.isLine||N.isPoints)&&(!N.frustumCulled||Pt.intersectsObject(N))){let nt=ke.update(N),Ze=N.material;if(fe&&(N.boundingSphere!==void 0?(N.boundingSphere===null&&N.computeBoundingSphere(),It.copy(N.boundingSphere.center)):(nt.boundingSphere===null&&nt.computeBoundingSphere(),It.copy(nt.boundingSphere.center)),It.applyMatrix4(N.matrixWorld).applyMatrix4(Xn)),Array.isArray(Ze)){let at=nt.groups;for(let mt=0,Ct=at.length;mt<Ct;mt++){let yt=at[mt],Rt=Ze[yt.materialIndex];Rt&&Rt.visible&&q.push(N,nt,Rt,pe,It.z,yt)}}else Ze.visible&&q.push(N,nt,Ze,pe,It.z,null)}}let Ye=N.children;for(let nt=0,Ze=Ye.length;nt<Ze;nt++)ji(Ye[nt],ie,pe,fe)}function Qt(N,ie,pe,fe){let{opaque:le,transmissive:Ye,transparent:nt}=N;X.setupLightsView(pe),ft===!0&&tt.setGlobalState(L.clippingPlanes,pe),fe&&Qe.viewport(xe.copy(fe)),le.length>0&&aa(le,ie,pe),Ye.length>0&&aa(Ye,ie,pe),nt.length>0&&aa(nt,ie,pe),Qe.buffers.depth.setTest(!0),Qe.buffers.depth.setMask(!0),Qe.buffers.color.setMask(!0),Qe.setPolygonOffset(!1)}function lo(N,ie,pe,fe){if((pe.isScene===!0?pe.overrideMaterial:null)!==null)return;if(X.state.transmissionRenderTarget[fe.id]===void 0){let Rt=an.has("EXT_color_buffer_half_float")||an.has("EXT_color_buffer_float");X.state.transmissionRenderTarget[fe.id]=new io(1,1,{generateMipmaps:!0,type:Rt?xs:Lr,minFilter:el,samples:gt.samples,stencilBuffer:o,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:yn.workingColorSpace})}let Ye=X.state.transmissionRenderTarget[fe.id],nt=fe.viewport||xe;Ye.setSize(nt.z*L.transmissionResolutionScale,nt.w*L.transmissionResolutionScale);let Ze=L.getRenderTarget(),at=L.getActiveCubeFace(),mt=L.getActiveMipmapLevel();L.setRenderTarget(Ye),L.getClearColor(qe),Be=L.getClearAlpha(),Be<1&&L.setClearColor(16777215,.5),L.clear(),Nt&&je.render(pe);let Ct=L.toneMapping;L.toneMapping=Yo;let yt=fe.viewport;if(fe.viewport!==void 0&&(fe.viewport=void 0),X.setupLightsView(fe),ft===!0&&tt.setGlobalState(L.clippingPlanes,fe),aa(N,pe,fe),te.updateMultisampleRenderTarget(Ye),te.updateRenderTargetMipmap(Ye),an.has("WEBGL_multisampled_render_to_texture")===!1){let Rt=!1;for(let bn=0,Bn=ie.length;bn<Bn;bn++){let zn=ie[bn],{object:Sn,geometry:_t,material:Yt,group:Vt}=zn;if(Yt.side===so&&Sn.layers.test(fe.layers)){let Oi=Yt.side;Yt.side=yr,Yt.needsUpdate=!0,xu(Sn,pe,fe,_t,Yt,Vt),Yt.side=Oi,Yt.needsUpdate=!0,Rt=!0}}Rt===!0&&(te.updateMultisampleRenderTarget(Ye),te.updateRenderTargetMipmap(Ye))}L.setRenderTarget(Ze,at,mt),L.setClearColor(qe,Be),yt!==void 0&&(fe.viewport=yt),L.toneMapping=Ct}function aa(N,ie,pe){let fe=ie.isScene===!0?ie.overrideMaterial:null;for(let le=0,Ye=N.length;le<Ye;le++){let nt=N[le],{object:Ze,geometry:at,group:mt}=nt,Ct=nt.material;Ct.allowOverride===!0&&fe!==null&&(Ct=fe),Ze.layers.test(pe.layers)&&xu(Ze,ie,pe,at,Ct,mt)}}function xu(N,ie,pe,fe,le,Ye){N.onBeforeRender(L,ie,pe,fe,le,Ye),N.modelViewMatrix.multiplyMatrices(pe.matrixWorldInverse,N.matrixWorld),N.normalMatrix.getNormalMatrix(N.modelViewMatrix),le.onBeforeRender(L,ie,pe,fe,N,Ye),le.transparent===!0&&le.side===so&&le.forceSinglePass===!1?(le.side=yr,le.needsUpdate=!0,L.renderBufferDirect(pe,ie,fe,le,N,Ye),le.side=na,le.needsUpdate=!0,L.renderBufferDirect(pe,ie,fe,le,N,Ye),le.side=so):L.renderBufferDirect(pe,ie,fe,le,N,Ye),N.onAfterRender(L,ie,pe,fe,le,Ye)}function uo(N,ie,pe){ie.isScene!==!0&&(ie=Kt);let fe=k.get(N),le=X.state.lights,Ye=X.state.shadowsArray,nt=le.state.version,Ze=dt.getParameters(N,le.state,Ye,ie,pe),at=dt.getProgramCacheKey(Ze),mt=fe.programs;fe.environment=N.isMeshStandardMaterial?ie.environment:null,fe.fog=ie.fog,fe.envMap=(N.isMeshStandardMaterial?Ae:ge).get(N.envMap||fe.environment),fe.envMapRotation=fe.environment!==null&&N.envMap===null?ie.environmentRotation:N.envMapRotation,mt===void 0&&(N.addEventListener("dispose",Xi),mt=new Map,fe.programs=mt);let Ct=mt.get(at);if(Ct!==void 0){if(fe.currentProgram===Ct&&fe.lightsStateVersion===nt)return bu(N,Ze),Ct}else Ze.uniforms=dt.getUniforms(N),N.onBeforeCompile(Ze,L),Ct=dt.acquireProgram(Ze,at),mt.set(at,Ct),fe.uniforms=Ze.uniforms;let yt=fe.uniforms;return(!N.isShaderMaterial&&!N.isRawShaderMaterial||N.clipping===!0)&&(yt.clippingPlanes=tt.uniform),bu(N,Ze),fe.needsLights=al(N),fe.lightsStateVersion=nt,fe.needsLights&&(yt.ambientLightColor.value=le.state.ambient,yt.lightProbe.value=le.state.probe,yt.directionalLights.value=le.state.directional,yt.directionalLightShadows.value=le.state.directionalShadow,yt.spotLights.value=le.state.spot,yt.spotLightShadows.value=le.state.spotShadow,yt.rectAreaLights.value=le.state.rectArea,yt.ltc_1.value=le.state.rectAreaLTC1,yt.ltc_2.value=le.state.rectAreaLTC2,yt.pointLights.value=le.state.point,yt.pointLightShadows.value=le.state.pointShadow,yt.hemisphereLights.value=le.state.hemi,yt.directionalShadowMap.value=le.state.directionalShadowMap,yt.directionalShadowMatrix.value=le.state.directionalShadowMatrix,yt.spotShadowMap.value=le.state.spotShadowMap,yt.spotLightMatrix.value=le.state.spotLightMatrix,yt.spotLightMap.value=le.state.spotLightMap,yt.pointShadowMap.value=le.state.pointShadowMap,yt.pointShadowMatrix.value=le.state.pointShadowMatrix),fe.currentProgram=Ct,fe.uniformsList=null,Ct}function sl(N){if(N.uniformsList===null){let ie=N.currentProgram.getUniforms();N.uniformsList=vd.seqWithValue(ie.seq,N.uniforms)}return N.uniformsList}function bu(N,ie){let pe=k.get(N);pe.outputColorSpace=ie.outputColorSpace,pe.batching=ie.batching,pe.batchingColor=ie.batchingColor,pe.instancing=ie.instancing,pe.instancingColor=ie.instancingColor,pe.instancingMorph=ie.instancingMorph,pe.skinning=ie.skinning,pe.morphTargets=ie.morphTargets,pe.morphNormals=ie.morphNormals,pe.morphColors=ie.morphColors,pe.morphTargetsCount=ie.morphTargetsCount,pe.numClippingPlanes=ie.numClippingPlanes,pe.numIntersection=ie.numClipIntersection,pe.vertexAlphas=ie.vertexAlphas,pe.vertexTangents=ie.vertexTangents,pe.toneMapping=ie.toneMapping}function co(N,ie,pe,fe,le){ie.isScene!==!0&&(ie=Kt),te.resetTextureUnits();let Ye=ie.fog,nt=fe.isMeshStandardMaterial?ie.environment:null,Ze=ce===null?L.outputColorSpace:ce.isXRRenderTarget===!0?ce.texture.colorSpace:cu,at=(fe.isMeshStandardMaterial?Ae:ge).get(fe.envMap||nt),mt=fe.vertexColors===!0&&!!pe.attributes.color&&pe.attributes.color.itemSize===4,Ct=!!pe.attributes.tangent&&(!!fe.normalMap||fe.anisotropy>0),yt=!!pe.morphAttributes.position,Rt=!!pe.morphAttributes.normal,bn=!!pe.morphAttributes.color,Bn=Yo;fe.toneMapped&&(ce===null||ce.isXRRenderTarget===!0)&&(Bn=L.toneMapping);let zn=pe.morphAttributes.position||pe.morphAttributes.normal||pe.morphAttributes.color,Sn=zn!==void 0?zn.length:0,_t=k.get(fe),Yt=X.state.lights;if(ft===!0&&(tn===!0||N!==Ee)){let yi=N===Ee&&fe.id===we;tt.setState(fe,N,yi)}let Vt=!1;fe.version===_t.__version?(_t.needsLights&&_t.lightsStateVersion!==Yt.state.version||_t.outputColorSpace!==Ze||le.isBatchedMesh&&_t.batching===!1||!le.isBatchedMesh&&_t.batching===!0||le.isBatchedMesh&&_t.batchingColor===!0&&le.colorTexture===null||le.isBatchedMesh&&_t.batchingColor===!1&&le.colorTexture!==null||le.isInstancedMesh&&_t.instancing===!1||!le.isInstancedMesh&&_t.instancing===!0||le.isSkinnedMesh&&_t.skinning===!1||!le.isSkinnedMesh&&_t.skinning===!0||le.isInstancedMesh&&_t.instancingColor===!0&&le.instanceColor===null||le.isInstancedMesh&&_t.instancingColor===!1&&le.instanceColor!==null||le.isInstancedMesh&&_t.instancingMorph===!0&&le.morphTexture===null||le.isInstancedMesh&&_t.instancingMorph===!1&&le.morphTexture!==null||_t.envMap!==at||fe.fog===!0&&_t.fog!==Ye||_t.numClippingPlanes!==void 0&&(_t.numClippingPlanes!==tt.numPlanes||_t.numIntersection!==tt.numIntersection)||_t.vertexAlphas!==mt||_t.vertexTangents!==Ct||_t.morphTargets!==yt||_t.morphNormals!==Rt||_t.morphColors!==bn||_t.toneMapping!==Bn||_t.morphTargetsCount!==Sn)&&(Vt=!0):(Vt=!0,_t.__version=fe.version);let Oi=_t.currentProgram;Vt===!0&&(Oi=uo(fe,ie,le));let br=!1,Jn=!1,ws=!1,Dn=Oi.getUniforms(),Bi=_t.uniforms;if(Qe.useProgram(Oi.program)&&(br=!0,Jn=!0,ws=!0),fe.id!==we&&(we=fe.id,Jn=!0),br||Ee!==N){Qe.buffers.depth.getReversed()&&N.reversedDepth!==!0&&(N._reversedDepth=!0,N.updateProjectionMatrix()),Dn.setValue(Q,"projectionMatrix",N.projectionMatrix),Dn.setValue(Q,"viewMatrix",N.matrixWorldInverse);let Vi=Dn.map.cameraPosition;Vi!==void 0&&Vi.setValue(Q,sn.setFromMatrixPosition(N.matrixWorld)),gt.logarithmicDepthBuffer&&Dn.setValue(Q,"logDepthBufFC",2/(Math.log(N.far+1)/Math.LN2)),(fe.isMeshPhongMaterial||fe.isMeshToonMaterial||fe.isMeshLambertMaterial||fe.isMeshBasicMaterial||fe.isMeshStandardMaterial||fe.isShaderMaterial)&&Dn.setValue(Q,"isOrthographic",N.isOrthographicCamera===!0),Ee!==N&&(Ee=N,Jn=!0,ws=!0)}if(_t.needsLights&&(Yt.state.directionalShadowMap.length>0&&Dn.setValue(Q,"directionalShadowMap",Yt.state.directionalShadowMap,te),Yt.state.spotShadowMap.length>0&&Dn.setValue(Q,"spotShadowMap",Yt.state.spotShadowMap,te),Yt.state.pointShadowMap.length>0&&Dn.setValue(Q,"pointShadowMap",Yt.state.pointShadowMap,te)),le.isSkinnedMesh){Dn.setOptional(Q,le,"bindMatrix"),Dn.setOptional(Q,le,"bindMatrixInverse");let yi=le.skeleton;yi&&(yi.boneTexture===null&&yi.computeBoneTexture(),Dn.setValue(Q,"boneTexture",yi.boneTexture,te))}le.isBatchedMesh&&(Dn.setOptional(Q,le,"batchingTexture"),Dn.setValue(Q,"batchingTexture",le._matricesTexture,te),Dn.setOptional(Q,le,"batchingIdTexture"),Dn.setValue(Q,"batchingIdTexture",le._indirectTexture,te),Dn.setOptional(Q,le,"batchingColorTexture"),le._colorsTexture!==null&&Dn.setValue(Q,"batchingColorTexture",le._colorsTexture,te));let Zi=pe.morphAttributes;if((Zi.position!==void 0||Zi.normal!==void 0||Zi.color!==void 0)&&Ut.update(le,pe,Oi),(Jn||_t.receiveShadow!==le.receiveShadow)&&(_t.receiveShadow=le.receiveShadow,Dn.setValue(Q,"receiveShadow",le.receiveShadow)),fe.isMeshGouraudMaterial&&fe.envMap!==null&&(Bi.envMap.value=at,Bi.flipEnvMap.value=at.isCubeTexture&&at.isRenderTargetTexture===!1?-1:1),fe.isMeshStandardMaterial&&fe.envMap===null&&ie.environment!==null&&(Bi.envMapIntensity.value=ie.environmentIntensity),Bi.dfgLUT!==void 0&&(Bi.dfgLUT.value=tj()),Jn&&(Dn.setValue(Q,"toneMappingExposure",L.toneMappingExposure),_t.needsLights&&Hr(Bi,ws),Ye&&fe.fog===!0&&xt.refreshFogUniforms(Bi,Ye),xt.refreshMaterialUniforms(Bi,fe,Re,Et,X.state.transmissionRenderTarget[N.id]),vd.upload(Q,sl(_t),Bi,te)),fe.isShaderMaterial&&fe.uniformsNeedUpdate===!0&&(vd.upload(Q,sl(_t),Bi,te),fe.uniformsNeedUpdate=!1),fe.isSpriteMaterial&&Dn.setValue(Q,"center",le.center),Dn.setValue(Q,"modelViewMatrix",le.modelViewMatrix),Dn.setValue(Q,"normalMatrix",le.normalMatrix),Dn.setValue(Q,"modelMatrix",le.matrixWorld),fe.isShaderMaterial||fe.isRawShaderMaterial){let yi=fe.uniformsGroups;for(let Vi=0,ua=yi.length;Vi<ua;Vi++){let Ao=yi[Vi];ue.update(Ao,Oi),ue.bind(Ao,Oi)}}return Oi}function Hr(N,ie){N.ambientLightColor.needsUpdate=ie,N.lightProbe.needsUpdate=ie,N.directionalLights.needsUpdate=ie,N.directionalLightShadows.needsUpdate=ie,N.pointLights.needsUpdate=ie,N.pointLightShadows.needsUpdate=ie,N.spotLights.needsUpdate=ie,N.spotLightShadows.needsUpdate=ie,N.rectAreaLights.needsUpdate=ie,N.hemisphereLights.needsUpdate=ie}function al(N){return N.isMeshLambertMaterial||N.isMeshToonMaterial||N.isMeshPhongMaterial||N.isMeshStandardMaterial||N.isShadowMaterial||N.isShaderMaterial&&N.lights===!0}this.getActiveCubeFace=function(){return K},this.getActiveMipmapLevel=function(){return re},this.getRenderTarget=function(){return ce},this.setRenderTargetTextures=function(N,ie,pe){let fe=k.get(N);fe.__autoAllocateDepthBuffer=N.resolveDepthBuffer===!1,fe.__autoAllocateDepthBuffer===!1&&(fe.__useRenderToTexture=!1),k.get(N.texture).__webglTexture=ie,k.get(N.depthTexture).__webglTexture=fe.__autoAllocateDepthBuffer?void 0:pe,fe.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function(N,ie){let pe=k.get(N);pe.__webglFramebuffer=ie,pe.__useDefaultFramebuffer=ie===void 0};let la=Q.createFramebuffer();this.setRenderTarget=function(N,ie=0,pe=0){ce=N,K=ie,re=pe;let fe=null,le=!1,Ye=!1;if(N){let Ze=k.get(N);if(Ze.__useDefaultFramebuffer!==void 0){Qe.bindFramebuffer(Q.FRAMEBUFFER,Ze.__webglFramebuffer),xe.copy(N.viewport),me.copy(N.scissor),Me=N.scissorTest,Qe.viewport(xe),Qe.scissor(me),Qe.setScissorTest(Me),we=-1;return}else if(Ze.__webglFramebuffer===void 0)te.setupRenderTarget(N);else if(Ze.__hasExternalTextures)te.rebindTextures(N,k.get(N.texture).__webglTexture,k.get(N.depthTexture).__webglTexture);else if(N.depthBuffer){let Ct=N.depthTexture;if(Ze.__boundDepthTexture!==Ct){if(Ct!==null&&k.has(Ct)&&(N.width!==Ct.image.width||N.height!==Ct.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");te.setupDepthRenderbuffer(N)}}let at=N.texture;(at.isData3DTexture||at.isDataArrayTexture||at.isCompressedArrayTexture)&&(Ye=!0);let mt=k.get(N).__webglFramebuffer;N.isWebGLCubeRenderTarget?(Array.isArray(mt[ie])?fe=mt[ie][pe]:fe=mt[ie],le=!0):N.samples>0&&te.useMultisampledRTT(N)===!1?fe=k.get(N).__webglMultisampledFramebuffer:Array.isArray(mt)?fe=mt[pe]:fe=mt,xe.copy(N.viewport),me.copy(N.scissor),Me=N.scissorTest}else xe.copy(Se).multiplyScalar(Re).floor(),me.copy(De).multiplyScalar(Re).floor(),Me=rt;if(pe!==0&&(fe=la),Qe.bindFramebuffer(Q.FRAMEBUFFER,fe)&&Qe.drawBuffers(N,fe),Qe.viewport(xe),Qe.scissor(me),Qe.setScissorTest(Me),le){let Ze=k.get(N.texture);Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_CUBE_MAP_POSITIVE_X+ie,Ze.__webglTexture,pe)}else if(Ye){let Ze=ie;for(let at=0;at<N.textures.length;at++){let mt=k.get(N.textures[at]);Q.framebufferTextureLayer(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0+at,mt.__webglTexture,pe,Ze)}}else if(N!==null&&pe!==0){let Ze=k.get(N.texture);Q.framebufferTexture2D(Q.FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,Ze.__webglTexture,pe)}we=-1},this.readRenderTargetPixels=function(N,ie,pe,fe,le,Ye,nt,Ze=0){if(!(N&&N.isWebGLRenderTarget)){At("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let at=k.get(N).__webglFramebuffer;if(N.isWebGLCubeRenderTarget&&nt!==void 0&&(at=at[nt]),at){Qe.bindFramebuffer(Q.FRAMEBUFFER,at);try{let mt=N.textures[Ze],Ct=mt.format,yt=mt.type;if(!gt.textureFormatReadable(Ct)){At("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!gt.textureTypeReadable(yt)){At("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ie>=0&&ie<=N.width-fe&&pe>=0&&pe<=N.height-le&&(N.textures.length>1&&Q.readBuffer(Q.COLOR_ATTACHMENT0+Ze),Q.readPixels(ie,pe,fe,le,Ue.convert(Ct),Ue.convert(yt),Ye))}finally{let mt=ce!==null?k.get(ce).__webglFramebuffer:null;Qe.bindFramebuffer(Q.FRAMEBUFFER,mt)}}},this.readRenderTargetPixelsAsync=function(N,ie,pe,fe,le,Ye,nt,Ze=0){return wt(this,null,function*(){if(!(N&&N.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let at=k.get(N).__webglFramebuffer;if(N.isWebGLCubeRenderTarget&&nt!==void 0&&(at=at[nt]),at)if(ie>=0&&ie<=N.width-fe&&pe>=0&&pe<=N.height-le){Qe.bindFramebuffer(Q.FRAMEBUFFER,at);let mt=N.textures[Ze],Ct=mt.format,yt=mt.type;if(!gt.textureFormatReadable(Ct))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!gt.textureTypeReadable(yt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");let Rt=Q.createBuffer();Q.bindBuffer(Q.PIXEL_PACK_BUFFER,Rt),Q.bufferData(Q.PIXEL_PACK_BUFFER,Ye.byteLength,Q.STREAM_READ),N.textures.length>1&&Q.readBuffer(Q.COLOR_ATTACHMENT0+Ze),Q.readPixels(ie,pe,fe,le,Ue.convert(Ct),Ue.convert(yt),0);let bn=ce!==null?k.get(ce).__webglFramebuffer:null;Qe.bindFramebuffer(Q.FRAMEBUFFER,bn);let Bn=Q.fenceSync(Q.SYNC_GPU_COMMANDS_COMPLETE,0);return Q.flush(),yield AT(Q,Bn,4),Q.bindBuffer(Q.PIXEL_PACK_BUFFER,Rt),Q.getBufferSubData(Q.PIXEL_PACK_BUFFER,0,Ye),Q.deleteBuffer(Rt),Q.deleteSync(Bn),Ye}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")})},this.copyFramebufferToTexture=function(N,ie=null,pe=0){let fe=Math.pow(2,-pe),le=Math.floor(N.image.width*fe),Ye=Math.floor(N.image.height*fe),nt=ie!==null?ie.x:0,Ze=ie!==null?ie.y:0;te.setTexture2D(N,0),Q.copyTexSubImage2D(Q.TEXTURE_2D,pe,0,0,nt,Ze,le,Ye),Qe.unbindTexture()};let Zn=Q.createFramebuffer(),Ed=Q.createFramebuffer();this.copyTextureToTexture=function(N,ie,pe=null,fe=null,le=0,Ye=null){Ye===null&&(le!==0?(rd("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Ye=le,le=0):Ye=0);let nt,Ze,at,mt,Ct,yt,Rt,bn,Bn,zn=N.isCompressedTexture?N.mipmaps[Ye]:N.image;if(pe!==null)nt=pe.max.x-pe.min.x,Ze=pe.max.y-pe.min.y,at=pe.isBox3?pe.max.z-pe.min.z:1,mt=pe.min.x,Ct=pe.min.y,yt=pe.isBox3?pe.min.z:0;else{let Zi=Math.pow(2,-le);nt=Math.floor(zn.width*Zi),Ze=Math.floor(zn.height*Zi),N.isDataArrayTexture?at=zn.depth:N.isData3DTexture?at=Math.floor(zn.depth*Zi):at=1,mt=0,Ct=0,yt=0}fe!==null?(Rt=fe.x,bn=fe.y,Bn=fe.z):(Rt=0,bn=0,Bn=0);let Sn=Ue.convert(ie.format),_t=Ue.convert(ie.type),Yt;ie.isData3DTexture?(te.setTexture3D(ie,0),Yt=Q.TEXTURE_3D):ie.isDataArrayTexture||ie.isCompressedArrayTexture?(te.setTexture2DArray(ie,0),Yt=Q.TEXTURE_2D_ARRAY):(te.setTexture2D(ie,0),Yt=Q.TEXTURE_2D),Q.pixelStorei(Q.UNPACK_FLIP_Y_WEBGL,ie.flipY),Q.pixelStorei(Q.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ie.premultiplyAlpha),Q.pixelStorei(Q.UNPACK_ALIGNMENT,ie.unpackAlignment);let Vt=Q.getParameter(Q.UNPACK_ROW_LENGTH),Oi=Q.getParameter(Q.UNPACK_IMAGE_HEIGHT),br=Q.getParameter(Q.UNPACK_SKIP_PIXELS),Jn=Q.getParameter(Q.UNPACK_SKIP_ROWS),ws=Q.getParameter(Q.UNPACK_SKIP_IMAGES);Q.pixelStorei(Q.UNPACK_ROW_LENGTH,zn.width),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,zn.height),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,mt),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,Ct),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,yt);let Dn=N.isDataArrayTexture||N.isData3DTexture,Bi=ie.isDataArrayTexture||ie.isData3DTexture;if(N.isDepthTexture){let Zi=k.get(N),yi=k.get(ie),Vi=k.get(Zi.__renderTarget),ua=k.get(yi.__renderTarget);Qe.bindFramebuffer(Q.READ_FRAMEBUFFER,Vi.__webglFramebuffer),Qe.bindFramebuffer(Q.DRAW_FRAMEBUFFER,ua.__webglFramebuffer);for(let Ao=0;Ao<at;Ao++)Dn&&(Q.framebufferTextureLayer(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,k.get(N).__webglTexture,le,yt+Ao),Q.framebufferTextureLayer(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,k.get(ie).__webglTexture,Ye,Bn+Ao)),Q.blitFramebuffer(mt,Ct,nt,Ze,Rt,bn,nt,Ze,Q.DEPTH_BUFFER_BIT,Q.NEAREST);Qe.bindFramebuffer(Q.READ_FRAMEBUFFER,null),Qe.bindFramebuffer(Q.DRAW_FRAMEBUFFER,null)}else if(le!==0||N.isRenderTargetTexture||k.has(N)){let Zi=k.get(N),yi=k.get(ie);Qe.bindFramebuffer(Q.READ_FRAMEBUFFER,Zn),Qe.bindFramebuffer(Q.DRAW_FRAMEBUFFER,Ed);for(let Vi=0;Vi<at;Vi++)Dn?Q.framebufferTextureLayer(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Zi.__webglTexture,le,yt+Vi):Q.framebufferTexture2D(Q.READ_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,Zi.__webglTexture,le),Bi?Q.framebufferTextureLayer(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,yi.__webglTexture,Ye,Bn+Vi):Q.framebufferTexture2D(Q.DRAW_FRAMEBUFFER,Q.COLOR_ATTACHMENT0,Q.TEXTURE_2D,yi.__webglTexture,Ye),le!==0?Q.blitFramebuffer(mt,Ct,nt,Ze,Rt,bn,nt,Ze,Q.COLOR_BUFFER_BIT,Q.NEAREST):Bi?Q.copyTexSubImage3D(Yt,Ye,Rt,bn,Bn+Vi,mt,Ct,nt,Ze):Q.copyTexSubImage2D(Yt,Ye,Rt,bn,mt,Ct,nt,Ze);Qe.bindFramebuffer(Q.READ_FRAMEBUFFER,null),Qe.bindFramebuffer(Q.DRAW_FRAMEBUFFER,null)}else Bi?N.isDataTexture||N.isData3DTexture?Q.texSubImage3D(Yt,Ye,Rt,bn,Bn,nt,Ze,at,Sn,_t,zn.data):ie.isCompressedArrayTexture?Q.compressedTexSubImage3D(Yt,Ye,Rt,bn,Bn,nt,Ze,at,Sn,zn.data):Q.texSubImage3D(Yt,Ye,Rt,bn,Bn,nt,Ze,at,Sn,_t,zn):N.isDataTexture?Q.texSubImage2D(Q.TEXTURE_2D,Ye,Rt,bn,nt,Ze,Sn,_t,zn.data):N.isCompressedTexture?Q.compressedTexSubImage2D(Q.TEXTURE_2D,Ye,Rt,bn,zn.width,zn.height,Sn,zn.data):Q.texSubImage2D(Q.TEXTURE_2D,Ye,Rt,bn,nt,Ze,Sn,_t,zn);Q.pixelStorei(Q.UNPACK_ROW_LENGTH,Vt),Q.pixelStorei(Q.UNPACK_IMAGE_HEIGHT,Oi),Q.pixelStorei(Q.UNPACK_SKIP_PIXELS,br),Q.pixelStorei(Q.UNPACK_SKIP_ROWS,Jn),Q.pixelStorei(Q.UNPACK_SKIP_IMAGES,ws),Ye===0&&ie.generateMipmaps&&Q.generateMipmap(Yt),Qe.unbindTexture()},this.initRenderTarget=function(N){k.get(N).__webglFramebuffer===void 0&&te.setupRenderTarget(N)},this.initTexture=function(N){N.isCubeTexture?te.setTextureCube(N,0):N.isData3DTexture?te.setTexture3D(N,0):N.isDataArrayTexture||N.isCompressedArrayTexture?te.setTexture2DArray(N,0):te.setTexture2D(N,0),Qe.unbindTexture()},this.resetState=function(){K=0,re=0,ce=null,Qe.reset(),Je.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Go}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;let e=this.getContext();e.drawingBufferColorSpace=yn._getDrawingBufferColorSpace(t),e.unpackColorSpace=yn._getUnpackColorSpace()}};$();var rD={type:"change"},MC={type:"start"},sD={type:"end"},k1=new fu,oD=new Eo,ij=Math.cos(70*rC.DEG2RAD),Li=new ae,Br=2*Math.PI,Ln={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},SC=1e-6,N1=class extends Hf{constructor(t,e=null){super(t,e),this.state=Ln.NONE,this.target=new ae,this.cursor=new ae,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ja.ROTATE,MIDDLE:Ja.DOLLY,RIGHT:Ja.PAN},this.touches={ONE:Ka.ROTATE,TWO:Ka.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new ae,this._lastQuaternion=new So,this._lastTargetPosition=new ae,this._quat=new So().setFromUnitVectors(t.up,new ae(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new fd,this._sphericalDelta=new fd,this._scale=1,this._panOffset=new ae,this._rotateStart=new Ft,this._rotateEnd=new Ft,this._rotateDelta=new Ft,this._panStart=new Ft,this._panEnd=new Ft,this._panDelta=new Ft,this._dollyStart=new Ft,this._dollyEnd=new Ft,this._dollyDelta=new Ft,this._dollyDirection=new ae,this._mouse=new Ft,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=oj.bind(this),this._onPointerDown=rj.bind(this),this._onPointerUp=sj.bind(this),this._onContextMenu=hj.bind(this),this._onMouseWheel=uj.bind(this),this._onKeyDown=cj.bind(this),this._onTouchStart=dj.bind(this),this._onTouchMove=fj.bind(this),this._onMouseDown=aj.bind(this),this._onMouseMove=lj.bind(this),this._interceptControlDown=pj.bind(this),this._interceptControlUp=mj.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(t){super.connect(t),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(rD),this.update(),this.state=Ln.NONE}update(t=null){let e=this.object.position;Li.copy(e).sub(this.target),Li.applyQuaternion(this._quat),this._spherical.setFromVector3(Li),this.autoRotate&&this.state===Ln.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let i=this.minAzimuthAngle,r=this.maxAzimuthAngle;isFinite(i)&&isFinite(r)&&(i<-Math.PI?i+=Br:i>Math.PI&&(i-=Br),r<-Math.PI?r+=Br:r>Math.PI&&(r-=Br),i<=r?this._spherical.theta=Math.max(i,Math.min(r,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(i+r)/2?Math.max(i,this._spherical.theta):Math.min(r,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let o=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{let l=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),o=l!=this._spherical.radius}if(Li.setFromSpherical(this._spherical),Li.applyQuaternion(this._quatInverse),e.copy(this.target).add(Li),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let l=null;if(this.object.isPerspectiveCamera){let c=Li.length();l=this._clampDistance(c*this._scale);let f=c-l;this.object.position.addScaledVector(this._dollyDirection,f),this.object.updateMatrixWorld(),o=!!f}else if(this.object.isOrthographicCamera){let c=new ae(this._mouse.x,this._mouse.y,0);c.unproject(this.object);let f=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),o=f!==this.object.zoom;let p=new ae(this._mouse.x,this._mouse.y,0);p.unproject(this.object),this.object.position.sub(p).add(c),this.object.updateMatrixWorld(),l=Li.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;l!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(l).add(this.object.position):(k1.origin.copy(this.object.position),k1.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(k1.direction))<ij?this.object.lookAt(this.target):(oD.setFromNormalAndCoplanarPoint(this.object.up,this.target),k1.intersectPlane(oD,this.target))))}else if(this.object.isOrthographicCamera){let l=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),l!==this.object.zoom&&(this.object.updateProjectionMatrix(),o=!0)}return this._scale=1,this._performCursorZoom=!1,o||this._lastPosition.distanceToSquared(this.object.position)>SC||8*(1-this._lastQuaternion.dot(this.object.quaternion))>SC||this._lastTargetPosition.distanceToSquared(this.target)>SC?(this.dispatchEvent(rD),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?Br/60*this.autoRotateSpeed*t:Br/60/60*this.autoRotateSpeed}_getZoomScale(t){let e=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*e)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,e){Li.setFromMatrixColumn(e,0),Li.multiplyScalar(-t),this._panOffset.add(Li)}_panUp(t,e){this.screenSpacePanning===!0?Li.setFromMatrixColumn(e,1):(Li.setFromMatrixColumn(e,0),Li.crossVectors(this.object.up,Li)),Li.multiplyScalar(t),this._panOffset.add(Li)}_pan(t,e){let i=this.domElement;if(this.object.isPerspectiveCamera){let r=this.object.position;Li.copy(r).sub(this.target);let o=Li.length();o*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*o/i.clientHeight,this.object.matrix),this._panUp(2*e*o/i.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/i.clientWidth,this.object.matrix),this._panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/i.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,e){if(!this.zoomToCursor)return;this._performCursorZoom=!0;let i=this.domElement.getBoundingClientRect(),r=t-i.left,o=e-i.top,l=i.width,c=i.height;this._mouse.x=r/l*2-1,this._mouse.y=-(o/c)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let e=this.domElement;this._rotateLeft(Br*this._rotateDelta.x/e.clientHeight),this._rotateUp(Br*this._rotateDelta.y/e.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let e=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(Br*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),e=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(-Br*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),e=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(Br*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),e=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(-Br*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),e=!0;break}e&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{let e=this._getSecondPointerPosition(t),i=.5*(t.pageX+e.x),r=.5*(t.pageY+e.y);this._rotateStart.set(i,r)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{let e=this._getSecondPointerPosition(t),i=.5*(t.pageX+e.x),r=.5*(t.pageY+e.y);this._panStart.set(i,r)}}_handleTouchStartDolly(t){let e=this._getSecondPointerPosition(t),i=t.pageX-e.x,r=t.pageY-e.y,o=Math.sqrt(i*i+r*r);this._dollyStart.set(0,o)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{let i=this._getSecondPointerPosition(t),r=.5*(t.pageX+i.x),o=.5*(t.pageY+i.y);this._rotateEnd.set(r,o)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);let e=this.domElement;this._rotateLeft(Br*this._rotateDelta.x/e.clientHeight),this._rotateUp(Br*this._rotateDelta.y/e.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{let e=this._getSecondPointerPosition(t),i=.5*(t.pageX+e.x),r=.5*(t.pageY+e.y);this._panEnd.set(i,r)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){let e=this._getSecondPointerPosition(t),i=t.pageX-e.x,r=t.pageY-e.y,o=Math.sqrt(i*i+r*r);this._dollyEnd.set(0,o),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);let l=(t.pageX+e.x)*.5,c=(t.pageY+e.y)*.5;this._updateZoomParameters(l,c)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let e=0;e<this._pointers.length;e++)if(this._pointers[e]==t.pointerId){this._pointers.splice(e,1);return}}_isTrackingPointer(t){for(let e=0;e<this._pointers.length;e++)if(this._pointers[e]==t.pointerId)return!0;return!1}_trackPointer(t){let e=this._pointerPositions[t.pointerId];e===void 0&&(e=new Ft,this._pointerPositions[t.pointerId]=e),e.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){let e=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[e]}_customWheelEvent(t){let e=t.deltaMode,i={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(e){case 1:i.deltaY*=16;break;case 2:i.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(i.deltaY*=10),i}};function rj(n){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(n.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(n)&&(this._addPointer(n),n.pointerType==="touch"?this._onTouchStart(n):this._onMouseDown(n)))}function oj(n){this.enabled!==!1&&(n.pointerType==="touch"?this._onTouchMove(n):this._onMouseMove(n))}function sj(n){switch(this._removePointer(n),this._pointers.length){case 0:this.domElement.releasePointerCapture(n.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(sD),this.state=Ln.NONE;break;case 1:let t=this._pointers[0],e=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:e.x,pageY:e.y});break}}function aj(n){let t;switch(n.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case Ja.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(n),this.state=Ln.DOLLY;break;case Ja.ROTATE:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=Ln.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=Ln.ROTATE}break;case Ja.PAN:if(n.ctrlKey||n.metaKey||n.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(n),this.state=Ln.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(n),this.state=Ln.PAN}break;default:this.state=Ln.NONE}this.state!==Ln.NONE&&this.dispatchEvent(MC)}function lj(n){switch(this.state){case Ln.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(n);break;case Ln.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(n);break;case Ln.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(n);break}}function uj(n){this.enabled===!1||this.enableZoom===!1||this.state!==Ln.NONE||(n.preventDefault(),this.dispatchEvent(MC),this._handleMouseWheel(this._customWheelEvent(n)),this.dispatchEvent(sD))}function cj(n){this.enabled!==!1&&this._handleKeyDown(n)}function dj(n){switch(this._trackPointer(n),this._pointers.length){case 1:switch(this.touches.ONE){case Ka.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(n),this.state=Ln.TOUCH_ROTATE;break;case Ka.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(n),this.state=Ln.TOUCH_PAN;break;default:this.state=Ln.NONE}break;case 2:switch(this.touches.TWO){case Ka.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(n),this.state=Ln.TOUCH_DOLLY_PAN;break;case Ka.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(n),this.state=Ln.TOUCH_DOLLY_ROTATE;break;default:this.state=Ln.NONE}break;default:this.state=Ln.NONE}this.state!==Ln.NONE&&this.dispatchEvent(MC)}function fj(n){switch(this._trackPointer(n),this.state){case Ln.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(n),this.update();break;case Ln.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(n),this.update();break;case Ln.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(n),this.update();break;case Ln.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(n),this.update();break;default:this.state=Ln.NONE}}function hj(n){this.enabled!==!1&&n.preventDefault()}function pj(n){n.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function mj(n){n.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}$();var U1=class n{constructor(t,e){this.http=t;this.authService=e}apiUrl=Bt.apiUrl;getRooms(t){return this.http.get(`${this.apiUrl}/classrooms`,{params:t,headers:this.authService.getAuthHeaders()})}getRoomById(t){return this.http.get(`${this.apiUrl}/classrooms/${t}`,{headers:this.authService.getAuthHeaders()})}createRoom(t){return this.http.post(`${this.apiUrl}/classrooms`,t,{headers:this.authService.getAuthHeaders()})}updateRoom(t,e){return this.http.put(`${this.apiUrl}/classrooms/${t}`,e,{headers:this.authService.getAuthHeaders()})}deleteRoom(t){return this.http.delete(`${this.apiUrl}/classrooms/${t}`,{headers:this.authService.getAuthHeaders()})}getRoomSchedule(t){return this.http.get(`${this.apiUrl}/classrooms/${t}/schedule`,{headers:this.authService.getAuthHeaders()})}getCurrentClasses(t){return this.http.get(`${this.apiUrl}/classrooms/${t}/current-classes`,{headers:this.authService.getAuthHeaders()})}getSchoolMap(){return this.http.get(`${this.apiUrl}/school/map`,{headers:this.authService.getAuthHeaders()})}changeRoomStatus(t,e){return this.http.patch(`${this.apiUrl}/classrooms/${t}/status`,{status:e},{headers:this.authService.getAuthHeaders()})}getAvailableRooms(t){return this.http.get(`${this.apiUrl}/classrooms/available`,{params:t,headers:this.authService.getAuthHeaders()})}getRoomStatistics(){return this.http.get(`${this.apiUrl}/classrooms/statistics`,{headers:this.authService.getAuthHeaders()})}loadRoomFurniture(t){return this.http.get(`${this.apiUrl}/classrooms/${t}/furniture`,{headers:this.authService.getAuthHeaders()})}saveRoomLayout(t,e){return this.http.post(`${this.apiUrl}/classrooms/${t}/layout`,e,{headers:this.authService.getAuthHeaders()})}static \u0275fac=function(e){return new(e||n)(We(pn),We(qn))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})};var _j=["gameCanvas"],aD=()=>[1,2,3];function vj(n,t){n&1&&(s(0,"div",61)(1,"div",62)(2,"div",63),b(3,"div",64),s(4,"div",65),b(5,"div",66)(6,"div",66)(7,"div",66)(8,"div",66)(9,"div",66)(10,"div",66)(11,"div",67),a()(),s(12,"p"),u(13,"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u063A\u0631\u0641..."),a()()())}function yj(n,t){if(n&1&&(s(0,"option",68),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),H(" \u0627\u0644\u0637\u0627\u0628\u0642 ",e," ")}}function xj(n,t){if(n&1){let e=he();s(0,"div",69)(1,"div",70)(2,"button",71),I("click",function(){F(e);let r=E();return R(r.changeFloor(-1))}),b(3,"i",72),u(4," \u0627\u0644\u0637\u0627\u0628\u0642 \u0627\u0644\u0633\u0627\u0628\u0642 "),a(),s(5,"div",73)(6,"div",74),b(7,"i",34),u(8),a(),s(9,"p",75),b(10,"i",38),u(11),a()(),s(12,"button",71),I("click",function(){F(e);let r=E();return R(r.changeFloor(1))}),u(13," \u0627\u0644\u0637\u0627\u0628\u0642 \u0627\u0644\u062A\u0627\u0644\u064A "),b(14,"i",76),a()(),s(15,"div",77)(16,"button",78),I("click",function(){F(e);let r=E();return R(r.zoomOut())}),b(17,"i",79),a(),s(18,"div",80),u(19),a(),s(20,"button",78),I("click",function(){F(e);let r=E();return R(r.zoomIn())}),b(21,"i",81),a(),s(22,"button",82),I("click",function(){F(e);let r=E();return R(r.resetView())}),b(23,"i",83),a()()()}if(n&2){let e=E();d(8),H(" \u0627\u0644\u0637\u0627\u0628\u0642 ",e.currentFloor," "),d(3),H(" ",e.currentBuilding," "),d(8),H(" ",(e.zoomLevel*100).toFixed(0),"% ")}}function bj(n,t){n&1&&(s(0,"div",84)(1,"div",85),b(2,"canvas",86,0),s(4,"div",87)(5,"h4"),b(6,"i",88),u(7," \u062A\u0639\u0644\u064A\u0645\u0627\u062A \u0627\u0644\u062A\u062D\u0643\u0645"),a(),s(8,"ul")(9,"li")(10,"span",89),u(11,"\u2191 \u2193"),a(),u(12," \u0627\u0644\u062A\u0646\u0642\u0644 \u0628\u064A\u0646 \u0627\u0644\u0637\u0648\u0627\u0628\u0642"),a(),s(13,"li")(14,"span",89),u(15,"+ -"),a(),u(16," \u0627\u0644\u062A\u0643\u0628\u064A\u0631 \u0648\u0627\u0644\u062A\u0635\u063A\u064A\u0631"),a(),s(17,"li")(18,"span",89),u(19,"R"),a(),u(20," \u0625\u0639\u0627\u062F\u0629 \u0627\u0644\u062A\u0639\u064A\u064A\u0646"),a(),s(21,"li"),u(22,"\u0627\u0633\u062D\u0628 \u0627\u0644\u0641\u0623\u0631\u0629 \u0644\u0644\u062A\u062F\u0648\u064A\u0631"),a(),s(23,"li"),u(24,"\u0639\u062C\u0644\u0629 \u0627\u0644\u0641\u0623\u0631\u0629 \u0644\u0644\u062A\u0645\u0631\u064A\u0631"),a()()()()())}function Cj(n,t){if(n&1){let e=he();s(0,"div",92),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.selectRoom(r))}),s(1,"div",93)(2,"div",94),b(3,"i",95),u(4),a(),s(5,"div",96),b(6,"i"),u(7),a()(),s(8,"div",97)(9,"div",98),b(10,"i",99),a(),s(11,"div",100)(12,"p"),b(13,"i",34),u(14),a(),s(15,"p"),b(16,"i",38),u(17),a(),s(18,"p"),b(19,"i",25),u(20),a()()(),s(21,"div",101)(22,"button",102),I("click",function(r){let o=F(e).$implicit;return E(2).editRoom(o),R(r.stopPropagation())}),b(23,"i",103),a(),s(24,"button",102),I("click",function(r){let o=F(e).$implicit,l=E(2);return l.changeStatus(o._id,l.getNextStatus(o.status)),R(r.stopPropagation())}),b(25,"i"),a(),s(26,"button",104),I("click",function(r){let o=F(e).$implicit;return E(2).deleteRoom(o._id),R(r.stopPropagation())}),b(27,"i",105),a()()()}if(n&2){let e=t.$implicit,i=E(2);Ie("selected",(i.selectedRoom==null?null:i.selectedRoom._id)===e._id)("available",e.status==="available")("occupied",e.status==="occupied")("maintenance",e.status==="maintenance"),d(4),H(" ",e.name," "),d(),Kn(e.status),d(),Kn(i.getStatusIcon(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(7),H(" \u0627\u0644\u0637\u0627\u0628\u0642: ",e.floor," "),d(3),H(" \u0627\u0644\u0645\u0628\u0646\u0649: ",e.building," "),d(3),H(" \u0627\u0644\u0633\u0639\u0629: ",e.capacity," \u0637\u0627\u0644\u0628 "),d(5),Kn(i.getStatusIcon(i.getNextStatus(e.status)))}}function Ej(n,t){if(n&1&&(s(0,"div",90),j(1,Cj,28,19,"div",91),a()),n&2){let e=E();d(),w("ngForOf",e.filteredRooms)}}function wj(n,t){if(n&1){let e=he();s(0,"tr",109),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.selectRoom(r))}),s(1,"td")(2,"div",110),b(3,"div",111),u(4),a()(),s(5,"td"),b(6,"i",34),u(7),a(),s(8,"td"),b(9,"i",38),u(10),a(),s(11,"td")(12,"span",112),b(13,"i",25),u(14),a()(),s(15,"td")(16,"span",113),b(17,"i"),u(18),a()(),s(19,"td")(20,"div",114)(21,"button",115),I("click",function(r){let o=F(e).$implicit;return E(2).editRoom(o),R(r.stopPropagation())}),b(22,"i",103),a(),s(23,"button",115),I("click",function(r){let o=F(e).$implicit,l=E(2);return l.changeStatus(o._id,l.getNextStatus(o.status)),R(r.stopPropagation())}),b(24,"i"),a(),s(25,"button",116),I("click",function(r){let o=F(e).$implicit;return E(2).deleteRoom(o._id),R(r.stopPropagation())}),b(26,"i",105),a()()()()}if(n&2){let e=t.$implicit,i=E(2);Ie("selected",(i.selectedRoom==null?null:i.selectedRoom._id)===e._id),d(3),fr("background-color",e.color||"#3498db"),d(),H(" ",e.name," "),d(3),H(" ",e.floor," "),d(3),H(" ",e.building," "),d(4),H(" ",e.capacity," "),d(2),Kn(e.status),d(),Kn(i.getStatusIcon(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(6),Kn(i.getStatusIcon(i.getNextStatus(e.status)))}}function Sj(n,t){if(n&1&&(s(0,"div",106)(1,"table",107)(2,"thead")(3,"tr")(4,"th"),u(5,"\u0627\u0644\u063A\u0631\u0641\u0629"),a(),s(6,"th"),u(7,"\u0627\u0644\u0637\u0627\u0628\u0642"),a(),s(8,"th"),u(9,"\u0627\u0644\u0645\u0628\u0646\u0649"),a(),s(10,"th"),u(11,"\u0627\u0644\u0633\u0639\u0629"),a(),s(12,"th"),u(13,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(14,"th"),u(15,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(16,"tbody"),j(17,wj,27,15,"tr",108),a()()()),n&2){let e=E();d(17),w("ngForOf",e.filteredRooms)}}function Mj(n,t){if(n&1&&(s(0,"span",132),b(1,"i",133),u(2),a()),n&2){let e=t.$implicit;d(2),H(" ",e," ")}}function Aj(n,t){n&1&&(s(0,"span",134),u(1," \u0644\u0627 \u062A\u0648\u062C\u062F \u062A\u062C\u0647\u064A\u0632\u0627\u062A "),a())}function Tj(n,t){if(n&1&&(s(0,"div",140)(1,"div"),u(2),a(),s(3,"div"),u(4),a(),s(5,"div"),u(6),a(),s(7,"div"),u(8),a()()),n&2){let e=t.$implicit;d(2),B(e.day),d(2),B(e.period),d(2),B(e.subject),d(2),B(e.teacher)}}function Dj(n,t){if(n&1&&(s(0,"div",135)(1,"h4"),b(2,"i",136),u(3," \u062C\u062F\u0648\u0644 \u0627\u0644\u062D\u0635\u0635 "),a(),s(4,"div",137)(5,"div",138)(6,"div"),u(7,"\u0627\u0644\u064A\u0648\u0645"),a(),s(8,"div"),u(9,"\u0627\u0644\u062D\u0635\u0629"),a(),s(10,"div"),u(11,"\u0627\u0644\u0645\u0627\u062F\u0629"),a(),s(12,"div"),u(13,"\u0627\u0644\u0645\u0639\u0644\u0645"),a()(),j(14,Tj,9,4,"div",139),a()()),n&2){let e=E(2);d(14),w("ngForOf",e.scheduleData)}}function Pj(n,t){if(n&1){let e=he();s(0,"div",117)(1,"div",118)(2,"h3"),b(3,"i",42),u(4),a(),s(5,"button",119),I("click",function(){F(e);let r=E();return R(r.selectedRoom=null)}),b(6,"i",120),a()(),s(7,"div",100)(8,"div",121)(9,"div",122),u(10,"\u0627\u0633\u0645 \u0627\u0644\u063A\u0631\u0641\u0629:"),a(),s(11,"div",123),b(12,"i",95),u(13),a()(),s(14,"div",121)(15,"div",122),u(16,"\u0627\u0644\u0645\u0648\u0642\u0639:"),a(),s(17,"div",123),b(18,"i",7),u(19),a()(),s(20,"div",121)(21,"div",122),u(22,"\u0627\u0644\u0637\u0627\u0628\u0642:"),a(),s(23,"div",123),b(24,"i",34),u(25),a()(),s(26,"div",121)(27,"div",122),u(28,"\u0627\u0644\u0645\u0628\u0646\u0649:"),a(),s(29,"div",123),b(30,"i",38),u(31),a()(),s(32,"div",121)(33,"div",122),u(34,"\u0627\u0644\u062D\u0627\u0644\u0629:"),a(),s(35,"div",123)(36,"div",124)(37,"button",125),I("click",function(){F(e);let r=E();return R(r.changeStatus(r.selectedRoom._id,"available"))}),b(38,"i",23),u(39," \u0645\u062A\u0627\u062D\u0629 "),a(),s(40,"button",125),I("click",function(){F(e);let r=E();return R(r.changeStatus(r.selectedRoom._id,"occupied"))}),b(41,"i",25),u(42," \u0645\u0634\u063A\u0648\u0644\u0629 "),a(),s(43,"button",125),I("click",function(){F(e);let r=E();return R(r.changeStatus(r.selectedRoom._id,"maintenance"))}),b(44,"i",27),u(45," \u0635\u064A\u0627\u0646\u0629 "),a()()()(),s(46,"div",121)(47,"div",122),u(48,"\u0627\u0644\u0633\u0639\u0629:"),a(),s(49,"div",123)(50,"div",126),b(51,"i",25),u(52),a()()(),s(53,"div",121)(54,"div",122),u(55,"\u0627\u0644\u062A\u062C\u0647\u064A\u0632\u0627\u062A:"),a(),s(56,"div",123)(57,"div",127),j(58,Mj,3,1,"span",128)(59,Aj,2,0,"span",129),a()()(),s(60,"div",121)(61,"div",122),u(62,"\u0644\u0648\u0646 \u0627\u0644\u063A\u0631\u0641\u0629:"),a(),s(63,"div",123),b(64,"div",130),a()()(),j(65,Dj,15,1,"div",131),a()}if(n&2){let e=E();d(4),H(" \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u063A\u0631\u0641\u0629: ",e.selectedRoom.name," "),d(9),H(" ",e.selectedRoom.name," "),d(6),H(" ",e.selectedRoom.location||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"," "),d(6),H(" ",e.selectedRoom.floor," "),d(6),H(" ",e.selectedRoom.building," "),d(6),Ie("active",e.selectedRoom.status==="available"),d(3),Ie("active",e.selectedRoom.status==="occupied"),d(3),Ie("active",e.selectedRoom.status==="maintenance"),d(9),H(" ",e.selectedRoom.capacity," \u0637\u0627\u0644\u0628 "),d(6),w("ngForOf",e.selectedRoom.equipment),d(),w("ngIf",!e.selectedRoom.equipment||e.selectedRoom.equipment.length===0),d(5),fr("background-color",e.selectedRoom.color||"#3498db"),d(),w("ngIf",e.scheduleData.length>0)}}function Ij(n,t){if(n&1&&(s(0,"option",68),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),H(" \u0627\u0644\u0637\u0627\u0628\u0642 ",e," ")}}function Oj(n,t){if(n&1){let e=he();s(0,"div",141),I("click",function(){F(e);let r=E();return r.isAddingRoom=!1,R(r.isEditingRoom=!1)}),s(1,"div",142),I("click",function(r){return F(e),R(r.stopPropagation())}),s(2,"div",143)(3,"h3"),b(4,"i",144),u(5),a(),s(6,"button",119),I("click",function(){F(e);let r=E();return r.isAddingRoom=!1,R(r.isEditingRoom=!1)}),b(7,"i",120),a()(),s(8,"div",145)(9,"form",146),I("ngSubmit",function(){F(e);let r=E();return R(r.isAddingRoom?r.saveNewRoom():r.saveRoomEdit())}),s(10,"div",147)(11,"div",148)(12,"label",149),b(13,"i",95),u(14," \u0627\u0633\u0645 \u0627\u0644\u063A\u0631\u0641\u0629 * "),a(),s(15,"input",150),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newRoom.name,r)||(o.newRoom.name=r),R(r)}),a()(),s(16,"div",148)(17,"label",151),b(18,"i",25),u(19," \u0627\u0644\u0633\u0639\u0629 "),a(),s(20,"input",152),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newRoom.capacity,r)||(o.newRoom.capacity=r),R(r)}),a()()(),s(21,"div",147)(22,"div",148)(23,"label",153),b(24,"i",34),u(25," \u0627\u0644\u0637\u0627\u0628\u0642 "),a(),s(26,"select",154),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newRoom.floor,r)||(o.newRoom.floor=r),R(r)}),j(27,Ij,2,2,"option",37),a()(),s(28,"div",148)(29,"label",155),b(30,"i",38),u(31," \u0627\u0644\u0645\u0628\u0646\u0649 "),a(),s(32,"select",156),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newRoom.building,r)||(o.newRoom.building=r),R(r)}),s(33,"option",39),u(34,"\u0627\u0644\u0645\u0628\u0646\u0649 \u0627\u0644\u0631\u0626\u064A\u0633\u064A"),a(),s(35,"option",40),u(36,"\u0645\u0628\u0646\u0649 \u0627\u0644\u0639\u0644\u0648\u0645"),a(),s(37,"option",41),u(38,"\u0645\u0628\u0646\u0649 \u0627\u0644\u0641\u0646\u0648\u0646"),a()()()(),s(39,"div",148)(40,"label",157),b(41,"i",7),u(42," \u0627\u0644\u0645\u0648\u0642\u0639 (\u0627\u062E\u062A\u064A\u0627\u0631\u064A) "),a(),s(43,"input",158),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newRoom.location,r)||(o.newRoom.location=r),R(r)}),a()(),s(44,"div",148)(45,"label",159),b(46,"i",42),u(47," \u0627\u0644\u062D\u0627\u0644\u0629 "),a(),s(48,"select",160),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newRoom.status,r)||(o.newRoom.status=r),R(r)}),s(49,"option",43),u(50,"\u0645\u062A\u0627\u062D\u0629"),a(),s(51,"option",44),u(52,"\u0645\u0634\u063A\u0648\u0644\u0629"),a(),s(53,"option",45),u(54,"\u0642\u064A\u062F \u0627\u0644\u0635\u064A\u0627\u0646\u0629"),a()()(),s(55,"div",148)(56,"label"),b(57,"i",161),u(58," \u0644\u0648\u0646 \u0627\u0644\u063A\u0631\u0641\u0629 "),a(),s(59,"div",162)(60,"input",163),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newRoom.color,r)||(o.newRoom.color=r),R(r)}),a(),b(61,"div",130),a()(),s(62,"div",148)(63,"label"),b(64,"i",27),u(65," \u0627\u0644\u062A\u062C\u0647\u064A\u0632\u0627\u062A \u0627\u0644\u0645\u062A\u0627\u062D\u0629 "),a(),s(66,"div",164)(67,"label")(68,"input",165),I("change",function(){F(e);let r=E();return R(r.toggleEquipment("\u0628\u0631\u0648\u062C\u0643\u062A\u0631"))}),a(),b(69,"i",166),u(70," \u0628\u0631\u0648\u062C\u0643\u062A\u0631 "),a(),s(71,"label")(72,"input",167),I("change",function(){F(e);let r=E();return R(r.toggleEquipment("\u062D\u0627\u0633\u0628 \u0622\u0644\u064A"))}),a(),b(73,"i",168),u(74," \u062D\u0627\u0633\u0628 \u0622\u0644\u064A "),a(),s(75,"label")(76,"input",169),I("change",function(){F(e);let r=E();return R(r.toggleEquipment("\u0645\u0643\u064A\u0641"))}),a(),b(77,"i",170),u(78," \u0645\u0643\u064A\u0641 "),a(),s(79,"label")(80,"input",171),I("change",function(){F(e);let r=E();return R(r.toggleEquipment("\u0633\u0628\u0648\u0631\u0629 \u0630\u0643\u064A\u0629"))}),a(),b(81,"i",172),u(82," \u0633\u0628\u0648\u0631\u0629 \u0630\u0643\u064A\u0629 "),a(),s(83,"label")(84,"input",173),I("change",function(){F(e);let r=E();return R(r.toggleEquipment("\u0645\u0643\u0628\u0631\u0627\u062A \u0635\u0648\u062A"))}),a(),b(85,"i",174),u(86," \u0645\u0643\u0628\u0631\u0627\u062A \u0635\u0648\u062A "),a(),s(87,"label")(88,"input",175),I("change",function(){F(e);let r=E();return R(r.toggleEquipment("\u0648\u0627\u064A \u0641\u0627\u064A"))}),a(),b(89,"i",176),u(90," \u0648\u0627\u064A \u0641\u0627\u064A "),a()()(),s(91,"div",177)(92,"button",178),I("click",function(){F(e);let r=E();return r.isAddingRoom=!1,R(r.isEditingRoom=!1)}),u(93," \u0625\u0644\u063A\u0627\u0621 "),a(),s(94,"button",179),u(95),a()()()()()()}if(n&2){let e=E();d(4),Ie("fa-plus",e.isAddingRoom)("fa-edit",e.isEditingRoom),d(),H(" ",e.isAddingRoom?"\u0625\u0636\u0627\u0641\u0629 \u063A\u0631\u0641\u0629 \u062C\u062F\u064A\u062F\u0629":"\u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u063A\u0631\u0641\u0629"," "),d(10),ve("ngModel",e.newRoom.name),d(5),ve("ngModel",e.newRoom.capacity),d(6),ve("ngModel",e.newRoom.floor),d(),w("ngForOf",(e.schoolMap==null?null:e.schoolMap.floors)||Ll(22,aD)),d(5),ve("ngModel",e.newRoom.building),d(11),ve("ngModel",e.newRoom.location),d(5),ve("ngModel",e.newRoom.status),d(12),ve("ngModel",e.newRoom.color),d(),fr("background-color",e.newRoom.color),d(7),w("checked",e.newRoom.equipment.includes("\u0628\u0631\u0648\u062C\u0643\u062A\u0631")),d(4),w("checked",e.newRoom.equipment.includes("\u062D\u0627\u0633\u0628 \u0622\u0644\u064A")),d(4),w("checked",e.newRoom.equipment.includes("\u0645\u0643\u064A\u0641")),d(4),w("checked",e.newRoom.equipment.includes("\u0633\u0628\u0648\u0631\u0629 \u0630\u0643\u064A\u0629")),d(4),w("checked",e.newRoom.equipment.includes("\u0645\u0643\u0628\u0631\u0627\u062A \u0635\u0648\u062A")),d(4),w("checked",e.newRoom.equipment.includes("\u0648\u0627\u064A \u0641\u0627\u064A")),d(7),H(" ",e.isAddingRoom?"\u0625\u0636\u0627\u0641\u0629":"\u062D\u0641\u0638 \u0627\u0644\u062A\u0639\u062F\u064A\u0644\u0627\u062A"," ")}}var L1=class n{constructor(t){this.roomsService=t}gameCanvasRef;rooms=[];selectedRoom=null;schoolMap=null;filteredRooms=[];isAddingRoom=!1;isEditingRoom=!1;isLoading=!0;viewMode="3d";currentFloor=1;currentBuilding="Main";zoomLevel=1;newRoom={name:"",capacity:30,floor:1,building:"Main",location:"",color:"#3498db",equipment:[],status:"available"};statistics={totalRooms:0,availableRooms:0,occupiedRooms:0,maintenanceRooms:0,totalCapacity:0};scene;camera;renderer;controls;roomObjects=[];filter={floor:"",building:"",status:"",capacity:""};scheduleData=[];ngOnInit(){this.loadData(),this.setupKeyboardControls()}ngAfterViewInit(){this.viewMode==="3d"&&this.init3DView()}loadData(){this.isLoading=!0,Fs({rooms:this.roomsService.getRooms(),map:this.roomsService.getSchoolMap(),stats:this.roomsService.getRoomStatistics()}).subscribe({next:t=>{this.rooms=t.rooms,this.filteredRooms=[...this.rooms],this.schoolMap=t.map,this.statistics=t.stats,this.isLoading=!1,this.viewMode==="3d"&&this.create3DScene()},error:t=>{console.error("Error loading data:",t),this.isLoading=!1}})}init3DView(){let t=this.gameCanvasRef.nativeElement;this.scene=new If,this.scene.background=new Zt(8900331),this.camera=new ir(75,t.clientWidth/t.clientHeight,.1,1e3),this.camera.position.set(50,50,50),this.renderer=new O1({canvas:t,antialias:!0}),this.renderer.setSize(t.clientWidth,t.clientHeight),this.renderer.setPixelRatio(window.devicePixelRatio),this.controls=new N1(this.camera,this.renderer.domElement),this.controls.enableDamping=!0,this.controls.dampingFactor=.05;let e=new Bf(16777215,.6);this.scene.add(e);let i=new Lf(16777215,.8);i.position.set(50,100,50),this.scene.add(i),this.createFloor(),this.create3DScene(),this.animate()}create3DScene(){if(!this.scene||!this.rooms.length)return;this.roomObjects.forEach(f=>this.scene.remove(f)),this.roomObjects=[];let t=100,e=60,i=15,r=new pi(t,5,e),o=new ri({color:9807270,transparent:!0,opacity:.8}),l=new gn(r,o);l.position.y=2.5,this.scene.add(l);let c=this.schoolMap?.floors||[1,2,3];c.forEach(f=>{let p=new vs(t-10,e-10),g=new ri({color:15528177,side:so}),m=new gn(p,g);m.rotation.x=Math.PI/2,m.position.y=f*i,this.scene.add(m),this.addFloorLabel(f,t);let x=this.rooms.filter(C=>C.floor===f);this.createFloorRooms(x,f,i)}),this.addStairs(t,e,c.length,i),this.addExteriorDecorations(t,e)}createFloorRooms(t,e,i){t.forEach((f,p)=>{let g=Math.floor(p/4),x=(p%4-3/2)*23,C=g*20,A=this.create3DRoom(f,x,e*i,C);this.roomObjects.push(A),this.scene.add(A),this.addRoomInteraction(A,f)})}create3DRoom(t,e,i,r){let o=new wo;o.position.set(e,i+2,r),o.userData={roomId:t._id,roomData:t};let l=18,c=10,f=12,p=.5,g;switch(t.status){case"available":g=3066993;break;case"occupied":g=15158332;break;case"maintenance":g=15965202;break;default:g=3447003}let m=new gn(new pi(l,c,p),new ri({color:g}));m.position.z=-f/2,o.add(m);let x=m.clone();x.position.z=f/2,o.add(x);let C=new gn(new pi(p,c,f),new ri({color:g}));C.position.x=l/2,o.add(C);let A=C.clone();A.position.x=-l/2,o.add(A);let O=new gn(new pi(l,p,f),new ri({color:8359053}));O.position.y=c/2,o.add(O);let T=new gn(new pi(l-1,p,f-1),new ri({color:3426654}));T.position.y=-c/2,o.add(T);let M=new gn(new pi(4,6,.2),new ri({color:9127187}));M.position.set(0,-2,-f/2),o.add(M);for(let G=0;G<2;G++){let Y=new gn(new pi(3,3,.1),new ri({color:8900331,transparent:!0,opacity:.6}));Y.position.set(G*6-3,2,-f/2),o.add(Y)}return this.addRoomLabel(o,t.name,l),this.addFurniture(o,t),o}addFurniture(t,e){let i=Math.min(e.capacity,30),r=5,o=Math.ceil(i/r);for(let f=0;f<r;f++)for(let p=0;p<o&&!(f*o+p>=i);p++){let g=new gn(new pi(1.5,1,1.5),new ri({color:2899536}));g.position.set(p*2-(o-1),-4.5,f*2-(r-1)),t.add(g);let m=new gn(new pi(1.5,2,.2),new ri({color:3426654}));m.position.set(p*2-(o-1),-3,f*2-(r-1)-.8),t.add(m)}let l=new gn(new pi(10,4,.1),new ri({color:0}));l.position.set(0,0,5),t.add(l);let c=new gn(new pi(10.2,4.2,.2),new ri({color:12597547}));c.position.set(0,0,5.1),t.add(c)}addRoomLabel(t,e,i){let r=document.createElement("canvas"),o=r.getContext("2d");if(!o)return;r.width=512,r.height=256,o.fillStyle="#ffffff",o.fillRect(0,0,r.width,r.height),o.fillStyle="#000000",o.font="bold 60px Arial",o.textAlign="center",o.fillText(e,r.width/2,r.height/2+20);let l=new ud(r),c=new gn(new vs(i-2,2),new Ya({map:l,transparent:!0}));c.position.set(0,5,-7),c.rotation.y=Math.PI,t.add(c)}addFloorLabel(t,e){let i=document.createElement("canvas"),r=i.getContext("2d");if(!r)return;i.width=256,i.height=128,r.fillStyle="#ffffff",r.fillRect(0,0,i.width,i.height),r.fillStyle="#2c3e50",r.font="bold 40px Arial",r.textAlign="center",r.fillText(`\u0627\u0644\u0637\u0627\u0628\u0642 ${t}`,i.width/2,i.height/2+20);let o=new ud(i),l=new gn(new vs(10,5),new Ya({map:o,transparent:!0}));l.position.set(-e/2+5,t*15,0),this.scene.add(l)}addStairs(t,e,i,r){for(let c=0;c<i-1;c++){let f=new wo;for(let p=0;p<10;p++){let g=new gn(new pi(5,r/10,10),new ri({color:8207512}));g.position.set(t/2+2,c*r+p*r/10,p-5),f.add(g)}this.scene.add(f)}}addExteriorDecorations(t,e){for(let r=0;r<5;r++){let o=this.createTree();o.position.set((Math.random()-.5)*(t+50),0,(Math.random()-.5)*(e+50)),this.scene.add(o)}let i=10;for(let r=0;r<i;r++){let o=new gn(new pi(4,.1,8),new ri({color:2899536}));if(o.position.set(-t/2-10+r%5*5,.05,e/2+10+Math.floor(r/5)*10),this.scene.add(o),Math.random()>.5){let l=this.createCar();l.position.copy(o.position),l.position.y=1,this.scene.add(l)}}}createTree(){let t=new wo,e=new gn(new cd(.5,.7,5),new ri({color:9127187}));t.add(e);let i=new gn(new Rf(3,8,8),new ri({color:2600544}));return i.position.y=4,t.add(i),t}createCar(){let t=new wo,e=new gn(new pi(3,1,6),new ri({color:12597547}));t.add(e);let i=new gn(new pi(2.8,.8,1),new ri({color:3447003,transparent:!0,opacity:.5}));i.position.y=.6,i.position.z=-1.5,t.add(i);let r=new cd(.5,.5,.3,16),o=new ri({color:2899536});for(let l=0;l<4;l++){let c=new gn(r,o);c.rotation.z=Math.PI/2,c.position.set(l<2?-1.2:1.2,-.6,l%2?-2:2),t.add(c)}return t}addRoomInteraction(t,e){t.userData=St(Oe({},t.userData),{onClick:()=>this.selectRoom(e)})}createFloor(){let t=new vs(200,200),e=new Nf().load("assets/textures/floor.jpg");e.wrapS=uu,e.wrapT=uu,e.repeat.set(8,8);let i=new ri({map:e,side:so}),r=new gn(t,i);r.rotation.x=Math.PI/2,r.receiveShadow=!0,this.scene.add(r);let o=new Vf(200,50,0,0);this.scene.add(o)}animate(){requestAnimationFrame(()=>this.animate()),this.controls&&this.controls.update(),this.renderer&&this.scene&&this.camera&&this.renderer.render(this.scene,this.camera),this.roomObjects.forEach(t=>{t.rotation.y+=.001})}changeViewMode(t){this.viewMode=t,t==="3d"&&!this.renderer&&setTimeout(()=>this.init3DView(),100)}changeFloor(t){let e=this.schoolMap?.floors||[1,2,3],r=(e.indexOf(this.currentFloor)+t+e.length)%e.length;this.currentFloor=e[r],this.viewMode==="3d"&&(this.camera.position.y=this.currentFloor*15+20,this.controls.target.y=this.currentFloor*15),this.filterRooms()}filterRooms(){this.filteredRooms=this.rooms.filter(t=>!(this.filter.floor&&t.floor!==parseInt(this.filter.floor)||this.filter.building&&t.building!==this.filter.building||this.filter.status&&t.status!==this.filter.status||this.filter.capacity&&t.capacity<parseInt(this.filter.capacity)||this.currentFloor&&t.floor!==this.currentFloor))}addRoom(){this.isAddingRoom=!0,this.newRoom={name:"",capacity:30,floor:this.currentFloor,building:this.currentBuilding,location:"",color:"#3498db",equipment:[],status:"available"}}saveNewRoom(){if(!this.newRoom.name){alert("\u0627\u0644\u0631\u062C\u0627\u0621 \u0625\u062F\u062E\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u063A\u0631\u0641\u0629");return}this.roomsService.createRoom(this.newRoom).subscribe({next:t=>{this.rooms.push(t),this.filterRooms(),this.isAddingRoom=!1,this.viewMode==="3d"&&this.create3DScene()},error:t=>{console.error("Error adding room:",t),alert("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u063A\u0631\u0641\u0629")}})}editRoom(t){this.selectedRoom=t,this.isEditingRoom=!0,this.newRoom=Oe({},t)}saveRoomEdit(){this.selectedRoom&&this.roomsService.updateRoom(this.selectedRoom._id,this.newRoom).subscribe({next:t=>{let e=this.rooms.findIndex(i=>i._id===t._id);e!==-1&&(this.rooms[e]=t),this.selectedRoom=t,this.isEditingRoom=!1,this.viewMode==="3d"&&this.create3DScene()},error:t=>{console.error("Error updating room:",t),alert("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u063A\u0631\u0641\u0629")}})}deleteRoom(t){confirm("\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u063A\u0631\u0641\u0629\u061F")&&this.roomsService.deleteRoom(t).subscribe({next:()=>{this.rooms=this.rooms.filter(e=>e._id!==t),this.filterRooms(),this.selectedRoom=null,this.viewMode==="3d"&&this.create3DScene()},error:e=>{console.error("Error deleting room:",e),alert("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062D\u0630\u0641 \u0627\u0644\u063A\u0631\u0641\u0629")}})}selectRoom(t){if(this.selectedRoom=t,this.roomsService.getRoomSchedule(t._id).subscribe({next:e=>{this.scheduleData=e},error:e=>{console.error("Error loading schedule:",e)}}),this.viewMode==="3d"){let e=this.roomObjects.find(i=>i.userData.roomId===t._id);e&&(this.controls.target.copy(e.position),this.camera.position.copy(e.position).add(new ae(20,20,20)))}}changeStatus(t,e){this.roomsService.changeRoomStatus(t,e).subscribe({next:i=>{let r=this.rooms.findIndex(o=>o._id===i._id);r!==-1&&(this.rooms[r]=i),this.selectedRoom?._id===i._id&&(this.selectedRoom=i),this.viewMode==="3d"&&this.create3DScene()},error:i=>{console.error("Error changing room status:",i)}})}setupKeyboardControls(){}handleKeyboardEvent(t){if(this.viewMode==="3d")switch(t.key){case"ArrowUp":this.changeFloor(1);break;case"ArrowDown":this.changeFloor(-1);break;case"+":this.zoomLevel=Math.min(this.zoomLevel+.1,2),this.camera.zoom=this.zoomLevel,this.camera.updateProjectionMatrix();break;case"-":this.zoomLevel=Math.max(this.zoomLevel-.1,.5),this.camera.zoom=this.zoomLevel,this.camera.updateProjectionMatrix();break;case"r":case"R":this.camera.position.set(50,50,50),this.controls.target.set(0,0,0);break}}onWindowResize(){if(this.camera&&this.renderer){let t=this.gameCanvasRef.nativeElement;this.camera.aspect=t.clientWidth/t.clientHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(t.clientWidth,t.clientHeight)}}zoomIn(){this.zoomLevel=Math.min(this.zoomLevel+.1,2),this.camera&&(this.camera.zoom=this.zoomLevel,this.camera.updateProjectionMatrix())}zoomOut(){this.zoomLevel=Math.max(this.zoomLevel-.1,.5),this.camera&&(this.camera.zoom=this.zoomLevel,this.camera.updateProjectionMatrix())}resetView(){this.camera&&this.controls&&(this.camera.position.set(50,50,50),this.controls.target.set(0,0,0),this.zoomLevel=1,this.camera.zoom=this.zoomLevel,this.camera.updateProjectionMatrix())}getStatusIcon(t){switch(t){case"available":return"fas fa-check-circle";case"occupied":return"fas fa-users";case"maintenance":return"fas fa-tools";default:return"fas fa-question-circle"}}getStatusText(t){switch(t){case"available":return"\u0645\u062A\u0627\u062D\u0629";case"occupied":return"\u0645\u0634\u063A\u0648\u0644\u0629";case"maintenance":return"\u0642\u064A\u062F \u0627\u0644\u0635\u064A\u0627\u0646\u0629";default:return"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"}}getNextStatus(t){switch(t){case"available":return"occupied";case"occupied":return"maintenance";case"maintenance":return"available";default:return"available"}}toggleEquipment(t){let e=this.newRoom.equipment.indexOf(t);e>-1?this.newRoom.equipment.splice(e,1):this.newRoom.equipment.push(t)}static \u0275fac=function(e){return new(e||n)(Ne(U1))};static \u0275cmp=nn({type:n,selectors:[["app-rooms-management-component"]],viewQuery:function(e,i){if(e&1&&mc(_j,5),e&2){let r;Nl(r=Ul())&&(i.gameCanvasRef=r.first)}},hostBindings:function(e,i){e&1&&I("keydown",function(o){return i.handleKeyboardEvent(o)},!1,as)("resize",function(){return i.onWindowResize()},!1,as)},decls:135,vars:25,consts:[["gameCanvas",""],[1,"rooms-management"],["class","loading-screen",4,"ngIf"],[1,"control-bar"],[1,"title-section"],[1,"fas","fa-school"],[1,"school-name"],[1,"fas","fa-map-marker-alt"],[1,"controls"],[1,"view-controls"],[1,"btn",3,"click"],[1,"fas","fa-list"],[1,"fas","fa-th-large"],[1,"fas","fa-cube"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"stats-panel"],[1,"stat-card"],[1,"stat-icon"],[1,"fas","fa-door-open"],[1,"stat-content"],[1,"stat-number"],[1,"stat-card","available"],[1,"fas","fa-check-circle"],[1,"stat-card","occupied"],[1,"fas","fa-users"],[1,"stat-card","maintenance"],[1,"fas","fa-tools"],[1,"fas","fa-user-friends"],[1,"filter-panel"],[1,"filter-title"],[1,"fas","fa-filter"],[1,"filter-controls"],[1,"filter-group"],[1,"fas","fa-layer-group"],[3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"fas","fa-building"],["value","Main"],["value","Science"],["value","Arts"],[1,"fas","fa-info-circle"],["value","available"],["value","occupied"],["value","maintenance"],["type","number","placeholder","\u0623\u062F\u062E\u0644 \u0627\u0644\u0633\u0639\u0629","min","1","max","100",3,"ngModelChange","input","ngModel"],["class","navigation-panel",4,"ngIf"],["class","game-view",4,"ngIf"],["class","rooms-grid",4,"ngIf"],["class","rooms-table-container",4,"ngIf"],["class","details-panel",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"footer"],[1,"footer-info"],[1,"fas","fa-clock"],[1,"legend"],[1,"legend-item"],[1,"legend-color","available"],[1,"legend-color","occupied"],[1,"legend-color","maintenance"],[1,"loading-screen"],[1,"loader"],[1,"school-building"],[1,"building-roof"],[1,"building-body"],[1,"window"],[1,"building-door"],[3,"value"],[1,"navigation-panel"],[1,"floor-navigation"],[1,"btn-nav",3,"click"],[1,"fas","fa-chevron-down"],[1,"current-floor"],[1,"floor-number"],[1,"building-name"],[1,"fas","fa-chevron-up"],[1,"zoom-controls"],[1,"btn-zoom",3,"click"],[1,"fas","fa-search-minus"],[1,"zoom-level"],[1,"fas","fa-search-plus"],["title","\u0625\u0639\u0627\u062F\u0629 \u0627\u0644\u062A\u0639\u064A\u064A\u0646",1,"btn-reset",3,"click"],[1,"fas","fa-sync-alt"],[1,"game-view"],[1,"canvas-container"],[1,"game-canvas"],[1,"game-instructions"],[1,"fas","fa-gamepad"],[1,"key"],[1,"rooms-grid"],["class","room-card",3,"selected","available","occupied","maintenance","click",4,"ngFor","ngForOf"],[1,"room-card",3,"click"],[1,"room-header"],[1,"room-name"],[1,"fas","fa-door-closed"],[1,"room-status"],[1,"room-body"],[1,"room-icon"],[1,"fas","fa-chalkboard-teacher"],[1,"room-details"],[1,"room-actions"],[1,"btn-action",3,"click"],[1,"fas","fa-edit"],[1,"btn-action","danger",3,"click"],[1,"fas","fa-trash"],[1,"rooms-table-container"],[1,"rooms-table"],[3,"selected","click",4,"ngFor","ngForOf"],[3,"click"],[1,"room-name-cell"],[1,"room-color-indicator"],[1,"capacity-badge"],[1,"status-badge"],[1,"actions-cell"],[1,"btn-action","small",3,"click"],[1,"btn-action","small","danger",3,"click"],[1,"details-panel"],[1,"panel-header"],[1,"btn-close",3,"click"],[1,"fas","fa-times"],[1,"detail-row"],[1,"detail-label"],[1,"detail-value"],[1,"status-controls"],[1,"btn-status",3,"click"],[1,"capacity-display"],[1,"equipment-tags"],["class","equipment-tag",4,"ngFor","ngForOf"],["class","text-muted",4,"ngIf"],[1,"color-preview"],["class","schedule-section",4,"ngIf"],[1,"equipment-tag"],[1,"fas","fa-check"],[1,"text-muted"],[1,"schedule-section"],[1,"fas","fa-calendar-alt"],[1,"schedule-table"],[1,"schedule-header"],["class","schedule-row",4,"ngFor","ngForOf"],[1,"schedule-row"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"fas"],[1,"modal-body"],[3,"ngSubmit"],[1,"form-row"],[1,"form-group"],["for","roomName"],["type","text","id","roomName","name","roomName","required","","placeholder","\u0623\u062F\u062E\u0644 \u0627\u0633\u0645 \u0627\u0644\u063A\u0631\u0641\u0629",3,"ngModelChange","ngModel"],["for","roomCapacity"],["type","number","id","roomCapacity","name","capacity","min","1","max","100","placeholder","\u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628",3,"ngModelChange","ngModel"],["for","roomFloor"],["id","roomFloor","name","floor",3,"ngModelChange","ngModel"],["for","roomBuilding"],["id","roomBuilding","name","building",3,"ngModelChange","ngModel"],["for","roomLocation"],["type","text","id","roomLocation","name","location","placeholder","\u0645\u062B\u0627\u0644: \u0634\u0645\u0627\u0644 \u0627\u0644\u0645\u0628\u0646\u0649 \u0627\u0644\u0631\u0626\u064A\u0633\u064A",3,"ngModelChange","ngModel"],["for","roomStatus"],["id","roomStatus","name","status",3,"ngModelChange","ngModel"],[1,"fas","fa-palette"],[1,"color-picker"],["type","color","name","color",3,"ngModelChange","ngModel"],[1,"equipment-selector"],["type","checkbox","name","projector",3,"change","checked"],[1,"fas","fa-video"],["type","checkbox","name","computer",3,"change","checked"],[1,"fas","fa-desktop"],["type","checkbox","name","airConditioner",3,"change","checked"],[1,"fas","fa-wind"],["type","checkbox","name","smartBoard",3,"change","checked"],[1,"fas","fa-chalkboard"],["type","checkbox","name","speakers",3,"change","checked"],[1,"fas","fa-volume-up"],["type","checkbox","name","wifi",3,"change","checked"],[1,"fas","fa-wifi"],[1,"form-actions"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary"]],template:function(e,i){e&1&&(s(0,"div",1),j(1,vj,14,0,"div",2),s(2,"div",3)(3,"div",4)(4,"h1"),b(5,"i",5),u(6," \u0646\u0638\u0627\u0645 \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0641\u0635\u0648\u0644 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629 "),a(),s(7,"p",6),b(8,"i",7),u(9," Al-rouad Akadime "),a()(),s(10,"div",8)(11,"div",9)(12,"button",10),I("click",function(){return i.changeViewMode("list")}),b(13,"i",11),u(14," \u0642\u0627\u0626\u0645\u0629 "),a(),s(15,"button",10),I("click",function(){return i.changeViewMode("grid")}),b(16,"i",12),u(17," \u0634\u0628\u0643\u0629 "),a(),s(18,"button",10),I("click",function(){return i.changeViewMode("3d")}),b(19,"i",13),u(20," \u062B\u0644\u0627\u062B\u064A \u0627\u0644\u0623\u0628\u0639\u0627\u062F "),a()(),s(21,"button",14),I("click",function(){return i.addRoom()}),b(22,"i",15),u(23," \u0625\u0636\u0627\u0641\u0629 \u063A\u0631\u0641\u0629 \u062C\u062F\u064A\u062F\u0629 "),a()()(),s(24,"div",16)(25,"div",17)(26,"div",18),b(27,"i",19),a(),s(28,"div",20)(29,"h3"),u(30,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u063A\u0631\u0641"),a(),s(31,"p",21),u(32),a()()(),s(33,"div",22)(34,"div",18),b(35,"i",23),a(),s(36,"div",20)(37,"h3"),u(38,"\u0627\u0644\u063A\u0631\u0641 \u0627\u0644\u0645\u062A\u0627\u062D\u0629"),a(),s(39,"p",21),u(40),a()()(),s(41,"div",24)(42,"div",18),b(43,"i",25),a(),s(44,"div",20)(45,"h3"),u(46,"\u0627\u0644\u063A\u0631\u0641 \u0627\u0644\u0645\u0634\u063A\u0648\u0644\u0629"),a(),s(47,"p",21),u(48),a()()(),s(49,"div",26)(50,"div",18),b(51,"i",27),a(),s(52,"div",20)(53,"h3"),u(54,"\u0642\u064A\u062F \u0627\u0644\u0635\u064A\u0627\u0646\u0629"),a(),s(55,"p",21),u(56),a()()(),s(57,"div",17)(58,"div",18),b(59,"i",28),a(),s(60,"div",20)(61,"h3"),u(62,"\u0627\u0644\u0633\u0639\u0629 \u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A\u0629"),a(),s(63,"p",21),u(64),a()()()(),s(65,"div",29)(66,"div",30),b(67,"i",31),u(68," \u062A\u0635\u0641\u064A\u0629 \u0627\u0644\u063A\u0631\u0641 "),a(),s(69,"div",32)(70,"div",33)(71,"label"),b(72,"i",34),u(73," \u0627\u0644\u0637\u0627\u0628\u0642"),a(),s(74,"select",35),ye("ngModelChange",function(o){return Ce(i.filter.floor,o)||(i.filter.floor=o),o}),I("change",function(){return i.filterRooms()}),s(75,"option",36),u(76,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0637\u0648\u0627\u0628\u0642"),a(),j(77,yj,2,2,"option",37),a()(),s(78,"div",33)(79,"label"),b(80,"i",38),u(81," \u0627\u0644\u0645\u0628\u0646\u0649"),a(),s(82,"select",35),ye("ngModelChange",function(o){return Ce(i.filter.building,o)||(i.filter.building=o),o}),I("change",function(){return i.filterRooms()}),s(83,"option",36),u(84,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0645\u0628\u0627\u0646\u064A"),a(),s(85,"option",39),u(86,"\u0627\u0644\u0645\u0628\u0646\u0649 \u0627\u0644\u0631\u0626\u064A\u0633\u064A"),a(),s(87,"option",40),u(88,"\u0645\u0628\u0646\u0649 \u0627\u0644\u0639\u0644\u0648\u0645"),a(),s(89,"option",41),u(90,"\u0645\u0628\u0646\u0649 \u0627\u0644\u0641\u0646\u0648\u0646"),a()()(),s(91,"div",33)(92,"label"),b(93,"i",42),u(94," \u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(95,"select",35),ye("ngModelChange",function(o){return Ce(i.filter.status,o)||(i.filter.status=o),o}),I("change",function(){return i.filterRooms()}),s(96,"option",36),u(97,"\u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0627\u0644\u0627\u062A"),a(),s(98,"option",43),u(99,"\u0645\u062A\u0627\u062D\u0629"),a(),s(100,"option",44),u(101,"\u0645\u0634\u063A\u0648\u0644\u0629"),a(),s(102,"option",45),u(103,"\u0635\u064A\u0627\u0646\u0629"),a()()(),s(104,"div",33)(105,"label"),b(106,"i",25),u(107," \u0627\u0644\u0633\u0639\u0629 (\u062D\u062F \u0623\u062F\u0646\u0649)"),a(),s(108,"input",46),ye("ngModelChange",function(o){return Ce(i.filter.capacity,o)||(i.filter.capacity=o),o}),I("input",function(){return i.filterRooms()}),a()()()(),j(109,xj,24,3,"div",47)(110,bj,25,0,"div",48)(111,Ej,2,1,"div",49)(112,Sj,18,1,"div",50)(113,Pj,66,17,"div",51)(114,Oj,96,23,"div",52),s(115,"div",53)(116,"div",54)(117,"p"),b(118,"i",55),a(),s(119,"p"),b(120,"i",5),u(121),a()(),s(122,"div",56)(123,"div",57),b(124,"div",58),s(125,"span"),u(126,"\u0645\u062A\u0627\u062D\u0629"),a()(),s(127,"div",57),b(128,"div",59),s(129,"span"),u(130,"\u0645\u0634\u063A\u0648\u0644\u0629"),a()(),s(131,"div",57),b(132,"div",60),s(133,"span"),u(134,"\u0635\u064A\u0627\u0646\u0629"),a()()()()()),e&2&&(d(),w("ngIf",i.isLoading),d(11),Ie("active",i.viewMode==="list"),d(3),Ie("active",i.viewMode==="grid"),d(3),Ie("active",i.viewMode==="3d"),d(14),B(i.statistics.totalRooms),d(8),B(i.statistics.availableRooms),d(8),B(i.statistics.occupiedRooms),d(8),B(i.statistics.maintenanceRooms),d(8),B(i.statistics.totalCapacity),d(10),ve("ngModel",i.filter.floor),d(3),w("ngForOf",(i.schoolMap==null?null:i.schoolMap.floors)||Ll(24,aD)),d(5),ve("ngModel",i.filter.building),d(13),ve("ngModel",i.filter.status),d(13),ve("ngModel",i.filter.capacity),d(),w("ngIf",i.viewMode==="3d"),d(),w("ngIf",i.viewMode==="3d"),d(),w("ngIf",i.viewMode==="grid"),d(),w("ngIf",i.viewMode==="list"),d(),w("ngIf",i.selectedRoom),d(),w("ngIf",i.isAddingRoom||i.isEditingRoom),d(7),H(" \u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u063A\u0631\u0641: ",i.statistics.totalRooms," \u063A\u0631\u0641\u0629 "))},dependencies:[Un,Ti,Di,Pi,Yn,gr,di,ii,Ai,$i,_r,tu,ti,mr,hn,Nn,An],encapsulation:2})};$();var Vr=ya(Na());$();var B1=class n{constructor(t,e){this.http=t;this.authService=e}apiUrl=Bt.apiUrl;getPayments(t){return this.http.get(`${this.apiUrl}/payments`,{params:t,headers:this.authService.getAuthHeaders()})}cancelPayment(t){return this.http.put(`${this.apiUrl}/payments/${t}/cancel`,{},{headers:this.authService.getAuthHeaders()})}deletePayment(t){return this.http.delete(`${this.apiUrl}/payments/${t}`,{headers:this.authService.getAuthHeaders()})}updatePaymentAmount(t,e){return this.http.put(`${this.apiUrl}/payments/${t}/amount`,{amount:e},{headers:this.authService.getAuthHeaders()})}createPayment(t){return this.http.post(`${this.apiUrl}/payments`,t,{headers:this.authService.getAuthHeaders()})}payPayment(t,e){return this.http.put(`${this.apiUrl}/payments/${t}/pay`,e,{headers:this.authService.getAuthHeaders()})}getClassPayments(t){return this.http.get(`${this.apiUrl}/payments/class/${t}`,{headers:this.authService.getAuthHeaders()})}getStudentPayments(t){return this.http.get(`${this.apiUrl}/payments/student/${t}`,{headers:this.authService.getAuthHeaders()})}recordPayment(t){return this.http.post(`${this.apiUrl}/payments`,t,{headers:this.authService.getAuthHeaders()})}updatePayment(t,e){return this.http.put(`${this.apiUrl}/payments/${t}`,e,{headers:this.authService.getAuthHeaders()})}createMonthlyPayment(t){return this.http.post(`${this.apiUrl}/payments/monthly`,t,{headers:this.authService.getAuthHeaders()})}createRoundPayment(t){return this.http.post(`${this.apiUrl}/payments/rounds`,t,{headers:this.authService.getAuthHeaders()})}getStudentRounds(t){return this.http.get(`${this.apiUrl}/payments/rounds/student/${t}`,{headers:this.authService.getAuthHeaders()})}getStudentMonthlyPayments(t){return this.http.get(`${this.apiUrl}/payments/monthly/student/${t}`,{headers:this.authService.getAuthHeaders()})}payLatePayment(t,e){return this.http.put(`${this.apiUrl}/payments/${t}/pay-late`,e,{headers:this.authService.getAuthHeaders()})}static \u0275fac=function(e){return new(e||n)(We(pn),We(qn))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})};$();var il=class n{constructor(t,e){this.http=t;this.authService=e}apiUrl=Bt.apiUrl;removeStudentFromClass(t,e){return this.http.delete(`${this.apiUrl}/classes/${t}/unenroll/${e}`,{headers:this.authService.getAuthHeaders()})}getClasses(){return this.http.get(`${this.apiUrl}/classes`,{headers:this.authService.getAuthHeaders()})}getClassById(t){return this.http.get(`${this.apiUrl}/classes/${t}`,{headers:this.authService.getAuthHeaders()})}static \u0275fac=function(e){return new(e||n)(We(pn),We(qn))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})};$();var rl=class n{constructor(t,e){this.http=t;this.authService=e}apiUrl=Bt.apiUrl;getTeachers(){return this.http.get(`${this.apiUrl}/teachers`,{headers:this.authService.getAuthHeaders()})}getTeacherById(t){return this.http.get(`${this.apiUrl}/teachers/${t}`,{headers:this.authService.getAuthHeaders()})}createTeacher(t){return this.http.post(`${this.apiUrl}/teachers`,t,{headers:this.authService.getAuthHeaders()})}updateTeacher(t,e){return this.http.put(`${this.apiUrl}/teachers/${t}`,e,{headers:this.authService.getAuthHeaders()})}deleteTeacher(t){return this.http.delete(`${this.apiUrl}/teachers/${t}`,{headers:this.authService.getAuthHeaders()})}static \u0275fac=function(e){return new(e||n)(We(pn),We(qn))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})};$();var oa=ya(Na());var xd=class n{constructor(t){this.ngZone=t;window.addEventListener("beforeunload",()=>{this.disconnect()})}port=null;writer=null;reader=null;isConnected=!1;PRINT_WIDTH=576;PRINT_HEIGHT=900;CANVAS_WIDTH=576;CANVAS_HEIGHT=900;MAX_CHUNK_SIZE=1024;COMPANY_NAME="\u0623\u0643\u0627\u062F\u064A\u0645\u064A\u0629 \u0627\u0644\u0631\u0648\u0627\u062F \u0644\u0644\u062A\u0639\u0644\u064A\u0645 \u0648\u0627\u0644\u0645\u0639\u0627\u0631\u0641";DEVELOPER_NAME="\u0631\u064A\u062F\u0648\u0643\u0633";FOOTER_TEXT="\u062A\u062A\u0645\u0646\u0649 \u0644\u0643\u0645 \u062A\u062C\u0631\u0628\u0629 \u062A\u0639\u0644\u064A\u0645\u064A\u0629 \u0645\u0645\u062A\u0639\u0629 \u0648\u0645\u0641\u064A\u062F\u0629";COMPANY_ADDRESS="\u0627\u0644\u062C\u0632\u0627\u0626\u0631\u060C \u0648\u0644\u0627\u064A\u0629 \u0627\u0644\u062C\u0632\u0627\u0626\u0631";QR_CODE_TEXT=`\u0623\u0643\u0627\u062F\u064A\u0645\u064A\u0629 \u0627\u0644\u0631\u0648\u0627\u062F \u0644\u0644\u062A\u0639\u0644\u064A\u0645 \u0648\u0627\u0644\u0645\u0639\u0627\u0631\u0641
\u0627\u0644\u0645\u0648\u0642\u0639: academy-arrowad.edu.dz
\u0647\u0627\u062A\u0641: 1234567890`;REDOX_LOGO_URL="https://redox-sm.onrender.com/favicon.ico";ACADEMY_LOGO_URL="https://redox-sm.onrender.com/favicon.ico";printCanvasDirect(t){return wt(this,null,function*(){try{if(!this.isConnected&&!(yield this.connectToThermalPrinter()))throw new Error("\u0641\u0634\u0644 \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0637\u0627\u0628\u0639\u0629");let e=t.width,i=t.height,o=t.getContext("2d").getImageData(0,0,e,i),l=Math.ceil(e/8),c=new Uint8Array(l*i);c.fill(0);for(let g=0;g<i;g++)for(let m=0;m<e;m++){let x=(g*e+m)*4,C=o.data[x],A=o.data[x+1],O=o.data[x+2];if(Math.floor(C*.3+A*.59+O*.11)<200){let M=Math.floor(g*l+m/8),G=7-m%8;c[M]|=1<<G}}yield this.writer.write(new Uint8Array([27,64])),yield this.writer.write(new Uint8Array([27,51,36]));let f=new Uint8Array([29,118,48,0,l&255,l>>8&255,i&255,i>>8&255]);yield this.writer.write(f);let p=1024;for(let g=0;g<c.length;g+=p){let m=c.slice(g,g+p);yield this.writer.write(m),yield this.delay(10)}return yield this.writer.write(new Uint8Array([27,100,5])),yield this.writer.write(new Uint8Array([29,86,65,3])),!0}catch(e){return console.error("\u062E\u0637\u0623 \u0641\u064A \u0637\u0628\u0627\u0639\u0629 Canvas:",e),!1}})}delay(t){return new Promise(e=>setTimeout(e,t))}connectToThermalPrinter(t=115200){return wt(this,null,function*(){try{if(!("serial"in navigator))throw new Error("\u0648\u0627\u062C\u0647\u0629 \u0627\u0644\u0637\u0627\u0628\u0639\u0629 \u063A\u064A\u0631 \u0645\u062F\u0639\u0648\u0645\u0629 \u0641\u064A \u0647\u0630\u0627 \u0627\u0644\u0645\u062A\u0635\u0641\u062D. \u0627\u0644\u0631\u062C\u0627\u0621 \u0627\u0633\u062A\u062E\u062F\u0627\u0645 Chrome \u0623\u0648 Edge.");return this.port=yield navigator.serial.requestPort(),yield this.port.open({baudRate:t,dataBits:8,stopBits:1,parity:"none",flowControl:"none"}),this.writer=this.port.writable.getWriter(),yield this.writer.write(new Uint8Array([27,64])),yield this.writer.write(new Uint8Array([27,51,24])),this.isConnected=!0,this.ngZone.run(()=>{oa.default.fire({icon:"success",title:"\u2705 \u062A\u0645 \u0627\u0644\u0627\u062A\u0635\u0627\u0644",text:"\u062A\u0645 \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0637\u0627\u0628\u0639\u0629 \u0627\u0644\u062D\u0631\u0627\u0631\u064A\u0629 \u0628\u0646\u062C\u0627\u062D",timer:1500,showConfirmButton:!1})}),console.log("\u2705 \u062A\u0645 \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0637\u0627\u0628\u0639\u0629 \u0628\u0646\u062C\u0627\u062D"),!0}catch(e){return console.error("\u274C \u062E\u0637\u0623 \u0627\u0644\u0627\u062A\u0635\u0627\u0644:",e),this.showConnectionError(e),this.isConnected=!1,!1}})}generateQRCode(t){let e=document.createElement("canvas");e.width=120,e.height=120;let i=e.getContext("2d");i.fillStyle="#FFFFFF",i.fillRect(0,0,e.width,e.height),i.fillStyle="#000000",i.lineWidth=3,i.strokeRect(10,10,e.width-20,e.height-20);let r=8,o=20;for(let l=0;l<7;l++)for(let c=0;c<7;c++)(l===0||l===6||c===0||c===6||l>=2&&l<=4&&c>=2&&c<=4)&&i.fillRect(o+l*r,o+c*r,r-1,r-1);return i.fillStyle="#333333",i.font="10px Arial",i.textAlign="center",i.fillText("QR Code",e.width/2,e.height-8),e}loadImage(t){return wt(this,null,function*(){return new Promise((e,i)=>{let r=new Image;r.crossOrigin="anonymous",r.onload=()=>e(r),r.onerror=i,r.src=t})})}ensureArabicNumbers(t){let e={"\u0660":"0","\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9"};return t.split("").map(i=>e[i]||i).join("")}formatAmountWithCommas(t){return t.toLocaleString("ar-SA")}formatArabicNumber(t){let e=["\u0660","\u0661","\u0662","\u0663","\u0664","\u0665","\u0666","\u0667","\u0668","\u0669"],i=["0","1","2","3","4","5","6","7","8","9"];return t.split("").map(r=>{let o=e.indexOf(r);return o!==-1?i[o]:r}).join("")}formatAmountArabic(t){let e=t.toLocaleString("ar-SA"),i={"\u0660":"0","\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9"};return e.split("").map(o=>i[o]||o).join("")+" \u062F.\u062C"}formatNumberArabic(t){let e=typeof t=="number"?t.toString():t;if(!e)return"";let i={"\u0660":"0","\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9"};return e.split("").map(r=>i[r]||r).join("")}formatDateTimeArabic(t){if(!t)return t;let e={"\u0660":"0","\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9","\u0660\u0660":"00","\u0660\u0661":"01","\u0660\u0662":"02","\u0660\u0663":"03","\u0660\u0664":"04","\u0660\u0665":"05","\u0660\u0666":"06","\u0660\u0667":"07","\u0660\u0668":"08","\u0660\u0669":"09"},i=t;return Object.keys(e).forEach(r=>{let o=e[r];i=i.replace(new RegExp(r,"g"),o)}),i}createBulkReceiptCanvas(t){return wt(this,null,function*(){let r=t.notes?this.calculateNotesHeight(t.notes,this.CANVAS_WIDTH-30,16):0,o=380+t.payments.length*35+r+150,l=document.createElement("canvas");l.width=this.CANVAS_WIDTH,l.height=Math.max(o,800);let c=l.getContext("2d");c.fillStyle="#FFFFFF",c.fillRect(0,0,l.width,l.height),c.fillStyle="#000000",c.textBaseline="top",c.textAlign="center",c.font='bold 30px "Arial", sans-serif',c.fillText("\u0623\u0643\u0627\u062F\u064A\u0645\u064A\u0629 \u0627\u0644\u0631\u0648\u0627\u062F \u0644\u0644\u062A\u0639\u0644\u064A\u0645 \u0648\u0627\u0644\u0645\u0639\u0627\u0631\u0641",l.width/2,10),c.font='16px "Arial", sans-serif',c.fillText("\u0627\u0644\u062C\u0632\u0627\u0626\u0631 \u060C \u0648\u0644\u0627\u064A\u0629 \u062A\u0642\u0631\u062A",l.width/2,45),c.fillText("\u0627\u0644\u0647\u0627\u062A\u0641 : 0673586274",l.width/2,65),this.drawDoubleLine(c,10,85,l.width-20);let f=105;c.textAlign="center",c.font='bold 22px "Arial", sans-serif',c.fillText("\u0625\u064A\u0635\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0627\u0644 \u062F\u0641\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0639 \u062C\u0645\u0627\u0639\u064A",l.width/2,f),f+=30,this.drawSingleLine(c,10,f,l.width-20),f+=10,c.textAlign="right",c.font='18px "Arial", sans-serif',[{label:"\u0631\u0642\u0645 \u0627\u0644\u0625\u064A\u0635\u0627\u0644:",value:this.formatNumberArabic(t.receiptNumber)},{label:"\u0627\u0644\u062A\u0627\u0631\u064A\u062E:",value:this.formatDateTimeArabic(t.date)},{label:"\u0627\u0644\u0648\u0642\u062A:",value:this.formatDateTimeArabic(t.time)},{label:"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639:",value:this.translatePaymentMethod(t.paymentMethod)},{label:"\u0639\u062F\u062F \u0627\u0644\u062F\u0641\u0639\u0627\u062A:",value:this.formatNumberArabic(t.paymentCount.toString())},{label:"\u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628:",value:this.formatNumberArabic(t.studentCount.toString())}].forEach(O=>{c.fillText(`${O.label} ${O.value}`,l.width-15,f),f+=25}),f+=10,this.drawDoubleLine(c,10,f,l.width-20),f+=20,c.textAlign="center",c.font='bold 22px "Arial", sans-serif',c.fillText("\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0627\u062A",l.width/2,f),f+=35;let g={studentName:(l.width-30)*.4,className:(l.width-30)*.25,month:(l.width-30)*.25,amount:(l.width-30)*.1};c.fillStyle="#2C3E50",c.fillRect(15,f,l.width-30,35),c.fillStyle="#FFFFFF",c.font='bold 16px "Arial", sans-serif';let m=20;c.textAlign="left",c.fillText("\u0627\u0644\u0634\u0647\u0631",m,f+10),m+=g.month,c.textAlign="center",c.fillText("\u0627\u0644\u062D\u0635\u0629",m+g.className/2,f+10),m+=g.className,c.textAlign="center",c.fillText("\u0627\u0644\u0645\u0628\u0644\u063A",m+g.amount/2,f+10),m+=g.amount,c.textAlign="right",c.fillText("\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628",l.width-20,f+10),f+=35,t.payments.forEach((O,T)=>{T%2===0?c.fillStyle="#F8F9FA":c.fillStyle="#FFFFFF",c.fillRect(15,f,l.width-30,35),c.fillStyle="#000000",c.strokeStyle="#DEE2E6",c.lineWidth=1,c.strokeRect(15,f,l.width-30,35);let M=20;c.textAlign="left",c.font='16px "Arial", sans-serif',c.fillText(O.month,M,f+10),M+=g.month,c.textAlign="center",c.fillText(O.className,M+g.className/2,f+10),M+=g.className,c.textAlign="center";let G=this.formatAmountArabic(O.amount);c.fillText(G,M+g.amount/2,f+10),M+=g.amount,c.textAlign="right",c.fillText(O.studentName,l.width-20,f+10),f+=35}),f+=20,this.drawSingleLine(c,10,f,l.width-20),f+=20,c.textAlign="center",c.font='bold 24px "Arial", sans-serif',c.fillStyle="#000000",c.fillText("\u0627\u0644\u0645\u062C\u0645\u0648\u0639 \u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:",l.width/2,f),f+=50,this.drawSingleLine(c,10,f,l.width-20,"#FF0000"),f+=30,c.font='bold 28px "Arial", sans-serif',c.fillStyle="#E74C3C";let x=this.formatAmountArabic(t.totalAmount);c.fillText(`${x} \u062F\u064A\u0646\u0627\u0631 \u062C\u0632\u0627\u0626\u0631\u064A`,l.width/2,f),f+=40,t.notes&&t.notes.trim()&&(c.textAlign="right",c.font='bold 18px "Arial", sans-serif',c.fillStyle="#2C3E50",c.fillText("\u0645\u0644\u0627\u062D\u0638\u0627\u062A:",l.width-15,f),f+=25,c.font='16px "Arial", sans-serif',c.fillStyle="#000000",this.splitTextIntoLines(c,t.notes,l.width-30,16).forEach(T=>{f<l.height-150&&(c.fillText(T.trim(),l.width-15,f),f+=22)}),f+=10),c.textAlign="center",c.font='16px "Arial", sans-serif',c.fillStyle="#2C3E50";let C=["\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A - \u0646\u0638\u0627\u0645 \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u062A\u0639\u0644\u064A\u0645","\u0645\u0637\u0648\u0631 \u0628\u0648\u0627\u0633\u0637\u0629: \u0631\u064A\u062F\u0648\u0643\u0633","\u0647\u0630\u0627 \u0625\u064A\u0635\u0627\u0644 \u0631\u0633\u0645\u064A - \u064A\u0631\u062C\u0649 \u0627\u0644\u0627\u062D\u062A\u0641\u0627\u0638 \u0628\u0647 \u0644\u0644\u0645\u0631\u0627\u062C\u0639\u0629",`\u0639\u062F\u062F \u0627\u0644\u062F\u0641\u0639\u0627\u062A: ${this.formatNumberArabic(t.paymentCount.toString())} | \u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628: ${this.formatNumberArabic(t.studentCount.toString())}`],A=l.height-120;return C.forEach(O=>{c.fillText(O,l.width/2,A),A+=25}),c.font='bold 18px "Arial", sans-serif',c.fillStyle="#27AE60",c.fillText("\u0634\u0643\u0631\u0627\u064B \u0644\u062B\u0642\u062A\u0643\u0645 thank for your trust ",l.width/2,l.height-30),l})}formatAmountEnglish(t){return t.toLocaleString("en-US")+" \u062F.\u062C"}splitTextIntoLines(t,e,i,r){t.font=`${r}px "Arial", sans-serif`;let o=e.split(" "),l="",c=[];for(let f of o){let p=l+f+" ";t.measureText(p).width>i&&l!==""?(c.push(l),l=f+" "):l=p}return l&&c.push(l),c}calculateNotesHeight(t,e,i){let o=document.createElement("canvas").getContext("2d");return o.font=`${i}px "Arial", sans-serif`,this.splitTextIntoLines(o,t,e,i).length*22+40}printBulkReceipt(t){return wt(this,null,function*(){if(!this.isConnected&&!(yield this.connectToThermalPrinter()))return this.showError("\u0641\u0634\u0644 \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0637\u0627\u0628\u0639\u0629"),!1;try{this.showLoading("\u062C\u0627\u0631\u064A \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 \u0627\u0644\u062C\u0645\u0627\u0639\u064A...");let e=yield this.createBulkReceiptCanvas(t),i=this.canvasToRaster(e);if(this.showLoading("\u062C\u0627\u0631\u064A \u0627\u0644\u0637\u0628\u0627\u0639\u0629..."),yield this.printRasterImage(i,e))return this.showSuccessToast("\u062A\u0645 \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 \u0627\u0644\u062C\u0645\u0627\u0639\u064A \u0628\u0646\u062C\u0627\u062D"),!0;throw new Error("\u0641\u0634\u0644 \u0627\u0644\u0637\u0628\u0627\u0639\u0629")}catch(e){return this.handleError(e),!1}})}createReceiptCanvas(t){return wt(this,null,function*(){let e=document.createElement("canvas");e.width=this.CANVAS_WIDTH,e.height=this.CANVAS_HEIGHT;let i=e.getContext("2d");i.fillStyle="#FFFFFF",i.fillRect(0,0,e.width,e.height),i.fillStyle="#000000",i.textBaseline="top",i.textAlign="center",i.font='bold 30px "Arial", sans-serif',i.fillText("\u0623\u0643\u0627\u062F\u064A\u0645\u064A\u0629 \u0627\u0644\u0631\u0648\u0627\u062F \u0644\u0644\u062A\u0639\u0644\u064A\u0645 \u0648\u0627\u0644\u0645\u0639\u0627\u0631\u0641",e.width/2,10),i.font='16px "Arial", sans-serif',i.fillText("\u0627\u0644\u062C\u0632\u0627\u0626\u0631 \u060C \u0648\u0644\u0627\u064A\u0629 \u062A\u0642\u0631\u062A",e.width/2,45),i.fillText("\u0627\u0644\u0647\u0627\u062A\u0641 : 0673586274",e.width/2,65),this.drawDoubleLine(i,10,85,e.width-20);let r=105;if(i.textAlign="center",i.font='bold 22px "Arial", sans-serif',i.fillText("\u0625\u064A\u0635\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0627\u0644 \u062F\u0641\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0639",e.width/2,r),r+=30,this.drawSingleLine(i,10,r,e.width-20),r+=10,i.textAlign="right",i.font='18px "Arial", sans-serif',[{label:"\u0631\u0642\u0645 \u0627\u0644\u0625\u064A\u0635\u0627\u0644:",value:this.formatNumberArabic(t.receiptNumber)},{label:"\u0627\u0644\u062A\u0627\u0631\u064A\u062E:",value:this.formatDateTimeArabic(t.date)},{label:"\u0627\u0644\u0648\u0642\u062A:",value:this.formatDateTimeArabic(t.time)},{label:"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639:",value:this.translatePaymentMethod(t.paymentMethod)}].forEach(C=>{i.fillText(`${C.label} ${C.value}`,e.width-15,r),r+=25}),r+=10,this.drawSingleLine(i,10,r,e.width-20),r+=15,i.font='bold 20px "Arial", sans-serif',i.fillText("\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u0637\u0627\u0644\u0628",e.width-15,r),r+=30,i.font='18px "Arial", sans-serif',[{label:"\u0627\u0644\u0627\u0633\u0640\u0640\u0640\u0645:",value:t.studentName},{label:"\u0631\u0642\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644:",value:this.formatNumberArabic(t.studentId)},{label:"\u0627\u0644\u0635\u0641:",value:t.className},{label:"\u0627\u0644\u0645\u0633\u062A\u0648\u0649:",value:t.academicYear||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"},{label:"\u0647\u0627\u062A\u0641 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631:",value:this.formatNumberArabic(t.parentPhone||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F")}].forEach(C=>{C.value&&(i.fillText(`${C.label} ${C.value}`,e.width-15,r),r+=25)}),r+=10,this.drawDoubleLine(i,10,r,e.width-20),r+=20,i.textAlign="center",i.font='bold 22px "Arial", sans-serif',i.fillText("\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062F\u0641\u0639",e.width/2,r),r+=35,i.fillStyle="#2C3E50",i.fillRect(15,r,e.width-30,35),i.fillStyle="#FFFFFF",i.textAlign="right",i.fillText("\u0627\u0644\u0628\u0646\u062F",e.width-25,r+10),i.textAlign="center",i.fillText("\u0627\u0644\u0645\u0628\u0644\u063A (\u062F\u062C)",e.width/2,r+10),i.textAlign="left",i.fillText("\u0627\u0644\u0643\u0645\u064A\u0629",30,r+10),r+=35,i.fillStyle="#FFFFFF",i.strokeStyle="#000000",i.lineWidth=1,i.strokeRect(15,r,e.width-30,35),i.fillStyle="#000000",i.textAlign="right",i.font='18px "Arial", sans-serif',i.fillText(t.className,e.width-25,r+10),i.textAlign="center",i.fillText(this.formatAmountArabic(t.amount),e.width/2,r+10),i.textAlign="left",i.fillText("1",30,r+10),r+=35,i.strokeRect(15,r,e.width-30,35),i.textAlign="right",i.fillText(`\u0644\u0641\u062A\u0631\u0629: ${t.month}`,e.width-25,r+10),r+=50,this.drawSingleLine(i,10,r,e.width-20),r+=20,i.textAlign="center",i.font='bold 24px "Arial", sans-serif',i.fillStyle="#000000",i.fillText("\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u0633\u062A\u062D\u0642:",e.width/2,r),r+=50,this.drawSingleLine(i,10,r,e.width-20,"#FF0000"),r+=30,i.font='bold 28px "Arial", sans-serif',i.fillStyle="#E74C3C",i.fillText(this.formatAmountArabic(t.amount),e.width/2,r),r+=40,this.drawDecorationLine(i,10,r,e.width-20),r+=30,t.notes&&t.notes.trim()){i.textAlign="right",i.font='bold 18px "Arial", sans-serif',i.fillStyle="#2C3E50",i.fillText("\u0645\u0644\u0627\u062D\u0638\u0627\u062A:",e.width-15,r),r+=25,i.font='16px "Arial", sans-serif',i.fillStyle="#000000";let C=e.width-30,A=t.notes.split(" "),O="",T=[];for(let M of A){let G=O+M+" ";i.measureText(G).width>C&&O!==""?(T.push(O),O=M+" "):O=G}O&&T.push(O),T.forEach((M,G)=>{r<e.height-150&&(i.fillText(M.trim(),e.width-15,r),r+=22)}),r+=10}let c=this.generateQRCode(this.QR_CODE_TEXT),f=80,p=e.width-f-20,g=e.height-f-120;i.drawImage(c,p,g,f,f),i.textAlign="center",i.font='12px "Arial", sans-serif',i.fillStyle="#666666",i.fillText("\u0627\u0644\u0645\u0633\u062D \u0644\u0644\u062A\u062D\u0642\u0642",p+f/2,g+f+15),i.textAlign="center",i.font='16px "Arial", sans-serif',i.fillStyle="#2C3E50";let m=["\u0646\u0638\u0627\u0645 \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u062A\u0639\u0644\u064A\u0645","\u0645\u0637\u0648\u0631 \u0628\u0648\u0627\u0633\u0637\u0629: \u0631\u064A\u062F\u0648\u0643\u0633",this.FOOTER_TEXT,"\u0647\u0630\u0627 \u0625\u064A\u0635\u0627\u0644 \u0631\u0633\u0645\u064A - \u064A\u0631\u062C\u0649 \u0627\u0644\u0627\u062D\u062A\u0641\u0627\u0638 \u0628\u0647 \u0644\u0644\u0645\u0631\u0627\u062C\u0639\u0629"],x=e.height-90;return m.forEach(C=>{i.fillText(C,e.width/2,x),x+=40}),i.font='bold 18px "Arial", sans-serif',i.fillStyle="#27AE60",i.fillText("\u0634\u0643\u0631\u0627\u064B \u0644\u062B\u0642\u062A\u0643\u0645 \u0627\u0644\u063A\u0627\u0644\u064A\u0629",e.width/2,e.height-20),e})}canvasToRaster(t){let r=t.getContext("2d").getImageData(0,0,t.width,t.height).data,o=Math.ceil(t.width/8),l=new Uint8Array(o*t.height);l.fill(0);for(let c=0;c<t.height;c++)for(let f=0;f<t.width;f++){let p=(c*t.width+f)*4,g=r[p],m=r[p+1],x=r[p+2];if(Math.floor(g*.3+m*.59+x*.11)<200){let A=Math.floor(c*o+f/8),O=7-f%8;l[A]|=1<<O}}return l}printRasterImage(t,e){return wt(this,null,function*(){try{if(!this.writer)throw new Error("\u0627\u0644\u0637\u0627\u0628\u0639\u0629 \u063A\u064A\u0631 \u0645\u062A\u0635\u0644\u0629");let i=Math.ceil(e.width/8),r=e.height,o=new Uint8Array([29,118,48,0,i&255,i>>8&255,r&255,r>>8&255]);yield this.writer.write(new Uint8Array([27,64,27,51,36])),yield this.writer.write(new Uint8Array([29,87,this.CANVAS_WIDTH/8&255,0])),yield this.writer.write(o);let l=1024;for(let c=0;c<t.length;c+=l){let f=t.slice(c,c+l);yield this.writer.write(f),yield new Promise(p=>setTimeout(p,10))}return yield this.writer.write(new Uint8Array([29,86,65,3])),yield this.writer.write(new Uint8Array([27,100,5])),!0}catch(i){throw console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0635\u0648\u0631\u0629 \u0627\u0644\u0646\u0642\u0637\u064A\u0629:",i),i}})}printProfessionalReceipt(t){return wt(this,null,function*(){if(!this.isConnected&&!(yield this.connectToThermalPrinter()))return this.showError("\u0641\u0634\u0644 \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0637\u0627\u0628\u0639\u0629"),!1;try{this.showLoading("\u062C\u0627\u0631\u064A \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0625\u064A\u0635\u0627\u0644...");let e=yield this.createReceiptCanvas(t),i=this.canvasToRaster(e);if(this.showLoading("\u062C\u0627\u0631\u064A \u0627\u0644\u0637\u0628\u0627\u0639\u0629..."),yield this.printRasterImage(i,e))return this.showSuccessToast("\u062A\u0645 \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 \u0628\u0646\u062C\u0627\u062D"),!0;throw new Error("\u0641\u0634\u0644 \u0627\u0644\u0637\u0628\u0627\u0639\u0629")}catch(e){return this.handleError(e),!1}})}drawSingleLine(t,e,i,r,o="#000000"){t.strokeStyle=o,t.lineWidth=1,t.beginPath(),t.moveTo(e,i),t.lineTo(e+r,i),t.stroke()}drawDoubleLine(t,e,i,r,o="#000000"){t.strokeStyle=o,t.lineWidth=1,t.beginPath(),t.moveTo(e,i),t.lineTo(e+r,i),t.stroke(),t.beginPath(),t.moveTo(e,i+2),t.lineTo(e+r,i+2),t.stroke()}drawDecorationLine(t,e,i,r){let c=e;for(t.beginPath(),t.strokeStyle="#2C3E50",t.lineWidth=2;c<e+r;)t.moveTo(c,i),t.lineTo(c+10,i),c+=15;t.stroke()}translatePaymentMethod(t){return{cash:"\u0646\u0642\u062F\u0627\u064B",bank:"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A",card:"\u0628\u0637\u0627\u0642\u0629 \u0627\u0626\u062A\u0645\u0627\u0646",check:"\u0634\u064A\u0643",online:"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A",mobile:"\u062F\u0641\u0639 \u0645\u062D\u0645\u0648\u0644"}[t.toLowerCase()]||t}showConnectionError(t){let e="\u274C \u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0637\u0627\u0628\u0639\u0629: ";t.message.includes("permission")||t.name==="SecurityError"?e+="\u064A\u062C\u0628 \u0645\u0646\u062D \u0627\u0644\u0635\u0644\u0627\u062D\u064A\u0629 \u0644\u0644\u0648\u0635\u0648\u0644 \u0625\u0644\u0649 \u0627\u0644\u0637\u0627\u0628\u0639\u0629":t.message.includes("supported")?e+="\u0647\u0630\u0647 \u0627\u0644\u0645\u064A\u0632\u0629 \u063A\u064A\u0631 \u0645\u062F\u0639\u0648\u0645\u0629 \u0641\u064A \u0645\u062A\u0635\u0641\u062D\u0643. \u0627\u0644\u0631\u062C\u0627\u0621 \u0627\u0633\u062A\u062E\u062F\u0627\u0645 Chrome \u0623\u0648 Edge":t.message.includes("No device selected")?e+="\u0644\u0645 \u064A\u062A\u0645 \u0627\u062E\u062A\u064A\u0627\u0631 \u0637\u0627\u0628\u0639\u0629":t.message.includes("baudRate")?e+="\u0645\u0639\u062F\u0644 \u0627\u0644\u0628\u0627\u0648\u062F \u063A\u064A\u0631 \u0635\u062D\u064A\u062D. \u062A\u0623\u0643\u062F \u0645\u0646 \u0636\u0628\u0637 \u0627\u0644\u0637\u0627\u0628\u0639\u0629 \u0639\u0644\u0649 115200 \u0628\u0627\u0648\u062F":e+=t.message,this.ngZone.run(()=>{oa.default.fire({icon:"error",title:"\u062E\u0637\u0623",text:e,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B",footer:"<small>\u062A\u0623\u0643\u062F \u0645\u0646 \u0623\u0646 \u0627\u0644\u0637\u0627\u0628\u0639\u0629 \u0645\u062A\u0635\u0644\u0629 \u0648\u062A\u0639\u0645\u0644 \u0628\u0634\u0643\u0644 \u0635\u062D\u064A\u062D</small>"})})}showSuccessToast(t){this.ngZone.run(()=>{oa.default.fire({icon:"success",title:"\u2705 \u0646\u062C\u0627\u062D",text:t,timer:2e3,showConfirmButton:!1,position:"top-end",toast:!0})})}showLoading(t){this.ngZone.run(()=>{oa.default.fire({title:t,allowOutsideClick:!1,showConfirmButton:!1,willOpen:()=>{oa.default.showLoading()}})})}handleError(t){console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u0637\u0627\u0628\u0639\u0629:",t),this.ngZone.run(()=>{oa.default.fire({icon:"error",title:"\u274C \u062E\u0637\u0623",text:"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u0637\u0628\u0627\u0639\u0629: "+t.message,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"})}),this.isConnected=!1}showError(t){this.ngZone.run(()=>{oa.default.fire({icon:"error",title:"\u062E\u0637\u0623",text:t,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"})})}disconnect(){return wt(this,null,function*(){try{this.writer&&(yield this.writer.releaseLock(),this.writer=null),this.reader&&(yield this.reader.releaseLock(),this.reader=null),this.port&&(yield this.port.close(),this.port=null),this.isConnected=!1,console.log("\u062A\u0645 \u0642\u0637\u0639 \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0637\u0627\u0628\u0639\u0629")}catch(t){console.error("\u062E\u0637\u0623 \u0641\u064A \u0642\u0637\u0639 \u0627\u0644\u0627\u062A\u0635\u0627\u0644:",t)}})}checkConnectionStatus(){return this.isConnected}getPrinterStatus(){return{isConnected:this.isConnected,port:this.port?"\u0645\u062A\u0635\u0644":"\u063A\u064A\u0631 \u0645\u062A\u0635\u0644",timestamp:new Date().toLocaleString("en-US"),width:this.PRINT_WIDTH,height:this.PRINT_HEIGHT,academy:this.COMPANY_NAME,developer:this.DEVELOPER_NAME}}printMonthlyPaymentReceipt(t){return wt(this,null,function*(){let e={receiptNumber:`PAY-${Date.now().toString().slice(-8)}`,date:new Date().toLocaleDateString("en-US"),time:new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),studentName:t.studentName||"\u0637\u0627\u0644\u0628",studentId:t.studentId||"\u0628\u062F\u0648\u0646 \u0631\u0642\u0645",className:t.className||"\u0645\u0627\u062F\u0629 \u062F\u0631\u0627\u0633\u064A\u0629",month:t.month||"\u0634\u0647\u0631",amount:t.amount||0,paymentMethod:t.paymentMethod||"cash",academicYear:t.academicYear||"",parentPhone:t.parentPhone||"",notes:"\u062A\u0645 \u0633\u062F\u0627\u062F \u0627\u0644\u0642\u0633\u0637 \u0627\u0644\u0634\u0647\u0631\u064A \u0628\u0646\u062C\u0627\u062D. \u0646\u062A\u0645\u0646\u0649 \u0644\u0644\u0637\u0627\u0644\u0628 \u0627\u0644\u062A\u0648\u0641\u064A\u0642 \u0648\u0627\u0644\u0646\u062C\u0627\u062D."};return yield this.printProfessionalReceipt(e)})}printStudentMonthlyReport(t,e,i){return wt(this,null,function*(){try{let r=new Date,o={receiptNumber:`RPT-${r.getTime().toString().slice(-8)}`,date:r.toLocaleDateString("en-US"),time:r.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),studentName:t.name||"\u0637\u0627\u0644\u0628",studentId:t.studentId||"\u0628\u062F\u0648\u0646 \u0631\u0642\u0645",className:"\u062A\u0642\u0631\u064A\u0631 \u0634\u0647\u0631\u064A \u0634\u0627\u0645\u0644",month:r.toLocaleDateString("en-US",{month:"long",year:"numeric"}),amount:i.totalPaid||0,paymentMethod:"\u062A\u0642\u0631\u064A\u0631",academicYear:t.academicYear||"",parentPhone:t.parentPhone||"",notes:`\u0646\u0633\u0628\u0629 \u0627\u0644\u062D\u0636\u0648\u0631: ${e.attendanceRate||0}%
\u062D\u0636\u0648\u0631: ${e.present||0} | \u063A\u064A\u0627\u0628: ${e.absent||0} | \u062A\u0623\u062E\u0631: ${e.late||0}
\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0645\u062F\u0641\u0648\u0639: ${i.totalPaid||0} \u062F.\u062C | \u0627\u0644\u0645\u062A\u0628\u0642\u064A: ${i.pending||0} \u062F.\u062C`};return yield this.printProfessionalReceipt(o)}catch(r){return console.error("\u062E\u0637\u0623 \u0641\u064A \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u062A\u0642\u0631\u064A\u0631:",r),!1}})}printAdvancedTestPage(){return wt(this,null,function*(){if(!this.isConnected&&!(yield this.connectToThermalPrinter()))return!1;try{let t=document.createElement("canvas");t.width=this.CANVAS_WIDTH,t.height=600;let e=t.getContext("2d");e.fillStyle="#FFFFFF",e.fillRect(0,0,t.width,t.height),e.fillStyle="#000000",e.textAlign="center",e.font='bold 32px "Arial", sans-serif',e.fillText("\u2728 \u0635\u0641\u062D\u0629 \u0627\u062E\u062A\u0628\u0627\u0631 \u0627\u0644\u0637\u0627\u0628\u0639\u0629 \u2728",t.width/2,30),e.font='18px "Arial", sans-serif',e.fillText(`\u0627\u0644\u0639\u0631\u0636: ${this.CANVAS_WIDTH}px | \u0627\u0644\u0627\u0631\u062A\u0641\u0627\u0639: 600px`,t.width/2,70),e.fillText("\u0645\u0642\u0627\u0633 \u0627\u0644\u0648\u0631\u0642: 80 \u0645\u0645 | \u062A\u0635\u0645\u064A\u0645 \u0639\u0631\u0628\u064A",t.width/2,95),this.drawDoubleLine(e,10,110,t.width-20),e.textAlign="right",e.font='bold 24px "Arial", sans-serif',e.fillText("\u0627\u062E\u062A\u0628\u0627\u0631 \u0627\u0644\u0623\u0631\u0642\u0627\u0645 \u0627\u0644\u0639\u0631\u0628\u064A\u0629:",t.width-15,130),e.font='20px "Arial", sans-serif',e.fillText("\u0627\u0644\u0623\u0631\u0642\u0627\u0645 \u0627\u0644\u0639\u0627\u062F\u064A\u0629: 1234567890",t.width-15,160),e.fillText(`\u0627\u0644\u0623\u0631\u0642\u0627\u0645 \u0627\u0644\u0639\u0631\u0628\u064A\u0629: ${this.formatArabicNumber("1234567890")}`,t.width-15,190),this.drawSingleLine(e,10,210,t.width-20),e.textAlign="center",e.font='bold 24px "Arial", sans-serif',e.fillText("\u0627\u062E\u062A\u0628\u0627\u0631 \u0627\u0644\u062C\u062F\u0648\u0644",t.width/2,230);let i=260;e.fillStyle="#2C3E50",e.fillRect(15,i,t.width-30,35),e.fillStyle="#FFFFFF",e.textAlign="right",e.fillText("\u0627\u0644\u0628\u0646\u062F",t.width-25,i+10),e.textAlign="center",e.fillText("\u0627\u0644\u0645\u0628\u0644\u063A",t.width/2,i+10),e.fillStyle="#FFFFFF",e.strokeStyle="#000000",e.strokeRect(15,i+35,t.width-30,35),e.fillStyle="#000000",e.textAlign="right",e.fillText("\u062D\u0635\u0629 \u0631\u064A\u0627\u0636\u064A\u0627\u062A",t.width-25,i+45),e.textAlign="center",e.fillText(this.formatArabicNumber("50000"),t.width/2,i+45),this.drawSingleLine(e,10,i+85,t.width-20);let r=i+105;e.textAlign="center",e.font='bold 22px "Arial", sans-serif',e.fillText("\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:",t.width/2,r),e.font='bold 26px "Arial", sans-serif',e.fillStyle="#E74C3C",e.fillText(`${this.formatArabicNumber("50000")} \u062F.\u062C`,t.width/2,r+30),e.font='bold 28px "Arial", sans-serif',e.fillStyle="#27AE60",e.fillText("\u2705 \u0627\u062E\u062A\u0628\u0627\u0631 \u0646\u0627\u062C\u062D \u2705",t.width/2,450),e.font='20px "Arial", sans-serif',e.fillStyle="#000000",e.fillText("\u0627\u0644\u062A\u0635\u0645\u064A\u0645 \u0627\u0644\u062C\u062F\u064A\u062F \u0628\u062F\u0648\u0646 \u062A\u062F\u0627\u062E\u0644",t.width/2,490),e.fillText("\u0627\u0644\u0623\u0631\u0642\u0627\u0645 \u0627\u0644\u0639\u0631\u0628\u064A\u0629 \u0635\u062D\u064A\u062D\u0629",t.width/2,515),e.font='16px "Arial", sans-serif',e.fillStyle="#666666",e.fillText(this.COMPANY_NAME,t.width/2,550),e.fillText(`\u0646\u0638\u0627\u0645 ${this.DEVELOPER_NAME}`,t.width/2,570);let o=this.canvasToRaster(t);return(yield this.printRasterImage(o,t))?(this.showSuccessToast("\u062A\u0645 \u0637\u0628\u0627\u0639\u0629 \u0635\u0641\u062D\u0629 \u0627\u0644\u0627\u062E\u062A\u0628\u0627\u0631 \u0628\u0646\u062C\u0627\u062D"),!0):!1}catch(t){return this.handleError(t),!1}})}quickTest(){return wt(this,null,function*(){try{let t={receiptNumber:"TEST-001",date:new Date().toLocaleDateString("en-US"),time:new Date().toLocaleTimeString("en-US"),studentName:"\u0645\u062D\u0645\u062F \u0623\u062D\u0645\u062F \u0639\u0644\u064A",studentId:"STD-2024-001",className:"\u0631\u064A\u0627\u0636\u064A\u0627\u062A - \u0627\u0644\u0645\u0633\u062A\u0648\u0649 \u0627\u0644\u0623\u0648\u0644",month:"\u064A\u0646\u0627\u064A\u0631 2024",amount:5e4,paymentMethod:"cash",academicYear:"1AS",parentPhone:"0551234567",notes:"\u0647\u0630\u0627 \u0625\u064A\u0635\u0627\u0644 \u0627\u062E\u062A\u0628\u0627\u0631\u064A \u0644\u0644\u062A\u062D\u0642\u0642 \u0645\u0646 \u0639\u0645\u0644 \u0627\u0644\u0637\u0627\u0628\u0639\u0629 \u0648\u0627\u0644\u0623\u0631\u0642\u0627\u0645 \u0627\u0644\u0639\u0631\u0628\u064A\u0629 \u0628\u0634\u0643\u0644 \u0635\u062D\u064A\u062D"};return yield this.printProfessionalReceipt(t)}catch(t){return console.error("\u0641\u0634\u0644 \u0627\u0644\u0627\u062E\u062A\u0628\u0627\u0631 \u0627\u0644\u0633\u0631\u064A\u0639:",t),!1}})}printWelcomeMessage(){return wt(this,null,function*(){if(!this.isConnected&&!(yield this.connectToThermalPrinter()))return!1;try{let t=document.createElement("canvas");t.width=this.CANVAS_WIDTH,t.height=400;let e=t.getContext("2d");e.fillStyle="#FFFFFF",e.fillRect(0,0,t.width,t.height),e.fillStyle="#000000",e.textAlign="center",e.font='bold 30px "Arial", sans-serif',e.fillText("\u0645\u0631\u062D\u0628\u0627\u064B \u0628\u0643\u0645 \u0641\u064A",t.width/2,30),e.font='bold 26px "Arial", sans-serif',e.fillText("\u0646\u0638\u0627\u0645 \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u062A\u0639\u0644\u064A\u0645",t.width/2,70),this.drawDoubleLine(e,10,100,t.width-20),e.textAlign="right",e.font='20px "Arial", sans-serif';let i=130;["\u2713 \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0637\u0644\u0627\u0628 \u0648\u0627\u0644\u0634\u0639\u0628","\u2713 \u0646\u0638\u0627\u0645 \u0627\u0644\u062D\u0636\u0648\u0631 \u0648\u0627\u0644\u063A\u064A\u0627\u0628","\u2713 \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0645\u0627\u0644\u064A\u0629","\u2713 \u062A\u0642\u0627\u0631\u064A\u0631 \u062A\u0641\u0635\u064A\u0644\u064A\u0629","\u2713 \u0637\u0628\u0627\u0639\u0629 \u0625\u064A\u0635\u0627\u0644\u0627\u062A \u0627\u062D\u062A\u0631\u0627\u0641\u064A\u0629"].forEach(c=>{e.fillText(c,t.width-15,i),i+=30}),this.drawSingleLine(e,10,i,t.width-20),i+=20,e.textAlign="center",e.font='bold 24px "Arial", sans-serif',e.fillText("\u062A\u062A\u0645\u0646\u0649 \u0644\u0643\u0645",t.width/2,i),e.font='20px "Arial", sans-serif',e.fillText("\u062A\u062C\u0631\u0628\u0629 \u062A\u0639\u0644\u064A\u0645\u064A\u0629 \u0645\u0645\u062A\u0639\u0629 \u0648\u0645\u0641\u064A\u062F\u0629",t.width/2,i+30),e.font='18px "Arial", sans-serif',e.fillStyle="#2C3E50",e.fillText("\u0646\u062D\u0648 \u0645\u0633\u062A\u0642\u0628\u0644 \u0632\u0627\u0647\u0631 \u0628\u0627\u0644\u0639\u0644\u0645 \u0648\u0627\u0644\u0645\u0639\u0631\u0641\u0629",t.width/2,i+60),e.font='16px "Arial", sans-serif',e.fillStyle="#666666",e.fillText(this.COMPANY_NAME,t.width/2,i+90),e.fillText(`\u0645\u0637\u0648\u0631 \u0628\u0648\u0627\u0633\u0637\u0629: ${this.DEVELOPER_NAME}`,t.width/2,i+110);let o=this.canvasToRaster(t);return(yield this.printRasterImage(o,t))?(this.showSuccessToast("\u062A\u0645 \u0637\u0628\u0627\u0639\u0629 \u0631\u0633\u0627\u0644\u0629 \u0627\u0644\u062A\u0631\u062D\u064A\u0628 \u0628\u0646\u062C\u0627\u062D"),!0):!1}catch(t){return console.error("\u062E\u0637\u0623 \u0641\u064A \u0637\u0628\u0627\u0639\u0629 \u0631\u0633\u0627\u0644\u0629 \u0627\u0644\u062A\u0631\u062D\u064A\u0628:",t),!1}})}previewReceipt(t){return wt(this,null,function*(){try{let i=(yield this.createReceiptCanvas(t)).toDataURL("image/png"),r=window.open("","_blank");r&&(r.document.write(`
          <!DOCTYPE html>
          <html dir="rtl">
          <head>
            <meta charset="UTF-8">
            <title>\u0645\u0639\u0627\u064A\u0646\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644</title>
            <style>
              body { 
                font-family: 'Arial', sans-serif; 
                padding: 20px; 
                background: #f5f5f5;
                text-align: center;
              }
              .preview-container {
                max-width: 576px;
                margin: 0 auto;
                background: white;
                padding: 20px;
                border-radius: 10px;
                box-shadow: 0 2px 10px rgba(0,0,0,0.1);
              }
              img { 
                max-width: 100%; 
                height: auto;
                border: 1px solid #ddd;
              }
              .controls {
                margin-top: 20px;
                padding: 15px;
                background: #f8f9fa;
                border-radius: 5px;
              }
              button {
                padding: 10px 20px;
                margin: 0 5px;
                border: none;
                border-radius: 5px;
                cursor: pointer;
                font-size: 16px;
              }
              .btn-print {
                background: #28a745;
                color: white;
              }
              .btn-close {
                background: #dc3545;
                color: white;
              }
              .features {
                text-align: right;
                margin-top: 15px;
                padding: 10px;
                background: #e9ecef;
                border-radius: 5px;
              }
            </style>
          </head>
          <body>
            <div class="preview-container">
              <h2>\u0645\u0639\u0627\u064A\u0646\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 - \u0627\u0644\u062A\u0635\u0645\u064A\u0645 \u0627\u0644\u062C\u062F\u064A\u062F</h2>
              <img src="${i}" alt="\u0645\u0639\u0627\u064A\u0646\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644">
              
              <div class="features">
                <h4>\u0645\u0645\u064A\u0632\u0627\u062A \u0627\u0644\u062A\u0635\u0645\u064A\u0645 \u0627\u0644\u062C\u062F\u064A\u062F:</h4>
                <ul style="text-align: right; padding-right: 20px;">
                  <li>\u062A\u0635\u0645\u064A\u0645 \u0645\u0646\u0638\u0645 \u0628\u062F\u0648\u0646 \u062A\u062F\u0627\u062E\u0644</li>
                  <li>\u0627\u0633\u062A\u062E\u062F\u0627\u0645 \u0627\u0644\u0623\u0631\u0642\u0627\u0645 \u0627\u0644\u0639\u0631\u0628\u064A\u0629 \u0627\u0644\u0635\u062D\u064A\u062D\u0629</li>
                  <li>\u0641\u0635\u0644 \u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A \u0639\u0646 \u0627\u0644\u062C\u062F\u0648\u0644 \u0628\u0648\u0636\u0648\u062D</li>
                  <li>\u0645\u0642\u0627\u0633 \u0627\u0644\u0648\u0631\u0642: 80 \u0645\u0645</li>
                  <li>\u062E\u0637\u0648\u0637 \u0648\u0627\u0636\u062D\u0629 \u0648\u0642\u0631\u0627\u0621\u0629 \u0633\u0647\u0644\u0629</li>
                </ul>
              </div>
              
              <div class="controls">
                <button class="btn-print" onclick="window.print()">\u{1F5A8}\uFE0F \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0645\u0639\u0627\u064A\u0646\u0629</button>
                <button class="btn-close" onclick="window.close()">\u2716 \u0625\u063A\u0644\u0627\u0642</button>
              </div>
              
              <p style="margin-top: 15px; color: #666; font-size: 14px;">
                \u0645\u0642\u0627\u0633 \u0627\u0644\u0648\u0631\u0642: 80 \u0645\u0645 \xD7 \u0627\u0631\u062A\u0641\u0627\u0639 \u062F\u064A\u0646\u0627\u0645\u064A\u0643\u064A<br>
                \u0627\u0644\u0623\u0631\u0642\u0627\u0645: \u0639\u0631\u0628\u064A\u0629 \u0635\u062D\u064A\u062D\u0629 (\u0660\u0661\u0662\u0663\u0664\u0665\u0666\u0667\u0668\u0669)<br>
                \u0627\u0644\u062A\u0635\u0645\u064A\u0645: \u0627\u062D\u062A\u0631\u0627\u0641\u064A \u0628\u062F\u0648\u0646 \u062A\u062F\u0627\u062E\u0644
              </p>
            </div>
          </body>
          </html>
        `),r.document.close())}catch(e){console.error("\u062E\u0637\u0623 \u0641\u064A \u0639\u0631\u0636 \u0627\u0644\u0645\u0639\u0627\u064A\u0646\u0629:",e),oa.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u0639\u0631\u0636 \u0645\u0639\u0627\u064A\u0646\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644","error")}})}testNewReceiptDesign(){return wt(this,null,function*(){try{let t={receiptNumber:"TEST-001",date:new Date().toLocaleDateString("en-US"),time:new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),studentName:"\u0645\u062D\u0645\u062F \u0623\u062D\u0645\u062F \u0639\u0644\u064A",studentId:"STD-2024-001",className:"\u0631\u064A\u0627\u0636\u064A\u0627\u062A - \u0627\u0644\u0645\u0633\u062A\u0648\u0649 \u0627\u0644\u0623\u0648\u0644",month:"\u064A\u0646\u0627\u064A\u0631 2024",amount:75e3,paymentMethod:"bank",academicYear:"1AS",parentPhone:"0551234567",notes:"\u0627\u0644\u062F\u0641\u0639\u0629 \u0627\u0644\u0623\u0648\u0644\u0649 \u0645\u0646 \u0623\u0635\u0644 3 \u062F\u0641\u0639\u0627\u062A - \u0646\u062A\u0645\u0646\u0649 \u0644\u0644\u0637\u0627\u0644\u0628 \u0627\u0644\u0646\u062C\u0627\u062D \u0648\u0627\u0644\u062A\u0648\u0641\u064A\u0642 \u0641\u064A \u0645\u0633\u064A\u0631\u062A\u0647 \u0627\u0644\u062A\u0639\u0644\u064A\u0645\u064A\u0629"};return yield this.printProfessionalReceipt(t)}catch(t){return console.error("\u0641\u0634\u0644 \u0627\u062E\u062A\u0628\u0627\u0631 \u0627\u0644\u062A\u0635\u0645\u064A\u0645 \u0627\u0644\u062C\u062F\u064A\u062F:",t),!1}})}printCustomReceipt(t,e,i,r,o,l="cash",c){return wt(this,null,function*(){try{let f={receiptNumber:`CUST-${Date.now().toString().slice(-8)}`,date:new Date().toLocaleDateString("en-US"),time:new Date().toLocaleTimeString("en-US ",{hour:"2-digit",minute:"2-digit"}),studentName:t,studentId:e,className:i,month:r,amount:o,paymentMethod:l,notes:c||"\u062F\u0641\u0639\u0629 \u0646\u0642\u062F\u064A\u0629"};return yield this.printProfessionalReceipt(f)}catch(f){return console.error("\u0641\u0634\u0644 \u0641\u064A \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 \u0627\u0644\u0645\u062E\u0635\u0635:",f),!1}})}static \u0275fac=function(e){return new(e||n)(We(si))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})};function Rj(n,t){n&1&&(s(0,"div",102)(1,"div",103),b(2,"div",104),s(3,"p"),u(4,"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A..."),a()()())}function kj(n,t){n&1&&b(0,"i",105)}function Nj(n,t){n&1&&b(0,"i",106)}function Uj(n,t){if(n&1){let e=he();s(0,"button",83),I("click",function(){F(e);let r=E();return R(r.connectToPrinter())}),b(1,"i",107),u(2," \u0627\u0644\u0627\u062A\u0635\u0627\u0644 "),a()}}function Lj(n,t){if(n&1){let e=he();s(0,"button",83),I("click",function(){F(e);let r=E();return R(r.disconnectPrinter())}),b(1,"i",107),u(2," \u0642\u0637\u0639 \u0627\u0644\u0627\u062A\u0635\u0627\u0644 "),a()}}function Bj(n,t){if(n&1&&(s(0,"option",108),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Gn(" ",e.name," - ",e.studentId," ")}}function Vj(n,t){if(n&1&&(s(0,"option",108),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),H(" ",e.name," ")}}function Hj(n,t){if(n&1&&(s(0,"option",108),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),H(" ",e," ")}}function zj(n,t){n&1&&b(0,"i",115)}function jj(n,t){n&1&&b(0,"i",106)}function Wj(n,t){if(n&1){let e=he();s(0,"div",109)(1,"div",110),b(2,"i",27),u(3),a(),s(4,"div",111)(5,"button",112),I("click",function(){F(e);let r=E();return R(r.markSelectedAsPaid())}),j(6,zj,1,0,"i",113)(7,jj,1,0,"i",10),u(8),a(),s(9,"button",114),I("click",function(){F(e);let r=E();return R(r.printSelectedReceipts())}),b(10,"i",17),u(11," \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644\u0627\u062A "),a(),s(12,"button",36),I("click",function(){F(e);let r=E();return R(r.selectedPayments.clear())}),b(13,"i",37),u(14," \u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u062A\u062D\u062F\u064A\u062F "),a()()()}if(n&2){let e=E();d(3),H(" ",e.selectedPayments.size," \u062F\u0641\u0639\u0629 \u0645\u062D\u062F\u062F\u0629 "),d(2),w("disabled",e.isBulkActionLoading),d(),w("ngIf",!e.isBulkActionLoading),d(),w("ngIf",e.isBulkActionLoading),d(),H(" ",e.isBulkActionLoading?"\u062C\u0627\u0631\u064A \u0627\u0644\u0645\u0639\u0627\u0644\u062C\u0629...":"\u062A\u0633\u062F\u064A\u062F \u0627\u0644\u0645\u062D\u062F\u062F"," ")}}function Gj(n,t){if(n&1){let e=he();s(0,"button",142),I("click",function(){F(e);let r=E().$implicit,o=E(2);return R(o.markPaymentAsPaid(r))}),b(1,"i",115),a()}}function $j(n,t){if(n&1){let e=he();s(0,"button",143),I("click",function(){F(e);let r=E().$implicit,o=E(2);return R(o.cancelPayment(r))}),b(1,"i",144),a()}}function Yj(n,t){if(n&1){let e=he();s(0,"tr")(1,"td",118)(2,"input",119),I("change",function(){let r=F(e).$implicit,o=E(2);return R(o.togglePaymentSelection(r._id))}),a()(),s(3,"td"),u(4),ut(5,"date"),a(),s(6,"td",122)(7,"div",123),u(8),a(),s(9,"div",124),u(10),a()(),s(11,"td"),u(12),s(13,"div",125),u(14),a()(),s(15,"td",126)(16,"span",127),u(17),ut(18,"number"),a()(),s(19,"td"),u(20),a(),s(21,"td")(22,"span",128),u(23),a()(),s(24,"td")(25,"span",129),u(26),a()(),s(27,"td",130)(28,"span",131),u(29),a(),s(30,"button",132),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.printSinglePaymentReceipt(r))}),b(31,"i",17),a()(),s(32,"td",133),u(33),a(),s(34,"td",134)(35,"div",135),j(36,Gj,2,0,"button",136),s(37,"button",137),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.openEditPaymentModal(r))}),b(38,"i",138),a(),j(39,$j,2,0,"button",139),s(40,"button",140),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.deletePayment(r))}),b(41,"i",141),a()()()()}if(n&2){let e=t.$implicit,i=E(2);Ie("selected",i.selectedPayments.has(e._id)),d(2),w("checked",i.selectedPayments.has(e._id)),d(2),H(" ",e.paymentDate?pt(5,21,e.paymentDate,"yyyy/MM/dd"):"\u063A\u064A\u0631 \u0645\u062F\u0641\u0648\u0639"," "),d(4),B((e.student==null?null:e.student.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"),d(2),B((e.student==null?null:e.student.studentId)||"\u0628\u062F\u0648\u0646 \u0631\u0642\u0645"),d(2),H(" ",(e.class==null?null:e.class.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"," "),d(2),B(e.class==null||e.class.teacher==null?null:e.class.teacher.name),d(3),H("",_c(18,24,e.amount)," \u062F.\u062C"),d(3),B(e.month),d(2),Kn(e.paymentMethod),d(),H(" ",i.getPaymentMethodText(e.paymentMethod)," "),d(2),Kn(i.getStatusClass(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(3),B(e.invoiceNumber||"\u0628\u062F\u0648\u0646 \u0631\u0642\u0645"),d(),w("disabled",!i.isPrinterConnected),d(3),H(" ",e.notes||"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u0644\u0627\u062D\u0638\u0627\u062A"," "),d(3),w("ngIf",e.status!=="paid"),d(3),w("ngIf",e.status==="paid")}}function qj(n,t){if(n&1){let e=he();s(0,"div",116)(1,"table",117)(2,"thead")(3,"tr")(4,"th",118)(5,"input",119),I("change",function(){F(e);let r=E();return R(r.selectAllPayments())}),a()(),s(6,"th",120),I("click",function(){F(e);let r=E();return R(r.sort("paymentDate"))}),u(7," \u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639 "),b(8,"i",84),a(),s(9,"th",120),I("click",function(){F(e);let r=E();return R(r.sort("student.name"))}),u(10," \u0627\u0644\u0637\u0627\u0644\u0628 "),b(11,"i",84),a(),s(12,"th",120),I("click",function(){F(e);let r=E();return R(r.sort("class.name"))}),u(13," \u0627\u0644\u062D\u0635\u0629 "),b(14,"i",84),a(),s(15,"th",120),I("click",function(){F(e);let r=E();return R(r.sort("amount"))}),u(16," \u0627\u0644\u0645\u0628\u0644\u063A "),b(17,"i",84),a(),s(18,"th"),u(19,"\u0627\u0644\u0634\u0647\u0631"),a(),s(20,"th"),u(21,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(22,"th"),u(23,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(24,"th"),u(25,"\u0631\u0642\u0645 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629"),a(),s(26,"th"),u(27,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"),a(),s(28,"th"),u(29,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(30,"tbody"),j(31,Yj,42,26,"tr",121),a()()()}if(n&2){let e=E();d(5),w("checked",e.selectedPayments.size===e.filteredPayments.length&&e.filteredPayments.length>0),d(3),Ie("fa-sort-up",e.sortField==="paymentDate"&&e.sortDirection==="asc")("fa-sort-down",e.sortField==="paymentDate"&&e.sortDirection==="desc"),d(3),Ie("fa-sort-up",e.sortField==="student.name"&&e.sortDirection==="asc")("fa-sort-down",e.sortField==="student.name"&&e.sortDirection==="desc"),d(3),Ie("fa-sort-up",e.sortField==="class.name"&&e.sortDirection==="asc")("fa-sort-down",e.sortField==="class.name"&&e.sortDirection==="desc"),d(3),Ie("fa-sort-up",e.sortField==="amount"&&e.sortDirection==="asc")("fa-sort-down",e.sortField==="amount"&&e.sortDirection==="desc"),d(14),w("ngForOf",e.paginatedPayments)}}function Xj(n,t){if(n&1&&(s(0,"div",152)(1,"span",153),u(2,"\u0631\u0642\u0645 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629:"),a(),s(3,"span",154),u(4),a()()),n&2){let e=E().$implicit;d(4),B(e.invoiceNumber)}}function Zj(n,t){if(n&1&&(s(0,"div",152)(1,"span",153),u(2,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A:"),a(),s(3,"span",164),u(4),a()()),n&2){let e=E().$implicit;d(4),B(e.notes)}}function Jj(n,t){if(n&1){let e=he();s(0,"button",165),I("click",function(){F(e);let r=E().$implicit,o=E(2);return R(o.markPaymentAsPaid(r))}),b(1,"i",115),u(2," \u062A\u0633\u062F\u064A\u062F "),a()}}function Kj(n,t){if(n&1){let e=he();s(0,"button",166),I("click",function(){F(e);let r=E().$implicit,o=E(2);return R(o.cancelPayment(r))}),b(1,"i",144),u(2," \u0625\u0644\u063A\u0627\u0621 "),a()}}function Qj(n,t){if(n&1){let e=he();s(0,"div",147)(1,"div",148)(2,"div",149)(3,"input",119),I("change",function(){let r=F(e).$implicit,o=E(2);return R(o.togglePaymentSelection(r._id))}),a()(),s(4,"div",150)(5,"h4"),u(6),a(),s(7,"span",124),u(8),a()(),s(9,"span",129),u(10),a()(),s(11,"div",151)(12,"div",152)(13,"span",153),u(14,"\u0627\u0644\u062D\u0635\u0629:"),a(),s(15,"span",154),u(16),a()(),s(17,"div",152)(18,"span",153),u(19,"\u0627\u0644\u0634\u0647\u0631:"),a(),s(20,"span",154),u(21),a()(),s(22,"div",152)(23,"span",153),u(24,"\u0627\u0644\u0645\u0628\u0644\u063A:"),a(),s(25,"span",155),u(26),ut(27,"number"),a()(),s(28,"div",152)(29,"span",153),u(30,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639:"),a(),s(31,"span",154),u(32),ut(33,"date"),a()(),s(34,"div",152)(35,"span",153),u(36,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639:"),a(),s(37,"span",128),u(38),a()(),j(39,Xj,5,1,"div",156)(40,Zj,5,1,"div",156),a(),s(41,"div",157)(42,"div",158),j(43,Jj,3,0,"button",159),s(44,"button",160),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.openEditPaymentModal(r))}),b(45,"i",138),u(46," \u062A\u0639\u062F\u064A\u0644 "),a(),j(47,Kj,3,0,"button",161),s(48,"button",162),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.deletePayment(r))}),b(49,"i",141),u(50," \u062D\u0630\u0641 "),a(),s(51,"button",163),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.printSinglePaymentReceipt(r))}),b(52,"i",17),u(53," \u0637\u0628\u0627\u0639\u0629 "),a()()()()}if(n&2){let e=t.$implicit,i=E(2);Ie("selected",i.selectedPayments.has(e._id)),d(3),w("checked",i.selectedPayments.has(e._id)),d(3),B((e.student==null?null:e.student.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"),d(2),B((e.student==null?null:e.student.studentId)||"\u0628\u062F\u0648\u0646 \u0631\u0642\u0645"),d(),Kn(i.getStatusClass(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(6),B((e.class==null?null:e.class.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"),d(5),B(e.month),d(5),H("",_c(27,20,e.amount)," \u062F.\u062C"),d(6),B(e.paymentDate?pt(33,22,e.paymentDate,"yyyy/MM/dd"):"\u063A\u064A\u0631 \u0645\u062F\u0641\u0648\u0639"),d(5),Kn(e.paymentMethod),d(),H(" ",i.getPaymentMethodText(e.paymentMethod)," "),d(),w("ngIf",e.invoiceNumber),d(),w("ngIf",e.notes),d(3),w("ngIf",e.status!=="paid"),d(4),w("ngIf",e.status==="paid"),d(4),w("disabled",!i.isPrinterConnected)}}function eW(n,t){if(n&1&&(s(0,"div",145),j(1,Qj,54,25,"div",146),a()),n&2){let e=E();d(),w("ngForOf",e.paginatedPayments)}}function tW(n,t){if(n&1){let e=he();s(0,"div",167)(1,"div",168),b(2,"i",169),s(3,"h3"),u(4,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A"),a(),s(5,"p"),u(6,"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u0649 \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u062A\u0637\u0627\u0628\u0642 \u0645\u0639\u0627\u064A\u064A\u0631 \u0627\u0644\u0628\u062D\u062B \u0627\u0644\u062E\u0627\u0635\u0629 \u0628\u0643"),a(),s(7,"button",6),I("click",function(){F(e);let r=E();return R(r.clearFilters())}),b(8,"i",37),u(9," \u0645\u0633\u062D \u0627\u0644\u0641\u0644\u0627\u062A\u0631 "),a()()()}}function nW(n,t){if(n&1){let e=he();s(0,"span",172),I("click",function(){F(e);let r=E().$implicit,o=E();return R(o.currentPage=r)}),u(1),a()}if(n&2){let e=E().$implicit,i=E();Ie("active",e===i.currentPage),d(),H(" ",e," ")}}function iW(n,t){if(n&1&&(s(0,"span",173),u(1),a()),n&2){let e=E().$implicit;d(),H(" ",e," ")}}function rW(n,t){if(n&1&&(v0(0),j(1,nW,2,3,"span",170)(2,iW,2,1,"span",171),y0()),n&2){let e=t.$implicit;d(),w("ngIf",typeof e=="number"),d(),w("ngIf",typeof e=="string")}}function oW(n,t){if(n&1&&(s(0,"option",108),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Qi(" ",e.name," - ",e.studentId," - ",e.grade||""," ")}}function sW(n,t){n&1&&(s(0,"div",202),u(1," \u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0637\u0627\u0644\u0628 "),a())}function aW(n,t){if(n&1&&(s(0,"option",108),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Gn(" ",e.name," - ",e.teacher==null?null:e.teacher.name," ")}}function lW(n,t){n&1&&(s(0,"div",202),u(1," \u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u062D\u0635\u0629 "),a())}function uW(n,t){n&1&&(s(0,"div",202),u(1," \u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0645\u0628\u0644\u063A \u0635\u062D\u064A\u062D "),a())}function cW(n,t){if(n&1&&(s(0,"option",108),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),H(" ",e," ")}}function dW(n,t){n&1&&(s(0,"div",202),u(1," \u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0634\u0647\u0631 "),a())}function fW(n,t){n&1&&b(0,"i",203)}function hW(n,t){n&1&&b(0,"i",106)}function pW(n,t){if(n&1){let e=he();s(0,"div",174)(1,"div",175)(2,"div",176)(3,"h3"),b(4,"i",4),u(5," \u062A\u0633\u062C\u064A\u0644 \u062F\u0641\u0639\u0629 \u062C\u062F\u064A\u062F\u0629 "),a(),s(6,"button",177),I("click",function(){F(e);let r=E();return R(r.closeNewPaymentModal())}),b(7,"i",37),a()(),s(8,"form",178),I("ngSubmit",function(){F(e);let r=E();return R(r.onSubmitNewPayment())}),s(9,"div",179)(10,"div",180)(11,"label",181),b(12,"i",41),u(13," \u0627\u0644\u0637\u0627\u0644\u0628 * "),a(),s(14,"select",182)(15,"option",43),u(16,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),j(17,oW,2,4,"option",44),a(),j(18,sW,2,0,"div",183),a(),s(19,"div",180)(20,"label",184),b(21,"i",46),u(22," \u0627\u0644\u062D\u0635\u0629 * "),a(),s(23,"select",185)(24,"option",43),u(25,"\u0627\u062E\u062A\u0631 \u0627\u0644\u062D\u0635\u0629"),a(),j(26,aW,2,3,"option",44),a(),j(27,lW,2,0,"div",183),a(),s(28,"div",186)(29,"div",180)(30,"label",187),b(31,"i",25),u(32," \u0627\u0644\u0645\u0628\u0644\u063A (\u062F.\u062C) * "),a(),b(33,"input",188),j(34,uW,2,0,"div",183),a(),s(35,"div",180)(36,"label",189),b(37,"i",49),u(38," \u0627\u0644\u0634\u0647\u0631 * "),a(),s(39,"select",190)(40,"option",43),u(41,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0634\u0647\u0631"),a(),j(42,cW,2,2,"option",44),a(),j(43,dW,2,0,"div",183),a()(),s(44,"div",186)(45,"div",180)(46,"label",191),b(47,"i",58),u(48," \u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639 "),a(),s(49,"select",192)(50,"option",60),u(51,"\u0646\u0642\u062F\u064A"),a(),s(52,"option",61),u(53,"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A"),a(),s(54,"option",62),u(55,"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"),a(),s(56,"option",63),u(57,"\u062F\u0641\u0639 \u0645\u062D\u0645\u0648\u0644"),a(),s(58,"option",64),u(59,"\u0634\u064A\u0643"),a()()(),s(60,"div",180)(61,"label",193),b(62,"i",66),u(63," \u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639 "),a(),b(64,"input",194),a()(),s(65,"div",180)(66,"label",195),b(67,"i",196),u(68," \u0645\u0644\u0627\u062D\u0638\u0627\u062A "),a(),b(69,"textarea",197),a()(),s(70,"div",198)(71,"button",199),I("click",function(){F(e);let r=E();return R(r.closeNewPaymentModal())}),u(72," \u0625\u0644\u063A\u0627\u0621 "),a(),s(73,"button",200),j(74,fW,1,0,"i",201)(75,hW,1,0,"i",10),u(76),a()()()()()}if(n&2){let e,i,r,o,l,c,f,p,g,m,x=E();d(8),w("formGroup",x.newPaymentForm),d(2),Ie("error",((e=x.newPaymentForm.get("studentId"))==null?null:e.invalid)&&((e=x.newPaymentForm.get("studentId"))==null?null:e.touched)),d(7),w("ngForOf",x.students),d(),w("ngIf",((i=x.newPaymentForm.get("studentId"))==null?null:i.invalid)&&((i=x.newPaymentForm.get("studentId"))==null?null:i.touched)),d(),Ie("error",((r=x.newPaymentForm.get("classId"))==null?null:r.invalid)&&((r=x.newPaymentForm.get("classId"))==null?null:r.touched)),d(7),w("ngForOf",x.getStudentClasses(((o=x.newPaymentForm.get("studentId"))==null?null:o.value)||"")),d(),w("ngIf",((l=x.newPaymentForm.get("classId"))==null?null:l.invalid)&&((l=x.newPaymentForm.get("classId"))==null?null:l.touched)),d(2),Ie("error",((c=x.newPaymentForm.get("amount"))==null?null:c.invalid)&&((c=x.newPaymentForm.get("amount"))==null?null:c.touched)),d(5),w("ngIf",((f=x.newPaymentForm.get("amount"))==null?null:f.invalid)&&((f=x.newPaymentForm.get("amount"))==null?null:f.touched)),d(),Ie("error",((p=x.newPaymentForm.get("month"))==null?null:p.invalid)&&((p=x.newPaymentForm.get("month"))==null?null:p.touched)),d(7),w("ngForOf",x.availableMonths),d(),w("ngIf",((g=x.newPaymentForm.get("month"))==null?null:g.invalid)&&((g=x.newPaymentForm.get("month"))==null?null:g.touched)),d(17),Ie("error",((m=x.newPaymentForm.get("paymentDate"))==null?null:m.invalid)&&((m=x.newPaymentForm.get("paymentDate"))==null?null:m.touched)),d(13),w("disabled",x.newPaymentForm.invalid||x.isRecordingPayment),d(),w("ngIf",!x.isRecordingPayment),d(),w("ngIf",x.isRecordingPayment),d(),H(" ",x.isRecordingPayment?"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u0633\u062C\u064A\u0644...":"\u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629"," ")}}function mW(n,t){if(n&1){let e=he();s(0,"div",174)(1,"div",175)(2,"div",176)(3,"h3"),b(4,"i",138),u(5," \u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629 "),a(),s(6,"button",177),I("click",function(){F(e);let r=E();return R(r.isEditPaymentModalOpen=!1)}),b(7,"i",37),a()(),s(8,"div",179)(9,"div",204)(10,"div",205)(11,"span",153),u(12,"\u0627\u0644\u0637\u0627\u0644\u0628:"),a(),s(13,"span",154),u(14),a()(),s(15,"div",205)(16,"span",153),u(17,"\u0627\u0644\u062D\u0635\u0629:"),a(),s(18,"span",154),u(19),a()(),s(20,"div",205)(21,"span",153),u(22,"\u0627\u0644\u0634\u0647\u0631:"),a(),s(23,"span",154),u(24),a()(),s(25,"div",205)(26,"span",153),u(27,"\u0627\u0644\u062D\u0627\u0644\u0629:"),a(),s(28,"span",129),u(29),a()()(),s(30,"div",206)(31,"button",6),I("click",function(){F(e);let r=E();return R(r.updatePaymentAmount())}),b(32,"i",4),u(33," \u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0645\u0628\u0644\u063A "),a()()(),s(34,"div",198)(35,"button",199),I("click",function(){F(e);let r=E();return R(r.isEditPaymentModalOpen=!1)}),u(36," \u0625\u063A\u0644\u0627\u0642 "),a()()()()}if(n&2){let e=E();d(14),B(e.editingPayment==null||e.editingPayment.student==null?null:e.editingPayment.student.name),d(5),B(e.editingPayment==null||e.editingPayment.class==null?null:e.editingPayment.class.name),d(5),B(e.editingPayment==null?null:e.editingPayment.month),d(4),Kn(e.getStatusClass((e.editingPayment==null?null:e.editingPayment.status)||"")),d(),H(" ",e.getStatusText((e.editingPayment==null?null:e.editingPayment.status)||"")," ")}}var V1=class n{constructor(t,e,i,r,o,l,c){this.paymentsService=t;this.studentsService=e;this.lessonsService=i;this.teachersService=r;this.authService=o;this.printerService=l;this.fb=c;this.newPaymentForm=this.fb.group({studentId:["",Tt.required],classId:["",Tt.required],amount:["",[Tt.required,Tt.min(1)]],month:["",Tt.required],paymentMethod:["cash",Tt.required],paymentDate:[new Date().toISOString().split("T")[0],Tt.required],notes:[""]}),this.generateAvailableMonths()}payments=[];filteredPayments=[];students=[];classes=[];teachers=[];isLoading=!0;isRecordingPayment=!1;isExporting=!1;filters={student:"",class:"",month:"",status:"",paymentMethod:"",startDate:"",endDate:""};newPaymentForm;isNewPaymentModalOpen=!1;selectedStudentForPayment=null;availableMonths=[];isEditPaymentModalOpen=!1;editingPayment=null;selectedPayments=new Set;isBulkActionLoading=!1;stats={totalPayments:0,totalAmount:0,pendingPayments:0,latePayments:0,paidAmount:0,pendingAmount:0};currentPage=1;itemsPerPage=20;totalPages=1;viewMode="table";sortField="paymentDate";sortDirection="desc";isPrinterConnected=!1;printerStatus="\u063A\u064A\u0631 \u0645\u062A\u0635\u0644";ngOnInit(){this.loadInitialData(),this.checkPrinterConnection(),this.updatePrinterStatus()}loadInitialData(){this.isLoading=!0,Fs({payments:this.paymentsService.getPayments(),students:this.studentsService.getStudents(),classes:this.lessonsService.getClasses(),teachers:this.teachersService.getTeachers()}).subscribe({next:t=>{this.payments=t.payments,this.students=t.students,this.classes=t.classes,this.teachers=t.teachers,this.applyFilters(),this.calculateStatistics(),this.isLoading=!1},error:t=>{console.error("Error loading data:",t),this.showError("\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A"),this.isLoading=!1}})}generateAvailableMonths(){let t=new Date,e=[];for(let i=-12;i<=6;i++){let r=new Date(t.getFullYear(),t.getMonth()+i,1),o=`${r.getFullYear()}-${String(r.getMonth()+1).padStart(2,"0")}`;e.push(o)}this.availableMonths=e}applyFilters(){let t=[...this.payments];if(this.filters.student&&(t=t.filter(e=>e.student?._id===this.filters.student||e.student?.name?.toLowerCase().includes(this.filters.student.toLowerCase()))),this.filters.class&&(t=t.filter(e=>e.class?._id===this.filters.class||e.class?.name?.toLowerCase().includes(this.filters.class.toLowerCase()))),this.filters.month&&(t=t.filter(e=>e.month===this.filters.month)),this.filters.status&&(t=t.filter(e=>e.status===this.filters.status)),this.filters.paymentMethod&&(t=t.filter(e=>e.paymentMethod===this.filters.paymentMethod)),this.filters.startDate){let e=new Date(this.filters.startDate);t=t.filter(i=>i.paymentDate?new Date(i.paymentDate)>=e:!1)}if(this.filters.endDate){let e=new Date(this.filters.endDate);e.setHours(23,59,59,999),t=t.filter(i=>i.paymentDate?new Date(i.paymentDate)<=e:!1)}t.sort((e,i)=>{let r=e[this.sortField],o=i[this.sortField];return this.sortField==="paymentDate"&&(r=e.paymentDate?new Date(e.paymentDate):new Date(0),o=i.paymentDate?new Date(i.paymentDate):new Date(0)),this.sortField==="student.name"&&(r=e.student?.name||"",o=i.student?.name||""),this.sortField==="class.name"&&(r=e.class?.name||"",o=i.class?.name||""),r<o?this.sortDirection==="asc"?-1:1:r>o?this.sortDirection==="asc"?1:-1:0}),this.filteredPayments=t,this.calculatePagination()}calculateStatistics(){this.stats.totalPayments=this.payments.length,this.stats.pendingPayments=this.payments.filter(t=>t.status==="pending").length,this.stats.latePayments=this.payments.filter(t=>t.status==="late").length,this.stats.totalAmount=this.payments.reduce((t,e)=>t+e.amount,0),this.stats.paidAmount=this.payments.filter(t=>t.status==="paid").reduce((t,e)=>t+e.amount,0),this.stats.pendingAmount=this.stats.totalAmount-this.stats.paidAmount}calculatePagination(){this.totalPages=Math.ceil(this.filteredPayments.length/this.itemsPerPage),this.currentPage=Math.max(1,Math.min(this.currentPage,this.totalPages))}get paginatedPayments(){let t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage;return this.filteredPayments.slice(t,e)}getPaginatedInfo(){let t=(this.currentPage-1)*this.itemsPerPage+1,e=Math.min(this.currentPage*this.itemsPerPage,this.filteredPayments.length);return{start:t,end:e}}getPageNumbers(){let t=[];if(this.totalPages<=7)for(let i=1;i<=this.totalPages;i++)t.push(i);else{let i=Math.max(1,this.currentPage-3),r=Math.min(this.totalPages,this.currentPage+3);this.currentPage<=4?r=7:this.currentPage>=this.totalPages-3&&(i=this.totalPages-7+1);for(let o=i;o<=r;o++)t.push(o)}return t}clearFilters(){this.filters={student:"",class:"",month:"",status:"",paymentMethod:"",startDate:"",endDate:""},this.applyFilters()}sort(t){this.sortField===t?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortField=t,this.sortDirection="asc"),this.applyFilters()}openNewPaymentModal(t){t&&(this.selectedStudentForPayment=t,this.newPaymentForm.patchValue({studentId:t._id})),this.newPaymentForm.reset({paymentMethod:"cash",paymentDate:new Date().toISOString().split("T")[0],amount:"",month:"",classId:"",notes:""}),this.isNewPaymentModalOpen=!0}closeNewPaymentModal(){this.isNewPaymentModalOpen=!1,this.selectedStudentForPayment=null}onSubmitNewPayment(){if(this.newPaymentForm.invalid){this.markFormGroupTouched(this.newPaymentForm);return}this.isRecordingPayment=!0;let t=this.newPaymentForm.value;this.paymentsService.createPayment(t).subscribe({next:e=>{this.showSuccess("\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629 \u0628\u0646\u062C\u0627\u062D"),this.loadInitialData(),this.closeNewPaymentModal(),this.isRecordingPayment=!1},error:e=>{console.error("Error recording payment:",e),this.showError("\u0641\u0634\u0644 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629"),this.isRecordingPayment=!1}})}markPaymentAsPaid(t){Vr.default.fire({title:"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062F\u0641\u0639",text:`\u0647\u0644 \u062A\u0631\u064A\u062F \u062A\u0623\u0643\u064A\u062F \u062F\u0641\u0639 \u0645\u0628\u0644\u063A ${t.amount} \u062F.\u062C \u0644\u0644\u0637\u0627\u0644\u0628 ${t.student?.name}\u061F`,icon:"question",showCancelButton:!0,confirmButtonText:"\u0646\u0639\u0645\u060C \u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062F\u0641\u0639",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",reverseButtons:!0}).then(e=>{if(e.isConfirmed){let i={paymentDate:new Date().toISOString(),paymentMethod:"cash"};this.paymentsService.payPayment(t._id,i).subscribe({next:r=>{this.showSuccess("\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u0641\u0639 \u0628\u0646\u062C\u0627\u062D");let o=this.payments.findIndex(l=>l._id===t._id);o!==-1&&(this.payments[o]=r,this.applyFilters(),this.calculateStatistics())},error:r=>{console.error("Error marking payment as paid:",r),this.showError("\u0641\u0634\u0644 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u0641\u0639")}})}})}openEditPaymentModal(t){this.editingPayment=Oe({},t),this.isEditPaymentModalOpen=!0}updatePaymentAmount(){this.editingPayment&&Vr.default.fire({title:"\u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0645\u0628\u0644\u063A",input:"number",inputLabel:"\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u062C\u062F\u064A\u062F",inputValue:this.editingPayment.amount,inputAttributes:{min:"1",step:"100"},showCancelButton:!0,confirmButtonText:"\u062D\u0641\u0638",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",reverseButtons:!0,inputValidator:t=>!t||Number(t)<=0?"\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0645\u0628\u0644\u063A \u0635\u062D\u064A\u062D":null}).then(t=>{if(t.isConfirmed){let e=Number(t.value);this.paymentsService.updatePaymentAmount(this.editingPayment._id,e).subscribe({next:i=>{this.showSuccess("\u062A\u0645 \u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0645\u0628\u0644\u063A \u0628\u0646\u062C\u0627\u062D");let r=this.payments.findIndex(o=>o._id===this.editingPayment._id);r!==-1&&(this.payments[r]=i,this.applyFilters(),this.calculateStatistics()),this.isEditPaymentModalOpen=!1},error:i=>{console.error("Error updating payment amount:",i),this.showError("\u0641\u0634\u0644 \u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0645\u0628\u0644\u063A")}})}})}cancelPayment(t){Vr.default.fire({title:"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u0625\u0644\u063A\u0627\u0621",text:`\u0647\u0644 \u062A\u0631\u064A\u062F \u0625\u0644\u063A\u0627\u0621 \u062F\u0641\u0639\u0629 \u0645\u0628\u0644\u063A ${t.amount} \u062F.\u062C \u0644\u0644\u0637\u0627\u0644\u0628 ${t.student?.name}\u061F`,icon:"warning",showCancelButton:!0,confirmButtonText:"\u0646\u0639\u0645\u060C \u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u062F\u0641\u0639\u0629",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u0623\u0645\u0631",confirmButtonColor:"#d33",reverseButtons:!0}).then(e=>{e.isConfirmed&&this.paymentsService.cancelPayment(t._id).subscribe({next:()=>{this.showSuccess("\u062A\u0645 \u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u062F\u0641\u0639\u0629 \u0628\u0646\u062C\u0627\u062D");let i=this.payments.findIndex(r=>r._id===t._id);i!==-1&&(this.payments[i].status="pending",this.payments[i].paymentDate=null,this.applyFilters(),this.calculateStatistics())},error:i=>{console.error("Error canceling payment:",i),this.showError("\u0641\u0634\u0644 \u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u062F\u0641\u0639\u0629")}})})}deletePayment(t){Vr.default.fire({title:"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062D\u0630\u0641",text:`\u0647\u0644 \u062A\u0631\u064A\u062F \u062D\u0630\u0641 \u062F\u0641\u0639\u0629 \u0645\u0628\u0644\u063A ${t.amount} \u062F.\u062C \u0644\u0644\u0637\u0627\u0644\u0628 ${t.student?.name}\u061F`,icon:"error",showCancelButton:!0,confirmButtonText:"\u0646\u0639\u0645\u060C \u062D\u0630\u0641 \u0627\u0644\u062F\u0641\u0639\u0629",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u0623\u0645\u0631",confirmButtonColor:"#d33",reverseButtons:!0}).then(e=>{e.isConfirmed&&this.paymentsService.deletePayment(t._id).subscribe({next:()=>{this.showSuccess("\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u062F\u0641\u0639\u0629 \u0628\u0646\u062C\u0627\u062D"),this.payments=this.payments.filter(i=>i._id!==t._id),this.applyFilters(),this.calculateStatistics()},error:i=>{console.error("Error deleting payment:",i),this.showError("\u0641\u0634\u0644 \u062D\u0630\u0641 \u0627\u0644\u062F\u0641\u0639\u0629")}})})}togglePaymentSelection(t){this.selectedPayments.has(t)?this.selectedPayments.delete(t):this.selectedPayments.add(t)}selectAllPayments(){this.selectedPayments.size===this.filteredPayments.length?this.selectedPayments.clear():this.filteredPayments.forEach(t=>this.selectedPayments.add(t._id))}markSelectedAsPaid(){if(this.selectedPayments.size===0){this.showWarning("\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u062F\u0641\u0639\u0627\u062A \u0623\u0648\u0644\u0627\u064B");return}Vr.default.fire({title:"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A",text:`\u0647\u0644 \u062A\u0631\u064A\u062F \u062A\u0623\u0643\u064A\u062F \u062F\u0641\u0639 ${this.selectedPayments.size} \u062F\u0641\u0639\u0629\u061F`,icon:"question",showCancelButton:!0,confirmButtonText:"\u0646\u0639\u0645\u060C \u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062F\u0641\u0639",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",reverseButtons:!0}).then(t=>{if(t.isConfirmed){this.isBulkActionLoading=!0;let e=Array.from(this.selectedPayments).map(i=>this.paymentsService.payPayment(i,{paymentDate:new Date().toISOString(),paymentMethod:"cash"}));Promise.all(e.map(i=>i.toPromise())).then(()=>{this.applyFilters(),this.calculateStatistics(),this.selectedPayments.clear(),this.isBulkActionLoading=!1,this.showSuccess(`\u062A\u0645 \u062A\u0633\u062F\u064A\u062F ${e.length} \u062F\u0641\u0639\u0629 \u0628\u0646\u062C\u0627\u062D`)}).catch(i=>{console.error("Error in bulk payment:",i),this.showError("\u062D\u062F\u062B \u062E\u0637\u0623 \u0641\u064A \u062A\u0633\u062F\u064A\u062F \u0628\u0639\u0636 \u0627\u0644\u062F\u0641\u0639\u0627\u062A"),this.isBulkActionLoading=!1})}})}printSelectedReceipts(){return wt(this,null,function*(){if(this.selectedPayments.size===0){this.showWarning("\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u062F\u0641\u0639\u0627\u062A \u0623\u0648\u0644\u0627\u064B");return}let t=Array.from(this.selectedPayments),e=this.payments.filter(r=>t.includes(r._id));if(e.length===0){this.showError("\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u0649 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u062F\u0641\u0639\u0627\u062A \u0627\u0644\u0645\u062D\u062F\u062F\u0629");return}if(!this.isPrinterConnected&&!(yield this.connectToPrinter()))return;let i=0;for(let r of e)(yield this.printSinglePaymentReceipt(r))&&i++,yield new Promise(l=>setTimeout(l,1e3));i>0&&(this.showSuccess(`\u062A\u0645 \u0637\u0628\u0627\u0639\u0629 ${i} \u0645\u0646 ${e.length} \u0625\u064A\u0635\u0627\u0644 \u0628\u0646\u062C\u0627\u062D`),i===e.length&&this.selectedPayments.clear())})}printSinglePaymentReceipt(t){return wt(this,null,function*(){if(!this.isPrinterConnected&&!(yield this.connectToPrinter()))return!1;let e={receiptNumber:t.invoiceNumber||`PAY-${Date.now().toString().slice(-8)}`,date:t.paymentDate?new Date(t.paymentDate).toLocaleDateString("ar-EG"):new Date().toLocaleDateString("ar-EG"),time:t.paymentDate?new Date(t.paymentDate).toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit"}):new Date().toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit"}),studentName:t.student?.name||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641",studentId:t.student?.studentId||"\u0628\u062F\u0648\u0646 \u0631\u0642\u0645",className:t.class?.name||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641",month:t.month,amount:t.amount,paymentMethod:t.paymentMethod,academicYear:t.student?.academicYear||"",parentPhone:t.student?.parentPhone||"",notes:t.notes||`\u062D\u0627\u0644\u0629 \u0627\u0644\u062F\u0641\u0639: ${this.getStatusText(t.status)}`};try{let i=yield this.printerService.printProfessionalReceipt(e);return i&&this.showToast("\u062A\u0645 \u0637\u0628\u0627\u0639\u0629 \u0625\u064A\u0635\u0627\u0644 \u0627\u0644\u062F\u0641\u0639"),i}catch(i){return console.error("Error printing receipt:",i),this.showError("\u0641\u0634\u0644 \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644"),!1}})}connectToPrinter(){return wt(this,null,function*(){try{this.showLoading("\u062C\u0627\u0631\u064A \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0637\u0627\u0628\u0639\u0629...");let t=yield this.printerService.connectToThermalPrinter();return this.isPrinterConnected=t,this.updatePrinterStatus(),t&&this.showSuccess("\u062A\u0645 \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0637\u0627\u0628\u0639\u0629 \u0628\u0646\u062C\u0627\u062D"),t}catch(t){return console.error("Error connecting to printer:",t),this.isPrinterConnected=!1,this.updatePrinterStatus(),!1}})}disconnectPrinter(){return wt(this,null,function*(){try{yield this.printerService.disconnect(),this.isPrinterConnected=!1,this.updatePrinterStatus(),this.showSuccess("\u062A\u0645 \u0642\u0637\u0639 \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0637\u0627\u0628\u0639\u0629")}catch(t){console.error("Error disconnecting printer:",t)}})}checkPrinterConnection(){this.isPrinterConnected=this.printerService.checkConnectionStatus(),this.updatePrinterStatus()}updatePrinterStatus(){if(this.isPrinterConnected){let t=this.printerService.getPrinterStatus();this.printerStatus=`\u0645\u062A\u0635\u0644 - ${t.timestamp}`}else this.printerStatus="\u063A\u064A\u0631 \u0645\u062A\u0635\u0644"}printTestPage(){return wt(this,null,function*(){if(!(!this.isPrinterConnected&&!(yield this.connectToPrinter())))try{this.showLoading("\u062C\u0627\u0631\u064A \u0637\u0628\u0627\u0639\u0629 \u0635\u0641\u062D\u0629 \u0627\u0644\u0627\u062E\u062A\u0628\u0627\u0631..."),(yield this.printerService.printAdvancedTestPage())&&(this.isPrinterConnected=!0,this.updatePrinterStatus(),this.showSuccess("\u062A\u0645 \u0637\u0628\u0627\u0639\u0629 \u0635\u0641\u062D\u0629 \u0627\u0644\u0627\u062E\u062A\u0628\u0627\u0631 \u0628\u0646\u062C\u0627\u062D"))}catch(t){console.error("Error printing test page:",t),this.showError("\u0641\u0634\u0644 \u0637\u0628\u0627\u0639\u0629 \u0635\u0641\u062D\u0629 \u0627\u0644\u0627\u062E\u062A\u0628\u0627\u0631")}})}printWelcomeMessage(){return wt(this,null,function*(){if(!(!this.isPrinterConnected&&!(yield this.connectToPrinter())))try{this.showLoading("\u062C\u0627\u0631\u064A \u0637\u0628\u0627\u0639\u0629 \u0631\u0633\u0627\u0644\u0629 \u0627\u0644\u062A\u0631\u062D\u064A\u0628..."),(yield this.printerService.printWelcomeMessage())&&this.showSuccess("\u062A\u0645 \u0637\u0628\u0627\u0639\u0629 \u0631\u0633\u0627\u0644\u0629 \u0627\u0644\u062A\u0631\u062D\u064A\u0628 \u0628\u0646\u062C\u0627\u062D")}catch(t){console.error("Error printing welcome message:",t),this.showError("\u0641\u0634\u0644 \u0637\u0628\u0627\u0639\u0629 \u0631\u0633\u0627\u0644\u0629 \u0627\u0644\u062A\u0631\u062D\u064A\u0628")}})}printMonthlyReport(){return wt(this,null,function*(){if(!this.isPrinterConnected&&!(yield this.connectToPrinter()))return;let t=this.paginatedPayments[0];if(!t){this.showWarning("\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0644\u0639\u0631\u0636 \u0627\u0644\u062A\u0642\u0631\u064A\u0631");return}let e=t.student;if(!e){this.showError("\u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A \u0643\u0627\u0641\u064A\u0629 \u0644\u0644\u0637\u0627\u0644\u0628");return}let i={attendanceRate:85,present:17,absent:3,late:2},r={totalPaid:this.stats.paidAmount,pending:this.stats.pendingAmount};try{this.showLoading("\u062C\u0627\u0631\u064A \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u0634\u0647\u0631\u064A..."),(yield this.printerService.printStudentMonthlyReport(e,i,r))&&this.showSuccess("\u062A\u0645 \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u0634\u0647\u0631\u064A \u0628\u0646\u062C\u0627\u062D")}catch(o){console.error("Error printing monthly report:",o),this.showError("\u0641\u0634\u0644 \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u0634\u0647\u0631\u064A")}})}exportToExcel(){this.isExporting=!0;let t=["\u0631\u0642\u0645 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629","\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628","\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628","\u0627\u0644\u062D\u0635\u0629","\u0627\u0644\u0645\u0628\u0644\u063A","\u0627\u0644\u0634\u0647\u0631","\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639","\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639","\u0627\u0644\u062D\u0627\u0644\u0629","\u0645\u0644\u0627\u062D\u0638\u0627\u062A"],e=this.filteredPayments.map(c=>[c.invoiceNumber||"N/A",c.student?.name||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641",c.student?.studentId||"N/A",c.class?.name||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641",c.amount,c.month,c.paymentDate?new Date(c.paymentDate).toLocaleDateString("ar-EG"):"\u063A\u064A\u0631 \u0645\u062F\u0641\u0648\u0639",this.getPaymentMethodText(c.paymentMethod),this.getStatusText(c.status),c.notes||""]),i=[t.join(","),...e.map(c=>c.map(f=>`"${f}"`).join(","))].join(`
`),r=new Blob(["\uFEFF"+i],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),l=URL.createObjectURL(r);o.setAttribute("href",l),o.setAttribute("download",`\u0645\u062F\u0641\u0648\u0639\u0627\u062A_${new Date().toISOString().split("T")[0]}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o),this.isExporting=!1,this.showSuccess("\u062A\u0645 \u062A\u0635\u062F\u064A\u0631 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A \u0628\u0646\u062C\u0627\u062D")}getStatusText(t){return{paid:"\u0645\u062F\u0641\u0648\u0639",pending:"\u0645\u0639\u0644\u0642",late:"\u0645\u062A\u0623\u062E\u0631"}[t]||t}getPaymentMethodText(t){return{cash:"\u0646\u0642\u062F\u064A",bank:"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A",online:"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A",mobile:"\u062F\u0641\u0639 \u0645\u062D\u0645\u0648\u0644",check:"\u0634\u064A\u0643"}[t]||t}getStatusClass(t){switch(t){case"paid":return"status-paid";case"pending":return"status-pending";case"late":return"status-late";default:return""}}getStudentClasses(t){return this.classes.filter(e=>e.students?.some(i=>i._id===t))}markFormGroupTouched(t){Object.values(t.controls).forEach(e=>{e.markAsTouched(),e instanceof ka&&this.markFormGroupTouched(e)})}showSuccess(t){Vr.default.fire({icon:"success",title:"\u0646\u062C\u0627\u062D",text:t,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B",timer:3e3})}showError(t){Vr.default.fire({icon:"error",title:"\u062E\u0637\u0623",text:t,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"})}showWarning(t){Vr.default.fire({icon:"warning",title:"\u062A\u062D\u0630\u064A\u0631",text:t,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"})}showToast(t){Vr.default.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:i=>{i.onmouseenter=Vr.default.stopTimer,i.onmouseleave=Vr.default.resumeTimer}}).fire({icon:"success",title:t})}showLoading(t){Vr.default.fire({title:t,allowOutsideClick:!1,didOpen:()=>{Vr.default.showLoading()}})}get printerStatusText(){return this.isPrinterConnected?"\u0645\u062A\u0635\u0644":"\u063A\u064A\u0631 \u0645\u062A\u0635\u0644"}static \u0275fac=function(e){return new(e||n)(Ne(B1),Ne(Vc),Ne(il),Ne(rl),Ne(qn),Ne(xd),Ne(Lc))};static \u0275cmp=nn({type:n,selectors:[["app-payments-management"]],decls:208,vars:61,consts:[[1,"payments-management"],["class","loading-overlay",4,"ngIf"],[1,"header-section"],[1,"header-content"],[1,"fas","fa-money-bill-wave"],[1,"header-actions"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus-circle"],[1,"btn","btn-success",3,"click","disabled"],["class","fas fa-file-excel",4,"ngIf"],["class","fas fa-spinner fa-spin",4,"ngIf"],[1,"printer-status"],[1,"status-indicator"],[1,"status-dot"],[1,"printer-actions"],["class","btn btn-sm btn-outline",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-outline",3,"click","disabled"],[1,"fas","fa-print"],[1,"statistics-section"],[1,"stat-card","total-payments"],[1,"stat-icon"],[1,"fas","fa-receipt"],[1,"stat-content"],[1,"stat-number"],[1,"stat-card","total-amount"],[1,"fas","fa-money-bill"],[1,"stat-card","paid-amount"],[1,"fas","fa-check-circle"],[1,"stat-card","pending-payments"],[1,"fas","fa-clock"],[1,"stat-subtext"],[1,"stat-card","late-payments"],[1,"fas","fa-exclamation-circle"],[1,"filters-section","card"],[1,"filters-header"],[1,"fas","fa-filter"],[1,"btn","btn-outline","btn-sm",3,"click"],[1,"fas","fa-times"],[1,"filters-grid"],[1,"filter-group"],["for","filterStudent"],[1,"fas","fa-user-graduate"],["id","filterStudent",1,"form-control",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["for","filterClass"],[1,"fas","fa-chalkboard-teacher"],["id","filterClass",1,"form-control",3,"ngModelChange","change","ngModel"],["for","filterMonth"],[1,"fas","fa-calendar-alt"],["id","filterMonth",1,"form-control",3,"ngModelChange","change","ngModel"],["for","filterStatus"],[1,"fas","fa-info-circle"],["id","filterStatus",1,"form-control",3,"ngModelChange","change","ngModel"],["value","paid"],["value","pending"],["value","late"],["for","filterPaymentMethod"],[1,"fas","fa-credit-card"],["id","filterPaymentMethod",1,"form-control",3,"ngModelChange","change","ngModel"],["value","cash"],["value","bank"],["value","online"],["value","mobile"],["value","check"],["for","filterStartDate"],[1,"fas","fa-calendar"],["type","date","id","filterStartDate",1,"form-control",3,"ngModelChange","change","ngModel"],["for","filterEndDate"],["type","date","id","filterEndDate",1,"form-control",3,"ngModelChange","change","ngModel"],["class","bulk-actions",4,"ngIf"],[1,"view-options","card"],[1,"view-mode"],[1,"btn","btn-sm",3,"click"],[1,"fas","fa-table"],[1,"fas","fa-th-large"],[1,"sort-options"],[1,"form-control-sm",3,"ngModelChange","change","ngModel"],["value","paymentDate"],["value","student.name"],["value","class.name"],["value","amount"],["value","month"],[1,"btn","btn-sm","btn-outline",3,"click"],[1,"fas"],[1,"pagination-controls"],["value","10"],["value","20"],["value","50"],["value","100"],["class","table-responsive card",4,"ngIf"],["class","cards-grid",4,"ngIf"],["class","no-results card",4,"ngIf"],[1,"pagination-section"],[1,"pagination-info"],[1,"fas","fa-angle-double-right"],[1,"fas","fa-angle-right"],[1,"page-numbers"],[4,"ngFor","ngForOf"],[1,"fas","fa-angle-left"],[1,"fas","fa-angle-double-left"],["class","modal-overlay",4,"ngIf"],[1,"loading-overlay"],[1,"loading-content"],[1,"spinner"],[1,"fas","fa-file-excel"],[1,"fas","fa-spinner","fa-spin"],[1,"fas","fa-plug"],[3,"value"],[1,"bulk-actions"],[1,"bulk-info"],[1,"bulk-buttons"],[1,"btn","btn-success","btn-sm",3,"click","disabled"],["class","fas fa-check",4,"ngIf"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"fas","fa-check"],[1,"table-responsive","card"],[1,"payments-table"],[1,"select-column"],["type","checkbox",3,"change","checked"],[1,"sortable",3,"click"],[3,"selected",4,"ngFor","ngForOf"],[1,"student-info"],[1,"student-name"],[1,"student-id"],[1,"class-teacher"],[1,"amount-cell"],[1,"amount"],[1,"payment-method"],[1,"status-badge"],[1,"invoice-cell"],[1,"invoice-number"],["title","\u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644",1,"btn-icon","btn-sm",3,"click","disabled"],[1,"notes-cell"],[1,"actions-cell"],[1,"action-buttons"],["class","btn-icon btn-success","title","\u062A\u0633\u062F\u064A\u062F \u0627\u0644\u062F\u0641\u0639\u0629",3,"click",4,"ngIf"],["title","\u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0645\u0628\u0644\u063A",1,"btn-icon","btn-info",3,"click"],[1,"fas","fa-edit"],["class","btn-icon btn-warning","title","\u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u062F\u0641\u0639",3,"click",4,"ngIf"],["title","\u062D\u0630\u0641 \u0627\u0644\u062F\u0641\u0639\u0629",1,"btn-icon","btn-danger",3,"click"],[1,"fas","fa-trash"],["title","\u062A\u0633\u062F\u064A\u062F \u0627\u0644\u062F\u0641\u0639\u0629",1,"btn-icon","btn-success",3,"click"],["title","\u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u062F\u0641\u0639",1,"btn-icon","btn-warning",3,"click"],[1,"fas","fa-undo"],[1,"cards-grid"],["class","payment-card",3,"selected",4,"ngFor","ngForOf"],[1,"payment-card"],[1,"card-header"],[1,"card-checkbox"],[1,"card-title"],[1,"card-body"],[1,"card-row"],[1,"label"],[1,"value"],[1,"amount-value"],["class","card-row",4,"ngIf"],[1,"card-footer"],[1,"card-actions"],["class","btn btn-sm btn-success",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-info",3,"click"],["class","btn btn-sm btn-warning",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-danger",3,"click"],[1,"btn","btn-sm","btn-primary",3,"click","disabled"],[1,"value","notes"],[1,"btn","btn-sm","btn-success",3,"click"],[1,"btn","btn-sm","btn-warning",3,"click"],[1,"no-results","card"],[1,"no-results-content"],[1,"fas","fa-search"],["class","page-number",3,"active","click",4,"ngIf"],["class","page-ellipsis",4,"ngIf"],[1,"page-number",3,"click"],[1,"page-ellipsis"],[1,"modal-overlay"],[1,"modal-container"],[1,"modal-header"],[1,"btn-icon",3,"click"],[3,"ngSubmit","formGroup"],[1,"modal-body"],[1,"form-group"],["for","studentId"],["id","studentId","formControlName","studentId",1,"form-control"],["class","error-message",4,"ngIf"],["for","classId"],["id","classId","formControlName","classId",1,"form-control"],[1,"form-row"],["for","amount"],["type","number","id","amount","formControlName","amount","min","1","step","100",1,"form-control"],["for","month"],["id","month","formControlName","month",1,"form-control"],["for","paymentMethod"],["id","paymentMethod","formControlName","paymentMethod",1,"form-control"],["for","paymentDate"],["type","date","id","paymentDate","formControlName","paymentDate",1,"form-control"],["for","notes"],[1,"fas","fa-sticky-note"],["id","notes","formControlName","notes","rows","3","placeholder","\u0623\u064A \u0645\u0644\u0627\u062D\u0638\u0627\u062A \u0625\u0636\u0627\u0641\u064A\u0629 \u062D\u0648\u0644 \u0627\u0644\u062F\u0641\u0639\u0629...",1,"form-control"],[1,"modal-footer"],["type","button",1,"btn","btn-outline",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","fas fa-save",4,"ngIf"],[1,"error-message"],[1,"fas","fa-save"],[1,"payment-info"],[1,"info-row"],[1,"edit-actions"]],template:function(e,i){e&1&&(s(0,"div",0),j(1,Rj,5,0,"div",1),s(2,"div",2)(3,"div",3)(4,"h1"),b(5,"i",4),u(6," \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A "),a(),s(7,"div",5)(8,"button",6),I("click",function(){return i.openNewPaymentModal()}),b(9,"i",7),u(10," \u062A\u0633\u062C\u064A\u0644 \u062F\u0641\u0639\u0629 \u062C\u062F\u064A\u062F\u0629 "),a(),s(11,"button",8),I("click",function(){return i.exportToExcel()}),j(12,kj,1,0,"i",9)(13,Nj,1,0,"i",10),u(14),a()()(),s(15,"div",11)(16,"div",12),b(17,"div",13),s(18,"span"),u(19),a()(),s(20,"div",14),j(21,Uj,3,0,"button",15)(22,Lj,3,0,"button",15),s(23,"button",16),I("click",function(){return i.printTestPage()}),b(24,"i",17),u(25," \u0627\u062E\u062A\u0628\u0627\u0631 \u0627\u0644\u0637\u0628\u0627\u0639\u0629 "),a()()()(),s(26,"div",18)(27,"div",19)(28,"div",20),b(29,"i",21),a(),s(30,"div",22)(31,"h3"),u(32,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A"),a(),s(33,"p",23),u(34),a()()(),s(35,"div",24)(36,"div",20),b(37,"i",25),a(),s(38,"div",22)(39,"h3"),u(40,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u0628\u0627\u0644\u063A"),a(),s(41,"p",23),u(42),ut(43,"number"),a()()(),s(44,"div",26)(45,"div",20),b(46,"i",27),a(),s(47,"div",22)(48,"h3"),u(49,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0645\u0624\u0643\u062F\u0629"),a(),s(50,"p",23),u(51),ut(52,"number"),a()()(),s(53,"div",28)(54,"div",20),b(55,"i",29),a(),s(56,"div",22)(57,"h3"),u(58,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0645\u0639\u0644\u0642\u0629"),a(),s(59,"p",23),u(60),a(),s(61,"p",30),u(62),ut(63,"number"),a()()(),s(64,"div",31)(65,"div",20),b(66,"i",32),a(),s(67,"div",22)(68,"h3"),u(69,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0645\u062A\u0623\u062E\u0631\u0629"),a(),s(70,"p",23),u(71),a()()()(),s(72,"div",33)(73,"div",34)(74,"h3"),b(75,"i",35),u(76," \u0641\u0644\u062A\u0631\u0629 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A"),a(),s(77,"button",36),I("click",function(){return i.clearFilters()}),b(78,"i",37),u(79," \u0645\u0633\u062D \u0627\u0644\u0641\u0644\u0627\u062A\u0631 "),a()(),s(80,"div",38)(81,"div",39)(82,"label",40),b(83,"i",41),u(84," \u0627\u0644\u0637\u0627\u0644\u0628 "),a(),s(85,"select",42),ye("ngModelChange",function(o){return Ce(i.filters.student,o)||(i.filters.student=o),o}),I("change",function(){return i.applyFilters()}),s(86,"option",43),u(87,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0637\u0644\u0627\u0628"),a(),j(88,Bj,2,3,"option",44),a()(),s(89,"div",39)(90,"label",45),b(91,"i",46),u(92," \u0627\u0644\u062D\u0635\u0629 "),a(),s(93,"select",47),ye("ngModelChange",function(o){return Ce(i.filters.class,o)||(i.filters.class=o),o}),I("change",function(){return i.applyFilters()}),s(94,"option",43),u(95,"\u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0635\u0635"),a(),j(96,Vj,2,2,"option",44),a()(),s(97,"div",39)(98,"label",48),b(99,"i",49),u(100," \u0627\u0644\u0634\u0647\u0631 "),a(),s(101,"select",50),ye("ngModelChange",function(o){return Ce(i.filters.month,o)||(i.filters.month=o),o}),I("change",function(){return i.applyFilters()}),s(102,"option",43),u(103,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0623\u0634\u0647\u0631"),a(),j(104,Hj,2,2,"option",44),a()(),s(105,"div",39)(106,"label",51),b(107,"i",52),u(108," \u0627\u0644\u062D\u0627\u0644\u0629 "),a(),s(109,"select",53),ye("ngModelChange",function(o){return Ce(i.filters.status,o)||(i.filters.status=o),o}),I("change",function(){return i.applyFilters()}),s(110,"option",43),u(111,"\u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0627\u0644\u0627\u062A"),a(),s(112,"option",54),u(113,"\u0645\u062F\u0641\u0648\u0639"),a(),s(114,"option",55),u(115,"\u0645\u0639\u0644\u0642"),a(),s(116,"option",56),u(117,"\u0645\u062A\u0623\u062E\u0631"),a()()(),s(118,"div",39)(119,"label",57),b(120,"i",58),u(121," \u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639 "),a(),s(122,"select",59),ye("ngModelChange",function(o){return Ce(i.filters.paymentMethod,o)||(i.filters.paymentMethod=o),o}),I("change",function(){return i.applyFilters()}),s(123,"option",43),u(124,"\u062C\u0645\u064A\u0639 \u0637\u0631\u0642 \u0627\u0644\u062F\u0641\u0639"),a(),s(125,"option",60),u(126,"\u0646\u0642\u062F\u064A"),a(),s(127,"option",61),u(128,"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A"),a(),s(129,"option",62),u(130,"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"),a(),s(131,"option",63),u(132,"\u062F\u0641\u0639 \u0645\u062D\u0645\u0648\u0644"),a(),s(133,"option",64),u(134,"\u0634\u064A\u0643"),a()()(),s(135,"div",39)(136,"label",65),b(137,"i",66),u(138," \u0645\u0646 \u062A\u0627\u0631\u064A\u062E "),a(),s(139,"input",67),ye("ngModelChange",function(o){return Ce(i.filters.startDate,o)||(i.filters.startDate=o),o}),I("change",function(){return i.applyFilters()}),a()(),s(140,"div",39)(141,"label",68),b(142,"i",66),u(143," \u0625\u0644\u0649 \u062A\u0627\u0631\u064A\u062E "),a(),s(144,"input",69),ye("ngModelChange",function(o){return Ce(i.filters.endDate,o)||(i.filters.endDate=o),o}),I("change",function(){return i.applyFilters()}),a()()(),j(145,Wj,15,5,"div",70),a(),s(146,"div",71)(147,"div",72)(148,"button",73),I("click",function(){return i.viewMode="table"}),b(149,"i",74),u(150," \u062C\u062F\u0648\u0644 "),a(),s(151,"button",73),I("click",function(){return i.viewMode="cards"}),b(152,"i",75),u(153," \u0628\u0637\u0627\u0642\u0627\u062A "),a()(),s(154,"div",76)(155,"span"),u(156,"\u062A\u0631\u062A\u064A\u0628 \u062D\u0633\u0628:"),a(),s(157,"select",77),ye("ngModelChange",function(o){return Ce(i.sortField,o)||(i.sortField=o),o}),I("change",function(){return i.applyFilters()}),s(158,"option",78),u(159,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639"),a(),s(160,"option",79),u(161,"\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(162,"option",80),u(163,"\u0627\u0633\u0645 \u0627\u0644\u062D\u0635\u0629"),a(),s(164,"option",81),u(165,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(166,"option",82),u(167,"\u0627\u0644\u0634\u0647\u0631"),a()(),s(168,"button",83),I("click",function(){return i.sortDirection=i.sortDirection==="asc"?"desc":"asc",i.applyFilters()}),b(169,"i",84),u(170),a()(),s(171,"div",85)(172,"span"),u(173,"\u0639\u0631\u0636"),a(),s(174,"select",77),ye("ngModelChange",function(o){return Ce(i.itemsPerPage,o)||(i.itemsPerPage=o),o}),I("change",function(){return i.applyFilters()}),s(175,"option",86),u(176,"10"),a(),s(177,"option",87),u(178,"20"),a(),s(179,"option",88),u(180,"50"),a(),s(181,"option",89),u(182,"100"),a()(),s(183,"span"),u(184),a()()(),j(185,qj,32,18,"div",90)(186,eW,2,1,"div",91)(187,tW,10,0,"div",92),s(188,"div",93)(189,"div",94),u(190),a(),s(191,"div",85)(192,"button",16),I("click",function(){return i.currentPage=1}),b(193,"i",95),u(194," \u0627\u0644\u0623\u0648\u0644 "),a(),s(195,"button",16),I("click",function(){return i.currentPage=i.currentPage-1}),b(196,"i",96),u(197," \u0627\u0644\u0633\u0627\u0628\u0642 "),a(),s(198,"div",97),j(199,rW,3,2,"ng-container",98),a(),s(200,"button",16),I("click",function(){return i.currentPage=i.currentPage+1}),u(201," \u0627\u0644\u062A\u0627\u0644\u064A "),b(202,"i",99),a(),s(203,"button",16),I("click",function(){return i.currentPage=i.totalPages}),u(204," \u0627\u0644\u0623\u062E\u064A\u0631 "),b(205,"i",100),a()()(),j(206,pW,77,22,"div",101)(207,mW,37,6,"div",101),a()),e&2&&(d(),w("ngIf",i.isLoading),d(10),w("disabled",i.isExporting||i.filteredPayments.length===0),d(),w("ngIf",!i.isExporting),d(),w("ngIf",i.isExporting),d(),H(" ",i.isExporting?"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u0635\u062F\u064A\u0631...":"\u062A\u0635\u062F\u064A\u0631 Excel"," "),d(),Ie("connected",i.isPrinterConnected)("disconnected",!i.isPrinterConnected),d(4),B(i.printerStatusText),d(2),w("ngIf",!i.isPrinterConnected),d(),w("ngIf",i.isPrinterConnected),d(),w("disabled",!i.isPrinterConnected),d(11),B(i.stats.totalPayments),d(8),H("",_c(43,55,i.stats.totalAmount)," \u062F.\u062C"),d(9),H("",_c(52,57,i.stats.paidAmount)," \u062F.\u062C"),d(9),B(i.stats.pendingPayments),d(2),H("",_c(63,59,i.stats.pendingAmount)," \u062F.\u062C"),d(9),B(i.stats.latePayments),d(14),ve("ngModel",i.filters.student),d(3),w("ngForOf",i.students),d(5),ve("ngModel",i.filters.class),d(3),w("ngForOf",i.classes),d(5),ve("ngModel",i.filters.month),d(3),w("ngForOf",i.availableMonths),d(5),ve("ngModel",i.filters.status),d(13),ve("ngModel",i.filters.paymentMethod),d(17),ve("ngModel",i.filters.startDate),d(5),ve("ngModel",i.filters.endDate),d(),w("ngIf",i.selectedPayments.size>0),d(3),Ie("active",i.viewMode==="table"),d(3),Ie("active",i.viewMode==="cards"),d(6),ve("ngModel",i.sortField),d(12),Ie("fa-sort-up",i.sortDirection==="asc")("fa-sort-down",i.sortDirection==="desc"),d(),H(" ",i.sortDirection==="asc"?"\u062A\u0635\u0627\u0639\u062F\u064A":"\u062A\u0646\u0627\u0632\u0644\u064A"," "),d(4),ve("ngModel",i.itemsPerPage),d(10),H("\u0645\u0646 ",i.filteredPayments.length," \u062F\u0641\u0639\u0629"),d(),w("ngIf",i.viewMode==="table"&&i.filteredPayments.length>0),d(),w("ngIf",i.viewMode==="cards"&&i.filteredPayments.length>0),d(),w("ngIf",i.filteredPayments.length===0&&!i.isLoading),d(3),Qi(" \u0639\u0631\u0636 ",i.getPaginatedInfo().start," \u0625\u0644\u0649 ",i.getPaginatedInfo().end," \u0645\u0646 ",i.filteredPayments.length," "),d(2),w("disabled",i.currentPage===1),d(3),w("disabled",i.currentPage===1),d(4),w("ngForOf",i.getPageNumbers()),d(),w("disabled",i.currentPage===i.totalPages),d(3),w("disabled",i.currentPage===i.totalPages),d(3),w("ngIf",i.isNewPaymentModalOpen),d(),w("ngIf",i.isEditPaymentModalOpen))},dependencies:[hn,Nn,An,T0,qr,Un,Ti,Di,Pi,Yn,gr,di,ii,Ai,_r,ti,Bc,Ql,eu],encapsulation:2})};$();var gW=(n,t)=>({"bg-success":n,"bg-warning":t}),_W=n=>({"text-danger":n});function vW(n,t){if(n&1&&(s(0,"div",38),b(1,"i",39),s(2,"strong"),u(3,"\u062A\u0645 \u0627\u0643\u062A\u0634\u0627\u0641 \u0628\u0637\u0627\u0642\u0629:"),a(),u(4),a()),n&2){let e=E();d(4),H(" ",e.detectedCardUid," ")}}function yW(n,t){if(n&1&&(s(0,"option",40),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Gn(" ",e.name," - ",e.studentId," ")}}function xW(n,t){n&1&&(s(0,"div",41)(1,"div",42)(2,"span",43),u(3,"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644..."),a()(),s(4,"p",44),u(5,"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0628\u0637\u0627\u0642\u0627\u062A..."),a()())}function bW(n,t){n&1&&(s(0,"div",41),b(1,"i",45),s(2,"p",44),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u0637\u0627\u0642\u0627\u062A \u0645\u0633\u062C\u0644\u0629"),a()())}function CW(n,t){n&1&&(s(0,"span",62),b(1,"i",63),u(2," \u0645\u0643\u062A\u0634\u0641\u0629 "),a())}function EW(n,t){if(n&1&&(s(0,"div"),u(1),s(2,"small",64),u(3),a()()),n&2){let e=E().$implicit,i=E(2);d(),H(" ",i.getStudentName(e)," "),d(2),B(e.student&&typeof e.student=="object"?e.student.studentId:"")}}function wW(n,t){n&1&&(s(0,"span",65),u(1," \u063A\u064A\u0631 \u0645\u0639\u064A\u0646 "),a())}function SW(n,t){if(n&1){let e=he();s(0,"tr")(1,"td")(2,"strong"),u(3),a(),j(4,CW,3,0,"span",49),a(),s(5,"td"),j(6,EW,4,2,"div",50)(7,wW,2,0,"span",51),a(),s(8,"td"),u(9),a(),s(10,"td")(11,"span",52),u(12),a()(),s(13,"td")(14,"div",53)(15,"button",54),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.viewCardDetails(r))}),b(16,"i",55),a(),s(17,"button",56),I("click",function(){let r=F(e).$implicit,o=E(2);return o.selectedCard=r,o.selectedStudentId="",R(o.showAssignCardModal=!0)}),b(18,"i",57),a(),s(19,"button",58),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.unassignCard(r._id))}),b(20,"i",59),a(),s(21,"button",60),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.deleteCard(r._id))}),b(22,"i",61),a()()()()}if(n&2){let e=t.$implicit,i=E(2);Ie("table-success",e.isDetected),d(3),B(e.uid),d(),w("ngIf",e.isDetected),d(2),w("ngIf",i.getStudentName(e)!=="\u063A\u064A\u0631 \u0645\u0639\u064A\u0646"),d(),w("ngIf",i.getStudentName(e)==="\u063A\u064A\u0631 \u0645\u0639\u064A\u0646"),d(2),B(i.formatDate(e.issueDate)),d(2),w("ngClass",Aa(11,gW,i.getStudentName(e)!=="\u063A\u064A\u0631 \u0645\u0639\u064A\u0646",i.getStudentName(e)==="\u063A\u064A\u0631 \u0645\u0639\u064A\u0646")),d(),H(" ",i.getStudentName(e)!=="\u063A\u064A\u0631 \u0645\u0639\u064A\u0646"?"\u0645\u0639\u064A\u0646\u0629":"\u063A\u064A\u0631 \u0645\u0639\u064A\u0646\u0629"," "),d(5),w("disabled",i.getStudentName(e)!=="\u063A\u064A\u0631 \u0645\u0639\u064A\u0646"),d(2),w("disabled",i.getStudentName(e)==="\u063A\u064A\u0631 \u0645\u0639\u064A\u0646")}}function MW(n,t){if(n&1&&(s(0,"div",46)(1,"table",47)(2,"thead")(3,"tr")(4,"th"),u(5,"\u0631\u0642\u0645 \u0627\u0644\u0628\u0637\u0627\u0642\u0629"),a(),s(6,"th"),u(7,"\u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(8,"th"),u(9,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0625\u0635\u062F\u0627\u0631"),a(),s(10,"th"),u(11,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(12,"th"),u(13,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(14,"tbody"),j(15,SW,23,14,"tr",48),a()()()),n&2){let e=E();d(15),w("ngForOf",e.cards)}}function AW(n,t){if(n&1&&(s(0,"div",80)(1,"div",81),b(2,"i",2),s(3,"strong"),u(4,"\u0631\u0642\u0645 \u0627\u0644\u0628\u0637\u0627\u0642\u0629:"),a(),u(5),a()()),n&2){let e=E(2);d(5),H(" ",e.selectedCard.uid," ")}}function TW(n,t){if(n&1&&(s(0,"option",40),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Qi(" ",e.name," - ",e.studentId," (",e.parentPhone||"\u0644\u0627 \u064A\u0648\u062C\u062F \u0647\u0627\u062A\u0641",") ")}}function DW(n,t){n&1&&(s(0,"div",82),b(1,"i",83),u(2," \u0644\u0627 \u062A\u0648\u062C\u062F \u0646\u062A\u0627\u0626\u062C \u0628\u062D\u062B "),a())}function PW(n,t){if(n&1){let e=he();s(0,"div",66),I("click",function(){F(e);let r=E();return R(r.showAssignCardModal=!1)}),s(1,"div",67),I("click",function(r){return F(e),R(r.stopPropagation())}),s(2,"div",68)(3,"h5",69),b(4,"i",57),u(5," \u062A\u0639\u064A\u064A\u0646 \u0628\u0637\u0627\u0642\u0629 \u0644\u0637\u0627\u0644\u0628 "),a(),s(6,"button",70),I("click",function(){F(e);let r=E();return R(r.showAssignCardModal=!1)}),a()(),s(7,"div",71),j(8,AW,6,1,"div",72),s(9,"div",73)(10,"label",74),u(11,"\u0628\u062D\u062B \u0639\u0646 \u0637\u0627\u0644\u0628:"),a(),s(12,"input",75),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.searchStudentTerm,r)||(o.searchStudentTerm=r),R(r)}),I("input",function(){F(e);let r=E();return R(r.filterStudents())}),a()(),s(13,"div",73)(14,"label",74),u(15,"\u0627\u062E\u062A\u0631 \u0637\u0627\u0644\u0628\u0627\u064B:"),a(),s(16,"select",26),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.selectedStudentId,r)||(o.selectedStudentId=r),R(r)}),s(17,"option",27),u(18,"\u0627\u062E\u062A\u0631 \u0637\u0627\u0644\u0628\u0627\u064B"),a(),j(19,TW,2,4,"option",28),a()(),j(20,DW,3,0,"div",76),a(),s(21,"div",77)(22,"button",78),I("click",function(){F(e);let r=E();return R(r.showAssignCardModal=!1)}),u(23," \u0625\u0644\u063A\u0627\u0621 "),a(),s(24,"button",79),I("click",function(){F(e);let r=E();return R(r.assignCardToStudent())}),u(25," \u062A\u0639\u064A\u064A\u0646 "),a()()()()}if(n&2){let e=E();d(8),w("ngIf",e.selectedCard),d(4),ve("ngModel",e.searchStudentTerm),d(4),ve("ngModel",e.selectedStudentId),d(3),w("ngForOf",e.filteredStudents),d(),w("ngIf",e.filteredStudents.length===0),d(4),w("disabled",!e.selectedStudentId)}}function IW(n,t){if(n&1&&(s(0,"div",95)(1,"h6"),b(2,"i",96),u(3," \u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u0637\u0627\u0644\u0628:"),a(),s(4,"div",97)(5,"div",98)(6,"div",90)(7,"span",91),u(8,"\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628:"),a(),s(9,"span",92),u(10),a()()(),s(11,"div",98)(12,"div",90)(13,"span",91),u(14,"\u0647\u0627\u062A\u0641 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631:"),a(),s(15,"span",92),u(16),a()()()()()),n&2){let e=E(3);d(10),B(e.selectedCard.student.studentId),d(6),B(e.selectedCard.student.parentPhone||"\u063A\u064A\u0631 \u0645\u062A\u0648\u0641\u0631")}}function OW(n,t){if(n&1&&(s(0,"div",71)(1,"div",89)(2,"div",90)(3,"span",91),u(4,"\u0631\u0642\u0645 \u0627\u0644\u0628\u0637\u0627\u0642\u0629:"),a(),s(5,"span",92),u(6),a()(),s(7,"div",90)(8,"span",91),u(9,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0625\u0635\u062F\u0627\u0631:"),a(),s(10,"span",92),u(11),a()(),s(12,"div",90)(13,"span",91),u(14,"\u0627\u0644\u0637\u0627\u0644\u0628:"),a(),s(15,"span",93),u(16),a()(),j(17,IW,17,2,"div",94),a()()),n&2){let e=E(2);d(6),B(e.selectedCard.uid),d(5),B(e.formatDate(e.selectedCard.issueDate)),d(4),w("ngClass",Rr(5,_W,e.getStudentName(e.selectedCard)==="\u063A\u064A\u0631 \u0645\u0639\u064A\u0646")),d(),H(" ",e.getStudentName(e.selectedCard)," "),d(),w("ngIf",e.selectedCard.student&&typeof e.selectedCard.student=="object")}}function FW(n,t){if(n&1){let e=he();s(0,"button",99),I("click",function(){F(e);let r=E(2);return r.unassignCard(r.selectedCard._id),R(r.showCardDetailsModal=!1)}),b(1,"i",59),u(2," \u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u062A\u0639\u064A\u064A\u0646 "),a()}}function RW(n,t){if(n&1){let e=he();s(0,"button",100),I("click",function(){F(e);let r=E(2);return r.selectedCard=null,r.selectedStudentId="",r.showAssignCardModal=!0,R(r.showCardDetailsModal=!1)}),b(1,"i",57),u(2," \u062A\u0639\u064A\u064A\u0646 \u0644\u0637\u0627\u0644\u0628 "),a()}}function kW(n,t){if(n&1){let e=he();s(0,"div",66),I("click",function(){F(e);let r=E();return R(r.showCardDetailsModal=!1)}),s(1,"div",67),I("click",function(r){return F(e),R(r.stopPropagation())}),s(2,"div",68)(3,"h5",69),b(4,"i",84),u(5," \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0628\u0637\u0627\u0642\u0629 "),a(),s(6,"button",70),I("click",function(){F(e);let r=E();return R(r.showCardDetailsModal=!1)}),a()(),j(7,OW,18,7,"div",85),s(8,"div",77),j(9,FW,3,0,"button",86)(10,RW,3,0,"button",87),s(11,"button",88),I("click",function(){F(e);let r=E();return r.deleteCard(r.selectedCard._id),R(r.showCardDetailsModal=!1)}),b(12,"i",61),u(13," \u062D\u0630\u0641 \u0627\u0644\u0628\u0637\u0627\u0642\u0629 "),a()()()()}if(n&2){let e=E();d(7),w("ngIf",e.selectedCard),d(2),w("ngIf",e.getStudentName(e.selectedCard)!=="\u063A\u064A\u0631 \u0645\u0639\u064A\u0646"),d(),w("ngIf",e.getStudentName(e.selectedCard)==="\u063A\u064A\u0631 \u0645\u0639\u064A\u0646")}}var H1=class n{constructor(t){this.http=t}cards=[];loading=!1;detectionActive=!1;detectionInterval;showAssignCardModal=!1;showCardDetailsModal=!1;selectedCard=null;selectedStudentId="";newCardUid="";searchUid="";students=[];filteredStudents=[];searchStudentTerm="";detectedCardUid="";isCardDetected=!1;detectionStatus="";ngOnInit(){console.log("Component initialized"),this.loadCards(),this.loadStudents()}ngOnDestroy(){this.stopCardDetection()}handleError(t){return console.error("HTTP Error:",t),t.error instanceof ErrorEvent?console.error("Client-side error:",t.error.message):console.error(`Server returned code ${t.status}, body was:`,t.error),wr(()=>new Error("\u062D\u062F\u062B \u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u062E\u0627\u062F\u0645"))}loadCards(){this.loading=!0,console.log("Loading cards..."),this.http.get(`${Bt.apiUrl}/cards`).pipe(gi(t=>(console.error("Error in loadCards:",t),alert("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0628\u0637\u0627\u0642\u0627\u062A. \u062A\u0623\u0643\u062F \u0645\u0646 \u062A\u0634\u063A\u064A\u0644 \u0627\u0644\u062E\u0627\u062F\u0645."),bt([])))).subscribe({next:t=>{console.log("Cards loaded:",t),this.cards=t||[],this.loading=!1,this.cards.length===0&&console.log("No cards found")},error:t=>{console.error("Subscription error in loadCards:",t),this.cards=[],this.loading=!1,alert("\u062A\u0639\u0630\u0631 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0628\u0637\u0627\u0642\u0627\u062A. \u064A\u0631\u062C\u0649 \u0627\u0644\u0645\u062D\u0627\u0648\u0644\u0629 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649.")},complete:()=>{console.log("loadCards request completed"),this.loading=!1}})}loadStudents(){console.log("Loading students..."),this.http.get(`${Bt.apiUrl}/students`).pipe(gi(t=>(console.error("Error in loadStudents:",t),alert("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0637\u0644\u0627\u0628. \u062A\u0623\u0643\u062F \u0645\u0646 \u062A\u0634\u063A\u064A\u0644 \u0627\u0644\u062E\u0627\u062F\u0645."),bt([])))).subscribe({next:t=>{console.log("Students loaded:",t),this.students=t||[],this.filteredStudents=this.students,this.students.length===0&&console.log("No students found")},error:t=>{console.error("Subscription error in loadStudents:",t),this.students=[],this.filteredStudents=[],alert("\u062A\u0639\u0630\u0631 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0637\u0644\u0627\u0628. \u064A\u0631\u062C\u0649 \u0627\u0644\u0645\u062D\u0627\u0648\u0644\u0629 \u0645\u0631\u0629 \u0623\u062E\u0631\u0649.")}})}filterStudents(){if(!this.searchStudentTerm.trim()){this.filteredStudents=this.students;return}let t=this.searchStudentTerm.toLowerCase();this.filteredStudents=this.students.filter(e=>e.name.toLowerCase().includes(t)||e.studentId.toLowerCase().includes(t)||e.parentPhone&&e.parentPhone.toLowerCase().includes(t))}startCardDetection(){this.detectionActive=!0,this.detectionStatus="\u062C\u0627\u0631\u064A \u0627\u0644\u0628\u062D\u062B \u0639\u0646 \u0628\u0637\u0627\u0642\u0629...",this.detectionInterval=setInterval(()=>{if(this.detectionActive&&!this.isCardDetected){this.detectedCardUid="CARD-"+Math.random().toString(36).substr(2,8).toUpperCase(),this.isCardDetected=!0,this.detectionStatus=`\u062A\u0645 \u0627\u0643\u062A\u0634\u0627\u0641 \u0627\u0644\u0628\u0637\u0627\u0642\u0629: ${this.detectedCardUid}`,this.newCardUid=this.detectedCardUid;let t=this.cards.find(e=>e.uid===this.detectedCardUid);t&&(t.isDetected=!0,setTimeout(()=>{t.isDetected=!1},2e3))}},3e3)}stopCardDetection(){this.detectionActive=!1,this.isCardDetected=!1,this.detectedCardUid="",this.detectionStatus="",this.detectionInterval&&(clearInterval(this.detectionInterval),this.detectionInterval=null)}resetDetection(){this.isCardDetected=!1,this.detectedCardUid="",this.detectionStatus="\u062C\u0627\u0647\u0632 \u0644\u0644\u0643\u0634\u0641 \u0639\u0646 \u0628\u0637\u0627\u0642\u0629 \u062C\u062F\u064A\u062F\u0629"}createCard(){if(!this.newCardUid.trim()){alert("\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0631\u0642\u0645 \u0627\u0644\u0628\u0637\u0627\u0642\u0629");return}let t={uid:this.newCardUid,student:this.selectedStudentId||null};console.log("Creating card with data:",t),this.http.post(`${Bt.apiUrl}/cards`,t).pipe(gi(e=>{console.error("Error creating card:",e);let i=e.error?.error||"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0628\u0637\u0627\u0642\u0629";return alert(i),wr(()=>new Error(i))})).subscribe({next:e=>{console.log("Card created successfully:",e),alert("\u062A\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u0628\u0646\u062C\u0627\u062D"),this.newCardUid="",this.selectedStudentId="",this.loadCards()},error:e=>{console.error("Subscription error in createCard:",e)}})}assignCardToStudent(){if(!this.selectedCard||!this.selectedStudentId){alert("\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0628\u0637\u0627\u0642\u0629 \u0648\u0637\u0627\u0644\u0628");return}console.log(`Assigning card ${this.selectedCard._id} to student ${this.selectedStudentId}`),this.http.put(`${Bt.apiUrl}/cards/${this.selectedCard._id}`,{student:this.selectedStudentId}).pipe(gi(t=>{console.error("Error assigning card:",t);let e=t.error?.error||"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u0639\u064A\u064A\u0646 \u0627\u0644\u0628\u0637\u0627\u0642\u0629";return alert(e),wr(()=>new Error(e))})).subscribe({next:t=>{console.log("Card assigned successfully:",t),alert("\u062A\u0645 \u062A\u0639\u064A\u064A\u0646 \u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u0644\u0644\u0637\u0627\u0644\u0628 \u0628\u0646\u062C\u0627\u062D"),this.showAssignCardModal=!1,this.selectedCard=null,this.selectedStudentId="",this.loadCards()},error:t=>{console.error("Subscription error in assignCardToStudent:",t)}})}updateCard(t,e){console.log(`Updating card ${t} with:`,e),this.http.put(`${Bt.apiUrl}/cards/${t}`,e).pipe(gi(i=>{console.error("Error updating card:",i);let r=i.error?.error||"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0628\u0637\u0627\u0642\u0629";return alert(r),wr(()=>new Error(r))})).subscribe({next:()=>{console.log("Card updated successfully"),alert("\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u0628\u0646\u062C\u0627\u062D"),this.loadCards()},error:i=>{console.error("Subscription error in updateCard:",i)}})}unassignCard(t){confirm("\u0647\u0644 \u062A\u0631\u064A\u062F \u0625\u0644\u063A\u0627\u0621 \u062A\u0639\u064A\u064A\u0646 \u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u0645\u0646 \u0627\u0644\u0637\u0627\u0644\u0628\u061F")&&(console.log(`Unassigning card ${t}`),this.http.put(`${Bt.apiUrl}/cards/${t}`,{student:null}).pipe(gi(e=>{console.error("Error unassigning card:",e);let i=e.error?.error||"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0625\u0644\u063A\u0627\u0621 \u062A\u0639\u064A\u064A\u0646 \u0627\u0644\u0628\u0637\u0627\u0642\u0629";return alert(i),wr(()=>new Error(i))})).subscribe({next:()=>{console.log("Card unassigned successfully"),alert("\u062A\u0645 \u0625\u0644\u063A\u0627\u0621 \u062A\u0639\u064A\u064A\u0646 \u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u0628\u0646\u062C\u0627\u062D"),this.loadCards()},error:e=>{console.error("Subscription error in unassignCard:",e)}}))}deleteCard(t){confirm("\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u0628\u0637\u0627\u0642\u0629\u061F")&&(console.log(`Deleting card ${t}`),this.http.delete(`${Bt.apiUrl}/cards/${t}`).pipe(gi(e=>{console.error("Error deleting card:",e);let i=e.error?.error||"\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062D\u0630\u0641 \u0627\u0644\u0628\u0637\u0627\u0642\u0629";return alert(i),wr(()=>new Error(i))})).subscribe({next:()=>{console.log("Card deleted successfully"),alert("\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u0628\u0646\u062C\u0627\u062D"),this.loadCards()},error:e=>{console.error("Subscription error in deleteCard:",e)}}))}viewCardDetails(t){this.selectedCard=t,this.showCardDetailsModal=!0}checkCard(){if(!this.searchUid.trim()){alert("\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0631\u0642\u0645 \u0627\u0644\u0628\u0637\u0627\u0642\u0629");return}console.log(`Checking card with UID: ${this.searchUid}`),this.http.get(`${Bt.apiUrl}/cards/uid/${this.searchUid}`).pipe(gi(t=>(console.error("Error checking card:",t),alert("\u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u063A\u064A\u0631 \u0645\u0633\u062C\u0644\u0629"),wr(()=>new Error("\u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u063A\u064A\u0631 \u0645\u0633\u062C\u0644\u0629"))))).subscribe({next:t=>{console.log("Card check result:",t),t.student?alert(`\u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u0645\u0633\u062C\u0644\u0629 \u0628\u0627\u0633\u0645: ${t.student.name} (${t.student.studentId})`):alert("\u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u063A\u064A\u0631 \u0645\u0633\u062C\u0644\u0629")},error:t=>{console.error("Subscription error in checkCard:",t)}})}getStudentName(t){return typeof t.student=="object"&&t.student!==null?t.student.name:"\u063A\u064A\u0631 \u0645\u0639\u064A\u0646"}getStudentObject(t){return typeof t.student=="object"&&t.student!==null?t.student:null}formatDate(t){try{return new Date(t).toLocaleDateString("ar-EG")}catch{return t}}static \u0275fac=function(e){return new(e||n)(Ne(pn))};static \u0275cmp=nn({type:n,selectors:[["app-cards-management"]],decls:58,vars:16,consts:[[1,"cards-management"],[1,"header"],[1,"fas","fa-id-card"],[1,"subtitle"],[1,"content"],[1,"detection-section","card","mb-4"],[1,"card-header","bg-primary","text-white"],[1,"fas","fa-search"],[1,"card-body"],[1,"row","align-items-center"],[1,"col-md-8"],[1,"detection-status"],[1,"status-indicator"],[1,"status-text"],["class","detected-card alert alert-success mt-3",4,"ngIf"],[1,"col-md-4","text-end"],[1,"btn","btn-success","me-2",3,"click","disabled"],[1,"fas","fa-play"],[1,"btn","btn-danger",3,"click","disabled"],[1,"fas","fa-stop"],[1,"row","mb-4"],[1,"col-md-4"],[1,"input-group"],["type","text","placeholder","\u0628\u062D\u062B \u0628\u0631\u0642\u0645 \u0627\u0644\u0628\u0637\u0627\u0642\u0629...",1,"form-control",3,"ngModelChange","keyup.enter","ngModel"],[1,"btn","btn-outline-primary",3,"click"],["type","text","placeholder","\u0625\u062F\u062E\u0627\u0644 \u0631\u0642\u0645 \u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u0627\u0644\u062C\u062F\u064A\u062F\u0629...",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-select",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center"],[1,"fas","fa-list"],[1,"badge","bg-primary"],["class","text-center py-4",4,"ngIf"],["class","table-responsive",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"detected-card","alert","alert-success","mt-3"],[1,"fas","fa-check-circle"],[3,"value"],[1,"text-center","py-4"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"mt-2"],[1,"fas","fa-id-card-slash","fa-3x","text-muted"],[1,"table-responsive"],[1,"table","table-hover"],[3,"table-success",4,"ngFor","ngForOf"],["class","badge bg-success ms-2",4,"ngIf"],[4,"ngIf"],["class","text-danger",4,"ngIf"],[1,"badge",3,"ngClass"],[1,"btn-group","btn-group-sm"],[1,"btn","btn-outline-info",3,"click"],[1,"fas","fa-eye"],[1,"btn","btn-outline-primary",3,"click","disabled"],[1,"fas","fa-user-plus"],[1,"btn","btn-outline-warning",3,"click","disabled"],[1,"fas","fa-user-minus"],[1,"btn","btn-outline-danger",3,"click"],[1,"fas","fa-trash"],[1,"badge","bg-success","ms-2"],[1,"fas","fa-wifi"],[1,"text-muted","d-block"],[1,"text-danger"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-title"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],["class","card-info mb-3",4,"ngIf"],[1,"mb-3"],[1,"form-label"],["type","text","placeholder","\u0627\u0628\u062D\u062B \u0628\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628 \u0623\u0648 \u0631\u0642\u0645\u0647...",1,"form-control",3,"ngModelChange","input","ngModel"],["class","alert alert-warning",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"card-info","mb-3"],[1,"alert","alert-info"],[1,"alert","alert-warning"],[1,"fas","fa-exclamation-triangle"],[1,"fas","fa-info-circle"],["class","modal-body",4,"ngIf"],["type","button","class","btn btn-warning",3,"click",4,"ngIf"],["type","button","class","btn btn-primary",3,"click",4,"ngIf"],["type","button",1,"btn","btn-danger",3,"click"],[1,"card-details"],[1,"detail-item"],[1,"label"],[1,"value"],[1,"value",3,"ngClass"],["class","student-info mt-4",4,"ngIf"],[1,"student-info","mt-4"],[1,"fas","fa-user-graduate"],[1,"row","mt-2"],[1,"col-md-6"],["type","button",1,"btn","btn-warning",3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"div",1)(2,"h1"),b(3,"i",2),u(4," \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0628\u0637\u0627\u0642\u0627\u062A "),a(),s(5,"p",3),u(6,"\u0625\u062F\u0627\u0631\u0629 \u0628\u0637\u0627\u0642\u0627\u062A \u0627\u0644\u0637\u0644\u0627\u0628 \u0648\u062A\u0639\u064A\u064A\u0646\u0647\u0627"),a()(),s(7,"div",4)(8,"div",5)(9,"div",6),b(10,"i",7),u(11," \u0643\u0634\u0641 \u0627\u0644\u0628\u0637\u0627\u0642\u0627\u062A "),a(),s(12,"div",8)(13,"div",9)(14,"div",10)(15,"div",11),b(16,"div",12),s(17,"span",13),u(18),a()(),j(19,vW,5,1,"div",14),a(),s(20,"div",15)(21,"button",16),I("click",function(){return i.startCardDetection()}),b(22,"i",17),u(23," \u0628\u062F\u0621 \u0627\u0644\u0643\u0634\u0641 "),a(),s(24,"button",18),I("click",function(){return i.stopCardDetection()}),b(25,"i",19),u(26," \u0625\u064A\u0642\u0627\u0641 "),a()()()()(),s(27,"div",20)(28,"div",21)(29,"div",22)(30,"input",23),ye("ngModelChange",function(o){return Ce(i.searchUid,o)||(i.searchUid=o),o}),I("keyup.enter",function(){return i.checkCard()}),a(),s(31,"button",24),I("click",function(){return i.checkCard()}),b(32,"i",7),u(33," \u0628\u062D\u062B "),a()()(),s(34,"div",10)(35,"div",22)(36,"input",25),ye("ngModelChange",function(o){return Ce(i.newCardUid,o)||(i.newCardUid=o),o}),a(),s(37,"select",26),ye("ngModelChange",function(o){return Ce(i.selectedStudentId,o)||(i.selectedStudentId=o),o}),s(38,"option",27),u(39,"\u0627\u062E\u062A\u0631 \u0637\u0627\u0644\u0628\u0627\u064B (\u0627\u062E\u062A\u064A\u0627\u0631\u064A)"),a(),j(40,yW,2,3,"option",28),a(),s(41,"button",29),I("click",function(){return i.createCard()}),b(42,"i",30),u(43," \u0625\u0636\u0627\u0641\u0629 \u0628\u0637\u0627\u0642\u0629 "),a()()()(),s(44,"div",31)(45,"div",32)(46,"div"),b(47,"i",33),u(48," \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0628\u0637\u0627\u0642\u0627\u062A "),a(),s(49,"div")(50,"span",34),u(51),a()()(),s(52,"div",8),j(53,xW,6,0,"div",35)(54,bW,4,0,"div",35)(55,MW,16,1,"div",36),a()()(),j(56,PW,26,6,"div",37)(57,kW,14,3,"div",37),a()),e&2&&(d(16),Ie("active",i.detectionActive),d(2),B(i.detectionStatus||"\u062C\u0627\u0647\u0632 \u0644\u0644\u0643\u0634\u0641"),d(),w("ngIf",i.isCardDetected),d(2),w("disabled",i.detectionActive),d(3),w("disabled",!i.detectionActive),d(6),ve("ngModel",i.searchUid),d(6),ve("ngModel",i.newCardUid),d(),ve("ngModel",i.selectedStudentId),d(3),w("ngForOf",i.students),d(11),H("",i.cards.length," \u0628\u0637\u0627\u0642\u0629"),d(2),w("ngIf",i.loading),d(),w("ngIf",!i.loading&&i.cards.length===0),d(),w("ngIf",!i.loading&&i.cards.length>0),d(),w("ngIf",i.showAssignCardModal),d(),w("ngIf",i.showCardDetailsModal))},dependencies:[hn,Bo,Nn,An,Un,Di,Pi,Yn,di,ii,ti],encapsulation:2})};$();function NW(n,t){if(n&1&&(s(0,"option",38),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Gn(" ",e.name," - ",e.subject," ")}}function UW(n,t){if(n&1&&(s(0,"option",38),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),H(" ",e.name," ")}}function LW(n,t){if(n&1&&(s(0,"option",38),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Qi(" ",e.name," - ",e.subject," (",e.academicYear,") ")}}function BW(n,t){if(n&1&&(s(0,"option",38),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Gn(" ",e.name," - ",e.subjects==null?null:e.subjects.join("\u060C ")," ")}}function VW(n,t){if(n&1&&(s(0,"option",38),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Gn(" ",e.name," (\u0633\u0639\u0629: ",e.capacity,") ")}}function HW(n,t){if(n&1){let e=he();s(0,"div",39)(1,"div",12)(2,"h5"),b(3,"i",40),u(4," \u0625\u0646\u0634\u0627\u0621 \u062D\u0635\u0629 \u062C\u062F\u064A\u062F\u0629"),a()(),s(5,"div",14)(6,"form",41,0),I("ngSubmit",function(){F(e);let r=E();return R(r.createLiveClass())}),s(8,"div",42)(9,"div",43)(10,"label",44),u(11,"\u0627\u0644\u062D\u0635\u0629 "),s(12,"span",45),u(13,"*"),a()(),s(14,"select",46),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLiveClass.class,r)||(o.newLiveClass.class=r),R(r)}),s(15,"option",19),u(16,"\u0627\u062E\u062A\u0631 \u0627\u0644\u062D\u0635\u0629"),a(),j(17,LW,2,4,"option",28),a()(),s(18,"div",43)(19,"label",47),u(20,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E "),s(21,"span",45),u(22,"*"),a()(),s(23,"input",48),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLiveClass.date,r)||(o.newLiveClass.date=r),R(r)}),a()(),s(24,"div",43)(25,"label",49),u(26,"\u0648\u0642\u062A \u0627\u0644\u0628\u062F\u0627\u064A\u0629 "),s(27,"span",45),u(28,"*"),a()(),s(29,"input",50),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLiveClass.startTime,r)||(o.newLiveClass.startTime=r),R(r)}),a()(),s(30,"div",43)(31,"label",51),u(32,"\u0648\u0642\u062A \u0627\u0644\u0646\u0647\u0627\u064A\u0629"),a(),s(33,"input",52),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLiveClass.endTime,r)||(o.newLiveClass.endTime=r),R(r)}),a()()(),s(34,"div",42)(35,"div",43)(36,"label",53),u(37,"\u0627\u0644\u0623\u0633\u062A\u0627\u0630 "),s(38,"span",45),u(39,"*"),a()(),s(40,"select",54),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLiveClass.teacher,r)||(o.newLiveClass.teacher=r),R(r)}),s(41,"option",19),u(42,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0623\u0633\u062A\u0627\u0630"),a(),j(43,BW,2,3,"option",28),a()(),s(44,"div",43)(45,"label",55),u(46,"\u0627\u0644\u0642\u0627\u0639\u0629"),a(),s(47,"select",56),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLiveClass.classroom,r)||(o.newLiveClass.classroom=r),R(r)}),s(48,"option",19),u(49,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0642\u0627\u0639\u0629"),a(),j(50,VW,2,3,"option",28),a()(),s(51,"div",43)(52,"label",57),u(53,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(54,"select",58),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLiveClass.status,r)||(o.newLiveClass.status=r),R(r)}),s(55,"option",20),u(56,"\u0645\u062C\u062F\u0648\u0644\u0629"),a(),s(57,"option",21),u(58,"\u062C\u0627\u0631\u064A\u0629"),a(),s(59,"option",22),u(60,"\u0645\u0643\u062A\u0645\u0644\u0629"),a()()()(),s(61,"div",43)(62,"label",59),u(63,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"),a(),s(64,"textarea",60),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newLiveClass.notes,r)||(o.newLiveClass.notes=r),R(r)}),a()(),s(65,"div",61)(66,"button",62),b(67,"i",63),u(68," \u062D\u0641\u0638 \u0627\u0644\u062D\u0635\u0629 "),a(),s(69,"button",64),I("click",function(){F(e);let r=E();return R(r.cancelCreate())}),b(70,"i",65),u(71," \u0625\u0644\u063A\u0627\u0621 "),a()()()()()}if(n&2){let e=gc(7),i=E();d(14),ve("ngModel",i.newLiveClass.class),d(3),w("ngForOf",i.allClasses),d(6),ve("ngModel",i.newLiveClass.date),d(6),ve("ngModel",i.newLiveClass.startTime),d(4),ve("ngModel",i.newLiveClass.endTime),d(7),ve("ngModel",i.newLiveClass.teacher),d(3),w("ngForOf",i.teachers),d(4),ve("ngModel",i.newLiveClass.classroom),d(3),w("ngForOf",i.classrooms),d(4),ve("ngModel",i.newLiveClass.status),d(10),ve("ngModel",i.newLiveClass.notes),d(2),w("disabled",!e.valid)}}function zW(n,t){n&1&&(s(0,"div",66)(1,"div",67),b(2,"div",68),a(),s(3,"p"),u(4,"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u062D\u064A\u0629..."),a()())}function jW(n,t){n&1&&(s(0,"div",69),b(1,"i",70),s(2,"h4"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u062D\u0635\u0635 \u062D\u064A\u0629"),a(),s(4,"p"),u(5,"\u0644\u0645 \u064A\u062A\u0645 \u0625\u0646\u0634\u0627\u0621 \u0623\u064A \u062D\u0635\u0635 \u062D\u064A\u0629 \u0628\u0639\u062F. \u064A\u0645\u0643\u0646\u0643 \u0625\u0646\u0634\u0627\u0621 \u062D\u0635\u0629 \u062C\u062F\u064A\u062F\u0629 \u0628\u0627\u0633\u062A\u062E\u062F\u0627\u0645 \u0627\u0644\u0632\u0631 \u0623\u0639\u0644\u0627\u0647."),a()())}function WW(n,t){if(n&1){let e=he();s(0,"div",95)(1,"h5"),b(2,"i",83),u(3," \u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u062D\u0635\u0629"),a(),s(4,"form",41,1),I("ngSubmit",function(){F(e);let r=E(2).$implicit,o=E();return R(o.updateLiveClass(r))}),s(6,"div",42)(7,"div",43)(8,"label",96),u(9,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(10,"select",97),ye("ngModelChange",function(r){F(e);let o=E(2).$implicit;return Ce(o.status,r)||(o.status=r),R(r)}),s(11,"option",20),u(12,"\u0645\u062C\u062F\u0648\u0644\u0629"),a(),s(13,"option",21),u(14,"\u062C\u0627\u0631\u064A\u0629"),a(),s(15,"option",22),u(16,"\u0645\u0643\u062A\u0645\u0644\u0629"),a(),s(17,"option",23),u(18,"\u0645\u0644\u063A\u0627\u0629"),a()()(),s(19,"div",43)(20,"label",98),u(21,"\u0648\u0642\u062A \u0627\u0644\u0646\u0647\u0627\u064A\u0629"),a(),s(22,"input",99),ye("ngModelChange",function(r){F(e);let o=E(2).$implicit;return Ce(o.endTime,r)||(o.endTime=r),R(r)}),a()()(),s(23,"div",43)(24,"label",100),u(25,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"),a(),s(26,"textarea",101),ye("ngModelChange",function(r){F(e);let o=E(2).$implicit;return Ce(o.notes,r)||(o.notes=r),R(r)}),a()(),s(27,"div",102)(28,"button",103),b(29,"i",104),u(30," \u062D\u0641\u0638 \u0627\u0644\u062A\u063A\u064A\u064A\u0631\u0627\u062A "),a(),s(31,"button",64),I("click",function(){F(e);let r=E(3);return R(r.cancelEdit())}),b(32,"i",65),u(33," \u0625\u0644\u063A\u0627\u0621 "),a()()()()}if(n&2){let e=E(2).$implicit;d(10),ve("ngModel",e.status),d(12),ve("ngModel",e.endTime),d(4),ve("ngModel",e.notes)}}function GW(n,t){if(n&1){let e=he();s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td")(6,"span",131),u(7),a()(),s(8,"td")(9,"div",132)(10,"button",133),I("click",function(){let r=F(e).$implicit,o=E(4).$implicit,l=E();return R(l.markStudentAttendance(o._id,r._id,"present"))}),u(11," \u062D\u0627\u0636\u0631 "),a(),s(12,"button",134),I("click",function(){let r=F(e).$implicit,o=E(4).$implicit,l=E();return R(l.markStudentAttendance(o._id,r._id,"absent"))}),u(13," \u063A\u0627\u0626\u0628 "),a(),s(14,"button",135),I("click",function(){let r=F(e).$implicit,o=E(4).$implicit,l=E();return R(l.markStudentAttendance(o._id,r._id,"late"))}),u(15," \u0645\u062A\u0623\u062E\u0631 "),a()()()()}if(n&2){let e=t.$implicit,i=E(4).$implicit,r=E();d(2),B(e.name),d(2),B(e.studentId),d(2),w("ngClass",r.getAttendanceStatusClass(i,e._id)),d(),H(" ",r.getAttendanceStatus(i,e._id)," ")}}function $W(n,t){if(n&1&&(s(0,"div",126)(1,"h6"),b(2,"i",127),u(3," \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0637\u0644\u0627\u0628"),a(),s(4,"div",128)(5,"table",129)(6,"thead")(7,"tr")(8,"th"),u(9,"\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(10,"th"),u(11,"\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(12,"th"),u(13,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(14,"th"),u(15,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(16,"tbody"),j(17,GW,16,4,"tr",130),a()()()()),n&2){let e=E(3).$implicit;d(17),w("ngForOf",e.class.students)}}function YW(n,t){if(n&1){let e=he();s(0,"div",136)(1,"button",137),I("click",function(){F(e);let r=E(3).$implicit,o=E();return R(o.loadClassStudents(r))}),b(2,"i",138),u(3," \u062A\u062D\u0645\u064A\u0644 \u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0637\u0644\u0627\u0628 "),a()()}}function qW(n,t){if(n&1){let e=he();s(0,"div",105)(1,"div",106)(2,"div",107)(3,"strong"),b(4,"i",108),u(5," \u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0625\u0636\u0627\u0641\u064A\u0629:"),a(),s(6,"p"),u(7),a()(),s(8,"div",107)(9,"strong"),b(10,"i",109),u(11," \u0625\u062D\u0635\u0627\u0626\u064A\u0627\u062A \u0627\u0644\u062D\u0636\u0648\u0631:"),a(),s(12,"div",110)(13,"div",111)(14,"div",112),u(15),a(),s(16,"div",113),u(17,"\u062D\u0627\u0636\u0631"),a()(),s(18,"div",114)(19,"div",112),u(20),a(),s(21,"div",113),u(22,"\u063A\u0627\u0626\u0628"),a()(),s(23,"div",115)(24,"div",112),u(25),a(),s(26,"div",113),u(27,"\u0645\u062A\u0623\u062E\u0631"),a()(),s(28,"div",116)(29,"div",112),u(30),a(),s(31,"div",113),u(32,"\u0625\u062C\u0645\u0627\u0644\u064A"),a()()()()(),s(33,"div",117)(34,"button",118),I("click",function(){F(e);let r=E(2).$implicit,o=E();return R(o.autoMarkAbsent(r._id))}),b(35,"i",119),u(36," \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u063A\u0627\u0626\u0628\u064A\u0646 \u062A\u0644\u0642\u0627\u0626\u064A\u0627\u064B "),a(),s(37,"button",120),I("click",function(){F(e);let r=E(2).$implicit,o=E();return R(o.getClassAttendanceReport(r.class==null?null:r.class._id))}),b(38,"i",121),u(39," \u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u062D\u0636\u0648\u0631 "),a(),s(40,"button",122),I("click",function(){F(e);let r=E(2).$implicit,o=E();return R(o.exportMonthlyAttendance(r.class==null?null:r.class._id))}),b(41,"i",123),u(42," \u062A\u0635\u062F\u064A\u0631 Excel "),a()(),j(43,$W,18,1,"div",124)(44,YW,4,0,"div",125),a()}if(n&2){let e=E(2).$implicit,i=E();d(7),B(e.notes||"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u0644\u0627\u062D\u0638\u0627\u062A"),d(8),B(i.countAttendance(e,"present")),d(5),B(i.countAttendance(e,"absent")),d(5),B(i.countAttendance(e,"late")),d(5),B(i.getTotalStudents(e)),d(13),w("ngIf",e.studentsLoaded&&(e.class==null||e.class.students==null?null:e.class.students.length)>0),d(),w("ngIf",!e.studentsLoaded&&(e.class==null?null:e.class._id))}}function XW(n,t){if(n&1&&(s(0,"div",14),j(1,WW,34,3,"div",93)(2,qW,45,7,"div",94),a()),n&2){let e=E().$implicit,i=E();d(),w("ngIf",e._id===i.editingClassId),d(),w("ngIf",!e._id===i.editingClassId)}}function ZW(n,t){if(n&1){let e=he();s(0,"div",71)(1,"div",72)(2,"div",73)(3,"div",74)(4,"h3",75),b(5,"i",5),u(6),a(),s(7,"div",76)(8,"span",77),u(9),a(),s(10,"span",78),u(11),a()()(),s(12,"div",79)(13,"button",80),I("click",function(){let r=F(e).$implicit,o=E();return R(o.toggleClassDetails(r))}),b(14,"i",81),a(),s(15,"button",80),I("click",function(){let r=F(e).$implicit,o=E();return R(o.openAttendanceModal(r))}),b(16,"i",82),a(),s(17,"button",80),I("click",function(){let r=F(e).$implicit,o=E();return R(o.editLiveClass(r))}),b(18,"i",83),a(),s(19,"button",84),I("click",function(){let r=F(e).$implicit,o=E();return R(o.confirmDeleteLiveClass(r._id))}),b(20,"i",85),a()()(),s(21,"div",86)(22,"div",87),b(23,"i",88),s(24,"span"),u(25),a()(),s(26,"div",87),b(27,"i",89),s(28,"span"),u(29),a()(),s(30,"div",87),b(31,"i",90),s(32,"span"),u(33),a()(),s(34,"div",87),b(35,"i",91),s(36,"span"),u(37),a()()()(),j(38,XW,3,2,"div",92),a()}if(n&2){let e=t.$implicit,i=E();d(),w("ngClass",i.getStatusClass(e.status)),d(5),H(" ",(e.class==null?null:e.class.name)||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"," "),d(3),B((e.class==null?null:e.class.subject)||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(2),B(i.getStatusText(e.status)),d(3),w("ngClass",e.showDetails?"fa-chevron-up":"fa-chevron-down"),d(11),B(i.formatDate(e.date)),d(4),Gn("",e.startTime," ",e.endTime?"- "+e.endTime:"",""),d(4),B((e.teacher==null?null:e.teacher.name)||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(4),B((e.classroom==null?null:e.classroom.name)||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(),w("ngIf",e.showDetails||e._id===i.editingClassId)}}function JW(n,t){if(n&1&&(s(0,"option",38),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Gn(" ",e.name," (",e.studentId,") ")}}function KW(n,t){if(n&1){let e=he();s(0,"tr")(1,"td"),u(2),a(),s(3,"td")(4,"span",131),u(5),a()(),s(6,"td"),u(7),a(),s(8,"td")(9,"button",134),I("click",function(){let r=F(e).$implicit,o=E(3);return R(o.removeAttendance(o.selectedLiveClass._id,r.student))}),b(10,"i",85),a()()()}if(n&2){let e=t.$implicit,i=E(3);d(2),B(i.getStudentName(e.student)),d(2),w("ngClass",e.status),d(),H(" ",i.getAttendanceStatusText(e.status)," "),d(2),B(i.formatTime(e.timestamp))}}function QW(n,t){if(n&1&&(s(0,"div",155)(1,"h5"),u(2,"\u0627\u0644\u062D\u0636\u0648\u0631 \u0627\u0644\u0645\u0633\u062C\u0644"),a(),s(3,"div",128)(4,"table",156)(5,"thead")(6,"tr")(7,"th"),u(8,"\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(9,"th"),u(10,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(11,"th"),u(12,"\u0627\u0644\u0648\u0642\u062A"),a(),s(13,"th"),u(14,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621"),a()()(),s(15,"tbody"),j(16,KW,11,4,"tr",130),a()()()()),n&2){let e=E(2);d(16),w("ngForOf",e.selectedLiveClass.attendance)}}function eG(n,t){if(n&1){let e=he();s(0,"div",139),I("click",function(){F(e);let r=E();return R(r.closeAttendanceModal())}),s(1,"div",140),I("click",function(r){return F(e),R(r.stopPropagation())}),s(2,"div",141)(3,"h3"),b(4,"i",82),u(5),a(),s(6,"button",142),I("click",function(){F(e);let r=E();return R(r.closeAttendanceModal())}),b(7,"i",65),a()(),s(8,"div",143)(9,"div",144)(10,"h5"),u(11,"\u062A\u0633\u062C\u064A\u0644 \u062D\u0636\u0648\u0631 \u0633\u0631\u064A\u0639"),a(),s(12,"form",41,2),I("ngSubmit",function(){F(e);let r=E();return R(r.submitQuickAttendance())}),s(14,"div",42)(15,"div",43)(16,"label",145),u(17,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0637\u0627\u0644\u0628:"),a(),s(18,"select",146),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.quickAttendance.studentId,r)||(o.quickAttendance.studentId=r),R(r)}),s(19,"option",19),u(20,"-- \u0627\u062E\u062A\u0631 \u0637\u0627\u0644\u0628 --"),a(),j(21,JW,2,3,"option",28),a()(),s(22,"div",43)(23,"label",147),u(24,"\u0627\u0644\u062D\u0627\u0644\u0629:"),a(),s(25,"select",148),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.quickAttendance.status,r)||(o.quickAttendance.status=r),R(r)}),s(26,"option",149),u(27,"\u062D\u0627\u0636\u0631"),a(),s(28,"option",150),u(29,"\u063A\u0627\u0626\u0628"),a(),s(30,"option",151),u(31,"\u0645\u062A\u0623\u062E\u0631"),a()()()(),s(32,"button",152),b(33,"i",104),u(34," \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062D\u0636\u0648\u0631 "),a()()(),j(35,QW,17,1,"div",153),a(),s(36,"div",154)(37,"button",9),I("click",function(){F(e);let r=E();return R(r.closeAttendanceModal())}),u(38," \u0625\u063A\u0644\u0627\u0642 "),a()()()()}if(n&2){let e=gc(13),i=E();d(5),H(" \u062A\u0633\u062C\u064A\u0644 \u062D\u0636\u0648\u0631 - ",i.selectedLiveClass.class==null?null:i.selectedLiveClass.class.name," "),d(13),ve("ngModel",i.quickAttendance.studentId),d(3),w("ngForOf",i.allStudents),d(4),ve("ngModel",i.quickAttendance.status),d(7),w("disabled",!e.valid),d(3),w("ngIf",(i.selectedLiveClass.attendance==null?null:i.selectedLiveClass.attendance.length)>0)}}function tG(n,t){n&1&&(s(0,"div",66)(1,"div",67),b(2,"div",68),a(),s(3,"p"),u(4,"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062A\u0642\u0631\u064A\u0631..."),a()())}function nG(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td"),u(6),a(),s(7,"td"),u(8),a(),s(9,"td"),u(10),a(),s(11,"td")(12,"div",166)(13,"div",167),u(14),a()()()()),n&2){let e=t.$implicit,i=E(3);d(2),B(e.student==null?null:e.student.name),d(2),B(e.student==null?null:e.student.studentId),d(2),B((e.statistics==null?null:e.statistics.present)||0),d(2),B((e.statistics==null?null:e.statistics.absent)||0),d(2),B((e.statistics==null?null:e.statistics.late)||0),d(3),fr("width",((e.statistics==null?null:e.statistics.attendanceRate)||0)+"%"),w("ngClass",i.getAttendanceRateClass(e.statistics==null?null:e.statistics.attendanceRate)),d(),H(" ",(e.statistics==null?null:e.statistics.attendanceRate)||0,"% ")}}function iG(n,t){if(n&1&&(s(0,"div")(1,"div",160)(2,"h4"),u(3),a(),s(4,"p"),u(5),a()(),s(6,"div",161)(7,"div",162)(8,"div",163),u(9),a(),s(10,"div",164),u(11,"\u0639\u062F\u062F \u0627\u0644\u062D\u0635\u0635"),a()(),s(12,"div",162)(13,"div",163),u(14),a(),s(15,"div",164),u(16,"\u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628"),a()(),s(17,"div",162)(18,"div",163),u(19),a(),s(20,"div",164),u(21,"\u0645\u062A\u0648\u0633\u0637 \u0627\u0644\u062D\u0636\u0648\u0631"),a()()(),s(22,"div",128)(23,"table",165)(24,"thead")(25,"tr")(26,"th"),u(27,"\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(28,"th"),u(29,"\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(30,"th"),u(31,"\u0627\u0644\u062D\u0636\u0648\u0631"),a(),s(32,"th"),u(33,"\u0627\u0644\u063A\u064A\u0627\u0628"),a(),s(34,"th"),u(35,"\u0627\u0644\u062A\u0623\u062E\u064A\u0631"),a(),s(36,"th"),u(37,"\u0627\u0644\u0646\u0633\u0628\u0629 %"),a()()(),s(38,"tbody"),j(39,nG,15,9,"tr",130),a()()()()),n&2){let e=E(2);d(3),B(e.attendanceReport.class==null?null:e.attendanceReport.class.name),d(2),Gn("",e.attendanceReport.class==null?null:e.attendanceReport.class.subject," | ",e.attendanceReport.period||"\u0627\u0644\u0641\u062A\u0631\u0629 \u0627\u0644\u0645\u062D\u062F\u062F\u0629",""),d(4),B((e.attendanceReport.summary==null?null:e.attendanceReport.summary.totalClasses)||0),d(5),B((e.attendanceReport.summary==null?null:e.attendanceReport.summary.totalStudents)||0),d(5),H("",(e.attendanceReport.summary==null?null:e.attendanceReport.summary.averageAttendance)||0,"%"),d(20),w("ngForOf",e.attendanceReport.students)}}function rG(n,t){if(n&1){let e=he();s(0,"button",122),I("click",function(){F(e);let r=E(2);return R(r.exportReport())}),b(1,"i",123),u(2," \u062A\u0635\u062F\u064A\u0631 \u0625\u0644\u0649 Excel "),a()}}function oG(n,t){if(n&1){let e=he();s(0,"div",139),I("click",function(){F(e);let r=E();return R(r.closeReportModal())}),s(1,"div",157),I("click",function(r){return F(e),R(r.stopPropagation())}),s(2,"div",141)(3,"h3"),b(4,"i",121),u(5," \u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u062D\u0636\u0648\u0631 "),a(),s(6,"button",142),I("click",function(){F(e);let r=E();return R(r.closeReportModal())}),b(7,"i",65),a()(),s(8,"div",143),j(9,tG,5,0,"div",33)(10,iG,40,7,"div",158),a(),s(11,"div",154),j(12,rG,3,0,"button",159),s(13,"button",9),I("click",function(){F(e);let r=E();return R(r.closeReportModal())}),u(14," \u0625\u063A\u0644\u0627\u0642 "),a()()()()}if(n&2){let e=E();d(9),w("ngIf",e.reportLoading),d(),w("ngIf",!e.reportLoading&&e.attendanceReport),d(2),w("ngIf",e.attendanceReport==null||e.attendanceReport.class==null?null:e.attendanceReport.class._id)}}function sG(n,t){if(n&1){let e=he();s(0,"div",168)(1,"button",169),I("click",function(){F(e);let r=E();return R(r.previousPage())}),b(2,"i",170),u(3," \u0627\u0644\u0633\u0627\u0628\u0642 "),a(),s(4,"span",171),u(5),a(),s(6,"button",169),I("click",function(){F(e);let r=E();return R(r.nextPage())}),u(7," \u0627\u0644\u062A\u0627\u0644\u064A "),b(8,"i",172),a()()}if(n&2){let e=E();d(),w("disabled",e.currentPage===1),d(4),Gn("\u0627\u0644\u0635\u0641\u062D\u0629 ",e.currentPage," \u0645\u0646 ",e.totalPages,""),d(),w("disabled",e.currentPage===e.totalPages)}}var z1=class n{constructor(t){this.http=t}apiUrl=_i.apiUrl||"http://localhost:3000/api";liveClasses=[];allClasses=[];teachers=[];students=[];allStudents=[];classrooms=[];loading=!1;showCreateForm=!1;showAttendanceModal=!1;showReportModal=!1;showBulkMessagesModal=!1;newLiveClass={class:"",date:"",startTime:"",endTime:"",teacher:"",classroom:"",status:"scheduled",notes:""};quickAttendance={studentId:"",status:"present",method:"manual"};filters={status:"",date:"",class:"",teacher:""};selectedLiveClass=null;editingClassId=null;attendanceReport=null;reportLoading=!1;attendanceStartDate="";attendanceEndDate="";monthlyAttendanceMonth="";currentPage=1;totalPages=1;itemsPerPage=10;ngOnInit(){this.loadInitialData()}loadInitialData(){this.loadLiveClasses(),this.loadAllClasses(),this.loadTeachers(),this.loadAllStudents(),this.loadClassrooms()}loadLiveClasses(){this.loading=!0;let t=`${this.apiUrl}/live-classes`,e=new URLSearchParams;this.filters.status&&e.append("status",this.filters.status),this.filters.date&&e.append("date",this.filters.date),this.filters.class&&e.append("class",this.filters.class),this.filters.teacher&&e.append("teacher",this.filters.teacher),e.toString()&&(t+=`?${e.toString()}`),this.http.get(t).subscribe({next:i=>{this.liveClasses=i.map(r=>St(Oe({},r),{showDetails:!1,studentsLoaded:!1})),this.totalPages=Math.ceil(this.liveClasses.length/this.itemsPerPage),this.loading=!1},error:i=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u062D\u064A\u0629:",i),this.loading=!1,alert("\u062D\u062F\u062B \u062E\u0637\u0623 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u062D\u064A\u0629")}})}loadAllClasses(){this.http.get(`${this.apiUrl}/classes`).subscribe({next:t=>{this.allClasses=t},error:t=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062D\u0635\u0635:",t)}})}loadTeachers(){this.http.get(`${this.apiUrl}/teachers`).subscribe({next:t=>{this.teachers=t},error:t=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629:",t)}})}loadAllStudents(){this.http.get(`${this.apiUrl}/students`).subscribe({next:t=>{this.allStudents=t},error:t=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0637\u0644\u0627\u0628:",t)}})}loadClassrooms(){this.http.get(`${this.apiUrl}/classrooms`).subscribe({next:t=>{this.classrooms=t},error:t=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0642\u0627\u0639\u0627\u062A:",t)}})}loadClassStudents(t){t.class?._id&&this.http.get(`${this.apiUrl}/classes/${t.class._id}/students`).subscribe({next:e=>{t.class.students=e,t.studentsLoaded=!0},error:e=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0637\u0644\u0627\u0628 \u0627\u0644\u062D\u0635\u0629:",e)}})}loadLiveClassAttendance(t){this.http.get(`${this.apiUrl}/live-classes/${t}/attendance`).subscribe({next:e=>{let i=this.liveClasses.find(r=>r._id===t);i&&(i.attendance=e.attendance||[])},error:e=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062D\u0636\u0648\u0631:",e)}})}createLiveClass(){if(!this.validateLiveClassForm())return;let t=St(Oe({},this.newLiveClass),{month:new Date(this.newLiveClass.date).toISOString().slice(0,7)});this.http.post(`${this.apiUrl}/live-classes`,t).subscribe({next:e=>{alert("\u2705 \u062A\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062D\u0635\u0629 \u0627\u0644\u062D\u064A\u0629 \u0628\u0646\u062C\u0627\u062D"),this.loadLiveClasses(),this.resetNewLiveClass(),this.showCreateForm=!1},error:e=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062D\u0635\u0629:",e),alert("\u274C \u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062D\u0635\u0629")}})}updateLiveClass(t){let e={status:t.status,endTime:t.endTime,notes:t.notes};this.http.put(`${this.apiUrl}/live-classes/${t._id}`,e).subscribe({next:()=>{alert("\u2705 \u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062D\u0635\u0629 \u0628\u0646\u062C\u0627\u062D"),this.editingClassId=null,this.loadLiveClasses()},error:i=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062D\u0635\u0629:",i),alert("\u274C \u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062D\u0635\u0629")}})}confirmDeleteLiveClass(t){confirm("\u26A0\uFE0F \u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u062D\u0635\u0629\u061F \u0647\u0630\u0627 \u0627\u0644\u0625\u062C\u0631\u0627\u0621 \u0644\u0627 \u064A\u0645\u0643\u0646 \u0627\u0644\u062A\u0631\u0627\u062C\u0639 \u0639\u0646\u0647.")&&this.deleteLiveClass(t)}deleteLiveClass(t){this.http.delete(`${this.apiUrl}/live-classes/${t}`).subscribe({next:()=>{alert("\u2705 \u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u062D\u0635\u0629 \u0628\u0646\u062C\u0627\u062D"),this.loadLiveClasses()},error:e=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062D\u0630\u0641 \u0627\u0644\u062D\u0635\u0629:",e),alert("\u274C \u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062D\u0630\u0641 \u0627\u0644\u062D\u0635\u0629")}})}markStudentAttendance(t,e,i){let r={studentId:e,status:i,method:"manual"};this.http.post(`${this.apiUrl}/live-classes/${t}/attendance`,r).subscribe({next:o=>{let l=this.liveClasses.find(c=>c._id===t);if(l){let c=l.attendance?.findIndex(p=>p.student?._id===e||p.student===e),f={student:e,status:i,timestamp:new Date};c>=0&&l.attendance?l.attendance[c]=f:(l.attendance||(l.attendance=[]),l.attendance.push(f))}},error:o=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062D\u0636\u0648\u0631:",o),alert("\u274C \u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062D\u0636\u0648\u0631")}})}submitQuickAttendance(){!this.selectedLiveClass||!this.quickAttendance.studentId||(this.markStudentAttendance(this.selectedLiveClass._id,this.quickAttendance.studentId,this.quickAttendance.status),this.quickAttendance={studentId:"",status:"present",method:"manual"})}removeAttendance(t,e){let i=this.liveClasses.find(r=>r._id===t);i&&i.attendance&&(i.attendance=i.attendance.filter(r=>r.student?._id!==e&&r.student!==e))}autoMarkAbsent(t){if(confirm("\u26A0\uFE0F \u0633\u064A\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u062C\u0645\u064A\u0639 \u0627\u0644\u0637\u0644\u0627\u0628 \u063A\u064A\u0631 \u0627\u0644\u0645\u0633\u062C\u0644 \u062D\u0636\u0648\u0631\u0647\u0645 \u0643\u063A\u0627\u0626\u0628\u064A\u0646 \u0648\u0625\u0631\u0633\u0627\u0644 \u0631\u0633\u0627\u0626\u0644 SMS \u0644\u0623\u0648\u0644\u064A\u0627\u0621 \u0623\u0645\u0648\u0631\u0647\u0645. \u0647\u0644 \u062A\u0631\u064A\u062F \u0627\u0644\u0645\u062A\u0627\u0628\u0639\u0629\u061F")){let e={autoSendSMS:!0,customMessage:""};this.http.post(`${this.apiUrl}/live-classes/${t}/auto-mark-absent`,e).subscribe({next:i=>{i.success?(alert(`\u2705 ${i.message}

\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 ${i.data?.absentCount||0} \u0637\u0627\u0644\u0628 \u0643\u063A\u0627\u0626\u0628\u064A\u0646
\u0648\u0625\u0631\u0633\u0627\u0644 ${i.data?.messagesSent||0} \u0631\u0633\u0627\u0644\u0629`),this.loadLiveClasses()):alert(`\u274C ${i.error}`)},error:i=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u063A\u0627\u0626\u0628\u064A\u0646:",i),alert("\u274C \u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u063A\u0627\u0626\u0628\u064A\u0646")}})}}getClassAttendanceReport(t){if(!t){alert("\u26A0\uFE0F \u0644\u0627 \u064A\u0645\u0643\u0646 \u0639\u0631\u0636 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0628\u062F\u0648\u0646 \u0645\u0639\u0631\u0641 \u0627\u0644\u062D\u0635\u0629");return}let e=new Date,i=new Date(e.getFullYear(),e.getMonth(),1),r=new Date(e.getFullYear(),e.getMonth()+1,0);this.reportLoading=!0,this.showReportModal=!0;let o=new URLSearchParams({startDate:i.toISOString().split("T")[0],endDate:r.toISOString().split("T")[0]});this.http.get(`${this.apiUrl}/live-classes/class/${t}/attendance?${o}`).subscribe({next:l=>{this.attendanceReport=l,this.reportLoading=!1},error:l=>{console.error("\u274C \u062E\u0637\u0623 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062A\u0642\u0631\u064A\u0631:",l),this.reportLoading=!1,alert("\u274C \u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062A\u0642\u0631\u064A\u0631")}})}exportMonthlyAttendance(t){if(!t){alert("\u26A0\uFE0F \u0644\u0627 \u064A\u0645\u0643\u0646 \u062A\u0635\u062F\u064A\u0631 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0628\u062F\u0648\u0646 \u0645\u0639\u0631\u0641 \u0627\u0644\u062D\u0635\u0629");return}let e=new Date,i=(e.getMonth()+1).toString().padStart(2,"0"),r=e.getFullYear(),o=`${this.apiUrl}/classes/${t}/monthly-attendance/export?month=${i}&year=${r}`;window.open(o,"_blank")}exportReport(){if(!this.attendanceReport?.class?._id)return;let t=new Date,e=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getFullYear(),r=`${this.apiUrl}/classes/${this.attendanceReport.class._id}/monthly-attendance/export?month=${e}&year=${i}`;window.open(r,"_blank")}openAttendanceModal(t){this.selectedLiveClass=t,this.showAttendanceModal=!0,this.loadLiveClassAttendance(t._id)}closeAttendanceModal(){this.showAttendanceModal=!1,this.selectedLiveClass=null,this.quickAttendance={studentId:"",status:"present",method:"manual"}}closeReportModal(){this.showReportModal=!1,this.attendanceReport=null}toggleClassDetails(t){t.showDetails=!t.showDetails,t.showDetails&&!t.studentsLoaded&&this.loadClassStudents(t)}editLiveClass(t){this.editingClassId=t._id,t.showDetails=!0}cancelEdit(){this.editingClassId=null,this.loadLiveClasses()}cancelCreate(){this.showCreateForm=!1,this.resetNewLiveClass()}applyFilters(){this.currentPage=1,this.loadLiveClasses()}previousPage(){this.currentPage>1&&this.currentPage--}nextPage(){this.currentPage<this.totalPages&&this.currentPage++}getStatusText(t){return{scheduled:"\u0645\u062C\u062F\u0648\u0644\u0629",ongoing:"\u062C\u0627\u0631\u064A\u0629",completed:"\u0645\u0643\u062A\u0645\u0644\u0629",cancelled:"\u0645\u0644\u063A\u0627\u0629"}[t]||t}getStatusClass(t){return t}getAttendanceStatus(t,e){if(!t.attendance)return"\u0644\u0645 \u064A\u0633\u062C\u0644";let i=t.attendance.find(o=>o.student?._id===e||o.student===e);return i?{present:"\u062D\u0627\u0636\u0631",absent:"\u063A\u0627\u0626\u0628",late:"\u0645\u062A\u0623\u062E\u0631"}[i.status]||i.status:"\u0644\u0645 \u064A\u0633\u062C\u0644"}getAttendanceStatusClass(t,e){if(!t.attendance)return"";let i=t.attendance.find(r=>r.student?._id===e||r.student===e);return i?i.status:""}getAttendanceStatusText(t){return{present:"\u062D\u0627\u0636\u0631",absent:"\u063A\u0627\u0626\u0628",late:"\u0645\u062A\u0623\u062E\u0631"}[t]||t}countAttendance(t,e){return t.attendance?t.attendance.filter(i=>i.status===e).length:0}getTotalStudents(t){return t.class?.students?.length||0}getStudentName(t){return t?typeof t=="object"?t.name||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641":this.allStudents.find(i=>i._id===t)?.name||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641":"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"}formatDate(t){return t?new Date(t).toLocaleDateString("ar-EG",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):""}formatTime(t){return t?new Date(t).toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit",hour12:!0}):""}getAttendanceRateClass(t){return t>=80?"good":t>=60?"warning":"poor"}validateLiveClassForm(){return this.newLiveClass.class?this.newLiveClass.date?this.newLiveClass.startTime?this.newLiveClass.teacher?!0:(alert("\u26A0\uFE0F \u064A\u062C\u0628 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0623\u0633\u062A\u0627\u0630"),!1):(alert("\u26A0\uFE0F \u064A\u062C\u0628 \u062A\u062D\u062F\u064A\u062F \u0648\u0642\u062A \u0627\u0644\u0628\u062F\u0627\u064A\u0629"),!1):(alert("\u26A0\uFE0F \u064A\u062C\u0628 \u062A\u062D\u062F\u064A\u062F \u0627\u0644\u062A\u0627\u0631\u064A\u062E"),!1):(alert("\u26A0\uFE0F \u064A\u062C\u0628 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u062D\u0635\u0629"),!1)}resetNewLiveClass(){this.newLiveClass={class:"",date:"",startTime:"",endTime:"",teacher:"",classroom:"",status:"scheduled",notes:""}}static \u0275fac=function(e){return new(e||n)(Ne(pn))};static \u0275cmp=nn({type:n,selectors:[["app-live-class"]],decls:59,vars:13,consts:[["createForm","ngForm"],["editForm","ngForm"],["attendanceForm","ngForm"],["dir","rtl",1,"live-class-container"],[1,"header"],[1,"fas","fa-video"],[1,"header-actions"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"btn","btn-secondary",3,"click"],[1,"fas","fa-sync-alt"],[1,"filters-section","card"],[1,"card-header"],[1,"fas","fa-filter"],[1,"card-body"],[1,"filter-row"],[1,"filter-group"],["for","statusFilter"],["id","statusFilter",1,"form-control",3,"ngModelChange","change","ngModel"],["value",""],["value","scheduled"],["value","ongoing"],["value","completed"],["value","cancelled"],["for","dateFilter"],["type","date","id","dateFilter",1,"form-control",3,"ngModelChange","change","ngModel"],["for","classFilter"],["id","classFilter",1,"form-control",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],["for","teacherFilter"],["id","teacherFilter",1,"form-control",3,"ngModelChange","change","ngModel"],["class","create-form-section card",4,"ngIf"],[1,"live-classes-list"],["class","loading-state",4,"ngIf"],["class","empty-state",4,"ngIf"],["class","live-class-card card",4,"ngFor","ngForOf"],["class","modal-overlay",3,"click",4,"ngIf"],["class","pagination",4,"ngIf"],[3,"value"],[1,"create-form-section","card"],[1,"fas","fa-plus-circle"],[3,"ngSubmit"],[1,"form-row"],[1,"form-group"],["for","createClass"],[1,"required"],["id","createClass","name","class","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","createDate"],["type","date","id","createDate","name","date","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","createStartTime"],["type","time","id","createStartTime","name","startTime","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","createEndTime"],["type","time","id","createEndTime","name","endTime",1,"form-control",3,"ngModelChange","ngModel"],["for","createTeacher"],["id","createTeacher","name","teacher","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","createClassroom"],["id","createClassroom","name","classroom",1,"form-control",3,"ngModelChange","ngModel"],["for","createStatus"],["id","createStatus","name","status",1,"form-control",3,"ngModelChange","ngModel"],["for","createNotes"],["id","createNotes","name","notes","rows","3","placeholder","\u0623\u062F\u062E\u0644 \u0623\u064A \u0645\u0644\u0627\u062D\u0638\u0627\u062A \u0625\u0636\u0627\u0641\u064A\u0629...",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-actions"],["type","submit",1,"btn","btn-success",3,"disabled"],[1,"fas","fa-save"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-times"],[1,"loading-state"],[1,"spinner"],[1,"spinner-circle"],[1,"empty-state"],[1,"fas","fa-calendar-times"],[1,"live-class-card","card"],[1,"card-header",3,"ngClass"],[1,"header-content"],[1,"class-info"],[1,"class-title"],[1,"class-subtitle"],[1,"subject-badge"],[1,"status-badge"],[1,"class-actions"],[1,"btn-action",3,"click"],[1,"fas",3,"ngClass"],[1,"fas","fa-clipboard-check"],[1,"fas","fa-edit"],[1,"btn-action","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"class-meta"],[1,"meta-item"],[1,"fas","fa-calendar"],[1,"fas","fa-clock"],[1,"fas","fa-chalkboard-teacher"],[1,"fas","fa-door-open"],["class","card-body",4,"ngIf"],["class","edit-section",4,"ngIf"],["class","details-section",4,"ngIf"],[1,"edit-section"],["for","editStatus"],["id","editStatus","name","status",1,"form-control",3,"ngModelChange","ngModel"],["for","editEndTime"],["type","time","id","editEndTime","name","endTime",1,"form-control",3,"ngModelChange","ngModel"],["for","editNotes"],["id","editNotes","name","notes","rows","2",1,"form-control",3,"ngModelChange","ngModel"],[1,"edit-actions"],["type","submit",1,"btn","btn-primary"],[1,"fas","fa-check"],[1,"details-section"],[1,"details-row"],[1,"detail-item"],[1,"fas","fa-info-circle"],[1,"fas","fa-users"],[1,"attendance-stats"],[1,"stat-box","present"],[1,"stat-count"],[1,"stat-label"],[1,"stat-box","absent"],[1,"stat-box","late"],[1,"stat-box","total"],[1,"quick-actions"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-robot"],[1,"btn","btn-info",3,"click"],[1,"fas","fa-chart-bar"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-file-excel"],["class","students-section",4,"ngIf"],["class","load-students-btn",4,"ngIf"],[1,"students-section"],[1,"fas","fa-user-graduate"],[1,"table-container"],[1,"students-table"],[4,"ngFor","ngForOf"],[1,"status-badge",3,"ngClass"],[1,"action-buttons"],[1,"btn-sm","btn-success",3,"click"],[1,"btn-sm","btn-danger",3,"click"],[1,"btn-sm","btn-warning",3,"click"],[1,"load-students-btn"],[1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-user-friends"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],[1,"modal-body"],[1,"quick-attendance-form"],["for","studentSelect"],["id","studentSelect","name","studentId","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","statusSelect"],["id","statusSelect","name","status","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","present"],["value","absent"],["value","late"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","current-attendance",4,"ngIf"],[1,"modal-footer"],[1,"current-attendance"],[1,"attendance-table"],[1,"modal-content","modal-lg",3,"click"],[4,"ngIf"],["class","btn btn-success",3,"click",4,"ngIf"],[1,"report-header"],[1,"report-summary"],[1,"summary-item"],[1,"summary-value"],[1,"summary-label"],[1,"report-table"],[1,"progress-bar-container"],[1,"progress-bar",3,"ngClass"],[1,"pagination"],[1,"page-btn",3,"click","disabled"],[1,"fas","fa-chevron-right"],[1,"page-info"],[1,"fas","fa-chevron-left"]],template:function(e,i){e&1&&(s(0,"div",3)(1,"div",4)(2,"h2"),b(3,"i",5),u(4," \u0646\u0638\u0627\u0645 \u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u062D\u064A\u0629"),a(),s(5,"div",6)(6,"button",7),I("click",function(){return i.showCreateForm=!i.showCreateForm}),b(7,"i",8),u(8," \u0625\u0646\u0634\u0627\u0621 \u062D\u0635\u0629 \u062C\u062F\u064A\u062F\u0629 "),a(),s(9,"button",9),I("click",function(){return i.loadLiveClasses()}),b(10,"i",10),u(11," \u062A\u062D\u062F\u064A\u062B "),a()()(),s(12,"div",11)(13,"div",12)(14,"h5"),b(15,"i",13),u(16," \u062A\u0635\u0641\u064A\u0629 \u0627\u0644\u062D\u0635\u0635"),a()(),s(17,"div",14)(18,"div",15)(19,"div",16)(20,"label",17),u(21,"\u0627\u0644\u062D\u0627\u0644\u0629:"),a(),s(22,"select",18),ye("ngModelChange",function(o){return Ce(i.filters.status,o)||(i.filters.status=o),o}),I("change",function(){return i.applyFilters()}),s(23,"option",19),u(24,"\u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0627\u0644\u0627\u062A"),a(),s(25,"option",20),u(26,"\u0645\u062C\u062F\u0648\u0644\u0629"),a(),s(27,"option",21),u(28,"\u062C\u0627\u0631\u064A\u0629"),a(),s(29,"option",22),u(30,"\u0645\u0643\u062A\u0645\u0644\u0629"),a(),s(31,"option",23),u(32,"\u0645\u0644\u063A\u0627\u0629"),a()()(),s(33,"div",16)(34,"label",24),u(35,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E:"),a(),s(36,"input",25),ye("ngModelChange",function(o){return Ce(i.filters.date,o)||(i.filters.date=o),o}),I("change",function(){return i.applyFilters()}),a()(),s(37,"div",16)(38,"label",26),u(39,"\u0627\u0644\u062D\u0635\u0629:"),a(),s(40,"select",27),ye("ngModelChange",function(o){return Ce(i.filters.class,o)||(i.filters.class=o),o}),I("change",function(){return i.applyFilters()}),s(41,"option",19),u(42,"\u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0635\u0635"),a(),j(43,NW,2,3,"option",28),a()(),s(44,"div",16)(45,"label",29),u(46,"\u0627\u0644\u0623\u0633\u062A\u0627\u0630:"),a(),s(47,"select",30),ye("ngModelChange",function(o){return Ce(i.filters.teacher,o)||(i.filters.teacher=o),o}),I("change",function(){return i.applyFilters()}),s(48,"option",19),u(49,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629"),a(),j(50,UW,2,2,"option",28),a()()()()(),j(51,HW,72,12,"div",31),s(52,"div",32),j(53,zW,5,0,"div",33)(54,jW,6,0,"div",34)(55,ZW,39,11,"div",35),a(),j(56,eG,39,6,"div",36)(57,oG,15,3,"div",36)(58,sG,9,4,"div",37),a()),e&2&&(d(22),ve("ngModel",i.filters.status),d(14),ve("ngModel",i.filters.date),d(4),ve("ngModel",i.filters.class),d(3),w("ngForOf",i.allClasses),d(4),ve("ngModel",i.filters.teacher),d(3),w("ngForOf",i.teachers),d(),w("ngIf",i.showCreateForm),d(2),w("ngIf",i.loading),d(),w("ngIf",!i.loading&&i.liveClasses.length===0),d(),w("ngForOf",i.liveClasses),d(),w("ngIf",i.showAttendanceModal&&i.selectedLiveClass),d(),w("ngIf",i.showReportModal&&i.attendanceReport),d(),w("ngIf",i.liveClasses.length>0))},dependencies:[hn,Bo,Nn,An,Un,Ti,Di,Pi,Yn,di,ii,Ai,$i,ti,mr],styles:[".live-class-container[_ngcontent-%COMP%]{padding:20px;max-width:1400px;margin:0 auto}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px;padding-bottom:16px;border-bottom:2px solid #e9ecef}.header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;margin:0;font-size:28px}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.filters-section[_ngcontent-%COMP%]{margin-bottom:24px;background:#f8f9fa;border:1px solid #dee2e6}.filter-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:16px;margin-top:12px}.filter-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:6px;font-weight:600;color:#495057}.create-form-section[_ngcontent-%COMP%]{margin-bottom:24px;animation:_ngcontent-%COMP%_slideDown .3s ease}@keyframes _ngcontent-%COMP%_slideDown{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:16px;margin-bottom:16px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:6px;font-weight:600;color:#495057}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   .required[_ngcontent-%COMP%]{color:#dc3545}.form-control[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #ced4da;border-radius:6px;font-size:14px;transition:border-color .15s ease-in-out}.form-control[_ngcontent-%COMP%]:focus{border-color:#3498db;outline:0;box-shadow:0 0 0 3px #3498db1a}.form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:20px;padding-top:16px;border-top:1px solid #dee2e6}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:6px;font-size:14px;font-weight:600;cursor:pointer;transition:all .3s ease;display:inline-flex;align-items:center;justify-content:center;gap:8px}.btn-primary[_ngcontent-%COMP%]{background-color:#3498db;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#2980b9}.btn-secondary[_ngcontent-%COMP%]{background-color:#95a5a6;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#7f8c8d}.btn-success[_ngcontent-%COMP%]{background-color:#27ae60;color:#fff}.btn-success[_ngcontent-%COMP%]:hover{background-color:#219653}.btn-danger[_ngcontent-%COMP%]{background-color:#e74c3c;color:#fff}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c0392b}.btn-warning[_ngcontent-%COMP%]{background-color:#f39c12;color:#fff}.btn-warning[_ngcontent-%COMP%]:hover{background-color:#d68910}.btn-info[_ngcontent-%COMP%]{background-color:#17a2b8;color:#fff}.btn-info[_ngcontent-%COMP%]:hover{background-color:#138496}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:12px}.btn-outline-primary[_ngcontent-%COMP%]{background-color:transparent;border:2px solid #3498db;color:#3498db}.btn-outline-primary[_ngcontent-%COMP%]:hover{background-color:#3498db;color:#fff}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:40px;color:#6c757d}.spinner[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;margin-bottom:16px}.spinner-circle[_ngcontent-%COMP%]{width:100%;height:100%;border:4px solid #f3f3f3;border-top:4px solid #3498db;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;background:#f8f9fa;border-radius:8px;border:2px dashed #dee2e6}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:48px;color:#95a5a6;margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#495057;margin-bottom:8px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d}.live-class-card[_ngcontent-%COMP%]{margin-bottom:20px;border:1px solid #dee2e6;border-radius:8px;overflow:hidden;transition:transform .3s ease,box-shadow .3s ease}.live-class-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 4px 12px #0000001a}.card-header.scheduled[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff3cd,#ffeaa7)}.card-header.ongoing[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d1ecf1,#a2d9ce)}.card-header.completed[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d4edda,#a8e6cf)}.card-header.cancelled[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8d7da,#f5b7b1)}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.class-title[_ngcontent-%COMP%]{margin:0;color:#2c3e50;font-size:20px}.class-subtitle[_ngcontent-%COMP%]{display:flex;gap:8px;margin-top:8px}.subject-badge[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;padding:4px 12px;border-radius:20px;font-size:12px;font-weight:600}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:20px;font-size:12px;font-weight:600}.status-badge.scheduled[_ngcontent-%COMP%]{background-color:#ffc107;color:#212529}.status-badge.ongoing[_ngcontent-%COMP%]{background-color:#17a2b8;color:#fff}.status-badge.completed[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.status-badge.cancelled[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.class-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.btn-action[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;border:none;background-color:#ffffffe6;color:#495057;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center}.btn-action[_ngcontent-%COMP%]:hover{background-color:#fff;transform:scale(1.1)}.btn-action.btn-danger[_ngcontent-%COMP%]{color:#dc3545}.btn-action.btn-danger[_ngcontent-%COMP%]:hover{background-color:#dc3545;color:#fff}.class-meta[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px;font-size:14px;color:#495057}.meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:6px}.meta-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#6c757d}.details-section[_ngcontent-%COMP%]{padding:20px}.details-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px}.detail-item[_ngcontent-%COMP%]{background:#f8f9fa;padding:16px;border-radius:6px;border:1px solid #e9ecef}.detail-item[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;margin-bottom:12px;color:#495057}.attendance-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}.stat-box[_ngcontent-%COMP%]{text-align:center;padding:12px;border-radius:6px;color:#fff}.stat-box.present[_ngcontent-%COMP%]{background-color:#28a745}.stat-box.absent[_ngcontent-%COMP%]{background-color:#dc3545}.stat-box.late[_ngcontent-%COMP%]{background-color:#ffc107;color:#212529}.stat-box.total[_ngcontent-%COMP%]{background-color:#17a2b8}.stat-count[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin-bottom:4px}.stat-label[_ngcontent-%COMP%]{font-size:12px;opacity:.9}.quick-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:24px}.students-section[_ngcontent-%COMP%]{margin-top:24px}.table-container[_ngcontent-%COMP%]{overflow-x:auto;margin-top:12px}.students-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;background:#fff}.students-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .students-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:right;border:1px solid #dee2e6}.students-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;font-weight:600;color:#495057;position:sticky;top:0}.students-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:4px}.load-students-btn[_ngcontent-%COMP%]{text-align:center;margin-top:20px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:8px;max-width:800px;width:90%;max-height:80vh;overflow-y:auto;animation:_ngcontent-%COMP%_slideUp .3s ease}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.modal-content.modal-lg[_ngcontent-%COMP%]{max-width:1000px}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #dee2e6}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;color:#2c3e50}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:20px;color:#6c757d;cursor:pointer;padding:8px;border-radius:50%;transition:all .3s ease}.modal-close[_ngcontent-%COMP%]:hover{background-color:#f8f9fa;color:#dc3545}.modal-body[_ngcontent-%COMP%]{padding:20px}.modal-footer[_ngcontent-%COMP%]{padding:20px;border-top:1px solid #dee2e6;text-align:left}.quick-attendance-form[_ngcontent-%COMP%]{margin-bottom:24px}.quick-attendance-form[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin-bottom:16px;color:#495057}.attendance-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.attendance-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .attendance-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:10px;text-align:right;border-bottom:1px solid #dee2e6}.attendance-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;font-weight:600;color:#495057}.report-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:24px}.report-summary[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:24px}.summary-item[_ngcontent-%COMP%]{text-align:center;padding:16px;background:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}.summary-value[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#3498db;margin-bottom:4px}.summary-label[_ngcontent-%COMP%]{font-size:12px;color:#6c757d;text-transform:uppercase;letter-spacing:1px}.report-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.report-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .report-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;text-align:right;border:1px solid #dee2e6}.report-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f8f9fa;font-weight:600;color:#495057;position:sticky;top:0}.progress-bar-container[_ngcontent-%COMP%]{height:24px;background-color:#e9ecef;border-radius:4px;overflow:hidden}.progress-bar[_ngcontent-%COMP%]{height:100%;text-align:center;color:#fff;font-size:12px;line-height:24px;transition:width .3s ease}.progress-bar.good[_ngcontent-%COMP%]{background-color:#28a745}.progress-bar.warning[_ngcontent-%COMP%]{background-color:#ffc107}.progress-bar.poor[_ngcontent-%COMP%]{background-color:#dc3545}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;gap:16px;margin-top:32px;padding-top:20px;border-top:1px solid #dee2e6}.page-btn[_ngcontent-%COMP%]{padding:10px 20px;background-color:#3498db;color:#fff;border:none;border-radius:6px;cursor:pointer;transition:all .3s ease}.page-btn[_ngcontent-%COMP%]:disabled{background-color:#bdc3c7;cursor:not-allowed}.page-info[_ngcontent-%COMP%]{color:#6c757d;font-weight:600}@media (max-width: 768px){.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.header-actions[_ngcontent-%COMP%]{width:100%}.filter-row[_ngcontent-%COMP%], .form-row[_ngcontent-%COMP%], .details-row[_ngcontent-%COMP%]{grid-template-columns:1fr}.attendance-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.quick-actions[_ngcontent-%COMP%]{flex-direction:column}.report-summary[_ngcontent-%COMP%]{grid-template-columns:1fr}.modal-content[_ngcontent-%COMP%]{width:95%;margin:10px}}"]})};$();$();var j1=class n{constructor(t,e){this.http=t;this.authService=e}apiUrl=Bt.apiUrl||"/api";getClasses(){return this.http.get(`${this.apiUrl}/classes`,{headers:this.authService.getAuthHeaders()})}getClassById(t){return this.http.get(`${this.apiUrl}/classes/${t}`,{headers:this.authService.getAuthHeaders()})}createClass(t){return this.http.post(`${this.apiUrl}/classes`,t,{headers:this.authService.getAuthHeaders()})}updateClass(t,e){return this.http.put(`${this.apiUrl}/classes/${t}`,e,{headers:this.authService.getAuthHeaders()})}deleteClass(t){return this.http.delete(`${this.apiUrl}/classes/${t}`,{headers:this.authService.getAuthHeaders()})}enrollStudent(t,e){return this.http.post(`${this.apiUrl}/classes/${t}/enroll/${e}`,{},{headers:this.authService.getAuthHeaders()})}unenrollStudent(t,e){return this.http.delete(`${this.apiUrl}/classes/${t}/unenroll/${e}`,{headers:this.authService.getAuthHeaders()})}getAvailableClasses(t,e){let i=`${this.apiUrl}/classes/available`,r={};return t&&(r.academicYear=t),e&&(r.studentId=e),this.http.get(i,{params:r,headers:this.authService.getAuthHeaders()})}getAvailableClassesForStudent(t,e){return this.http.get(`${this.apiUrl}/classes/available/${t}?studentId=${e}`,{headers:this.authService.getAuthHeaders()})}addStudentToClass(t,e){return this.http.post(`${this.apiUrl}/classes/${t}/enroll/${e}`,{},{headers:this.authService.getAuthHeaders()})}static \u0275fac=function(e){return new(e||n)(We(pn),We(qn))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})};$();var W1=class n{constructor(t,e){this.http=t;this.authService=e}apiUrl=Bt.apiUrl;getLiveClasses(t){let e=`${this.apiUrl}/live-classes`;if(t){let i=new URLSearchParams;t.status&&i.append("status",t.status),t.date&&i.append("date",t.date),e+=`?${i.toString()}`}return this.http.get(e,{headers:this.authService.getAuthHeaders()})}getLiveClassById(t){return this.http.get(`${this.apiUrl}/live-classes/${t}`,{headers:this.authService.getAuthHeaders()})}createLiveClass(t){return this.http.post(`${this.apiUrl}/live-classes`,t,{headers:this.authService.getAuthHeaders()})}updateLiveClass(t,e){return this.http.put(`${this.apiUrl}/live-classes/${t}`,e,{headers:this.authService.getAuthHeaders()})}recordAttendance(t,e){return this.http.post(`${this.apiUrl}/live-classes/${t}/attendance`,e,{headers:this.authService.getAuthHeaders()})}startLiveClass(t){return this.http.put(`${this.apiUrl}/live-classes/${t}`,{status:"ongoing"},{headers:this.authService.getAuthHeaders()})}endLiveClass(t,e){let i={status:"completed"};return e&&(i.endTime=e),this.http.put(`${this.apiUrl}/live-classes/${t}`,i,{headers:this.authService.getAuthHeaders()})}cancelLiveClass(t){return this.http.put(`${this.apiUrl}/live-classes/${t}`,{status:"cancelled"},{headers:this.authService.getAuthHeaders()})}getClassAttendance(t){return this.http.get(`${this.apiUrl}/live-classes/class/${t}/attendance`,{headers:this.authService.getAuthHeaders()})}autoMarkAbsent(t){return this.http.post(`${this.apiUrl}/live-classes/${t}/auto-mark-absent`,{},{headers:this.authService.getAuthHeaders()})}static \u0275fac=function(e){return new(e||n)(We(pn),We(qn))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})};var uG=["fileInput"];function cG(n,t){if(n&1&&(s(0,"option",93),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),B(e)}}function dG(n,t){n&1&&(s(0,"tr")(1,"td",94)(2,"div",95),b(3,"i",96),u(4," \u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644... "),a()()())}function fG(n,t){n&1&&(s(0,"tr")(1,"td",97),b(2,"i",98),u(3," \u0644\u0627 \u062A\u0648\u062C\u062F \u0646\u062A\u0627\u0626\u062C "),a()())}function hG(n,t){if(n&1&&(s(0,"span",109),u(1),a()),n&2){let e=t.$implicit;d(),H(" ",e," ")}}function pG(n,t){if(n&1){let e=he();s(0,"tr",99),I("click",function(){let r=F(e).$implicit,o=E();return R(o.selectTeacher(r))}),s(1,"td"),u(2),a(),s(3,"td",100)(4,"strong"),u(5),a()(),s(6,"td"),j(7,hG,2,1,"span",101),a(),s(8,"td"),u(9),a(),s(10,"td"),u(11),a(),s(12,"td"),u(13),a(),s(14,"td")(15,"span",102),u(16),a()(),s(17,"td",103)(18,"button",104),I("click",function(r){let o=F(e).$implicit;return E().openEditModal(o),R(r.stopPropagation())}),b(19,"i",81),a(),s(20,"button",105),I("click",function(r){let o=F(e).$implicit;return E().toggleTeacherStatus(o),R(r.stopPropagation())}),b(21,"i",106),a(),s(22,"button",107),I("click",function(r){let o=F(e).$implicit;return E().openDeleteModal(o),R(r.stopPropagation())}),b(23,"i",108),a()()()}if(n&2){let e=t.$implicit,i=t.index,r=E();Ie("selected",(r.selectedTeacher==null?null:r.selectedTeacher._id)===e._id),d(2),B((r.currentPage-1)*r.itemsPerPage+i+1),d(3),B(e.name),d(2),w("ngForOf",e.subjects),d(2),B(e.phone||"\u063A\u064A\u0631 \u0645\u062A\u0648\u0641\u0631"),d(2),B(e.email||"\u063A\u064A\u0631 \u0645\u062A\u0648\u0641\u0631"),d(2),B(r.formatDate(e.hireDate)),d(2),Ie("active",r.isTeacherActive(e))("inactive",!r.isTeacherActive(e)),d(),H(" ",r.getTeacherStatus(e)," "),d(4),Hy("title",r.isTeacherActive(e)?"\u062A\u0639\u0637\u064A\u0644":"\u062A\u0641\u0639\u064A\u0644"),d(),Ie("fa-user-slash",r.isTeacherActive(e))("fa-user-check",!r.isTeacherActive(e))}}function mG(n,t){if(n&1){let e=he();s(0,"div",110)(1,"button",111),I("click",function(){F(e);let r=E();return R(r.prevPage())}),b(2,"i",112),u(3," \u0627\u0644\u0633\u0627\u0628\u0642 "),a(),s(4,"span",113),u(5),a(),s(6,"button",111),I("click",function(){F(e);let r=E();return R(r.nextPage())}),u(7," \u0627\u0644\u062A\u0627\u0644\u064A "),b(8,"i",114),a()()}if(n&2){let e=E();d(),w("disabled",e.currentPage===1),d(4),Gn(" \u0627\u0644\u0635\u0641\u062D\u0629 ",e.currentPage," \u0645\u0646 ",e.totalPages," "),d(),w("disabled",e.currentPage===e.totalPages)}}function gG(n,t){if(n&1&&(s(0,"div",143)(1,"div",144)(2,"strong"),u(3),a(),s(4,"small",120),u(5),a()(),s(6,"span",145),u(7),a()()),n&2){let e=t.$implicit,i=E(3);d(3),B(e.name),d(2),B(e.subject),d(2),H("",i.calculateClassesstudentlenght(e.students)||0," \u0637\u0627\u0644\u0628")}}function _G(n,t){if(n&1){let e=he();s(0,"button",146),I("click",function(){F(e);let r=E(3);return R(r.showClassesModal=!0)}),u(1," \u0639\u0631\u0636 \u0627\u0644\u0645\u0632\u064A\u062F "),b(2,"i",114),a()}}function vG(n,t){if(n&1&&(s(0,"div",140),j(1,gG,8,3,"div",141)(2,_G,3,0,"button",142),a()),n&2){let e=E(2);d(),w("ngForOf",e.teacherClasses.slice(0,5)),d(),w("ngIf",e.teacherClasses.length>5)}}function yG(n,t){n&1&&(s(0,"div",147),b(1,"i",40),s(2,"p"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u062D\u0635\u0635 \u0645\u0633\u0646\u062F\u0629"),a()())}function xG(n,t){if(n&1){let e=he();s(0,"div",115)(1,"div",116)(2,"div",117)(3,"div",118),b(4,"i",119),a(),s(5,"div",100)(6,"h4"),u(7),a(),s(8,"p",120),u(9,"\u0623\u0633\u062A\u0627\u0630"),a()()(),s(10,"div",121)(11,"div",122),b(12,"i",123),s(13,"span")(14,"strong"),u(15,"\u0627\u0644\u0645\u0648\u0627\u062F:"),a(),u(16),a()(),s(17,"div",122),b(18,"i",124),s(19,"span")(20,"strong"),u(21,"\u0627\u0644\u0647\u0627\u062A\u0641:"),a(),u(22),a()(),s(23,"div",122),b(24,"i",125),s(25,"span")(26,"strong"),u(27,"\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A:"),a(),u(28),a()(),s(29,"div",122),b(30,"i",42),s(31,"span")(32,"strong"),u(33,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062A\u0639\u064A\u064A\u0646:"),a(),u(34),a()(),s(35,"div",122),b(36,"i",38),s(37,"span")(38,"strong"),u(39,"\u0627\u0644\u062D\u0627\u0644\u0629:"),a(),s(40,"span",102),u(41),a()()()()(),s(42,"div",126)(43,"h5"),u(44,"\u0627\u0644\u0625\u062D\u0635\u0627\u0626\u064A\u0627\u062A"),a(),s(45,"div",127)(46,"div",128)(47,"div",129),u(48),a(),s(49,"div",130),u(50,"\u0639\u062F\u062F \u0627\u0644\u062D\u0635\u0635"),a()(),s(51,"div",128)(52,"div",129),u(53),a(),s(54,"div",130),u(55,"\u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628"),a()(),s(56,"div",128)(57,"div",129),u(58),a(),s(59,"div",130),u(60,"\u062D\u0635\u0635 \u062D\u064A\u0629"),a()(),s(61,"div",128)(62,"div",129),u(63),a(),s(64,"div",130),u(65,"\u062D\u0635\u0635 \u0647\u0630\u0627 \u0627\u0644\u0634\u0647\u0631"),a()()()(),s(66,"div",131)(67,"div",132)(68,"h5"),u(69,"\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u0633\u0646\u062F\u0629"),a(),s(70,"span",133),u(71),a()(),j(72,vG,3,2,"div",134)(73,yG,4,0,"ng-template",null,2,FS),a(),s(75,"div",135)(76,"h5"),u(77,"\u0625\u062C\u0631\u0627\u0621\u0627\u062A \u0633\u0631\u064A\u0639\u0629"),a(),s(78,"div",136)(79,"button",137),I("click",function(){F(e);let r=E();return R(r.openEditModal(r.selectedTeacher))}),b(80,"i",81),u(81," \u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A "),a(),s(82,"button",138),I("click",function(){F(e);let r=E();return R(r.toggleTeacherStatus(r.selectedTeacher))}),b(83,"i",106),u(84),a(),s(85,"button",139),I("click",function(){F(e);let r=E();return R(r.openDeleteModal(r.selectedTeacher))}),b(86,"i",108),u(87," \u062D\u0630\u0641 "),a()()()()}if(n&2){let e=gc(74),i=E();d(7),B(i.selectedTeacher.name),d(9),H(" ",i.getSubjectsText(i.selectedTeacher.subjects),""),d(6),H(" ",i.selectedTeacher.phone||"\u063A\u064A\u0631 \u0645\u062A\u0648\u0641\u0631",""),d(6),H(" ",i.selectedTeacher.email||"\u063A\u064A\u0631 \u0645\u062A\u0648\u0641\u0631",""),d(6),H(" ",i.formatDate(i.selectedTeacher.hireDate),""),d(6),Ie("active",i.isTeacherActive(i.selectedTeacher)),d(),H(" ",i.getTeacherStatus(i.selectedTeacher)," "),d(7),B(i.teacherStats.totalClasses),d(5),B(i.teacherStats.totalStudents),d(5),B(i.teacherStats.totalLiveClasses),d(5),B(i.teacherStats.thisMonthClasses),d(8),B(i.teacherClasses.length),d(),w("ngIf",i.teacherClasses.length>0)("ngIfElse",e),d(11),Ie("fa-user-slash",i.isTeacherActive(i.selectedTeacher))("fa-user-check",!i.isTeacherActive(i.selectedTeacher)),d(),H(" ",i.isTeacherActive(i.selectedTeacher)?"\u062A\u0639\u0637\u064A\u0644":"\u062A\u0641\u0639\u064A\u0644"," ")}}function bG(n,t){if(n&1){let e=he();s(0,"div",148)(1,"input",149),I("change",function(){let r=F(e).$implicit,o=E();return R(o.toggleSubject(r,"new"))}),a(),s(2,"label",150),u(3),a()()}if(n&2){let e=t.$implicit,i=E();d(),w("id","new-subject-"+e)("checked",i.isSubjectSelected(e,"new")),d(),w("for","new-subject-"+e),d(),H(" ",e," ")}}function CG(n,t){n&1&&(s(0,"span"),b(1,"i",96),u(2," \u062C\u0627\u0631\u064A \u0627\u0644\u062D\u0641\u0638..."),a())}function EG(n,t){n&1&&(s(0,"span"),u(1,"\u062D\u0641\u0638"),a())}function wG(n,t){if(n&1){let e=he();s(0,"div",148)(1,"input",149),I("change",function(){let r=F(e).$implicit,o=E(2);return R(o.toggleSubject(r,"edit"))}),a(),s(2,"label",150),u(3),a()()}if(n&2){let e=t.$implicit,i=E(2);d(),w("id","edit-subject-"+e)("checked",i.isSubjectSelected(e,"edit")),d(),w("for","edit-subject-"+e),d(),H(" ",e," ")}}function SG(n,t){if(n&1){let e=he();s(0,"form",64,3),I("ngSubmit",function(){F(e);let r=E();return R(r.editTeacher())}),s(2,"div",65)(3,"label",151),u(4,"\u0627\u0633\u0645 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 *"),a(),s(5,"input",152),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.editTeacherData.name,r)||(o.editTeacherData.name=r),R(r)}),a()(),s(6,"div",65)(7,"label"),u(8,"\u0627\u0644\u0645\u0648\u0627\u062F *"),a(),s(9,"div",68),j(10,wG,4,4,"div",69),a()(),s(11,"div",17)(12,"div",70)(13,"div",65)(14,"label",153),u(15,"\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062A\u0641"),a(),s(16,"input",154),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.editTeacherData.phone,r)||(o.editTeacherData.phone=r),R(r)}),a()()(),s(17,"div",70)(18,"div",65)(19,"label",155),u(20,"\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"),a(),s(21,"input",156),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.editTeacherData.email,r)||(o.editTeacherData.email=r),R(r)}),a()()()(),s(22,"div",65)(23,"label",157),u(24,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062A\u0639\u064A\u064A\u0646"),a(),s(25,"input",158),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.editTeacherData.hireDate,r)||(o.editTeacherData.hireDate=r),R(r)}),a()(),s(26,"div",65)(27,"div",159)(28,"input",160),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.editTeacherData.active,r)||(o.editTeacherData.active=r),R(r)}),a(),s(29,"label",161),u(30," \u0623\u0633\u062A\u0627\u0630 \u0646\u0634\u0637 "),a()()()()}if(n&2){let e=E();d(5),ve("ngModel",e.editTeacherData.name),d(5),w("ngForOf",e.subjectsList),d(6),ve("ngModel",e.editTeacherData.phone),d(5),ve("ngModel",e.editTeacherData.email),d(4),ve("ngModel",e.editTeacherData.hireDate),d(3),ve("ngModel",e.editTeacherData.active)}}function MG(n,t){n&1&&(s(0,"span"),b(1,"i",96),u(2," \u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u062F\u064A\u062B..."),a())}function AG(n,t){n&1&&(s(0,"span"),u(1,"\u062A\u062D\u062F\u064A\u062B"),a())}function TG(n,t){if(n&1&&(s(0,"p"),u(1," \u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 "),s(2,"strong"),u(3),a(),u(4,"\u061F "),a()),n&2){let e=E();d(3),B(e.selectedTeacher.name)}}function DG(n,t){n&1&&(s(0,"span"),b(1,"i",96),u(2," \u062C\u0627\u0631\u064A \u0627\u0644\u062D\u0630\u0641..."),a())}function PG(n,t){n&1&&(s(0,"span"),u(1,"\u062D\u0630\u0641"),a())}function IG(n,t){if(n&1&&(s(0,"small",163),u(1),a()),n&2){let e=t.$implicit;d(),Gn(" ",e.day," ",e.time," ")}}function OG(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td"),u(6),a(),s(7,"td"),u(8),a(),s(9,"td"),j(10,IG,2,2,"small",162),a()()),n&2){let e=t.$implicit;d(2),B(e.name),d(2),B(e.subject),d(2),B(e.students.length||0),d(2),B(e.academicYear||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(2),w("ngForOf",e.schedule)}}function FG(n,t){n&1&&(s(0,"div",164)(1,"div",165)(2,"span",166),u(3,"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644..."),a()()())}var G1=class n{constructor(t,e,i,r,o){this.teachersService=t;this.classesService=e;this.liveClassesService=i;this.lessonsService=r;this.authService=o}teachers=[];classes=[];liveClasses=[];teacherClasses=[];teacherLiveClasses=[];selectedTeacher=null;selectedTeacherId="";newTeacher={name:"",subjects:[],phone:"",email:"",hireDate:new Date().toISOString().split("T")[0],active:!0};editTeacherData={};searchTerm="";subjectFilter="";statusFilter="all";subjectsList=["\u0631\u064A\u0627\u0636\u064A\u0627\u062A","\u0641\u064A\u0632\u064A\u0627\u0621","\u0639\u0644\u0648\u0645","\u0644\u063A\u0629 \u0639\u0631\u0628\u064A\u0629","\u0644\u063A\u0629 \u0641\u0631\u0646\u0633\u064A\u0629","\u0644\u063A\u0629 \u0627\u0646\u062C\u0644\u064A\u0632\u064A\u0629","\u062A\u0627\u0631\u064A\u062E","\u062C\u063A\u0631\u0627\u0641\u064A\u0627","\u0641\u0644\u0633\u0641\u0629","\u0625\u0639\u0644\u0627\u0645 \u0622\u0644\u064A"];isLoading=!1;showAddModal=!1;showEditModal=!1;showDetailsModal=!1;showConfirmDeleteModal=!1;showClassesModal=!1;teacherStats={totalClasses:0,totalStudents:0,totalLiveClasses:0,thisMonthClasses:0};currentPage=1;itemsPerPage=10;totalItems=0;fileInput;ngOnInit(){this.loadTeachers(),this.loadClasses(),this.loadLiveClasses()}get activeTeachersCount(){return this.teachers.filter(t=>this.isTeacherActive(t)).length}loadTeachers(){this.isLoading=!0,this.teachersService.getTeachers().subscribe({next:t=>{this.teachers=t,this.totalItems=t.length,this.isLoading=!1},error:t=>{console.error("Error loading teachers:",t),this.isLoading=!1,alert("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629")}})}loadClasses(){this.classesService.getClasses().subscribe({next:t=>{this.classes=t},error:t=>{console.error("Error loading classes:",t)}})}loadLiveClasses(){this.liveClassesService.getLiveClasses().subscribe({next:t=>{this.liveClasses=t},error:t=>{console.error("Error loading live classes:",t)}})}get filteredTeachers(){let t=this.teachers;if(this.searchTerm){let e=this.searchTerm.toLowerCase();t=t.filter(i=>i.name.toLowerCase().includes(e)||i.email?.toLowerCase().includes(e)||i.phone?.includes(e))}return this.subjectFilter&&(t=t.filter(e=>e.subjects.includes(this.subjectFilter))),this.statusFilter==="active"?t=t.filter(e=>e.active===void 0||e.active===!0):this.statusFilter==="inactive"&&(t=t.filter(e=>e.active===!1)),this.totalItems=t.length,t}get paginatedTeachers(){let t=(this.currentPage-1)*this.itemsPerPage;return this.filteredTeachers.slice(t,t+this.itemsPerPage)}nextPage(){this.currentPage<this.totalPages&&this.currentPage++}prevPage(){this.currentPage>1&&this.currentPage--}get totalPages(){return Math.ceil(this.totalItems/this.itemsPerPage)}selectTeacher(t){this.selectedTeacher=t,this.selectedTeacherId=t._id,this.loadTeacherDetails()}loadTeacherDetails(){this.selectedTeacher&&(this.teacherClasses=this.classes.filter(t=>t.teacher&&t.teacher._id===this.selectedTeacherId),this.teacherLiveClasses=this.liveClasses.filter(t=>t.teacher&&t.teacher._id===this.selectedTeacherId),this.calculateTeacherStats())}calculateTeacherStats(){if(!this.selectedTeacher)return;let t=new Date,e=t.getMonth()+1,i=t.getFullYear();this.teacherStats={totalClasses:this.teacherClasses.length,totalStudents:this.teacherClasses.reduce((r,o)=>r+(o.students?o.students.length:0),0),totalLiveClasses:this.teacherLiveClasses.length,thisMonthClasses:this.teacherLiveClasses.filter(r=>{let o=new Date(r.date);return o.getMonth()+1===e&&o.getFullYear()===i}).length}}addTeacher(){this.validateTeacherForm(this.newTeacher)&&(this.isLoading=!0,this.teachersService.createTeacher(this.newTeacher).subscribe({next:t=>{t.existed?(alert("\u0647\u0630\u0627 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 \u0645\u0648\u062C\u0648\u062F \u0628\u0627\u0644\u0641\u0639\u0644 \u0641\u064A \u0627\u0644\u0646\u0638\u0627\u0645"),this.loadTeachers()):(alert("\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 \u0628\u0646\u062C\u0627\u062D"),this.loadTeachers(),this.showAddModal=!1,this.resetNewTeacherForm()),this.isLoading=!1},error:t=>{console.error("Error adding teacher:",t),alert("\u0641\u0634\u0644 \u0641\u064A \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630"),this.isLoading=!1}}))}editTeacher(){!this.selectedTeacher||!this.validateTeacherForm(this.editTeacherData)||(this.isLoading=!0,this.teachersService.updateTeacher(this.selectedTeacher._id,this.editTeacherData).subscribe({next:()=>{alert("\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0623\u0633\u062A\u0627\u0630 \u0628\u0646\u062C\u0627\u062D"),this.loadTeachers(),this.showEditModal=!1,this.isLoading=!1},error:t=>{console.error("Error updating teacher:",t),alert("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u062F\u064A\u062B \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0623\u0633\u062A\u0627\u0630"),this.isLoading=!1}}))}deleteTeacher(){this.selectedTeacher&&(this.isLoading=!0,this.teachersService.deleteTeacher(this.selectedTeacher._id).subscribe({next:()=>{alert("\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 \u0628\u0646\u062C\u0627\u062D"),this.loadTeachers(),this.selectedTeacher=null,this.showConfirmDeleteModal=!1,this.isLoading=!1},error:t=>{console.error("Error deleting teacher:",t),alert("\u0641\u0634\u0644 \u0641\u064A \u062D\u0630\u0641 \u0627\u0644\u0623\u0633\u062A\u0627\u0630"),this.isLoading=!1}}))}toggleTeacherStatus(t){let e=t.active===void 0?!0:t.active,i=St(Oe({},t),{active:!e});this.teachersService.updateTeacher(t._id,i).subscribe({next:()=>{alert(`\u062A\u0645 ${e?"\u062A\u0639\u0637\u064A\u0644":"\u062A\u0641\u0639\u064A\u0644"} \u0627\u0644\u0623\u0633\u062A\u0627\u0630 \u0628\u0646\u062C\u0627\u062D`),this.loadTeachers(),this.selectedTeacher&&this.selectedTeacher._id===t._id&&(this.selectedTeacher.active=!e)},error:r=>{console.error("Error updating teacher status:",r),alert("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u062F\u064A\u062B \u062D\u0627\u0644\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630")}})}validateTeacherForm(t){return t.name.trim()?!t.subjects||t.subjects.length===0?(alert("\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0645\u0627\u062F\u0629 \u0648\u0627\u062D\u062F\u0629 \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644"),!1):t.email&&!this.isValidEmail(t.email)?(alert("\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0628\u0631\u064A\u062F \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A \u0635\u062D\u064A\u062D"),!1):!0:(alert("\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0627\u0633\u0645 \u0627\u0644\u0623\u0633\u062A\u0627\u0630"),!1)}isValidEmail(t){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)}resetNewTeacherForm(){this.newTeacher={name:"",subjects:[],phone:"",email:"",hireDate:new Date().toISOString().split("T")[0],active:!0}}openEditModal(t){this.selectedTeacher=t,this.editTeacherData={name:t.name,subjects:[...t.subjects],phone:t.phone||"",email:t.email||"",hireDate:t.hireDate.split("T")[0],active:t.active===void 0?!0:t.active},this.showEditModal=!0}openDeleteModal(t){this.selectedTeacher=t,this.showConfirmDeleteModal=!0}toggleSubject(t,e){let i=e==="new"?this.newTeacher:this.editTeacherData,r=i.subjects.indexOf(t);r>-1?i.subjects.splice(r,1):i.subjects.push(t)}isSubjectSelected(t,e){return(e==="new"?this.newTeacher:this.editTeacherData).subjects.includes(t)}getSubjectsText(t){return t.join("\u060C ")}formatDate(t){return new Date(t).toLocaleDateString("ar-EG")}isTeacherActive(t){return t.active===void 0||t.active===!0}getTeacherStatus(t){return this.isTeacherActive(t)?"\u0646\u0634\u0637":"\u063A\u064A\u0631 \u0646\u0634\u0637"}exportToCSV(){let t=["\u0627\u0644\u0627\u0633\u0645","\u0627\u0644\u0645\u0648\u0627\u062F","\u0627\u0644\u0647\u0627\u062A\u0641","\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A","\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062A\u0639\u064A\u064A\u0646","\u0627\u0644\u062D\u0627\u0644\u0629"],e=this.filteredTeachers.map(c=>[c.name,c.subjects.join(" - "),c.phone||"\u063A\u064A\u0631 \u0645\u062A\u0648\u0641\u0631",c.email||"\u063A\u064A\u0631 \u0645\u062A\u0648\u0641\u0631",this.formatDate(c.hireDate),this.getTeacherStatus(c)]),i=[t.join(","),...e.map(c=>c.join(","))].join(`
`),r=new Blob(["\uFEFF"+i],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),l=URL.createObjectURL(r);o.setAttribute("href",l),o.setAttribute("download",`\u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629_${new Date().toISOString().split("T")[0]}.csv`),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)}onFileSelected(t){let e=t.target.files[0];if(!e)return;let i=new FileReader;i.onload=r=>{let o=r.target.result;this.processCSV(o)},i.readAsText(e,"UTF-8")}processCSV(t){let i=t.split(`
`)[0].split(",");console.log("Processing CSV file..."),alert("\u0648\u0638\u064A\u0641\u0629 \u0627\u0644\u0627\u0633\u062A\u064A\u0631\u0627\u062F \u0642\u064A\u062F \u0627\u0644\u062A\u0637\u0648\u064A\u0631"),this.fileInput&&(this.fileInput.nativeElement.value="")}clearFilters(){this.searchTerm="",this.subjectFilter="",this.statusFilter="all",this.currentPage=1}calculateClassesstudentlenght(t){return t.students.lenght}static \u0275fac=function(e){return new(e||n)(Ne(rl),Ne(j1),Ne(W1),Ne(il),Ne(qn))};static \u0275cmp=nn({type:n,selectors:[["app-teachers-management"]],viewQuery:function(e,i){if(e&1&&mc(uG,5),e&2){let r;Nl(r=Ul())&&(i.fileInput=r.first)}},decls:230,vars:52,consts:[["fileInput",""],["addForm","ngForm"],["noClasses",""],["editForm","ngForm"],[1,"teachers-management"],[1,"header"],[1,"fas","fa-chalkboard-teacher"],[1,"header-actions"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"btn","btn-secondary",3,"click"],[1,"fas","fa-file-export"],[1,"import-btn"],["type","file","accept",".csv",2,"display","none",3,"change"],[1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-file-import"],[1,"filters-section"],[1,"row"],[1,"col-md-4"],[1,"search-box"],[1,"fas","fa-search"],["type","text","placeholder","\u0628\u062D\u062B \u0628\u0627\u0633\u0645 \u0627\u0644\u0623\u0633\u062A\u0627\u0630\u060C \u0627\u0644\u0647\u0627\u062A\u0641\u060C \u0623\u0648 \u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A...",3,"ngModelChange","input","ngModel"],[1,"col-md-3"],[1,"form-control",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["value","all"],["value","active"],["value","inactive"],[1,"col-md-2"],[1,"btn","btn-clear",3,"click"],[1,"fas","fa-times"],[1,"stats-cards"],[1,"stat-card"],[1,"stat-icon","bg-primary"],[1,"fas","fa-users"],[1,"stat-info"],[1,"stat-icon","bg-success"],[1,"fas","fa-user-check"],[1,"stat-icon","bg-warning"],[1,"fas","fa-chalkboard"],[1,"stat-icon","bg-info"],[1,"fas","fa-calendar-alt"],[1,"table-container"],[1,"table-header"],[1,"total-count"],[1,"table-responsive"],[1,"table","table-hover"],[4,"ngIf"],[3,"selected","click",4,"ngFor","ngForOf"],["class","pagination",4,"ngIf"],[1,"details-sidebar"],[1,"sidebar-header"],[1,"close-btn",3,"click"],["class","sidebar-content",4,"ngIf"],[1,"overlay",3,"click"],[1,"teacher-modal"],[1,"teacher-modal-dialog"],[1,"teacher-modal-content"],[1,"teacher-modal-header"],[1,"teacher-modal-title"],[1,"fas","fa-user-plus"],["type","button",1,"close",3,"click"],[1,"teacher-modal-body"],[3,"ngSubmit"],[1,"form-group"],["for","name"],["type","text","id","name","name","name","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"subjects-checkboxes"],["class","form-check form-check-inline",4,"ngFor","ngForOf"],[1,"col-md-6"],["for","phone"],["type","tel","id","phone","name","phone",1,"form-control",3,"ngModelChange","ngModel"],["for","email"],["type","email","id","email","name","email",1,"form-control",3,"ngModelChange","ngModel"],["for","hireDate"],["type","date","id","hireDate","name","hireDate",1,"form-control",3,"ngModelChange","ngModel"],[1,"teacher-modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"teacher-modal-backdrop",3,"click"],[1,"fas","fa-edit"],[3,"ngSubmit",4,"ngIf"],[1,"teacher-modal-dialog","teacher-modal-sm"],[1,"teacher-modal-title","text-danger"],[1,"fas","fa-exclamation-triangle"],[1,"text-danger"],[1,"fas","fa-exclamation-circle"],["type","button",1,"btn","btn-danger",3,"click","disabled"],[1,"teacher-modal-dialog","teacher-modal-lg"],[1,"table"],[4,"ngFor","ngForOf"],["class","loading-overlay",4,"ngIf"],[3,"value"],["colspan","8",1,"text-center"],[1,"loading-spinner"],[1,"fas","fa-spinner","fa-spin"],["colspan","8",1,"text-center","text-muted"],[1,"fas","fa-info-circle"],[3,"click"],[1,"teacher-name"],["class","subjects-badge",4,"ngFor","ngForOf"],[1,"status-badge"],[1,"actions"],["title","\u062A\u0639\u062F\u064A\u0644",1,"btn","btn-sm","btn-info",3,"click"],[1,"btn","btn-sm","btn-warning",3,"click","title"],[1,"fas"],["title","\u062D\u0630\u0641",1,"btn","btn-sm","btn-danger",3,"click"],[1,"fas","fa-trash"],[1,"subjects-badge"],[1,"pagination"],[1,"btn","btn-outline-secondary",3,"click","disabled"],[1,"fas","fa-chevron-right"],[1,"page-info"],[1,"fas","fa-chevron-left"],[1,"sidebar-content"],[1,"teacher-info-card"],[1,"teacher-header"],[1,"teacher-avatar"],[1,"fas","fa-user-graduate"],[1,"text-muted"],[1,"teacher-details"],[1,"detail-item"],[1,"fas","fa-book"],[1,"fas","fa-phone"],[1,"fas","fa-envelope"],[1,"stats-section"],[1,"stats-grid"],[1,"stat-item"],[1,"stat-value"],[1,"stat-label"],[1,"classes-section"],[1,"section-header"],[1,"badge"],["class","classes-list",4,"ngIf","ngIfElse"],[1,"quick-actions"],[1,"action-buttons"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"btn","btn-sm","btn-outline-warning",3,"click"],[1,"btn","btn-sm","btn-outline-danger",3,"click"],[1,"classes-list"],["class","class-item",4,"ngFor","ngForOf"],["class","btn btn-link show-more",3,"click",4,"ngIf"],[1,"class-item"],[1,"class-info"],[1,"students-count"],[1,"btn","btn-link","show-more",3,"click"],[1,"empty-state"],[1,"form-check","form-check-inline"],["type","checkbox",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label",3,"for"],["for","editName"],["type","text","id","editName","name","editName","required","",1,"form-control",3,"ngModelChange","ngModel"],["for","editPhone"],["type","tel","id","editPhone","name","editPhone",1,"form-control",3,"ngModelChange","ngModel"],["for","editEmail"],["type","email","id","editEmail","name","editEmail",1,"form-control",3,"ngModelChange","ngModel"],["for","editHireDate"],["type","date","id","editHireDate","name","editHireDate",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-check"],["type","checkbox","id","editActive","name","editActive",1,"form-check-input",3,"ngModelChange","ngModel"],["for","editActive",1,"form-check-label"],["class","schedule-item",4,"ngFor","ngForOf"],[1,"schedule-item"],[1,"loading-overlay"],["role","status",1,"spinner-border","text-primary"],[1,"sr-only"]],template:function(e,i){if(e&1){let r=he();s(0,"div",4)(1,"div",5)(2,"h1"),b(3,"i",6),u(4," \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629"),a(),s(5,"div",7)(6,"button",8),I("click",function(){return F(r),R(i.showAddModal=!0)}),b(7,"i",9),u(8," \u0625\u0636\u0627\u0641\u0629 \u0623\u0633\u062A\u0627\u0630 \u062C\u062F\u064A\u062F "),a(),s(9,"button",10),I("click",function(){return F(r),R(i.exportToCSV())}),b(10,"i",11),u(11," \u062A\u0635\u062F\u064A\u0631 \u0625\u0644\u0649 CSV "),a(),s(12,"div",12)(13,"input",13,0),I("change",function(l){return F(r),R(i.onFileSelected(l))}),a(),s(15,"button",14),I("click",function(){F(r);let l=gc(14);return R(l.click())}),b(16,"i",15),u(17," \u0627\u0633\u062A\u064A\u0631\u0627\u062F \u0645\u0646 CSV "),a()()()(),s(18,"div",16)(19,"div",17)(20,"div",18)(21,"div",19),b(22,"i",20),s(23,"input",21),ye("ngModelChange",function(l){return F(r),Ce(i.searchTerm,l)||(i.searchTerm=l),R(l)}),I("input",function(){return F(r),R(i.currentPage=1)}),a()()(),s(24,"div",22)(25,"select",23),ye("ngModelChange",function(l){return F(r),Ce(i.subjectFilter,l)||(i.subjectFilter=l),R(l)}),I("change",function(){return F(r),R(i.currentPage=1)}),s(26,"option",24),u(27,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0645\u0648\u0627\u062F"),a(),j(28,cG,2,2,"option",25),a()(),s(29,"div",22)(30,"select",23),ye("ngModelChange",function(l){return F(r),Ce(i.statusFilter,l)||(i.statusFilter=l),R(l)}),I("change",function(){return F(r),R(i.currentPage=1)}),s(31,"option",26),u(32,"\u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0627\u0644\u0627\u062A"),a(),s(33,"option",27),u(34,"\u0646\u0634\u0637"),a(),s(35,"option",28),u(36,"\u063A\u064A\u0631 \u0646\u0634\u0637"),a()()(),s(37,"div",29)(38,"button",30),I("click",function(){return F(r),R(i.clearFilters())}),b(39,"i",31),u(40," \u0645\u0633\u062D \u0627\u0644\u0641\u0644\u062A\u0631 "),a()()()(),s(41,"div",32)(42,"div",33)(43,"div",34),b(44,"i",35),a(),s(45,"div",36)(46,"h3"),u(47),a(),s(48,"p"),u(49,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629"),a()()(),s(50,"div",33)(51,"div",37),b(52,"i",38),a(),s(53,"div",36)(54,"h3"),u(55),a(),s(56,"p"),u(57,"\u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629 \u0627\u0644\u0646\u0634\u0637\u064A\u0646"),a()()(),s(58,"div",33)(59,"div",39),b(60,"i",40),a(),s(61,"div",36)(62,"h3"),u(63),a(),s(64,"p"),u(65,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u062D\u0635\u0635"),a()()(),s(66,"div",33)(67,"div",41),b(68,"i",42),a(),s(69,"div",36)(70,"h3"),u(71),a(),s(72,"p"),u(73,"\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u062D\u064A\u0629"),a()()()(),s(74,"div",43)(75,"div",44)(76,"h3"),u(77,"\u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629"),a(),s(78,"span",45),u(79),a()(),s(80,"div",46)(81,"table",47)(82,"thead")(83,"tr")(84,"th"),u(85,"#"),a(),s(86,"th"),u(87,"\u0627\u0644\u0627\u0633\u0645"),a(),s(88,"th"),u(89,"\u0627\u0644\u0645\u0648\u0627\u062F"),a(),s(90,"th"),u(91,"\u0627\u0644\u0647\u0627\u062A\u0641"),a(),s(92,"th"),u(93,"\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"),a(),s(94,"th"),u(95,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062A\u0639\u064A\u064A\u0646"),a(),s(96,"th"),u(97,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(98,"th"),u(99,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(100,"tbody"),j(101,dG,5,0,"tr",48)(102,fG,4,0,"tr",48)(103,pG,24,18,"tr",49),a()()(),j(104,mG,9,4,"div",50),a(),s(105,"div",51)(106,"div",52)(107,"h4"),u(108,"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0623\u0633\u062A\u0627\u0630"),a(),s(109,"button",53),I("click",function(){return F(r),R(i.selectedTeacher=null)}),b(110,"i",31),a()(),j(111,xG,88,20,"div",54),a(),s(112,"div",55),I("click",function(){return F(r),R(i.selectedTeacher=null)}),a(),s(113,"div",56)(114,"div",57)(115,"div",58)(116,"div",59)(117,"h5",60),b(118,"i",61),u(119," \u0625\u0636\u0627\u0641\u0629 \u0623\u0633\u062A\u0627\u0630 \u062C\u062F\u064A\u062F"),a(),s(120,"button",62),I("click",function(){return F(r),R(i.showAddModal=!1)}),s(121,"span"),u(122,"\xD7"),a()()(),s(123,"div",63)(124,"form",64,1),I("ngSubmit",function(){return F(r),R(i.addTeacher())}),s(126,"div",65)(127,"label",66),u(128,"\u0627\u0633\u0645 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 *"),a(),s(129,"input",67),ye("ngModelChange",function(l){return F(r),Ce(i.newTeacher.name,l)||(i.newTeacher.name=l),R(l)}),a()(),s(130,"div",65)(131,"label"),u(132,"\u0627\u0644\u0645\u0648\u0627\u062F *"),a(),s(133,"div",68),j(134,bG,4,4,"div",69),a()(),s(135,"div",17)(136,"div",70)(137,"div",65)(138,"label",71),u(139,"\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062A\u0641"),a(),s(140,"input",72),ye("ngModelChange",function(l){return F(r),Ce(i.newTeacher.phone,l)||(i.newTeacher.phone=l),R(l)}),a()()(),s(141,"div",70)(142,"div",65)(143,"label",73),u(144,"\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"),a(),s(145,"input",74),ye("ngModelChange",function(l){return F(r),Ce(i.newTeacher.email,l)||(i.newTeacher.email=l),R(l)}),a()()()(),s(146,"div",65)(147,"label",75),u(148,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062A\u0639\u064A\u064A\u0646"),a(),s(149,"input",76),ye("ngModelChange",function(l){return F(r),Ce(i.newTeacher.hireDate,l)||(i.newTeacher.hireDate=l),R(l)}),a()()()(),s(150,"div",77)(151,"button",78),I("click",function(){return F(r),R(i.showAddModal=!1)}),u(152," \u0625\u0644\u063A\u0627\u0621 "),a(),s(153,"button",79),I("click",function(){return F(r),R(i.addTeacher())}),j(154,CG,3,0,"span",48)(155,EG,2,0,"span",48),a()()()()(),s(156,"div",80),I("click",function(){return F(r),R(i.showAddModal=!1)}),a(),s(157,"div",56)(158,"div",57)(159,"div",58)(160,"div",59)(161,"h5",60),b(162,"i",81),u(163," \u062A\u0639\u062F\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0623\u0633\u062A\u0627\u0630"),a(),s(164,"button",62),I("click",function(){return F(r),R(i.showEditModal=!1)}),s(165,"span"),u(166,"\xD7"),a()()(),s(167,"div",63),j(168,SG,31,6,"form",82),a(),s(169,"div",77)(170,"button",78),I("click",function(){return F(r),R(i.showEditModal=!1)}),u(171," \u0625\u0644\u063A\u0627\u0621 "),a(),s(172,"button",79),I("click",function(){return F(r),R(i.editTeacher())}),j(173,MG,3,0,"span",48)(174,AG,2,0,"span",48),a()()()()(),s(175,"div",80),I("click",function(){return F(r),R(i.showEditModal=!1)}),a(),s(176,"div",56)(177,"div",83)(178,"div",58)(179,"div",59)(180,"h5",84),b(181,"i",85),u(182," \u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062D\u0630\u0641"),a(),s(183,"button",62),I("click",function(){return F(r),R(i.showConfirmDeleteModal=!1)}),s(184,"span"),u(185,"\xD7"),a()()(),s(186,"div",63),j(187,TG,5,1,"p",48),s(188,"p",86),b(189,"i",87),u(190," \u0647\u0630\u0627 \u0627\u0644\u0625\u062C\u0631\u0627\u0621 \u0644\u0627 \u064A\u0645\u0643\u0646 \u0627\u0644\u062A\u0631\u0627\u062C\u0639 \u0639\u0646\u0647! "),a()(),s(191,"div",77)(192,"button",78),I("click",function(){return F(r),R(i.showConfirmDeleteModal=!1)}),u(193," \u0625\u0644\u063A\u0627\u0621 "),a(),s(194,"button",88),I("click",function(){return F(r),R(i.deleteTeacher())}),j(195,DG,3,0,"span",48)(196,PG,2,0,"span",48),a()()()()(),s(197,"div",80),I("click",function(){return F(r),R(i.showConfirmDeleteModal=!1)}),a(),s(198,"div",56)(199,"div",89)(200,"div",58)(201,"div",59)(202,"h5",60),b(203,"i",40),u(204," \u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u0633\u0646\u062F\u0629 "),a(),s(205,"button",62),I("click",function(){return F(r),R(i.showClassesModal=!1)}),s(206,"span"),u(207,"\xD7"),a()()(),s(208,"div",63)(209,"div",46)(210,"table",90)(211,"thead")(212,"tr")(213,"th"),u(214,"\u0627\u0633\u0645 \u0627\u0644\u062D\u0635\u0629"),a(),s(215,"th"),u(216,"\u0627\u0644\u0645\u0627\u062F\u0629"),a(),s(217,"th"),u(218,"\u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628"),a(),s(219,"th"),u(220,"\u0627\u0644\u0633\u0646\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629"),a(),s(221,"th"),u(222,"\u0627\u0644\u062C\u062F\u0648\u0644"),a()()(),s(223,"tbody"),j(224,OG,11,5,"tr",91),a()()()(),s(225,"div",77)(226,"button",78),I("click",function(){return F(r),R(i.showClassesModal=!1)}),u(227," \u0625\u063A\u0644\u0627\u0642 "),a()()()()(),s(228,"div",80),I("click",function(){return F(r),R(i.showClassesModal=!1)}),a(),j(229,FG,4,0,"div",92),a()}e&2&&(d(23),ve("ngModel",i.searchTerm),d(2),ve("ngModel",i.subjectFilter),d(3),w("ngForOf",i.subjectsList),d(2),ve("ngModel",i.statusFilter),d(17),B(i.teachers.length),d(8),B(i.activeTeachersCount),d(8),B(i.classes.length),d(8),B(i.liveClasses.length),d(8),H("\u0639\u062F\u062F \u0627\u0644\u0646\u062A\u0627\u0626\u062C: ",i.totalItems,""),d(22),w("ngIf",i.isLoading),d(),w("ngIf",!i.isLoading&&i.paginatedTeachers.length===0),d(),w("ngForOf",i.paginatedTeachers),d(),w("ngIf",i.totalPages>1),d(),Ie("show",i.selectedTeacher),d(6),w("ngIf",i.selectedTeacher),d(),Ie("show",i.selectedTeacher),d(),Ie("show",i.showAddModal),d(16),ve("ngModel",i.newTeacher.name),d(5),w("ngForOf",i.subjectsList),d(6),ve("ngModel",i.newTeacher.phone),d(5),ve("ngModel",i.newTeacher.email),d(4),ve("ngModel",i.newTeacher.hireDate),d(4),w("disabled",i.isLoading),d(),w("ngIf",i.isLoading),d(),w("ngIf",!i.isLoading),d(),Ie("show",i.showAddModal),d(),Ie("show",i.showEditModal),d(11),w("ngIf",i.selectedTeacher),d(4),w("disabled",i.isLoading),d(),w("ngIf",i.isLoading),d(),w("ngIf",!i.isLoading),d(),Ie("show",i.showEditModal),d(),Ie("show",i.showConfirmDeleteModal),d(11),w("ngIf",i.selectedTeacher),d(7),w("disabled",i.isLoading),d(),w("ngIf",i.isLoading),d(),w("ngIf",!i.isLoading),d(),Ie("show",i.showConfirmDeleteModal),d(),Ie("show",i.showClassesModal),d(26),w("ngForOf",i.teacherClasses),d(4),Ie("show",i.showClassesModal),d(),w("ngIf",i.isLoading))},dependencies:[hn,Nn,An,Un,Ti,Di,Pi,Yn,ff,di,ii,Ai,$i,ti,mr],styles:[".teachers-management[_ngcontent-%COMP%]{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;direction:rtl;padding:20px;background-color:#f8f9fa;min-height:100vh;color:#333}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:30px;padding:20px;background:linear-gradient(135deg,#4a6fa5,#2c3e50);border-radius:12px;color:#fff;box-shadow:0 4px 12px #0000001a}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:28px;font-weight:600}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:12px;font-size:32px}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:500;cursor:pointer;transition:all .3s ease;display:inline-flex;align-items:center;justify-content:center;gap:8px}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 8px #00000026}.btn[_ngcontent-%COMP%]:active{transform:translateY(0)}.btn-primary[_ngcontent-%COMP%]{background-color:#4a6fa5;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background-color:#3a5a85}.btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.btn-secondary[_ngcontent-%COMP%]:hover{background-color:#5a6268}.btn-outline-secondary[_ngcontent-%COMP%]{background-color:transparent;border:1px solid #6c757d;color:#6c757d}.btn-outline-secondary[_ngcontent-%COMP%]:hover{background-color:#6c757d;color:#fff}.btn-clear[_ngcontent-%COMP%]{background-color:#f8f9fa;border:1px solid #dee2e6;color:#6c757d}.btn-clear[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.btn-link[_ngcontent-%COMP%]{background:none;border:none;color:#4a6fa5;text-decoration:none;padding:0}.btn-link[_ngcontent-%COMP%]:hover{text-decoration:underline}.filters-section[_ngcontent-%COMP%]{background-color:#fff;padding:20px;border-radius:12px;margin-bottom:24px;box-shadow:0 2px 8px #0000000d}.search-box[_ngcontent-%COMP%]{position:relative}.search-box[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{position:absolute;right:15px;top:50%;transform:translateY(-50%);color:#6c757d}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:12px 45px 12px 15px;border:1px solid #dee2e6;border-radius:8px;font-size:14px;transition:border-color .3s}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4a6fa5;box-shadow:0 0 0 3px #4a6fa51a}.form-control[_ngcontent-%COMP%]{padding:12px 15px;border:1px solid #dee2e6;border-radius:8px;font-size:14px;width:100%;background-color:#fff}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#4a6fa5;box-shadow:0 0 0 3px #4a6fa51a}.stats-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:20px;margin-bottom:30px}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;display:flex;align-items:center;gap:20px;box-shadow:0 2px 8px #0000000d;transition:transform .3s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 4px 12px #0000001a}.stat-icon[_ngcontent-%COMP%]{width:60px;height:60px;border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:24px;color:#fff}.stat-icon.bg-primary[_ngcontent-%COMP%]{background-color:#4a6fa5}.stat-icon.bg-success[_ngcontent-%COMP%]{background-color:#28a745}.stat-icon.bg-warning[_ngcontent-%COMP%]{background-color:#ffc107}.stat-icon.bg-info[_ngcontent-%COMP%]{background-color:#17a2b8}.stat-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:28px;font-weight:700;color:#2c3e50}.stat-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;color:#6c757d;font-size:14px}.table-container[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;overflow:hidden;box-shadow:0 2px 8px #0000000d;margin-bottom:30px}.table-header[_ngcontent-%COMP%]{padding:20px;border-bottom:1px solid #dee2e6;display:flex;justify-content:space-between;align-items:center}.table-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:18px;color:#2c3e50}.total-count[_ngcontent-%COMP%]{color:#6c757d;font-size:14px}.table-responsive[_ngcontent-%COMP%]{overflow-x:auto}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#f8f9fa}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:16px 20px;text-align:right;font-weight:600;color:#2c3e50;border-bottom:2px solid #dee2e6;font-size:14px}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:16px 20px;border-bottom:1px solid #dee2e6;font-size:14px}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background-color .2s}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f8f9fa}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr.selected[_ngcontent-%COMP%]{background-color:#4a6fa51a}.subjects-badge[_ngcontent-%COMP%]{display:inline-block;background-color:#e3f2fd;color:#1976d2;padding:4px 10px;border-radius:20px;font-size:12px;margin:2px 4px 2px 0}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:6px 12px;border-radius:20px;font-size:12px;font-weight:500}.status-badge.active[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724}.status-badge.inactive[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24}.actions[_ngcontent-%COMP%]{display:flex;gap:8px;justify-content:flex-start}.actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:36px;height:36px;padding:0;display:inline-flex;align-items:center;justify-content:center}.btn-info[_ngcontent-%COMP%]{background-color:#17a2b8;color:#fff}.btn-warning[_ngcontent-%COMP%]{background-color:#ffc107;color:#212529}.btn-danger[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.btn-info[_ngcontent-%COMP%]:hover{background-color:#138496}.btn-warning[_ngcontent-%COMP%]:hover{background-color:#e0a800}.btn-danger[_ngcontent-%COMP%]:hover{background-color:#c82333}.pagination[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;padding:20px;gap:20px}.page-info[_ngcontent-%COMP%]{font-size:14px;color:#6c757d}.loading-spinner[_ngcontent-%COMP%]{padding:40px;text-align:center;color:#4a6fa5}.loading-spinner[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:10px}.details-sidebar[_ngcontent-%COMP%]{position:fixed;top:0;left:-400px;width:380px;height:100vh;background-color:#fff;box-shadow:-2px 0 20px #0000001a;z-index:1050;transition:left .3s ease;overflow-y:auto}.details-sidebar.show[_ngcontent-%COMP%]{left:0}.sidebar-header[_ngcontent-%COMP%]{padding:20px;border-bottom:1px solid #dee2e6;display:flex;justify-content:space-between;align-items:center}.sidebar-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#2c3e50}.close-btn[_ngcontent-%COMP%]{background:none;border:none;font-size:20px;color:#6c757d;cursor:pointer;padding:5px}.close-btn[_ngcontent-%COMP%]:hover{color:#dc3545}.sidebar-content[_ngcontent-%COMP%]{padding:20px}.teacher-info-card[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-radius:12px;padding:20px;margin-bottom:24px}.teacher-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;margin-bottom:20px}.teacher-avatar[_ngcontent-%COMP%]{width:70px;height:70px;border-radius:50%;background:linear-gradient(135deg,#4a6fa5,#2c3e50);display:flex;align-items:center;justify-content:center;font-size:32px;color:#fff}.teacher-name[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:20px;color:#2c3e50}.teacher-name[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:5px 0 0;color:#6c757d}.teacher-details[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.detail-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;font-size:14px}.detail-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#4a6fa5;width:20px}.stats-section[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #dee2e6;border-radius:12px;padding:20px;margin-bottom:24px}.stats-section[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin-top:0;margin-bottom:16px;color:#2c3e50;font-size:16px}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:15px}.stat-item[_ngcontent-%COMP%]{text-align:center;padding:15px;background-color:#f8f9fa;border-radius:8px}.stat-value[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#4a6fa5;margin-bottom:5px}.stat-label[_ngcontent-%COMP%]{font-size:12px;color:#6c757d;text-transform:uppercase;letter-spacing:.5px}.classes-section[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #dee2e6;border-radius:12px;padding:20px;margin-bottom:24px}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.section-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;color:#2c3e50;font-size:16px}.section-header[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background-color:#4a6fa5;color:#fff;padding:4px 10px;border-radius:12px;font-size:12px}.classes-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.class-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px;background-color:#f8f9fa;border-radius:8px;transition:background-color .2s}.class-item[_ngcontent-%COMP%]:hover{background-color:#e9ecef}.class-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.class-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{font-size:14px;color:#2c3e50}.class-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{font-size:12px}.students-count[_ngcontent-%COMP%]{font-size:12px;color:#6c757d}.show-more[_ngcontent-%COMP%]{text-align:center;padding:10px;font-size:14px}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:30px;color:#6c757d}.empty-state[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:48px;margin-bottom:15px;opacity:.5}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0}.quick-actions[_ngcontent-%COMP%]{background-color:#fff;border:1px solid #dee2e6;border-radius:12px;padding:20px}.quick-actions[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin-top:0;margin-bottom:16px;color:#2c3e50;font-size:16px}.action-buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.overlay[_ngcontent-%COMP%]{position:fixed;top:0;right:0;width:100%;height:100%;background-color:#00000080;z-index:1040;opacity:0;visibility:hidden;transition:all .3s ease}.overlay.show[_ngcontent-%COMP%]{opacity:1;visibility:visible}.teacher-modal[_ngcontent-%COMP%]{position:fixed;top:0;right:0;width:100%;height:100%;z-index:1060;opacity:0;visibility:hidden;transition:all .3s ease}.teacher-modal.show[_ngcontent-%COMP%]{opacity:1;visibility:visible}.teacher-modal-dialog[_ngcontent-%COMP%]{position:relative;width:90%;max-width:500px;margin:30px auto;z-index:1061}.teacher-modal-sm[_ngcontent-%COMP%]{max-width:400px}.teacher-modal-lg[_ngcontent-%COMP%]{max-width:800px}.teacher-modal-content[_ngcontent-%COMP%]{background-color:#fff;border-radius:12px;box-shadow:0 10px 30px #0003}.teacher-modal-header[_ngcontent-%COMP%]{padding:20px;border-bottom:1px solid #dee2e6;display:flex;justify-content:space-between;align-items:center}.teacher-modal-title[_ngcontent-%COMP%]{margin:0;font-size:18px;color:#2c3e50}.teacher-modal-title[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-left:10px}.teacher-modal-header[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;color:#6c757d;cursor:pointer;padding:0;line-height:1}.teacher-modal-body[_ngcontent-%COMP%]{padding:20px;max-height:70vh;overflow-y:auto}.teacher-modal-footer[_ngcontent-%COMP%]{padding:20px;border-top:1px solid #dee2e6;display:flex;justify-content:flex-end;gap:10px}.teacher-modal-backdrop[_ngcontent-%COMP%]{position:fixed;top:0;right:0;width:100%;height:100%;background-color:#00000080;z-index:1060;opacity:0;visibility:hidden;transition:all .3s ease}.teacher-modal-backdrop.show[_ngcontent-%COMP%]{opacity:1;visibility:visible}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:500;color:#2c3e50}.form-check[_ngcontent-%COMP%]{margin-bottom:10px}.form-check-input[_ngcontent-%COMP%]{margin-left:10px}.form-check-label[_ngcontent-%COMP%]{cursor:pointer}.subjects-checkboxes[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:15px}.loading-overlay[_ngcontent-%COMP%]{position:fixed;top:0;right:0;width:100%;height:100%;background-color:#fffc;z-index:1070;display:flex;align-items:center;justify-content:center}.spinner-border[_ngcontent-%COMP%]{width:60px;height:60px;border-width:4px}.text-center[_ngcontent-%COMP%]{text-align:center}.text-muted[_ngcontent-%COMP%]{color:#6c757d}.text-danger[_ngcontent-%COMP%]{color:#dc3545}.text-primary[_ngcontent-%COMP%]{color:#4a6fa5}@media (max-width: 992px){.stats-cards[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.details-sidebar[_ngcontent-%COMP%]{width:320px}}@media (max-width: 768px){.header[_ngcontent-%COMP%]{flex-direction:column;gap:20px;text-align:center}.header-actions[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center}.stats-cards[_ngcontent-%COMP%]{grid-template-columns:1fr}.teacher-modal-dialog[_ngcontent-%COMP%]{width:95%;margin:10px auto}.details-sidebar[_ngcontent-%COMP%]{width:100%;left:-100%}}@media (max-width: 576px){.teachers-management[_ngcontent-%COMP%]{padding:10px}.filters-section[_ngcontent-%COMP%]   .row[_ngcontent-%COMP%]{flex-direction:column;gap:15px}.filters-section[_ngcontent-%COMP%]   .col-md-2[_ngcontent-%COMP%], .filters-section[_ngcontent-%COMP%]   .col-md-3[_ngcontent-%COMP%], .filters-section[_ngcontent-%COMP%]   .col-md-4[_ngcontent-%COMP%]{width:100%}.table-header[_ngcontent-%COMP%]{flex-direction:column;gap:10px;align-items:flex-start}.actions[_ngcontent-%COMP%]{flex-wrap:wrap}}"]})};$();var et=ya(Na());var Kf=n=>({active:n}),$1=n=>({"show active":n}),uD=(n,t)=>({"bg-info":n,"bg-warning":t}),cD=(n,t)=>({"bg-success":n,"bg-danger":t}),RG=(n,t)=>({"bg-success":n,"bg-warning":t}),kG=(n,t,e)=>({"bg-success":n,"bg-warning":t,"bg-danger":e}),NG=(n,t,e)=>({"border-success":n,"border-warning":t,"border-danger":e});function UG(n,t){n&1&&(s(0,"div",59)(1,"div",60)(2,"span",61),u(3,"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644..."),a()()())}function LG(n,t){if(n&1&&(s(0,"option",82),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),H(" ",e," ")}}function BG(n,t){if(n&1&&(s(0,"option",82),u(1),a()),n&2){let e=t.$implicit;w("value",e.value),d(),H(" ",e.label," ")}}function VG(n,t){if(n&1){let e=he();s(0,"div",62)(1,"div",63)(2,"div",64)(3,"div",65)(4,"h5",66),b(5,"i",67),u(6,"\u0625\u0636\u0627\u0641\u0629 \u062F\u0641\u0639\u0629 \u062C\u062F\u064A\u062F\u0629 "),a(),s(7,"button",68),I("click",function(){F(e);let r=E();return R(r.closePaymentModal())}),a()(),s(8,"div",69)(9,"form",70),I("ngSubmit",function(){F(e);let r=E();return R(r.addPayment())}),s(10,"div",71)(11,"div",72)(12,"label",30),u(13,"\u0627\u0644\u0645\u0628\u0644\u063A (\u062F.\u062C)"),a(),s(14,"input",73),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newPayment.amount,r)||(o.newPayment.amount=r),R(r)}),a()(),s(15,"div",72)(16,"label",30),u(17,"\u0627\u0644\u0634\u0647\u0631"),a(),s(18,"select",74),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newPayment.month,r)||(o.newPayment.month=r),R(r)}),s(19,"option",32),u(20,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0634\u0647\u0631"),a(),j(21,LG,2,2,"option",33),a()(),s(22,"div",72)(23,"label",30),u(24,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(25,"select",75),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newPayment.paymentMethod,r)||(o.newPayment.paymentMethod=r),R(r)}),j(26,BG,2,2,"option",33),a()(),s(27,"div",72)(28,"label",30),u(29,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E"),a(),b(30,"input",76),ut(31,"date"),a(),s(32,"div",77)(33,"label",30),u(34,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"),a(),s(35,"textarea",78),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.newPayment.notes,r)||(o.newPayment.notes=r),R(r)}),a()()(),s(36,"div",79)(37,"button",80),I("click",function(){F(e);let r=E();return R(r.closePaymentModal())}),u(38,"\u0625\u0644\u063A\u0627\u0621"),a(),s(39,"button",81),u(40,"\u062D\u0641\u0638 \u0627\u0644\u062F\u0641\u0639\u0629"),a()()()()()()()}if(n&2){let e=E();d(14),ve("ngModel",e.newPayment.amount),d(4),ve("ngModel",e.newPayment.month),d(3),w("ngForOf",e.generateMonthOptions()),d(4),ve("ngModel",e.newPayment.paymentMethod),d(),w("ngForOf",e.paymentMethods),d(4),w("value",pt(31,7,e.currentDate,"yyyy-MM-dd")),d(5),ve("ngModel",e.newPayment.notes)}}function HG(n,t){if(n&1&&(s(0,"option",82),u(1),a()),n&2){let e=t.$implicit;w("value",e.value),d(),H(" ",e.label," ")}}function zG(n,t){if(n&1){let e=he();s(0,"form",70),I("ngSubmit",function(){F(e);let r=E(2);return R(r.updatePayment())}),s(1,"div",71)(2,"div",72)(3,"label",30),u(4,"\u0627\u0644\u0645\u0628\u0644\u063A (\u062F.\u062C)"),a(),s(5,"input",73),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.editingPayment.amount,r)||(o.editingPayment.amount=r),R(r)}),a()(),s(6,"div",72)(7,"label",30),u(8,"\u0627\u0644\u0634\u0647\u0631"),a(),s(9,"input",86),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.editingPayment.month,r)||(o.editingPayment.month=r),R(r)}),a()(),s(10,"div",72)(11,"label",30),u(12,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(13,"select",75),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.editingPayment.paymentMethod,r)||(o.editingPayment.paymentMethod=r),R(r)}),j(14,HG,2,2,"option",33),a()(),s(15,"div",72)(16,"label",30),u(17,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(18,"select",87),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.editingPayment.status,r)||(o.editingPayment.status=r),R(r)}),s(19,"option",88),u(20,"\u0645\u062F\u0641\u0648\u0639"),a(),s(21,"option",89),u(22,"\u0645\u0639\u0644\u0642"),a(),s(23,"option",90),u(24,"\u0645\u062A\u0623\u062E\u0631"),a()()(),s(25,"div",77)(26,"label",30),u(27,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"),a(),s(28,"textarea",78),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.editingPayment.notes,r)||(o.editingPayment.notes=r),R(r)}),a()()(),s(29,"div",79)(30,"button",80),I("click",function(){F(e);let r=E(2);return R(r.closeEditPaymentModal())}),u(31,"\u0625\u0644\u063A\u0627\u0621"),a(),s(32,"button",91),u(33,"\u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062F\u0641\u0639\u0629"),a()()()}if(n&2){let e=E(2);d(5),ve("ngModel",e.editingPayment.amount),d(4),ve("ngModel",e.editingPayment.month),d(4),ve("ngModel",e.editingPayment.paymentMethod),d(),w("ngForOf",e.paymentMethods),d(4),ve("ngModel",e.editingPayment.status),d(10),ve("ngModel",e.editingPayment.notes)}}function jG(n,t){if(n&1){let e=he();s(0,"div",62)(1,"div",63)(2,"div",64)(3,"div",83)(4,"h5",66),b(5,"i",84),u(6,"\u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629 "),a(),s(7,"button",68),I("click",function(){F(e);let r=E();return R(r.closeEditPaymentModal())}),a()(),s(8,"div",69),j(9,zG,34,6,"form",85),a()()()()}if(n&2){let e=E();d(9),w("ngIf",e.editingPayment)}}function WG(n,t){if(n&1&&(s(0,"div",69)(1,"div",97),b(2,"i",98),s(3,"h5",99),u(4,"\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u062D\u0630\u0641 \u0647\u0630\u0647 \u0627\u0644\u062F\u0641\u0639\u0629\u061F"),a(),s(5,"div",100)(6,"p",101)(7,"strong"),u(8,"\u0627\u0644\u0645\u0628\u0644\u063A:"),a(),u(9),ut(10,"number"),a(),s(11,"p",101)(12,"strong"),u(13,"\u0627\u0644\u0634\u0647\u0631:"),a(),u(14),a(),s(15,"p",17)(16,"strong"),u(17,"\u0627\u0644\u062D\u0627\u0644\u0629:"),a(),u(18),a()(),s(19,"p",102),b(20,"i",103),u(21," \u0644\u0627 \u064A\u0645\u0643\u0646 \u0627\u0644\u062A\u0631\u0627\u062C\u0639 \u0639\u0646 \u0647\u0630\u0627 \u0627\u0644\u0625\u062C\u0631\u0627\u0621 "),a()()()),n&2){let e=E(2);d(9),H(" ",pt(10,3,e.paymentToDelete.amount,"1.0-0")," \u062F.\u062C"),d(5),H(" ",e.paymentToDelete.month,""),d(4),H(" ",e.getPaymentStatusText(e.paymentToDelete),"")}}function GG(n,t){if(n&1){let e=he();s(0,"div",62)(1,"div",92)(2,"div",64)(3,"div",93)(4,"h5",66),b(5,"i",94),u(6,"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062D\u0630\u0641 "),a(),s(7,"button",68),I("click",function(){F(e);let r=E();return R(r.closeDeleteConfirmModal())}),a()(),j(8,WG,22,6,"div",95),s(9,"div",79)(10,"button",80),I("click",function(){F(e);let r=E();return R(r.closeDeleteConfirmModal())}),u(11,"\u0625\u0644\u063A\u0627\u0621"),a(),s(12,"button",96),I("click",function(){F(e);let r=E();return R(r.deletePayment())}),u(13,"\u062D\u0630\u0641"),a()()()()()}if(n&2){let e=E();d(8),w("ngIf",e.paymentToDelete)}}function $G(n,t){if(n&1&&(s(0,"div",108)(1,"div",109)(2,"span"),u(3,"\u062C\u0627\u0631\u064A \u0645\u0639\u0627\u0644\u062C\u0629 \u0627\u0644\u062F\u0641\u0639\u0627\u062A..."),a(),s(4,"span"),u(5),a()(),s(6,"div",110)(7,"div",111),u(8),a()()()),n&2){let e=E(2);d(5),H("",e.bulkPaymentProgress,"%"),d(2),fr("width",e.bulkPaymentProgress+"%"),d(),H(" ",e.bulkPaymentProgress,"% ")}}function YG(n,t){if(n&1&&(s(0,"option",82),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),H(" ",e," ")}}function qG(n,t){if(n&1&&(s(0,"option",82),u(1),a()),n&2){let e=t.$implicit;w("value",e.value),d(),H(" ",e.label," ")}}function XG(n,t){if(n&1){let e=he();s(0,"button",129),I("click",function(){let r=F(e).$implicit,o=E(3);return R(o.selectClassForBulkPayment(r))}),u(1),ut(2,"number"),a()}if(n&2){let e=t.$implicit,i=E(3);w("ngClass",Rr(6,Kf,(i.classForBulkPayment==null?null:i.classForBulkPayment._id)===e._id)),d(),Gn(" ",e.name," - ",pt(2,3,e.price,"1.0-0")," \u062F.\u062C ")}}function ZG(n,t){if(n&1&&(s(0,"div",130)(1,"div",118)(2,"div")(3,"strong"),u(4),a(),u(5," \u0637\u0627\u0644\u0628 \u0645\u062E\u062A\u0627\u0631 "),a(),s(6,"div",131)(7,"h5",17),u(8),ut(9,"number"),a(),s(10,"small",117),u(11,"\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A"),a()()()()),n&2){let e=E(3);d(4),B(e.selectedStudents.length),d(4),H("",pt(9,2,e.selectedStudents.length*e.bulkPayment.amount,"1.0-0")," \u062F.\u062C")}}function JG(n,t){if(n&1){let e=he();s(0,"tr")(1,"td")(2,"input",132),I("change",function(){let r=F(e).$implicit,o=E(3);return R(o.toggleStudentSelection(r))}),a()(),s(3,"td"),u(4),a(),s(5,"td"),u(6),a(),s(7,"td"),u(8),a(),s(9,"td"),u(10),a()()}if(n&2){let e=t.$implicit,i=E(3);d(2),w("checked",i.isStudentSelected(e)),d(2),B(e.name),d(2),B(e.studentId),d(2),B(i.getAcademicYearName(e.academicYear)),d(2),B(e.parentName)}}function KG(n,t){if(n&1){let e=he();s(0,"div")(1,"div",41)(2,"div",29)(3,"label",30),u(4,"\u0627\u0644\u0645\u0628\u0644\u063A \u0644\u0644\u0637\u0627\u0644\u0628 \u0627\u0644\u0648\u0627\u062D\u062F (\u062F.\u062C)"),a(),s(5,"input",112),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.bulkPayment.amount,r)||(o.bulkPayment.amount=r),R(r)}),a()(),s(6,"div",29)(7,"label",30),u(8,"\u0627\u0644\u0634\u0647\u0631"),a(),s(9,"select",113),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.bulkPayment.month,r)||(o.bulkPayment.month=r),R(r)}),s(10,"option",32),u(11,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0634\u0647\u0631"),a(),j(12,YG,2,2,"option",33),a()(),s(13,"div",29)(14,"label",30),u(15,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(16,"select",113),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.bulkPayment.paymentMethod,r)||(o.bulkPayment.paymentMethod=r),R(r)}),j(17,qG,2,2,"option",33),a()(),s(18,"div",77)(19,"label",30),u(20,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"),a(),s(21,"textarea",114),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.bulkPayment.notes,r)||(o.bulkPayment.notes=r),R(r)}),a()()(),s(22,"div",108)(23,"label",30),u(24,"\u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u062D\u0635\u0629 (\u0627\u062E\u062A\u064A\u0627\u0631\u064A)"),a(),s(25,"div",115),j(26,XG,3,8,"button",116),a(),s(27,"small",117),u(28,"\u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u062D\u0635\u0629 \u0633\u064A\u062A\u0645 \u0631\u0628\u0637 \u0627\u0644\u062F\u0641\u0639\u0627\u062A \u0628\u0647\u0627 \u062A\u0644\u0642\u0627\u0626\u064A\u0627\u064B"),a()(),s(29,"div",15)(30,"div",26)(31,"div",118)(32,"h6",17),u(33),a(),s(34,"div")(35,"button",119),I("click",function(){F(e);let r=E(2);return R(r.selectAllStudents())}),b(36,"i",120),u(37,"\u062A\u062D\u062F\u064A\u062F \u0627\u0644\u0643\u0644 "),a(),s(38,"button",121),I("click",function(){F(e);let r=E(2);return R(r.deselectAllStudents())}),b(39,"i",122),u(40,"\u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u0643\u0644 "),a()()()(),s(41,"div",22)(42,"div",99)(43,"input",123),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.studentSearchTerm,r)||(o.studentSearchTerm=r),R(r)}),I("input",function(){F(e);let r=E(2);return R(r.filterStudents())}),a()(),j(44,ZG,12,5,"div",124),s(45,"div",125)(46,"table",126)(47,"thead")(48,"tr"),b(49,"th",127),s(50,"th"),u(51,"\u0627\u0644\u0627\u0633\u0645"),a(),s(52,"th"),u(53,"\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(54,"th"),u(55,"\u0627\u0644\u0645\u0633\u062A\u0648\u0649"),a(),s(56,"th"),u(57,"\u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631"),a()()(),s(58,"tbody"),j(59,JG,11,5,"tr",128),a()()()()()()}if(n&2){let e=E(2);d(5),ve("ngModel",e.bulkPayment.amount),d(4),ve("ngModel",e.bulkPayment.month),d(3),w("ngForOf",e.generateMonthOptions()),d(4),ve("ngModel",e.bulkPayment.paymentMethod),d(),w("ngForOf",e.paymentMethods),d(4),ve("ngModel",e.bulkPayment.notes),d(5),w("ngForOf",e.studentClasses),d(7),H("\u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0637\u0644\u0627\u0628 (",e.selectedStudents.length,")"),d(10),ve("ngModel",e.studentSearchTerm),d(),w("ngIf",e.selectedStudents.length>0),d(15),w("ngForOf",e.filteredStudents)}}function QG(n,t){n&1&&(s(0,"span"),b(1,"i",133),u(2,"\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A "),a())}function e$(n,t){n&1&&(s(0,"span"),b(1,"span",134),u(2," \u062C\u0627\u0631\u064A \u0627\u0644\u0645\u0639\u0627\u0644\u062C\u0629... "),a())}function t$(n,t){if(n&1){let e=he();s(0,"div",62)(1,"div",104)(2,"div",64)(3,"div",105)(4,"h5",66),b(5,"i",21),u(6,"\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A \u0644\u0644\u0637\u0644\u0627\u0628 "),a(),s(7,"button",68),I("click",function(){F(e);let r=E();return R(r.closeBulkPaymentModal())}),a()(),s(8,"div",69),j(9,$G,9,4,"div",106)(10,KG,60,11,"div",51),a(),s(11,"div",79)(12,"button",80),I("click",function(){F(e);let r=E();return R(r.closeBulkPaymentModal())}),u(13,"\u0625\u0644\u063A\u0627\u0621"),a(),s(14,"button",107),I("click",function(){F(e);let r=E();return R(r.processBulkPayment())}),j(15,QG,3,0,"span",51)(16,e$,3,0,"span",51),a()()()()()}if(n&2){let e=E();d(9),w("ngIf",e.isProcessingBulkPayment),d(),w("ngIf",!e.isProcessingBulkPayment),d(4),w("disabled",e.selectedStudents.length===0||e.isProcessingBulkPayment),d(),w("ngIf",!e.isProcessingBulkPayment),d(),w("ngIf",e.isProcessingBulkPayment)}}function n$(n,t){n&1&&(s(0,"div",137),b(1,"i",138),s(2,"h5",117),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0644\u0647\u0630\u0647 \u0627\u0644\u062D\u0635\u0629"),a()())}function i$(n,t){if(n&1&&(s(0,"tr")(1,"td")(2,"strong"),u(3),a()(),s(4,"td"),u(5),a(),s(6,"td"),u(7),a(),s(8,"td")(9,"strong",142),u(10),ut(11,"number"),a()(),s(12,"td"),u(13),a(),s(14,"td"),u(15),a(),s(16,"td"),u(17),ut(18,"date"),a(),s(19,"td")(20,"span",143),u(21),a()()()),n&2){let e=t.$implicit,i=E(3);d(3),B(e.invoiceNumber||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(2),B((e.student==null?null:e.student.name)||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(2),B((e.student==null?null:e.student.studentId)||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(3),H("",pt(11,9,e.amount,"1.0-0")," \u062F.\u062C"),d(3),B(e.month),d(2),B(i.getPaymentMethodLabel(e.paymentMethod)),d(2),H(" ",e.paymentDate?pt(18,12,e.paymentDate,"dd/MM/yyyy"):"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u062F\u0641\u0639"," "),d(3),w("ngClass",i.getPaymentStatusClass(e)),d(),H(" ",i.getPaymentStatusText(e)," ")}}function r$(n,t){if(n&1&&(s(0,"div",139)(1,"table",140)(2,"thead",141)(3,"tr")(4,"th"),u(5,"\u0631\u0642\u0645 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629"),a(),s(6,"th"),u(7,"\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(8,"th"),u(9,"\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(10,"th"),u(11,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(12,"th"),u(13,"\u0627\u0644\u0634\u0647\u0631"),a(),s(14,"th"),u(15,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(16,"th"),u(17,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639"),a(),s(18,"th"),u(19,"\u0627\u0644\u062D\u0627\u0644\u0629"),a()()(),s(20,"tbody"),j(21,i$,22,15,"tr",128),a()()()),n&2){let e=E(2);d(21),w("ngForOf",e.classPayments)}}function o$(n,t){if(n&1){let e=he();s(0,"div",62)(1,"div",104)(2,"div",64)(3,"div",135)(4,"h5",66),b(5,"i",136),u(6),a(),s(7,"button",68),I("click",function(){F(e);let r=E();return R(r.closeClassPaymentsModal())}),a()(),s(8,"div",69),j(9,n$,4,0,"div",23)(10,r$,22,1,"div",24),a(),s(11,"div",79)(12,"button",80),I("click",function(){F(e);let r=E();return R(r.closeClassPaymentsModal())}),u(13,"\u0625\u063A\u0644\u0627\u0642"),a()()()()()}if(n&2){let e=E();d(6),H("\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u062D\u0635\u0629: ",e.selectedClassForPayments==null?null:e.selectedClassForPayments.name," "),d(3),w("ngIf",e.classPayments.length===0),d(),w("ngIf",e.classPayments.length>0)}}function s$(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),ut(5,"number"),a(),s(6,"td"),u(7),a(),s(8,"td")(9,"span",149),u(10,"\u0645\u0639\u0644\u0642"),a()()()),n&2){let e=t.$implicit;d(2),B(e.month),d(2),H("",pt(5,3,e.amount,"1.0-0")," \u062F.\u062C"),d(3),B(e.className||"\u0639\u0627\u0645")}}function a$(n,t){if(n&1){let e=he();s(0,"div",62)(1,"div",63)(2,"div",64)(3,"div",105)(4,"h5",66),b(5,"i",133),u(6,"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A \u0644\u0644\u0645\u062D\u062F\u062F "),a(),s(7,"button",68),I("click",function(){F(e);let r=E();return R(r.closeBulkPayConfirmation())}),a()(),s(8,"div",69)(9,"div",144)(10,"h6"),b(11,"i",145),u(12,"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A"),a(),s(13,"p",101)(14,"strong"),u(15,"\u0639\u062F\u062F \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0645\u062D\u062F\u062F\u0629:"),a(),u(16),a(),s(17,"p",101)(18,"strong"),u(19,"\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:"),a(),u(20),ut(21,"number"),a(),s(22,"p",17)(23,"strong"),u(24,"\u0645\u0644\u0627\u062D\u0638\u0629:"),a(),u(25," \u0633\u064A\u062A\u0645 \u062F\u0641\u0639 \u062C\u0645\u064A\u0639 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0645\u062D\u062F\u062F\u0629 \u0628\u0646\u0641\u0633 \u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a()(),s(26,"div",146)(27,"table",147)(28,"thead",141)(29,"tr")(30,"th"),u(31,"\u0627\u0644\u0634\u0647\u0631"),a(),s(32,"th"),u(33,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(34,"th"),u(35,"\u0627\u0644\u062D\u0635\u0629"),a(),s(36,"th"),u(37,"\u0627\u0644\u062D\u0627\u0644\u0629"),a()()(),s(38,"tbody"),j(39,s$,11,6,"tr",128),a()()(),s(40,"div",97)(41,"button",148),I("click",function(){F(e);let r=E();return R(r.closeBulkPayConfirmation())}),b(42,"i",39),u(43,"\u0625\u0644\u063A\u0627\u0621 "),a(),s(44,"button",20),I("click",function(){F(e);let r=E();return R(r.processBulkPaySelected())}),b(45,"i",27),u(46,"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A "),a()()()()()()}if(n&2){let e=E();d(16),H(" ",e.selectedPaymentsForBulkPay.length,""),d(4),H(" ",pt(21,3,e.getSelectedPaymentsTotal(),"1.0-0")," \u062F.\u062C"),d(19),w("ngForOf",e.selectedPaymentsForBulkPay)}}function l$(n,t){n&1&&(s(0,"div",137)(1,"div",150)(2,"span",61),u(3,"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644..."),a()(),s(4,"p",151),u(5,"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u062A\u0627\u062D\u0629..."),a()())}function u$(n,t){if(n&1&&(s(0,"span",157),u(1),a()),n&2){let e=t.$implicit;d(),Gn(" ",e.name," - ",e.subject," ")}}function c$(n,t){if(n&1&&(s(0,"div",144)(1,"h6"),b(2,"i",145),u(3,"\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u0633\u062C\u0644\u0629 \u062D\u0627\u0644\u064A\u0627\u064B:"),a(),s(4,"div",155),j(5,u$,2,2,"span",156),a()()),n&2){let e=E(3);d(5),w("ngForOf",e.alreadyEnrolledClasses)}}function d$(n,t){if(n&1&&(s(0,"option",82),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),B(e)}}function f$(n,t){if(n&1&&(s(0,"option",82),u(1),a()),n&2){let e=t.$implicit;w("value",e.value),d(),B(e.label)}}function h$(n,t){n&1&&(s(0,"span"),u(1,", "),a())}function p$(n,t){if(n&1&&(s(0,"span"),u(1),j(2,h$,2,0,"span",51),a()),n&2){let e=t.$implicit,i=t.last;d(),H(" ",e.name,""),d(),w("ngIf",!i)}}function m$(n,t){if(n&1&&(s(0,"div",158)(1,"div",118)(2,"div")(3,"h6"),b(4,"i",27),u(5),a(),s(6,"p",159),j(7,p$,3,2,"span",128),a()(),s(8,"div",131)(9,"h5",17),u(10),ut(11,"number"),a(),s(12,"small"),u(13,"\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0634\u0647\u0631\u064A"),a()()()()),n&2){let e=E(3);d(5),H("\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u062E\u062A\u0627\u0631\u0629 (",e.selectedClasses.length,")"),d(2),w("ngForOf",e.selectedClasses),d(3),H("",pt(11,3,e.calculateMonthlyTotal(),"1.0-0")," \u062F.\u062C")}}function g$(n,t){n&1&&(s(0,"div",137),b(1,"i",160),s(2,"h5",117),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u062D\u0635\u0635 \u0645\u062A\u0627\u062D\u0629"),a(),s(4,"p",117),u(5,"\u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u062A\u0627\u062D\u0629 \u0645\u0633\u062C\u0644\u0629 \u0644\u0644\u0637\u0627\u0644\u0628"),a()())}function _$(n,t){n&1&&(s(0,"div",164),b(1,"i",165),u(2," \u063A\u064A\u0631 \u0645\u062A\u0648\u0627\u0641\u0642 \u0645\u0639 \u0645\u0633\u062A\u0648\u0649 \u0627\u0644\u0637\u0627\u0644\u0628 "),a())}function v$(n,t){if(n&1){let e=he();s(0,"tr")(1,"td")(2,"input",161),I("change",function(){let r=F(e).$implicit,o=E(4);return R(o.toggleClassSelection(r))}),a()(),s(3,"td")(4,"strong"),u(5),a(),j(6,_$,3,0,"div",162),a(),s(7,"td"),u(8),a(),s(9,"td"),u(10),a(),s(11,"td"),u(12),a(),s(13,"td")(14,"span",143),u(15),a()(),s(16,"td")(17,"strong",142),u(18),ut(19,"number"),a(),s(20,"div",163),u(21),a()()()}if(n&2){let e=t.$implicit,i=E(4);d(2),w("checked",i.isClassSelected(e._id||e.id))("disabled",!i.isLevelCompatible(e)),d(3),B(e.name),d(),w("ngIf",!i.isLevelCompatible(e)),d(2),B(e.subject),d(2),B((e.teacher==null?null:e.teacher.name)||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(2),B(i.getAcademicYearName(e.academicYear)),d(2),w("ngClass",Aa(14,uD,e.paymentSystem==="monthly",e.paymentSystem==="rounds")),d(),H(" ",e.paymentSystem==="monthly"?"\u0634\u0647\u0631\u064A":"\u062C\u0648\u0644\u0627\u062A"," "),d(3),H("",pt(19,11,e.price,"1.0-0")," \u062F.\u062C"),d(3),H(" ",e.paymentSystem==="monthly"?"\u0634\u0647\u0631\u064A\u0627\u064B":"\u0644\u0644\u0645\u062C\u0645\u0648\u0639\u0629"," ")}}function y$(n,t){if(n&1&&(s(0,"div",139)(1,"table",140)(2,"thead",141)(3,"tr")(4,"th",127),u(5,"\u0627\u062E\u062A\u0631"),a(),s(6,"th"),u(7,"\u0627\u0633\u0645 \u0627\u0644\u062D\u0635\u0629"),a(),s(8,"th"),u(9,"\u0627\u0644\u0645\u0627\u062F\u0629"),a(),s(10,"th"),u(11,"\u0627\u0644\u0645\u0639\u0644\u0645"),a(),s(12,"th"),u(13,"\u0627\u0644\u0645\u0633\u062A\u0648\u0649"),a(),s(14,"th"),u(15,"\u0646\u0638\u0627\u0645 \u0627\u0644\u062F\u0641\u0639"),a(),s(16,"th"),u(17,"\u0627\u0644\u0633\u0639\u0631"),a()()(),s(18,"tbody"),j(19,v$,22,17,"tr",128),a()()()),n&2){let e=E(3);d(19),w("ngForOf",e.filteredAvailableClasses)}}function x$(n,t){if(n&1){let e=he();s(0,"div"),j(1,c$,6,1,"div",152),s(2,"div",41)(3,"div",153)(4,"label",30),u(5,"\u0641\u0644\u062A\u0631\u0629 \u062D\u0633\u0628 \u0627\u0644\u0645\u0627\u062F\u0629:"),a(),s(6,"select",31),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.filterSubject,r)||(o.filterSubject=r),R(r)}),I("change",function(){F(e);let r=E(2);return R(r.filterAvailableClasses())}),s(7,"option",32),u(8,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0645\u0648\u0627\u062F"),a(),j(9,d$,2,2,"option",33),a()(),s(10,"div",153)(11,"label",30),u(12,"\u0641\u0644\u062A\u0631\u0629 \u062D\u0633\u0628 \u0627\u0644\u0645\u0633\u062A\u0648\u0649:"),a(),s(13,"select",31),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.filterLevel,r)||(o.filterLevel=r),R(r)}),I("change",function(){F(e);let r=E(2);return R(r.filterAvailableClasses())}),s(14,"option",32),u(15,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0645\u0633\u062A\u0648\u064A\u0627\u062A"),a(),j(16,f$,2,2,"option",33),a()()(),j(17,m$,14,6,"div",154)(18,g$,6,0,"div",23)(19,y$,20,1,"div",24),a()}if(n&2){let e=E(2);d(),w("ngIf",e.alreadyEnrolledClasses.length>0),d(5),ve("ngModel",e.filterSubject),d(3),w("ngForOf",e.subjects),d(4),ve("ngModel",e.filterLevel),d(3),w("ngForOf",e.academicYears),d(),w("ngIf",e.selectedClasses.length>0),d(),w("ngIf",e.filteredAvailableClasses.length===0),d(),w("ngIf",e.filteredAvailableClasses.length>0)}}function b$(n,t){n&1&&(s(0,"span"),b(1,"i",67),u(2,"\u062A\u0633\u062C\u064A\u0644 \u0641\u064A \u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u062E\u062A\u0627\u0631\u0629 "),a())}function C$(n,t){n&1&&(s(0,"span"),b(1,"span",134),u(2," \u062C\u0627\u0631\u064A \u0627\u0644\u062A\u0633\u062C\u064A\u0644... "),a())}function E$(n,t){if(n&1){let e=he();s(0,"div",62)(1,"div",104)(2,"div",64)(3,"div",105)(4,"h5",66),b(5,"i",67),u(6,"\u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0637\u0627\u0644\u0628 \u0625\u0644\u0649 \u062D\u0635\u0635 \u062C\u062F\u064A\u062F\u0629 "),a(),s(7,"button",68),I("click",function(){F(e);let r=E();return R(r.closeAddToLessonsModal())}),a()(),s(8,"div",69),j(9,l$,6,0,"div",23)(10,x$,20,8,"div",51),a(),s(11,"div",79)(12,"button",80),I("click",function(){F(e);let r=E();return R(r.closeAddToLessonsModal())}),u(13,"\u0625\u0644\u063A\u0627\u0621"),a(),s(14,"button",107),I("click",function(){F(e);let r=E();return R(r.checkAndEnrollStudentToSelectedClasses())}),j(15,b$,3,0,"span",51)(16,C$,3,0,"span",51),a()()()()()}if(n&2){let e=E();d(9),w("ngIf",e.loadingAvailableClasses),d(),w("ngIf",!e.loadingAvailableClasses),d(4),w("disabled",e.selectedClasses.length===0||e.isEnrolling),d(),w("ngIf",!e.isEnrolling),d(),w("ngIf",e.isEnrolling)}}function w$(n,t){if(n&1){let e=he();s(0,"div",69)(1,"div",168)(2,"h6"),b(3,"i",145),u(4,"\u0645\u0639\u0644\u0648\u0645\u0629"),a(),s(5,"p",17),u(6," \u0627\u0644\u062D\u0635\u0629 "),s(7,"strong"),u(8),a(),u(9," \u062A\u0633\u062A\u062E\u062F\u0645 \u0646\u0638\u0627\u0645 \u0627\u0644\u062F\u0641\u0639 \u0628\u0627\u0644\u062C\u0648\u0644\u0627\u062A. \u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062C\u0648\u0644\u0629 \u0627\u0644\u0623\u0648\u0644\u0649 \u0644\u0644\u0637\u0627\u0644\u0628. "),a()(),s(10,"form",70),I("ngSubmit",function(){F(e);let r=E(2);return R(r.confirmRoundSelection())}),s(11,"div",71)(12,"div",72)(13,"label",30),u(14,"\u0631\u0642\u0645 \u0627\u0644\u062C\u0648\u0644\u0629"),a(),s(15,"input",169),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.roundSelection.roundNumber,r)||(o.roundSelection.roundNumber=r),R(r)}),a()(),s(16,"div",72)(17,"label",30),u(18,"\u0639\u062F\u062F \u0627\u0644\u062C\u0644\u0633\u0627\u062A"),a(),s(19,"input",170),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.roundSelection.sessionCount,r)||(o.roundSelection.sessionCount=r),R(r)}),I("change",function(){F(e);let r=E(2);return R(r.updateRoundTotalAmount())}),a()(),s(20,"div",72)(21,"label",30),u(22,"\u0633\u0639\u0631 \u0627\u0644\u062C\u0644\u0633\u0629 (\u062F.\u062C)"),a(),s(23,"input",171),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.roundSelection.sessionPrice,r)||(o.roundSelection.sessionPrice=r),R(r)}),I("change",function(){F(e);let r=E(2);return R(r.updateRoundTotalAmount())}),a()(),s(24,"div",72)(25,"label",30),u(26,"\u0627\u0644\u0645\u062C\u0645\u0648\u0639 \u0627\u0644\u0643\u0644\u064A (\u062F.\u062C)"),a(),b(27,"input",172),ut(28,"number"),a(),s(29,"div",72)(30,"label",30),u(31,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0628\u062F\u0621"),a(),s(32,"input",173),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.roundSelection.startDate,r)||(o.roundSelection.startDate=r),R(r)}),a()(),s(33,"div",72)(34,"label",30),u(35,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0627\u0646\u062A\u0647\u0627\u0621"),a(),s(36,"input",174),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.roundSelection.endDate,r)||(o.roundSelection.endDate=r),R(r)}),a()(),s(37,"div",77)(38,"label",30),u(39,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"),a(),s(40,"textarea",175),ye("ngModelChange",function(r){F(e);let o=E(2);return Ce(o.roundSelection.notes,r)||(o.roundSelection.notes=r),R(r)}),a()()()()()}if(n&2){let e=E(2);d(8),B(e.selectedClassForRounds.name),d(7),ve("ngModel",e.roundSelection.roundNumber),d(4),ve("ngModel",e.roundSelection.sessionCount),d(4),ve("ngModel",e.roundSelection.sessionPrice),d(4),w("value",pt(28,10,e.roundSelection.totalAmount,"1.0-0")),d(5),ve("ngModel",e.roundSelection.startDate),w("valueAsDate",e.roundSelection.startDate),d(4),ve("ngModel",e.roundSelection.endDate),w("valueAsDate",e.roundSelection.endDate),d(4),ve("ngModel",e.roundSelection.notes)}}function S$(n,t){if(n&1){let e=he();s(0,"div",62)(1,"div",63)(2,"div",64)(3,"div",83)(4,"h5",66),b(5,"i",166),u(6,"\u062A\u0643\u0648\u064A\u0646 \u0646\u0638\u0627\u0645 \u0627\u0644\u062C\u0648\u0644\u0627\u062A "),a(),s(7,"button",68),I("click",function(){F(e);let r=E();return R(r.closeRoundSelectionModal())}),a()(),j(8,w$,41,13,"div",95),s(9,"div",79)(10,"button",80),I("click",function(){F(e);let r=E();return R(r.closeRoundSelectionModal())}),u(11,"\u0631\u062C\u0648\u0639"),a(),s(12,"button",167),I("click",function(){F(e);let r=E();return R(r.confirmRoundSelection())}),u(13," \u062A\u0623\u0643\u064A\u062F \u0648\u0627\u0644\u0645\u062A\u0627\u0628\u0639\u0629 "),a()()()()()}if(n&2){let e=E();d(8),w("ngIf",e.selectedClassForRounds)}}function M$(n,t){if(n&1){let e=he();s(0,"div",176)(1,"div",177)(2,"div")(3,"button",178),I("click",function(){F(e);let r=E();return R(r.goBack())}),b(4,"i",179),u(5,"\u0627\u0644\u0639\u0648\u062F\u0629 \u0625\u0644\u0649 \u0627\u0644\u0642\u0627\u0626\u0645\u0629 "),a(),s(6,"h1",180),u(7),a(),s(8,"div",181)(9,"span",182),u(10),a(),s(11,"span",143),u(12),a(),s(13,"span",183),u(14),a()()(),s(15,"div",184)(16,"button",185),I("click",function(){F(e);let r=E();return R(r.printStudentReport())}),b(17,"i",186),u(18,"\u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 "),a(),s(19,"button",187),I("click",function(){F(e);let r=E();return R(r.openBulkPaymentModal())}),b(20,"i",21),u(21,"\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A \u062C\u062F\u064A\u062F "),a(),s(22,"button",188),I("click",function(){F(e);let r=E();return R(r.openAddToLessonsModal())}),b(23,"i",67),u(24,"\u0625\u0636\u0627\u0641\u0629 \u0625\u0644\u0649 \u062D\u0635\u0635 "),a()()(),s(25,"div",189)(26,"div",190)(27,"div",191)(28,"div",192),b(29,"i",193),a(),s(30,"div",194)(31,"h5"),u(32),a(),s(33,"p"),u(34,"\u0639\u062F\u062F \u0627\u0644\u062D\u0635\u0635"),a()()()(),s(35,"div",190)(36,"div",191)(37,"div",195),b(38,"i",196),a(),s(39,"div",194)(40,"h5"),u(41),ut(42,"number"),a(),s(43,"p"),u(44,"\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0645\u062F\u0641\u0648\u0639"),a()()()(),s(45,"div",190)(46,"div",191)(47,"div",197),b(48,"i",48),a(),s(49,"div",194)(50,"h5"),u(51),ut(52,"number"),a(),s(53,"p"),u(54,"\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0645\u0639\u0644\u0642"),a()()()(),s(55,"div",190)(56,"div",191)(57,"div",198),b(58,"i",199),a(),s(59,"div",194)(60,"h5"),u(61),a(),s(62,"p"),u(63,"\u0627\u0644\u0639\u0645\u0631"),a()()()()()()}if(n&2){let e=E();d(7),B(e.student.name),d(3),H("\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628: ",e.student.studentId,""),d(),w("ngClass",Aa(15,cD,e.student.active,!e.student.active)),d(),H(" ",e.student.active?"\u0646\u0634\u0637":"\u063A\u064A\u0631 \u0646\u0634\u0637"," "),d(2),B(e.getAcademicYearName(e.student.academicYear)),d(18),B(e.studentClasses.length),d(9),H("",pt(42,9,e.getTotalPaid(),"1.0-0")," \u062F.\u062C"),d(10),H("",pt(52,12,e.getTotalPending(),"1.0-0")," \u062F.\u062C"),d(10),B(e.calculateAge(e.student.birthDate))}}function A$(n,t){if(n&1&&(s(0,"span",117),u(1),a()),n&2){let e=E(2);d(),H(" (\u0627\u0644\u0639\u0645\u0631: ",e.calculateAge(e.student.birthDate)," \u0633\u0646\u0629) ")}}function T$(n,t){n&1&&(s(0,"div",219),b(1,"i",220),s(2,"p"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u062D\u0635\u0635 \u0645\u0633\u062C\u0644\u0629"),a()())}function D$(n,t){if(n&1){let e=he();s(0,"li",223)(1,"div")(2,"h6",101),u(3),a(),s(4,"small",117),u(5),a()(),s(6,"div",224)(7,"span",225),u(8),ut(9,"number"),a(),s(10,"button",226),I("click",function(){let r=F(e).$implicit,o=E(3);return R(o.openClassPaymentsModal(r))}),b(11,"i",227),a()()()}if(n&2){let e=t.$implicit;d(3),B(e.name),d(2),B(e.subject),d(3),H(" ",pt(9,3,e.price,"1.0-0")," \u062F.\u062C ")}}function P$(n,t){if(n&1&&(s(0,"div")(1,"ul",221),j(2,D$,12,6,"li",222),a()()),n&2){let e=E(2);d(2),w("ngForOf",e.studentClasses)}}function I$(n,t){if(n&1&&(s(0,"div",71)(1,"div",200)(2,"div",15)(3,"div",52)(4,"h5",17),b(5,"i",145),u(6,"\u0627\u0644\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u0623\u0633\u0627\u0633\u064A\u0629"),a()(),s(7,"div",22)(8,"div",71)(9,"div",72)(10,"label",201),u(11,"\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(12,"p",202),u(13),a()(),s(14,"div",72)(15,"label",201),u(16,"\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(17,"p",202),u(18),a()(),s(19,"div",72)(20,"label",201),u(21,"\u0627\u0644\u0645\u0633\u062A\u0648\u0649 \u0627\u0644\u062F\u0631\u0627\u0633\u064A"),a(),s(22,"p",202),u(23),a()(),s(24,"div",72)(25,"label",201),u(26,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0645\u064A\u0644\u0627\u062F"),a(),s(27,"p",202),u(28),ut(29,"date"),j(30,A$,2,1,"span",203),a()(),s(31,"div",72)(32,"label",201),u(33,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062A\u0633\u062C\u064A\u0644"),a(),s(34,"p",202),u(35),ut(36,"date"),a()(),s(37,"div",72)(38,"label",201),u(39,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(40,"p",202)(41,"span",143),u(42),a(),s(43,"span",204),u(44),a()()()()()(),s(45,"div",205)(46,"div",206)(47,"h5",17),b(48,"i",21),u(49,"\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631"),a()(),s(50,"div",22)(51,"div",71)(52,"div",72)(53,"label",201),u(54,"\u0627\u0633\u0645 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631"),a(),s(55,"p",202),u(56),a()(),s(57,"div",72)(58,"label",201),u(59,"\u0631\u0642\u0645 \u0627\u0644\u0647\u0627\u062A\u0641"),a(),s(60,"p",202),u(61),a()(),s(62,"div",72)(63,"label",201),u(64,"\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"),a(),s(65,"p",202),u(66),a()()()()()(),s(67,"div",42)(68,"div",15)(69,"div",207)(70,"h5",17),b(71,"i",208),u(72,"\u0645\u0644\u062E\u0635 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A"),a()(),s(73,"div",22)(74,"div",209)(75,"div",210)(76,"span",211),u(77,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639:"),a(),s(78,"span",212),u(79),ut(80,"number"),a()(),s(81,"div",210)(82,"span",211),u(83,"\u0627\u0644\u0645\u0639\u0644\u0642:"),a(),s(84,"span",213),u(85),ut(86,"number"),a()(),b(87,"hr"),s(88,"div",214)(89,"span",211),u(90,"\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:"),a(),s(91,"span",215),u(92),ut(93,"number"),a()()()()(),s(94,"div",205)(95,"div",216)(96,"h5",17),b(97,"i",217),u(98,"\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u0633\u062C\u0644\u0629"),a()(),s(99,"div",22),j(100,T$,4,0,"div",218)(101,P$,3,1,"div",51),a()()()()),n&2){let e=E();d(13),B(e.student.name),d(5),B(e.student.studentId),d(5),B(e.getAcademicYearName(e.student.academicYear)),d(5),H(" ",e.student.birthDate?pt(29,18,e.student.birthDate,"dd/MM/yyyy"):"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"," "),d(2),w("ngIf",e.student.birthDate),d(5),B(pt(36,21,e.student.registrationDate,"dd/MM/yyyy")),d(6),w("ngClass",Aa(33,cD,e.student.active,!e.student.active)),d(),H(" ",e.student.active?"\u0646\u0634\u0637":"\u063A\u064A\u0631 \u0646\u0634\u0637"," "),d(),w("ngClass",Aa(36,RG,e.student.hasPaidRegistration,!e.student.hasPaidRegistration)),d(),H(" ",e.student.hasPaidRegistration?"\u0645\u0633\u062C\u0644 \u0628\u062F\u0641\u0639":"\u063A\u064A\u0631 \u0645\u0633\u062C\u0644"," "),d(12),B(e.student.parentName),d(5),B(e.student.parentPhone),d(5),H(" ",e.student.parentEmail||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"," "),d(13),H("",pt(80,24,e.getTotalPaid(),"1.0-0")," \u062F.\u062C"),d(6),H("",pt(86,27,e.getTotalPending(),"1.0-0")," \u062F.\u062C"),d(7),H("",pt(93,30,e.getTotalPaid()+e.getTotalPending(),"1.0-0")," \u062F.\u062C"),d(8),w("ngIf",e.studentClasses.length===0),d(),w("ngIf",e.studentClasses.length>0)}}function O$(n,t){if(n&1){let e=he();s(0,"div",137),b(1,"i",160),s(2,"h5",117),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u062D\u0635\u0635 \u0645\u0633\u062C\u0644\u0629"),a(),s(4,"p",228),u(5,"\u0627\u0628\u062F\u0623 \u0628\u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0637\u0627\u0644\u0628 \u0625\u0644\u0649 \u062D\u0635\u0635 \u062C\u062F\u064A\u062F\u0629"),a(),s(6,"button",229),I("click",function(){F(e);let r=E();return R(r.openAddToLessonsModal())}),b(7,"i",67),u(8,"\u0625\u0636\u0627\u0641\u0629 \u0625\u0644\u0649 \u062D\u0635\u0635 "),a()()}}function F$(n,t){if(n&1&&(s(0,"div",163),b(1,"i",234),u(2),a()),n&2){let e=E().$implicit;d(2),Gn(" ",e.schedule[0]==null?null:e.schedule[0].day," - ",e.schedule[0]==null?null:e.schedule[0].time," ")}}function R$(n,t){if(n&1){let e=he();s(0,"tr")(1,"td")(2,"strong"),u(3),a(),j(4,F$,3,2,"div",230),a(),s(5,"td"),u(6),a(),s(7,"td"),u(8),a(),s(9,"td")(10,"span",143),u(11),a()(),s(12,"td")(13,"strong",142),u(14),ut(15,"number"),a(),s(16,"div",163),u(17),a()(),s(18,"td"),u(19),a(),s(20,"td")(21,"span",231),u(22,"\u0646\u0634\u0637\u0629"),a()(),s(23,"td")(24,"div",232)(25,"button",233),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.openClassPaymentsModal(r))}),b(26,"i",227),a()()()()}if(n&2){let e=t.$implicit,i=E(2);d(3),B(e.name),d(),w("ngIf",e.schedule),d(2),B(e.subject),d(2),B((e.teacher==null?null:e.teacher.name)||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(2),w("ngClass",Aa(12,uD,e.paymentSystem==="monthly",e.paymentSystem==="rounds")),d(),H(" ",e.paymentSystem==="monthly"?"\u0634\u0647\u0631\u064A":"\u062C\u0648\u0644\u0627\u062A"," "),d(3),H("",pt(15,9,e.price,"1.0-0")," \u062F.\u062C"),d(3),H(" ",e.paymentSystem==="monthly"?"\u0634\u0647\u0631\u064A\u0627\u064B":"\u0644\u0644\u0645\u062C\u0645\u0648\u0639\u0629"," "),d(2),B(i.getAcademicYearName(e.academicYear))}}function k$(n,t){if(n&1&&(s(0,"div",139)(1,"table",140)(2,"thead",141)(3,"tr")(4,"th"),u(5,"\u0627\u0633\u0645 \u0627\u0644\u062D\u0635\u0629"),a(),s(6,"th"),u(7,"\u0627\u0644\u0645\u0627\u062F\u0629"),a(),s(8,"th"),u(9,"\u0627\u0644\u0645\u0639\u0644\u0645"),a(),s(10,"th"),u(11,"\u0646\u0638\u0627\u0645 \u0627\u0644\u062F\u0641\u0639"),a(),s(12,"th"),u(13,"\u0627\u0644\u0633\u0639\u0631"),a(),s(14,"th"),u(15,"\u0627\u0644\u0645\u0633\u062A\u0648\u0649"),a(),s(16,"th"),u(17,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(18,"th"),u(19,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(20,"tbody"),j(21,R$,27,15,"tr",128),a()()()),n&2){let e=E();d(21),w("ngForOf",e.studentClasses)}}function N$(n,t){if(n&1&&(s(0,"option",82),u(1),a()),n&2){let e=t.$implicit;w("value",e),d(),H(" ",e," ")}}function U$(n,t){if(n&1&&(s(0,"option",82),u(1),a()),n&2){let e=t.$implicit;w("value",e._id||e.id),d(),H(" ",e.name," ")}}function L$(n,t){if(n&1){let e=he();s(0,"div",235)(1,"div",118)(2,"div")(3,"h6",236),b(4,"i",27),u(5,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0645\u062D\u062F\u062F\u0629"),a(),s(6,"p",17)(7,"strong"),u(8),a(),u(9," \u062F\u0641\u0639\u0629 \u0645\u0628\u0644\u063A\u0647\u0627 "),s(10,"strong"),u(11),ut(12,"number"),a()()(),s(13,"div",237)(14,"button",238),I("click",function(){F(e);let r=E();return R(r.printSelectedPaymentsReceipt())}),b(15,"i",186),u(16,"\u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0645\u062D\u062F\u062F "),a(),s(17,"button",20),I("click",function(){F(e);let r=E();return R(r.openBulkPayConfirmation())}),b(18,"i",133),u(19,"\u062F\u0641\u0639 \u0627\u0644\u0645\u062D\u062F\u062F "),a()()()()}if(n&2){let e=E();d(8),B(e.selectedPaymentsForBulkPay.length),d(3),H("",pt(12,3,e.getSelectedPaymentsTotal(),"1.0-0")," \u062F.\u062C"),d(3),w("disabled",!e.hasPaidPaymentsSelected())}}function B$(n,t){if(n&1){let e=he();s(0,"div",137),b(1,"i",138),s(2,"h5",117),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0645\u0633\u062C\u0644\u0629"),a(),s(4,"p",228),u(5,"\u0627\u0628\u062F\u0623 \u0628\u062A\u0633\u062C\u064A\u0644 \u062F\u0641\u0639\u0629 \u062C\u062F\u064A\u062F\u0629 \u0644\u0644\u0637\u0627\u0644\u0628"),a(),s(6,"div")(7,"button",187),I("click",function(){F(e);let r=E();return R(r.openAddPaymentModal())}),b(8,"i",67),u(9,"\u062F\u0641\u0639\u0629 \u0641\u0631\u062F\u064A\u0629 "),a(),s(10,"button",20),I("click",function(){F(e);let r=E();return R(r.openBulkPaymentModal())}),b(11,"i",21),u(12,"\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A \u062C\u062F\u064A\u062F "),a()()()}}function V$(n,t){if(n&1){let e=he();s(0,"button",267),I("click",function(){F(e);let r=E().$implicit,o=E(3);return R(o.payPayment(r))}),b(1,"i",268),a()}}function H$(n,t){if(n&1){let e=he();s(0,"button",269),I("click",function(){F(e);let r=E().$implicit,o=E(3);return R(o.printPaymentReceipt(r))}),b(1,"i",262),a()}}function z$(n,t){if(n&1){let e=he();s(0,"tr")(1,"td")(2,"input",161),I("change",function(){let r=F(e).$implicit,o=E(3);return R(o.togglePaymentSelection(r))}),a()(),s(3,"td")(4,"strong"),u(5),a()(),s(6,"td"),u(7),ut(8,"date"),a(),s(9,"td")(10,"strong",142),u(11),ut(12,"number"),a()(),s(13,"td"),u(14),a(),s(15,"td"),u(16),a(),s(17,"td")(18,"span",143),u(19),a()(),s(20,"td")(21,"div",232),j(22,V$,2,0,"button",259)(23,H$,2,0,"button",260),s(24,"button",261),I("click",function(){let r=F(e).$implicit,o=E(3);return R(o.printPaymentReceipt(r))}),b(25,"i",262),a(),s(26,"button",263),I("click",function(){let r=F(e).$implicit,o=E(3);return R(o.openEditPaymentModal(r))}),b(27,"i",264),a(),s(28,"button",265),I("click",function(){let r=F(e).$implicit,o=E(3);return R(o.openDeleteConfirmModal(r))}),b(29,"i",266),a()()()()}if(n&2){let e=t.$implicit,i=E(3);Ie("table-warning",!i.isPaymentSelected(e))("table-success",i.isPaymentSelected(e)),d(2),w("checked",i.isPaymentSelected(e))("disabled",e.status==="paid"),d(3),B(e.invoiceNumber||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(2),H(" ",e.paymentDate?pt(8,15,e.paymentDate,"dd/MM/yyyy"):"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u062F\u0641\u0639"," "),d(4),H("",pt(12,18,e.amount,"1.0-0")," \u062F.\u062C"),d(3),B(e.month),d(2),B(i.getPaymentMethodLabel(e.paymentMethod)),d(2),w("ngClass",i.getPaymentStatusClass(e)),d(),H(" ",i.getPaymentStatusText(e)," "),d(3),w("ngIf",e.status!=="paid"),d(),w("ngIf",e.status==="paid")}}function j$(n,t){if(n&1&&(s(0,"tfoot")(1,"tr",270)(2,"td",271)(3,"strong"),u(4,"\u0627\u0644\u0645\u062C\u0645\u0648\u0639:"),a()(),s(5,"td")(6,"strong"),u(7),ut(8,"number"),a()(),b(9,"td",272),a()()),n&2){let e=E().$implicit;d(7),H("",pt(8,1,e.totalAmount,"1.0-0")," \u062F.\u062C")}}function W$(n,t){if(n&1){let e=he();s(0,"div",248)(1,"h2",249)(2,"button",250),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.toggleClassPaymentGroup(r.classId))}),s(3,"div",251)(4,"div")(5,"h6",101),u(6),a(),s(7,"div",252)(8,"span",231),b(9,"i",253),u(10),ut(11,"number"),a(),s(12,"span",149),b(13,"i",234),u(14),ut(15,"number"),a(),s(16,"span",254),b(17,"i",255),u(18),a()()(),s(19,"div",131)(20,"strong",142),u(21),ut(22,"number"),a()()()()(),s(23,"div",256)(24,"div",257)(25,"div",139)(26,"table",126)(27,"thead",141)(28,"tr")(29,"th",127)(30,"input",132),I("change",function(){let r=F(e).$implicit,o=E(2);return R(o.toggleAllPaymentsInGroup(r))}),a()(),s(31,"th"),u(32,"\u0631\u0642\u0645 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629"),a(),s(33,"th"),u(34,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E"),a(),s(35,"th"),u(36,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(37,"th"),u(38,"\u0627\u0644\u0634\u0647\u0631"),a(),s(39,"th"),u(40,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(41,"th"),u(42,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(43,"th"),u(44,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(45,"tbody"),j(46,z$,30,21,"tr",258),a(),j(47,j$,10,4,"tfoot",51),a()()()()()}if(n&2){let e=t.$implicit,i=E(2);d(2),Ie("collapsed",!i.isClassGroupExpanded(e.classId)),Ma("aria-expanded",i.isClassGroupExpanded(e.classId)),d(4),B(e.className),d(4),H(" \u0645\u062F\u0641\u0648\u0639: ",pt(11,13,e.paidAmount,"1.0-0")," \u062F.\u062C "),d(4),H(" \u0645\u0639\u0644\u0642: ",pt(15,16,e.pendingAmount,"1.0-0")," \u062F.\u062C "),d(4),H(" ",e.payments.length," \u062F\u0641\u0639\u0629 "),d(3),H("",pt(22,19,e.totalAmount,"1.0-0")," \u062F.\u062C"),d(2),Ie("show",i.isClassGroupExpanded(e.classId)),d(7),w("checked",i.isAllPaymentsInGroupSelected(e)),d(16),w("ngForOf",e.payments),d(),w("ngIf",e.payments.length>0)}}function G$(n,t){if(n&1&&(s(0,"div",243)(1,"span"),u(2),a(),s(3,"strong"),u(4),ut(5,"number"),a()()),n&2){let e=t.$implicit;d(2),H("",e.className,":"),d(2),H("",pt(5,2,e.totalAmount,"1.0-0")," \u062F.\u062C")}}function $$(n,t){if(n&1&&(s(0,"div")(1,"div",239),j(2,W$,48,22,"div",240),a(),s(3,"div",205)(4,"div",241)(5,"h6",17),b(6,"i",208),u(7,"\u0645\u0644\u062E\u0635 \u0634\u0627\u0645\u0644 \u0644\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A"),a()(),s(8,"div",22)(9,"div",71)(10,"div",153)(11,"h6"),u(12,"\u062D\u0633\u0628 \u0627\u0644\u062D\u0627\u0644\u0629:"),a(),s(13,"div",242)(14,"div",243)(15,"span"),u(16,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A:"),a(),s(17,"strong",244),u(18),ut(19,"number"),a()(),s(20,"div",243)(21,"span"),u(22,"\u0627\u0644\u0645\u0639\u0644\u0642\u0629:"),a(),s(23,"strong",245),u(24),ut(25,"number"),a()(),s(26,"div",246)(27,"span"),u(28,"\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:"),a(),s(29,"strong",142),u(30),ut(31,"number"),a()()()(),s(32,"div",153)(33,"h6"),u(34,"\u062D\u0633\u0628 \u0627\u0644\u062D\u0635\u0635:"),a(),s(35,"div",242),j(36,G$,6,5,"div",247),a()()()()()()),n&2){let e=E();d(2),w("ngForOf",e.classPaymentGroups),d(16),H("",pt(19,5,e.getTotalPaid(),"1.0-0")," \u062F.\u062C"),d(6),H("",pt(25,8,e.getTotalPending(),"1.0-0")," \u062F.\u062C"),d(6),H("",pt(31,11,e.getTotalPaid()+e.getTotalPending(),"1.0-0")," \u062F.\u062C"),d(6),w("ngForOf",e.classPaymentGroups)}}function Y$(n,t){n&1&&(s(0,"div",273),b(1,"i",145),u(2," \u0644\u0627 \u062A\u0648\u062C\u062F \u062F\u0641\u0639\u0627\u062A \u0634\u0647\u0631\u064A\u0629 \u0645\u0633\u062C\u0644\u0629 \u0644\u0647\u0630\u0627 \u0627\u0644\u0637\u0627\u0644\u0628 "),a())}function q$(n,t){if(n&1){let e=he();s(0,"button",267),I("click",function(){F(e);let r=E().$implicit,o=E(2);return R(o.payLatePayment(r))}),b(1,"i",268),a()}}function X$(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td")(4,"strong",142),u(5),ut(6,"number"),a()(),s(7,"td"),u(8),a(),s(9,"td"),u(10),ut(11,"date"),a(),s(12,"td"),u(13),ut(14,"date"),a(),s(15,"td"),u(16),a(),s(17,"td")(18,"span",143),u(19),a()(),s(20,"td")(21,"div",232),j(22,q$,2,0,"button",259),a()()()),n&2){let e=t.$implicit,i=E(2);d(2),B(e.month),d(3),H("",pt(6,9,e.amount,"1.0-0")," \u062F.\u062C"),d(3),B(e.className||"\u0639\u0627\u0645"),d(2),H(" ",e.dueDate?pt(11,12,e.dueDate,"dd/MM/yyyy"):"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"," "),d(3),H(" ",e.paymentDate?pt(14,15,e.paymentDate,"dd/MM/yyyy"):"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u062F\u0641\u0639"," "),d(3),B(e.paymentMethod?i.getPaymentMethodLabel(e.paymentMethod):"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(2),w("ngClass",x0(18,kG,e.status==="paid",e.status==="pending",e.status==="late")),d(),H(" ",e.status==="paid"?"\u0645\u062F\u0641\u0648\u0639":e.status==="pending"?"\u0645\u0639\u0644\u0642":e.status==="late"?"\u0645\u062A\u0623\u062E\u0631":e.status," "),d(3),w("ngIf",e.status!=="paid")}}function Z$(n,t){if(n&1&&(s(0,"div",139)(1,"table",140)(2,"thead",141)(3,"tr")(4,"th"),u(5,"\u0627\u0644\u0634\u0647\u0631"),a(),s(6,"th"),u(7,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(8,"th"),u(9,"\u0627\u0644\u062D\u0635\u0629"),a(),s(10,"th"),u(11,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0627\u0633\u062A\u062D\u0642\u0627\u0642"),a(),s(12,"th"),u(13,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639"),a(),s(14,"th"),u(15,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(16,"th"),u(17,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(18,"th"),u(19,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(20,"tbody"),j(21,X$,23,22,"tr",128),a()()()),n&2){let e=E();d(21),w("ngForOf",e.studentMonthlyPayments)}}function J$(n,t){n&1&&(s(0,"div",100),b(1,"i",274),u(2," \u0644\u0627 \u062A\u0648\u062C\u062F \u062C\u0648\u0644\u0627\u062A \u062F\u0641\u0639 \u0645\u0633\u062C\u0644\u0629 \u0644\u0647\u0630\u0627 \u0627\u0644\u0637\u0627\u0644\u0628 "),a())}function K$(n,t){if(n&1&&(s(0,"div",281)(1,"span",211),u(2,"\u0627\u0644\u062D\u0635\u0629:"),a(),s(3,"span",215),u(4),a()()),n&2){let e=E().$implicit;d(4),B(e.class.name)}}function Q$(n,t){if(n&1){let e=he();s(0,"button",288),I("click",function(){F(e);let r=E().$implicit,o=E(2);return R(o.payRound(r))}),b(1,"i",289),u(2,"\u062F\u0641\u0639 "),a()}}function eY(n,t){if(n&1){let e=he();s(0,"div",276)(1,"div",277)(2,"div",278)(3,"h6",279)(4,"span"),b(5,"i",166),u(6),a(),s(7,"span",143),u(8),a()()(),s(9,"div",22)(10,"div",280)(11,"div",281)(12,"span",211),u(13,"\u0639\u062F\u062F \u0627\u0644\u062C\u0644\u0633\u0627\u062A:"),a(),s(14,"span",215),u(15),a()(),s(16,"div",281)(17,"span",211),u(18,"\u0633\u0639\u0631 \u0627\u0644\u062C\u0644\u0633\u0629:"),a(),s(19,"span",215),u(20),ut(21,"number"),a()(),s(22,"div",281)(23,"span",211),u(24,"\u0627\u0644\u0645\u062C\u0645\u0648\u0639:"),a(),s(25,"span",282),u(26),ut(27,"number"),a()(),s(28,"div",281)(29,"span",211),u(30,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0628\u062F\u0621:"),a(),s(31,"span",215),u(32),ut(33,"date"),a()(),s(34,"div",281)(35,"span",211),u(36,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0627\u0646\u062A\u0647\u0627\u0621:"),a(),s(37,"span",215),u(38),ut(39,"date"),a()(),j(40,K$,5,1,"div",283),a()(),s(41,"div",284)(42,"div",243)(43,"button",285),I("click",function(){let r=F(e).$implicit,o=E(2);return R(o.viewRoundDetails(r))}),b(44,"i",286),u(45,"\u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644 "),a(),j(46,Q$,3,0,"button",287),a()()()()}if(n&2){let e=t.$implicit;d(),w("ngClass",x0(23,NG,e.status==="paid",e.status==="pending",e.status==="late")),d(5),H(" \u0627\u0644\u062C\u0648\u0644\u0629 ",e.roundNumber," "),d(),w("ngClass",e.statusClass),d(),H(" ",e.statusText," "),d(7),B(e.sessionCount),d(5),H("",pt(21,11,e.sessionPrice,"1.0-0")," \u062F.\u062C"),d(6),H("",pt(27,14,e.totalAmount,"1.0-0")," \u062F.\u062C"),d(6),B(pt(33,17,e.startDate,"dd/MM/yyyy")),d(6),B(pt(39,20,e.endDate,"dd/MM/yyyy")),d(2),w("ngIf",e.class),d(6),w("ngIf",e.status!=="paid")}}function tY(n,t){if(n&1&&(s(0,"div",71),j(1,eY,47,27,"div",275),a()),n&2){let e=E();d(),w("ngForOf",e.studentRounds)}}var Y1=class n{constructor(t,e,i,r){this.route=t;this.router=e;this.http=i;this.printerService=r}apiUrl=Bt.apiUrl;student=null;loading=!1;activeTab="info";studentClasses=[];paymentHistory=[];showPaymentModal=!1;showEditPaymentModal=!1;showDeleteConfirmModal=!1;showBulkPaymentModal=!1;showClassPaymentsModal=!1;classPaymentGroups=[];selectedPaymentsForBulkPay=[];showBulkPayConfirmation=!1;selectedMonthForGroupPay="";selectedClassForGroupPay="all";newPayment={student:"",amount:0,month:"",paymentMethod:"cash",notes:""};bulkPayment={studentIds:[],classId:"",amount:0,month:"",paymentMethod:"cash",notes:"\u062F\u0641\u0639\u0629 \u062C\u0645\u0627\u0639\u064A\u0629"};editingPayment=null;paymentToDelete=null;selectedClassForPayments=null;classPayments=[];allStudents=[];selectedStudents=[];filteredStudents=[];studentSearchTerm="";classForBulkPayment=null;isProcessingBulkPayment=!1;bulkPaymentProgress=0;bulkPaymentResults=[];months=["\u064A\u0646\u0627\u064A\u0631","\u0641\u0628\u0631\u0627\u064A\u0631","\u0645\u0627\u0631\u0633","\u0623\u0628\u0631\u064A\u0644","\u0645\u0627\u064A\u0648","\u064A\u0648\u0646\u064A\u0648","\u064A\u0648\u0644\u064A\u0648","\u0623\u063A\u0633\u0637\u0633","\u0633\u0628\u062A\u0645\u0628\u0631","\u0623\u0643\u062A\u0648\u0628\u0631","\u0646\u0648\u0641\u0645\u0628\u0631","\u062F\u064A\u0633\u0645\u0628\u0631"];paymentMethods=[{value:"cash",label:"\u0646\u0642\u062F\u0627\u064B"},{value:"bank",label:"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A"},{value:"card",label:"\u0628\u0637\u0627\u0642\u0629 \u0625\u0626\u062A\u0645\u0627\u0646"},{value:"check",label:"\u0634\u064A\u0643"},{value:"online",label:"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"},{value:"mobile",label:"\u062F\u0641\u0639 \u0645\u062D\u0645\u0648\u0644"}];academicYears=[{value:"1AS",label:"\u0627\u0644\u0623\u0648\u0644\u0649 \u062B\u0627\u0646\u0648\u064A"},{value:"2AS",label:"\u0627\u0644\u062B\u0627\u0646\u064A\u0629 \u062B\u0627\u0646\u0648\u064A"},{value:"3AS",label:"\u0627\u0644\u062B\u0627\u0644\u062B\u0629 \u062B\u0627\u0646\u0648\u064A"},{value:"1MS",label:"\u0627\u0644\u0623\u0648\u0644\u0649 \u0645\u062A\u0648\u0633\u0637"},{value:"2MS",label:"\u0627\u0644\u062B\u0627\u0646\u064A\u0629 \u0645\u062A\u0648\u0633\u0637"},{value:"3MS",label:"\u0627\u0644\u062B\u0627\u0644\u062B\u0629 \u0645\u062A\u0648\u0633\u0637"},{value:"4MS",label:"\u0627\u0644\u0631\u0627\u0628\u0639\u0629 \u0645\u062A\u0648\u0633\u0637"},{value:"1AP",label:"\u0627\u0644\u0623\u0648\u0644\u0649 \u0627\u0628\u062A\u062F\u0627\u0626\u064A"},{value:"2AP",label:"\u0627\u0644\u062B\u0627\u0646\u064A\u0629 \u0627\u0628\u062A\u062F\u0627\u0626\u064A"},{value:"3AP",label:"\u0627\u0644\u062B\u0627\u0644\u062B\u0629 \u0627\u0628\u062A\u062F\u0627\u0626\u064A"},{value:"4AP",label:"\u0627\u0644\u0631\u0627\u0628\u0639\u0629 \u0627\u0628\u062A\u062F\u0627\u0626\u064A"},{value:"5AP",label:"\u0627\u0644\u062E\u0627\u0645\u0633\u0629 \u0627\u0628\u062A\u062F\u0627\u0626\u064A"}];showAddToLessonsModal=!1;availableClasses=[];filteredAvailableClasses=[];alreadyEnrolledClasses=[];selectedClasses=[];loadingAvailableClasses=!1;isEnrolling=!1;showRoundSelectionModal=!1;selectedClassForRounds=null;roundSelection={roundNumber:`RND-${Date.now().toString().slice(-6)}`,sessionCount:8,sessionPrice:0,totalAmount:0,startDate:new Date,endDate:new Date(Date.now()+30*24*60*60*1e3),notes:""};filterSubject="";filterLevel="";subjects=["\u0631\u064A\u0627\u0636\u064A\u0627\u062A","\u0641\u064A\u0632\u064A\u0627\u0621","\u0639\u0644\u0648\u0645","\u0644\u063A\u0629 \u0639\u0631\u0628\u064A\u0629","\u0644\u063A\u0629 \u0641\u0631\u0646\u0633\u064A\u0629","\u0644\u063A\u0629 \u0627\u0646\u062C\u0644\u064A\u0632\u064A\u0629","\u062A\u0627\u0631\u064A\u062E","\u062C\u063A\u0631\u0627\u0641\u064A\u0627","\u0641\u0644\u0633\u0641\u0629","\u0625\u0639\u0644\u0627\u0645 \u0622\u0644\u064A"];studentMonthlyPayments=[];studentRounds=[];currentDate=new Date;receiptOptions=[{label:"\u0625\u064A\u0635\u0627\u0644 \u0648\u0627\u062D\u062F \u0644\u062C\u0645\u064A\u0639 \u0627\u0644\u062F\u0641\u0639\u0627\u062A",value:"single",description:"\u0637\u0628\u0627\u0639\u0629 \u062C\u0645\u064A\u0639 \u0627\u0644\u062F\u0641\u0639\u0627\u062A \u0641\u064A \u0625\u064A\u0635\u0627\u0644 \u0648\u0627\u062D\u062F \u0645\u0639 \u062A\u0641\u0627\u0635\u064A\u0644 \u0643\u0644 \u062F\u0641\u0639\u0629",icon:"fas fa-receipt"},{label:"\u0625\u064A\u0635\u0627\u0644\u0627\u062A \u0645\u0646\u0641\u0635\u0644\u0629 \u0644\u0643\u0644 \u062F\u0641\u0639\u0629",value:"multiple",description:"\u0637\u0628\u0627\u0639\u0629 \u0625\u064A\u0635\u0627\u0644 \u0645\u0646\u0641\u0635\u0644 \u0644\u0643\u0644 \u062F\u0641\u0639\u0629",icon:"fas fa-copy"}];selectedReceiptOption="single";ngOnInit(){this.loadStudentDetails(),this.loadAllStudents()}getHeaders(){let t=localStorage.getItem("token");return new Xr({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}loadStudentDetails(){let t=this.route.snapshot.paramMap.get("id");if(!t){this.router.navigate(["/home/students-management"]);return}this.loading=!0,this.http.get(`${this.apiUrl}/students/${t}`,{headers:this.getHeaders()}).subscribe({next:e=>{this.student=e,this.newPayment.student=this.getStudentId(),this.loadStudentClasses(t),this.loadPaymentHistory(t),this.loadStudentPaymentSystems(t),this.loading=!1},error:e=>{console.error("Error loading student details:",e),et.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u0637\u0627\u0644\u0628","error"),this.router.navigate(["/home/students-management"]),this.loading=!1}})}loadAllStudents(){this.http.get(`${this.apiUrl}/students`,{headers:this.getHeaders()}).subscribe({next:t=>{t.success&&t.data?(this.allStudents=t.data,this.filteredStudents=[...this.allStudents]):(this.allStudents=[],this.filteredStudents=[])},error:t=>{console.error("Error loading all students:",t),this.allStudents=[],this.filteredStudents=[]}})}loadStudentClasses(t){this.http.get(`${this.apiUrl}/students/${t}`,{headers:this.getHeaders()}).subscribe({next:e=>{this.studentClasses=e.classes||[]},error:e=>{console.error("Error loading student classes:",e),this.studentClasses=[]}})}loadPaymentHistory(t){console.log("Loading payment history for student:",t),this.http.get(`${this.apiUrl}/payments/student/${t}`,{headers:this.getHeaders()}).subscribe({next:e=>{console.log("Payment history response:",e),e.success&&e.payments?(this.paymentHistory=e.payments,this.classPaymentGroups=this.groupPaymentsByClass(e.payments),console.log(`Loaded ${this.paymentHistory.length} payments`)):(this.paymentHistory=[],this.classPaymentGroups=[],console.log("No payments found or error in response"))},error:e=>{console.error("Error loading payment history:",e),this.paymentHistory=[],this.classPaymentGroups=[],et.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0633\u062C\u0644 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A","error")}})}groupPaymentsByClass(t){let e={};return t.forEach(i=>{let r=i.class?._id||i.class||"general",o=i.className||"\u0639\u0627\u0645";e[r]||(e[r]={classId:r,className:o,payments:[],totalAmount:0,paidAmount:0,pendingAmount:0}),e[r].payments.push(i),e[r].totalAmount+=i.amount,i.status==="paid"?e[r].paidAmount+=i.amount:e[r].pendingAmount+=i.amount}),Object.values(e)}toggleClassPaymentGroup(t){let e=this.classPaymentGroups.find(i=>i.classId===t);e&&(e.expanded=!e.expanded)}isClassGroupExpanded(t){let e=this.classPaymentGroups.find(i=>i.classId===t);return e&&e.expanded||!1}processBulkPaySelected(){return wt(this,null,function*(){if(this.selectedPaymentsForBulkPay.length===0){et.default.fire({icon:"warning",title:"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0645\u062E\u062A\u0627\u0631\u0629",text:"\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0644\u0644\u062F\u0641\u0639 \u0623\u0648\u0644\u0627\u064B",confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"});return}if(this.selectedPaymentsForBulkPay.some(x=>x.status==="paid")){let x=this.selectedPaymentsForBulkPay.filter(A=>A.status!=="paid"),{value:C}=yield et.default.fire({title:"\u062A\u062D\u0630\u064A\u0631",html:`
          <div class="text-start">
            <p class="text-warning"><i class="fas fa-exclamation-triangle me-2"></i>\u0628\u0639\u0636 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0645\u062E\u062A\u0627\u0631\u0629 \u0645\u062F\u0641\u0648\u0639\u0629 \u0645\u0633\u0628\u0642\u0627\u064B</p>
            <p><strong>\u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0629:</strong> ${this.selectedPaymentsForBulkPay.length-x.length}</p>
            <p><strong>\u0627\u0644\u0645\u0639\u0644\u0642\u0629:</strong> ${x.length}</p>
            <p>\u0647\u0644 \u062A\u0631\u064A\u062F \u0627\u0644\u0645\u062A\u0627\u0628\u0639\u0629 \u0645\u0639 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0645\u0639\u0644\u0642\u0629 \u0641\u0642\u0637\u061F</p>
          </div>
        `,icon:"warning",showCancelButton:!0,confirmButtonText:"\u0646\u0639\u0645\u060C \u0645\u062A\u0627\u0628\u0639\u0629",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"});if(!C)return;this.selectedPaymentsForBulkPay=x}let e=this.getSelectedPaymentsTotal(),i=new Set(this.selectedPaymentsForBulkPay.map(x=>x.student?._id||x.student)),{value:r}=yield et.default.fire({title:"\u062E\u064A\u0627\u0631\u0627\u062A \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A",html:`
        <div class="text-start">
          <div class="alert alert-info">
            <h6><i class="fas fa-info-circle me-2"></i>\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A</h6>
            <p class="mb-1"><strong>\u0639\u062F\u062F \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A:</strong> ${this.selectedPaymentsForBulkPay.length}</p>
            <p class="mb-1"><strong>\u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628:</strong> ${i.size}</p>
            <p class="mb-1"><strong>\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:</strong> ${e.toLocaleString("ar-SA")} \u062F.\u062C</p>
          </div>
          
          <div class="mb-3">
            <label class="form-label"><strong>\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639:</strong></label>
            <select class="form-select" id="paymentMethod">
              <option value="cash">\u0646\u0642\u062F\u0627\u064B</option>
              <option value="bank">\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A</option>
              <option value="card">\u0628\u0637\u0627\u0642\u0629 \u0627\u0626\u062A\u0645\u0627\u0646</option>
              <option value="online">\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A</option>
              <option value="mobile">\u062F\u0641\u0639 \u0645\u062D\u0645\u0648\u0644</option>
            </select>
          </div>
          
          <div class="mb-3">
            <label class="form-label"><strong>\u062E\u064A\u0627\u0631 \u0627\u0644\u0637\u0628\u0627\u0639\u0629:</strong></label>
            <select class="form-select" id="printOption">
              <option value="single">\u0625\u064A\u0635\u0627\u0644 \u0648\u0627\u062D\u062F \u0644\u062C\u0645\u064A\u0639 \u0627\u0644\u062F\u0641\u0639\u0627\u062A</option>
              <option value="multiple">\u0625\u064A\u0635\u0627\u0644\u0627\u062A \u0645\u0646\u0641\u0635\u0644\u0629 \u0644\u0643\u0644 \u062F\u0641\u0639\u0629</option>
            </select>
          </div>
          
          <div class="mb-3">
            <label class="form-label"><strong>\u0645\u0644\u0627\u062D\u0638\u0627\u062A:</strong></label>
            <textarea class="form-control" id="paymentNotes" rows="2" placeholder="\u0645\u0644\u0627\u062D\u0638\u0627\u062A \u062D\u0648\u0644 \u0627\u0644\u062F\u0641\u0639..."></textarea>
          </div>
          
          <div class="alert alert-warning">
            <i class="fas fa-exclamation-circle me-2"></i>
            <small>\u0633\u064A\u062A\u0645 \u062F\u0641\u0639 ${this.selectedPaymentsForBulkPay.length} \u062F\u0641\u0639\u0629 \u0628\u0642\u064A\u0645\u0629 \u0625\u062C\u0645\u0627\u0644\u064A\u0629 ${e.toLocaleString("ar-SA")} \u062F.\u062C</small>
          </div>
        </div>
      `,icon:"question",showCancelButton:!0,confirmButtonText:"\u062F\u0641\u0639",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",width:"600px",preConfirm:()=>{let x=document.getElementById("paymentMethod").value,C=document.getElementById("printOption").value,A=document.getElementById("paymentNotes").value;return x?{paymentMethod:x,printOption:C,paymentNotes:A}:(et.default.showValidationMessage("\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),!1)}});if(!r)return;let{paymentMethod:o,printOption:l,paymentNotes:c}=r;et.default.fire({title:"\u062C\u0627\u0631\u064A \u0645\u0639\u0627\u0644\u062C\u0629 \u0627\u0644\u062F\u0641\u0639\u0627\u062A...",html:`
        <div class="text-center">
          <div class="spinner-border text-primary mb-3" style="width: 3rem; height: 3rem;" role="status">
            <span class="visually-hidden">\u062C\u0627\u0631\u064A \u0627\u0644\u0645\u0639\u0627\u0644\u062C\u0629...</span>
          </div>
          <h5 class="mb-2">\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A</h5>
          <p>\u062C\u0627\u0631\u064A \u0645\u0639\u0627\u0644\u062C\u0629 ${this.selectedPaymentsForBulkPay.length} \u062F\u0641\u0639\u0629...</p>
          
          <div class="progress mt-4" style="height: 25px; border-radius: 12px;">
            <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" 
                 style="width: 0%; font-weight: bold; font-size: 14px;" 
                 id="bulk-pay-progress">0%</div>
          </div>
          
          <div class="row mt-4">
            <div class="col-6 text-end">
              <small class="text-muted">\u0627\u0644\u0646\u062C\u0627\u062D:</small>
              <h5 class="text-success" id="success-count">0</h5>
            </div>
            <div class="col-6 text-start">
              <small class="text-muted">\u0627\u0644\u0641\u0634\u0644:</small>
              <h5 class="text-danger" id="fail-count">0</h5>
            </div>
          </div>
          
          <div class="mt-3">
            <small class="text-muted" id="current-payment">\u062C\u0627\u0631\u064A \u0628\u062F\u0621 \u0627\u0644\u0645\u0639\u0627\u0644\u062C\u0629...</small>
          </div>
        </div>
      `,showConfirmButton:!1,allowOutsideClick:!1,allowEscapeKey:!1,width:"500px"});let f=0,p=0,g=[],m=[];try{for(let x=0;x<this.selectedPaymentsForBulkPay.length;x++){let C=this.selectedPaymentsForBulkPay[x],A=C._id||C.id,O=Math.round((x+1)/this.selectedPaymentsForBulkPay.length*100);if(this.updateProgress(O,x+1,f,p,C),!A){p++,g.push({payment:C.month,student:C.studentName,success:!1,message:"\u0631\u0642\u0645 \u0627\u0644\u062F\u0641\u0639\u0629 \u063A\u064A\u0631 \u0635\u0627\u0644\u062D",error:"ID_NOT_FOUND"});continue}try{let T={paymentMethod:o,paymentDate:new Date().toISOString(),notes:c||`\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A - ${new Date().toLocaleDateString("ar-SA")}`},M=yield this.http.put(`${this.apiUrl}/payments/${A}/pay`,T,{headers:this.getHeaders()}).toPromise();f++;let G=St(Oe({},C),{paymentMethod:o,paymentDate:new Date,invoiceNumber:M.invoiceNumber||`INV-${Date.now().toString().slice(-8)}-${x}`,notes:T.notes});m.push(G),g.push({payment:C.month,student:C.studentName,success:!0,message:"\u062A\u0645 \u0627\u0644\u062F\u0641\u0639 \u0628\u0646\u062C\u0627\u062D",receiptNumber:M.invoiceNumber})}catch(T){p++;let M="\u0641\u0634\u0644 \u0641\u064A \u0627\u0644\u062F\u0641\u0639";T.error?.message?M=T.error.message:T.message&&(M=T.message),g.push({payment:C.month,student:C.studentName,success:!1,message:M,error:T.error?.code||"UNKNOWN_ERROR"})}yield this.delay(100)}et.default.close(),l==="single"&&f>0?yield this.printSingleReceiptForMultiplePayments(m,o,c):l==="multiple"&&f>0&&(yield this.printMultipleReceipts(m)),yield this.showBulkPayResults(f,p,g,m),f>0&&this.student&&(yield this.refreshData())}catch(x){console.error("\u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u0645\u0639\u0627\u0644\u062C\u0629 \u0627\u0644\u062C\u0645\u0627\u0639\u064A\u0629:",x),et.default.fire({icon:"error",title:"\u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u0645\u0639\u0627\u0644\u062C\u0629",text:"\u062D\u062F\u062B \u062E\u0637\u0623 \u063A\u064A\u0631 \u0645\u062A\u0648\u0642\u0639 \u0623\u062B\u0646\u0627\u0621 \u0645\u0639\u0627\u0644\u062C\u0629 \u0627\u0644\u062F\u0641\u0639\u0627\u062A",confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"})}finally{f>0&&(this.selectedPaymentsForBulkPay=[]),this.closeBulkPayConfirmation()}})}updateProgress(t,e,i,r,o){let l=document.getElementById("bulk-pay-progress"),c=document.getElementById("success-count"),f=document.getElementById("fail-count"),p=document.getElementById("current-payment");l&&(l.style.width=`${t}%`,l.textContent=`${t}%`),c&&(c.textContent=i.toString()),f&&(f.textContent=r.toString()),p&&(p.textContent=`\u062C\u0627\u0631\u064A \u0645\u0639\u0627\u0644\u062C\u0629: ${e}/${this.selectedPaymentsForBulkPay.length} - ${o.month} - ${o.amount.toLocaleString("ar-SA")} \u062F.\u062C`)}delay(t){return new Promise(e=>setTimeout(e,t))}showBulkPayResults(t,e,i,r){return wt(this,null,function*(){let o=i.filter(c=>!c.success),l=`
      <div class="text-start">
        <div class="alert ${t>0?"alert-success":"alert-danger"}">
          <h5><i class="fas ${t>0?"fa-check-circle":"fa-exclamation-triangle"} me-2"></i>
            ${t>0?"\u062A\u0645\u062A \u0627\u0644\u062F\u0641\u0639\u0627\u062A \u0628\u0646\u062C\u0627\u062D":"\u0641\u0634\u0644 \u0641\u064A \u0627\u0644\u062F\u0641\u0639\u0627\u062A"}
          </h5>
          <div class="row mt-3">
            <div class="col-4 text-center">
              <h2 class="text-success">${t}</h2>
              <small>\u0627\u0644\u0646\u062C\u0627\u062D\u0627\u062A</small>
            </div>
            <div class="col-4 text-center">
              <h2 class="text-danger">${e}</h2>
              <small>\u0627\u0644\u0641\u0634\u0644</small>
            </div>
            <div class="col-4 text-center">
              <h2 class="text-primary">${t+e}</h2>
              <small>\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A</small>
            </div>
          </div>
        </div>
        
        ${o.length>0?`
          <div class="alert alert-warning mt-3">
            <h6><i class="fas fa-exclamation-circle me-2"></i>\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0627\u062A \u0627\u0644\u0641\u0627\u0634\u0644\u0629:</h6>
            <div class="mt-2" style="max-height: 200px; overflow-y: auto;">
              ${o.map(c=>`
                <div class="mb-2 p-2 border-start border-warning border-3 bg-light">
                  <div class="d-flex justify-content-between">
                    <strong>${c.student||"\u0637\u0627\u0644\u0628"}</strong>
                    <small class="text-danger">${c.error||"\u062E\u0637\u0623"}</small>
                  </div>
                  <div class="small text-muted">${c.payment}: ${c.message}</div>
                </div>
              `).join("")}
            </div>
          </div>
        `:""}
        
        <div class="alert alert-info mt-3">
          <h6><i class="fas fa-info-circle me-2"></i>\u062E\u064A\u0627\u0631\u0627\u062A \u0627\u0644\u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u0636\u0627\u0641\u064A\u0629:</h6>
          <div class="d-flex flex-wrap gap-2 mt-2">
            ${t>0?`
              <button class="btn btn-success btn-sm" onclick="window.printResultsAction('single')">
                <i class="fas fa-receipt me-1"></i>\u0637\u0628\u0627\u0639\u0629 \u0625\u064A\u0635\u0627\u0644 \u0648\u0627\u062D\u062F
              </button>
              <button class="btn btn-info btn-sm" onclick="window.printResultsAction('multiple')">
                <i class="fas fa-copy me-1"></i>\u0637\u0628\u0627\u0639\u0629 \u0625\u064A\u0635\u0627\u0644\u0627\u062A \u0645\u0646\u0641\u0635\u0644\u0629
              </button>
              <button class="btn btn-secondary btn-sm" onclick="window.printResultsAction('close')">
                <i class="fas fa-times me-1"></i>\u0625\u063A\u0644\u0627\u0642
              </button>
            `:""}
          </div>
        </div>
      </div>
    `;yield et.default.fire({title:"\u0646\u062A\u0627\u0626\u062C \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A",html:l,icon:t>0?"success":"error",showConfirmButton:!1,width:"700px",didOpen:()=>{window.printResultsAction=c=>wt(this,null,function*(){et.default.close(),c==="single"&&t>0?yield this.printSingleReceiptForMultiplePayments(r,r[0]?.paymentMethod||"cash","\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A \u0625\u0636\u0627\u0641\u064A"):c==="multiple"&&t>0&&(yield this.printMultipleReceipts(r))})},didClose:()=>{delete window.printResultsAction}})})}printMultipleReceipts(t){return wt(this,null,function*(){if(!t||t.length===0){et.default.fire({icon:"warning",title:"\u0644\u0627 \u062A\u0648\u062C\u062F \u0625\u064A\u0635\u0627\u0644\u0627\u062A \u0644\u0644\u0637\u0628\u0627\u0639\u0629",text:"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0645\u062F\u0641\u0648\u0639\u0629 \u0644\u0644\u0637\u0628\u0627\u0639\u0629",confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"});return}et.default.fire({title:"\u062C\u0627\u0631\u064A \u0627\u0644\u0637\u0628\u0627\u0639\u0629...",html:`
        <div class="text-center">
          <div class="spinner-border text-primary mb-3" role="status">
            <span class="visually-hidden">\u062C\u0627\u0631\u064A \u0627\u0644\u0637\u0628\u0627\u0639\u0629...</span>
          </div>
          <p>\u062C\u0627\u0631\u064A \u0637\u0628\u0627\u0639\u0629 ${t.length} \u0625\u064A\u0635\u0627\u0644...</p>
          <div class="progress" style="height: 20px;">
            <div class="progress-bar progress-bar-striped progress-bar-animated" 
                 style="width: 0%" id="print-progress">0%</div>
          </div>
        </div>
      `,showConfirmButton:!1,allowOutsideClick:!1});let e=0,i=0;for(let r=0;r<t.length;r++){let o=t[r];try{let l={receiptNumber:o.invoiceNumber||`RC-${Date.now().toString().slice(-8)}-${r}`,date:new Date().toLocaleDateString("en-US"),time:new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),studentName:o.studentName||this.student?.name||"",studentId:o.studentId||this.student?.studentId||"",className:o.className||"\u0639\u0627\u0645",month:o.month,amount:o.amount,paymentMethod:o.paymentMethod||"cash",academicYear:this.student?.academicYear,parentPhone:this.student?.parentPhone,notes:`\u062F\u0641\u0639\u0629 \u062C\u0645\u0627\u0639\u064A\u0629 - ${o.notes||""}`};yield this.printerService.printProfessionalReceipt(l),e++;let c=Math.round((r+1)/t.length*100),f=document.getElementById("print-progress");f&&(f.style.width=`${c}%`,f.textContent=`${c}%`),yield this.delay(500)}catch(l){console.error(`\u0641\u0634\u0644 \u0637\u0628\u0627\u0639\u0629 \u0625\u064A\u0635\u0627\u0644 ${r+1}:`,l),i++}}et.default.close(),et.default.fire({title:"\u0646\u062A\u0627\u0626\u062C \u0627\u0644\u0637\u0628\u0627\u0639\u0629",html:`
        <div class="text-start">
          <div class="alert ${e>0?"alert-success":"alert-danger"}">
            <h6><i class="fas ${e>0?"fa-check-circle":"fa-exclamation-triangle"} me-2"></i>
              ${e>0?"\u062A\u0645\u062A \u0627\u0644\u0637\u0628\u0627\u0639\u0629 \u0628\u0646\u062C\u0627\u062D":"\u0641\u0634\u0644 \u0641\u064A \u0627\u0644\u0637\u0628\u0627\u0639\u0629"}
            </h6>
            <p class="mb-1"><strong>\u0627\u0644\u0645\u0637\u0628\u0648\u0639:</strong> ${e}</p>
            <p class="mb-1"><strong>\u0627\u0644\u0641\u0634\u0644:</strong> ${i}</p>
            <p class="mb-0"><strong>\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:</strong> ${t.length}</p>
          </div>
        </div>
      `,icon:e>0?"success":"error",showConfirmButton:!0,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"})})}printSingleReceiptForMultiplePayments(t,e,i){return wt(this,null,function*(){if(!(!t||t.length===0))try{et.default.fire({title:"\u062C\u0627\u0631\u064A \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 \u0627\u0644\u0645\u0648\u062D\u062F...",allowOutsideClick:!1,didOpen:()=>{et.default.showLoading()}});let r=new Set(t.map(f=>f.studentName||this.student?.name||"")),o=t.reduce((f,p)=>f+p.amount,0),l={receiptNumber:`BLK-${Date.now().toString().slice(-8)}`,date:new Date().toLocaleDateString("ar-SA"),time:new Date().toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"}),totalAmount:o,paymentCount:t.length,studentCount:r.size,paymentMethod:e,payments:t.map(f=>({studentName:f.studentName||this.student?.name||"\u0637\u0627\u0644\u0628",studentId:f.studentId||this.student?.studentId||"",className:f.className||"\u0639\u0627\u0645",month:f.month,amount:f.amount,notes:f.notes})),notes:i||`\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A \u0644\u0640 ${t.length} \u062F\u0641\u0639\u0629`};if(yield this.printBulkReceipt(l))et.default.fire({icon:"success",title:"\u062A\u0645 \u0627\u0644\u0637\u0628\u0627\u0639\u0629",text:"\u062A\u0645 \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 \u0627\u0644\u0645\u0648\u062D\u062F \u0628\u0646\u062C\u0627\u062D",timer:1500,showConfirmButton:!1});else throw new Error("\u0641\u0634\u0644 \u0641\u064A \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644")}catch(r){console.error("\u062E\u0637\u0623 \u0641\u064A \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 \u0627\u0644\u0645\u0648\u062D\u062F:",r),et.default.fire({icon:"error",title:"\u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u0637\u0628\u0627\u0639\u0629",text:"\u0641\u0634\u0644 \u0641\u064A \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 \u0627\u0644\u0645\u0648\u062D\u062F",confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"})}})}ensureArabicNumbers(t){if(!t)return t;let e={"\u0660":"0","\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9"};return t.split("").map(i=>e[i]||i).join("")}printBulkReceipt(t){return wt(this,null,function*(){try{if(!this.printerService.checkConnectionStatus()&&!(yield this.printerService.connectToThermalPrinter()))throw new Error("\u0641\u0634\u0644 \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0637\u0627\u0628\u0639\u0629");let e=document.createElement("canvas"),i=e.getContext("2d"),r=576,o=25,l=100,c=40,f=50,p=t.payments.length*f+30,g=l+200+p+c;e.width=r,e.height=g,i.fillStyle="#FFFFFF",i.fillRect(0,0,r,g),i.textAlign="center",i.fillStyle="#000000",i.font="bold 24px Arial",i.fillText("\u0623\u0643\u0627\u062F\u064A\u0645\u064A\u0629 \u0627\u0644\u0631\u0648\u0627\u062F \u0644\u0644\u062A\u0639\u0644\u064A\u0645 \u0648\u0627\u0644\u0645\u0639\u0627\u0631\u0641",r/2,20),i.font="16px Arial",i.fillText("\u0627\u0644\u062C\u0632\u0627\u0626\u0631 \u060C \u0648\u0644\u0627\u064A\u0629 \u062A\u0642\u0631\u062A",r/2,45),i.fillText("\u0627\u0644\u0647\u0627\u062A\u0641 : 0673586274",r/2,65),this.drawLine(i,20,85,r-20,85);let m=105;i.textAlign="center",i.font="bold 20px Arial",i.fillText("\u0650\u0650A \u0625\u064A\u0635\u0640\u0640\u0640\u0627\u0644 \u062F\u0641\u0640\u0640\u0640\u0639 \u062C\u0645\u0627\u0639\u064A",r/2,m),m+=25,this.drawLine(i,20,m,r-20,m),m+=15,i.textAlign="right",i.font="16px Arial",[{label:"\u0631\u0642\u0645 \u0627\u0644\u0625\u064A\u0635\u0627\u0644:",value:t.receiptNumber},{label:"\u0627\u0644\u062A\u0627\u0631\u064A\u062E:",value:t.date},{label:"\u0627\u0644\u0648\u0642\u062A:",value:t.time},{label:"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639:",value:this.translatePaymentMethod(t.paymentMethod)},{label:"\u0639\u062F\u062F \u0627\u0644\u062F\u0641\u0639\u0627\u062A:",value:t.paymentCount.toString()},{label:"\u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628:",value:t.studentCount.toString()}].forEach(A=>{i.fillText(`${A.label} ${A.value}`,r-25,m),m+=22}),m+=10,this.drawLine(i,20,m,r-20,m),m+=20,i.textAlign="center",i.font="bold 18px Arial",i.fillText("\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0627\u062A",r/2,m),m+=30,i.fillStyle="#2C3E50",i.fillRect(20,m,r-40,30);let C=(r-40)/4;if(i.fillStyle="#FFFFFF",i.textAlign="center",i.font="bold 16px Arial",i.fillText("\u0627\u0644\u0637\u0627\u0644\u0628",20+C*.5,m+20),i.fillText("\u0627\u0644\u062D\u0635\u0629",20+C*1.5,m+20),i.fillText("\u0627\u0644\u0634\u0647\u0631",20+C*2.5,m+20),i.fillText("\u0627\u0644\u0645\u0628\u0644\u063A",20+C*3.5,m+20),m+=30,t.payments.forEach((A,O)=>{O%2===0?i.fillStyle="#F8F9FA":i.fillStyle="#FFFFFF",i.fillRect(20,m,r-40,f),i.fillStyle="#000000",i.strokeStyle="#DEE2E6",i.lineWidth=1,i.strokeRect(20,m,r-40,f),i.textAlign="right",i.font="14px Arial";let T=A.studentName.length>12?A.studentName.substring(0,12)+"...":A.studentName;i.fillText(T,20+C-10,m+25),i.textAlign="center";let M=A.className.length>8?A.className.substring(0,8)+"...":A.className;i.fillText(M,20+C*2,m+25),i.textAlign="center";let G=A.month.length>10?A.month.substring(0,10)+"...":A.month;if(i.fillText(G,20+C*3,m+25),i.textAlign="left",i.font="bold 14px Arial",i.fillStyle="#E74C3C",i.fillText(`${A.amount.toLocaleString()} \u062F.\u062C`,20+C*3.7,m+25),i.textAlign="left",i.font="12px Arial",i.fillStyle="#666666",i.fillText(`ID: ${A.studentId||""}`,20+C-10,m+45),A.notes){let Y=A.notes.length>15?A.notes.substring(0,15)+"...":A.notes;i.textAlign="center",i.fillText(Y,20+C*2,m+45)}m+=f}),m+=20,this.drawDoubleLine(i,20,m,r-40),m+=25,i.textAlign="center",i.font="bold 20px Arial",i.fillStyle="#000000",i.fillText("\u0627\u0644\u0645\u062C\u0645\u0648\u0639 \u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:",r/2,m),m+=25,i.font="bold 22px Arial",i.fillStyle="#E74C3C",i.fillText(`${t.totalAmount.toLocaleString()} \u062F\u064A\u0646\u0627\u0631 \u062C\u0632\u0627\u0626\u0631\u064A`,r/2,m),m+=30,t.notes&&t.notes.trim()){i.textAlign="right",i.font="bold 16px Arial",i.fillStyle="#2C3E50",i.fillText("\u0645\u0644\u0627\u062D\u0638\u0627\u062A:",r-25,m),m+=20,i.font="14px Arial",i.fillStyle="#000000";let A=t.notes.split(" "),O="",T=r-40;for(let M of A){let G=O+M+" ";i.measureText(G).width>T&&O!==""?(i.fillText(O.trim(),r-25,m),m+=20,O=M+" "):O=G}O&&i.fillText(O.trim(),r-25,m)}return m=g-25,i.textAlign="center",i.font="14px Arial",i.fillStyle="#666666",i.fillText("\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A - \u0646\u0638\u0627\u0645 \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u062A\u0639\u0644\u064A\u0645",r/2,m),m+=18,i.fillText("\u0645\u0637\u0648\u0631 \u0628\u0648\u0627\u0633\u0637\u0629: \u0631\u064A\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u0640\u062F\u0648\u0643\u0633",r/2,m),yield this.printerService.printBulkReceipt(t)}catch(e){return console.error("\u062E\u0637\u0623 \u0641\u064A \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 \u0627\u0644\u0645\u0648\u062D\u062F:",e),!1}})}drawSingleLine(t,e,i,r,o="#000000"){t.beginPath(),t.moveTo(e,i),t.lineTo(r,i),t.strokeStyle=o,t.lineWidth=1,t.stroke()}drawLine(t,e,i,r,o){t.beginPath(),t.moveTo(e,i),t.lineTo(r,o),t.strokeStyle="#000000",t.lineWidth=1,t.stroke()}drawDoubleLine(t,e,i,r){t.beginPath(),t.strokeStyle="#000000",t.lineWidth=1,t.moveTo(e,i),t.lineTo(e+r,i),t.moveTo(e,i+3),t.lineTo(e+r,i+3),t.stroke()}formatArabicDate(t){try{let e=new Date(t),i={year:"numeric",month:"long",day:"numeric"};return e.toLocaleDateString("ar-SA",i)}catch{return t}}formatArabicTime(t){try{return new Date(`2000-01-01T${t}`).toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"})}catch{return t}}translatePaymentMethod(t){return{cash:"\u0646\u0642\u062F\u0627\u064B",bank:"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A",card:"\u0628\u0637\u0627\u0642\u0629 \u0627\u0626\u062A\u0645\u0627\u0646",check:"\u0634\u064A\u0643",online:"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A",mobile:"\u062F\u0641\u0639 \u0645\u062D\u0645\u0648\u0644"}[t.toLowerCase()]||t}printCanvasImage(t){return wt(this,null,function*(){try{let e=window.open("","_blank");if(e){let i=t.toDataURL("image/png");return e.document.write(`
          <!DOCTYPE html>
          <html dir="rtl">
          <head>
            <title>\u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 \u0627\u0644\u0645\u0648\u062D\u062F</title>
            <style>
              body { margin: 0; padding: 10px; }
              img { width: 576px; max-width: 100%; }
              @media print {
                body { margin: 0; }
                img { width: 576px; }
              }
            </style>
          </head>
          <body>
            <img src="${i}" alt="\u0625\u064A\u0635\u0627\u0644 \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u0645\u0648\u062D\u062F">
            <script>
              window.onload = function() {
                window.print();
                setTimeout(function() {
                  window.close();
                }, 1000);
              };
            <\/script>
          </body>
          </html>
        `),e.document.close(),!0}return!1}catch(e){return console.error("\u062E\u0637\u0623 \u0641\u064A \u0637\u0628\u0627\u0639\u0629 Canvas:",e),!1}})}getSelectedPaymentsTotal(){return this.selectedPaymentsForBulkPay.reduce((t,e)=>t+e.amount,0)}loadClassPayments(t){t&&this.http.get(`${this.apiUrl}/payments/class/${t}`,{headers:this.getHeaders()}).subscribe({next:e=>{e.success&&e.payments?this.classPayments=e.payments:this.classPayments=[]},error:e=>{console.error("Error loading class payments:",e),this.classPayments=[]}})}loadStudentPaymentSystems(t){this.http.get(`${this.apiUrl}/payments/student/${t}`,{headers:this.getHeaders()}).subscribe({next:e=>{e.success&&e.payments&&(this.studentMonthlyPayments=e.payments.map(i=>({id:i._id,_id:i._id,studentId:i.student?._id||t,month:i.month,amount:i.amount,status:i.status,paymentDate:i.paymentDate,paymentMethod:i.paymentMethod,notes:i.notes,className:i.class?.name})))},error:e=>{console.error("Error loading monthly payments:",e),this.studentMonthlyPayments=[]}}),this.http.get(`${this.apiUrl}/payment-systems/rounds/student/${t}`,{headers:this.getHeaders()}).subscribe({next:e=>{e.success&&e.rounds?(this.studentRounds=e.rounds,this.updateRoundStatuses()):this.studentRounds=[]},error:e=>{console.error("Error loading rounds:",e),this.studentRounds=[]}})}updateRoundStatuses(){let t=new Date;this.studentRounds.forEach(e=>{let i=new Date(e.endDate),r=new Date(e.startDate);e.status==="paid"?(e.statusText="\u0645\u062F\u0641\u0648\u0639\u0629",e.statusClass="badge bg-success"):t>i&&e.status!=="paid"?(e.statusText="\u0645\u0646\u062A\u0647\u064A\u0629",e.statusClass="badge bg-danger"):t>=r&&t<=i&&e.status!=="paid"?(e.statusText="\u0645\u062A\u0623\u062E\u0631\u0629",e.statusClass="badge bg-warning"):t<r?(e.statusText="\u0642\u0627\u062F\u0645\u0629",e.statusClass="badge bg-info"):(e.statusText="\u0645\u0639\u0644\u0642\u0629",e.statusClass="badge bg-secondary")})}getStudentId(){return this.student?this.student.id?this.student.id:this.student._id?this.student._id:this.student.studentId||"":""}setActiveTab(t){this.activeTab=t,t==="payments"&&this.student&&this.loadPaymentHistory(this.getStudentId())}goBack(){this.router.navigate(["/home/students-management"])}openAddPaymentModal(){if(!this.student)return;let t=new Date,e=this.months[t.getMonth()],i=t.getFullYear();this.newPayment={student:this.getStudentId(),amount:0,month:`${e} ${i}`,paymentMethod:"cash",notes:""},this.showPaymentModal=!0,window.scrollTo({top:0,behavior:"smooth"})}closePaymentModal(){this.showPaymentModal=!1,this.newPayment={student:"",amount:0,month:"",paymentMethod:"cash",notes:""}}isGroupAllSelected(t){return!t.payments||t.payments.length===0?!1:t.payments.every(e=>this.isPaymentSelected(e))}toggleGroupSelection(t){this.isGroupAllSelected(t)?t.payments.forEach(i=>{let r=this.selectedPaymentsForBulkPay.findIndex(o=>o._id===i._id||o.id===i.id);r>-1&&this.selectedPaymentsForBulkPay.splice(r,1)}):t.payments.forEach(i=>{i.status!=="paid"&&!this.isPaymentSelected(i)&&this.selectedPaymentsForBulkPay.push(i)})}isAnyPaymentInGroupSelected(t){return t.payments.some(e=>this.isPaymentSelected(e))}getUniqueMonths(){let t=new Set;return this.paymentHistory.forEach(e=>{e.month&&t.add(e.month)}),Array.from(t).sort((e,i)=>{let r=this.months,o=l=>{let c=l.split(" ")[0];return r.indexOf(c)};return o(e)-o(i)})}isAllPaymentsInGroupSelected(t){return t.payments.every(e=>this.isPaymentSelected(e))}toggleAllPaymentsInGroup(t){let e=this.isAllPaymentsInGroupSelected(t);t.payments.forEach(i=>{if(e){let r=this.selectedPaymentsForBulkPay.findIndex(o=>(o._id||o.id)===(i._id||i.id));r>-1&&this.selectedPaymentsForBulkPay.splice(r,1)}else!this.isPaymentSelected(i)&&i.status!=="paid"&&this.selectedPaymentsForBulkPay.push(i)})}togglePaymentSelection(t){let e=this.selectedPaymentsForBulkPay.findIndex(i=>(i._id||i.id)===(t._id||t.id));e>-1?this.selectedPaymentsForBulkPay.splice(e,1):this.selectedPaymentsForBulkPay.push(t)}isPaymentSelected(t){return this.selectedPaymentsForBulkPay.some(e=>(e._id||e.id)===(t._id||t.id))}selectAllPendingPayments(){this.selectedPaymentsForBulkPay=this.paymentHistory.filter(t=>t.status!=="paid")}selectPaymentsByMonth(t){if(!t){this.selectedPaymentsForBulkPay=[];return}this.selectedPaymentsForBulkPay=this.paymentHistory.filter(e=>e.month===t&&e.status!=="paid")}selectPaymentsByClass(t){if(t==="all"){this.selectAllPendingPayments();return}this.selectedPaymentsForBulkPay=this.paymentHistory.filter(e=>(e.class?._id===t||e.class===t)&&e.status!=="paid")}openBulkPayConfirmation(){if(this.selectedPaymentsForBulkPay.length===0){et.default.fire("\u062A\u0646\u0628\u064A\u0647","\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0644\u0644\u062F\u0641\u0639","warning");return}this.showBulkPayConfirmation=!0,window.scrollTo({top:0,behavior:"smooth"})}closeBulkPayConfirmation(){this.showBulkPayConfirmation=!1}openBulkPaymentModal(){let t=new Date,e=this.months[t.getMonth()],i=t.getFullYear();this.bulkPayment={studentIds:[],classId:"",amount:0,month:`${e} ${i}`,paymentMethod:"cash",notes:"\u062F\u0641\u0639\u0629 \u062C\u0645\u0627\u0639\u064A\u0629"},this.student&&this.toggleStudentSelection(this.student),this.showBulkPaymentModal=!0,window.scrollTo({top:0,behavior:"smooth"})}closeBulkPaymentModal(){this.showBulkPaymentModal=!1,this.bulkPayment={studentIds:[],classId:"",amount:0,month:"",paymentMethod:"cash",notes:""},this.selectedStudents=[],this.classForBulkPayment=null,this.bulkPaymentResults=[],this.bulkPaymentProgress=0}toggleStudentSelection(t){let e=t._id||t.id;if(!e)return;let i=this.selectedStudents.findIndex(r=>(r._id||r.id)===e);if(i>-1){this.selectedStudents.splice(i,1);let r=this.bulkPayment.studentIds.indexOf(e);r>-1&&this.bulkPayment.studentIds.splice(r,1)}else this.selectedStudents.push(t),this.bulkPayment.studentIds.push(e)}isStudentSelected(t){let e=t._id||t.id;return e?this.selectedStudents.some(i=>(i._id||i.id)===e):!1}selectAllStudents(){this.selectedStudents=[...this.filteredStudents],this.bulkPayment.studentIds=this.filteredStudents.map(t=>t._id||t.id).filter(t=>t!==void 0)}deselectAllStudents(){this.selectedStudents=[],this.bulkPayment.studentIds=[]}filterStudents(){if(!this.studentSearchTerm.trim()){this.filteredStudents=[...this.allStudents];return}let t=this.studentSearchTerm.toLowerCase();this.filteredStudents=this.allStudents.filter(e=>e.name.toLowerCase().includes(t)||e.studentId.toLowerCase().includes(t)||e.parentName&&e.parentName.toLowerCase().includes(t))}selectClassForBulkPayment(t){this.classForBulkPayment=t,this.bulkPayment.classId=t._id||t.id||"",this.bulkPayment.amount=t.price||0}processBulkPayment(){return wt(this,null,function*(){if(this.selectedStudents.length===0){et.default.fire("\u062E\u0637\u0623","\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0637\u0627\u0644\u0628 \u0648\u0627\u062D\u062F \u0639\u0644\u0649 \u0627\u0644\u0623\u0642\u0644","error");return}if(!this.bulkPayment.amount||this.bulkPayment.amount<=0){et.default.fire("\u062E\u0637\u0623","\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0645\u0628\u0644\u063A \u0635\u062D\u064A\u062D","error");return}if(!this.bulkPayment.month){et.default.fire("\u062E\u0637\u0623","\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0634\u0647\u0631","error");return}if(!(yield et.default.fire({title:"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A",html:`
        <div class="text-start">
          <p><strong>\u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628:</strong> ${this.selectedStudents.length}</p>
          <p><strong>\u0627\u0644\u0645\u0628\u0644\u063A \u0644\u0644\u0637\u0627\u0644\u0628 \u0627\u0644\u0648\u0627\u062D\u062F:</strong> ${this.bulkPayment.amount.toLocaleString()} \u062F.\u062C</p>
          <p><strong>\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:</strong> ${(this.selectedStudents.length*this.bulkPayment.amount).toLocaleString()} \u062F.\u062C</p>
          <p><strong>\u0627\u0644\u0634\u0647\u0631:</strong> ${this.bulkPayment.month}</p>
          <p><strong>\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639:</strong> ${this.getPaymentMethodLabel(this.bulkPayment.paymentMethod)}</p>
          ${this.classForBulkPayment?`<p><strong>\u0627\u0644\u062D\u0635\u0629:</strong> ${this.classForBulkPayment.name}</p>`:""}
        </div>
      `,icon:"question",showCancelButton:!0,confirmButtonText:"\u0646\u0639\u0645\u060C \u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"})).isConfirmed)return;this.isProcessingBulkPayment=!0,this.bulkPaymentProgress=0,this.bulkPaymentResults=[];let e=this.selectedStudents.length,i=0,r=0,o=this.selectedStudents.map(f=>({student:f._id||f.id,class:this.bulkPayment.classId,amount:this.bulkPayment.amount,month:this.bulkPayment.month,paymentMethod:this.bulkPayment.paymentMethod,notes:`${this.bulkPayment.notes} - ${f.name}`})),l=5;for(let f=0;f<o.length;f+=l){let p=o.slice(f,f+l);try{let g=p.map(x=>this.http.post(`${this.apiUrl}/payments`,x,{headers:this.getHeaders()}).toPromise());(yield Promise.allSettled(g)).forEach((x,C)=>{let A=f+C,O=this.selectedStudents[A];x.status==="fulfilled"&&x.value?(i++,this.bulkPaymentResults.push({student:O.name,success:!0,message:"\u062A\u0645 \u0627\u0644\u062F\u0641\u0639 \u0628\u0646\u062C\u0627\u062D",receiptNumber:x.value.payment?.invoiceNumber||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}),this.printerService.checkConnectionStatus()&&this.printBulkPaymentReceipt(O,x.value.payment)):(r++,this.bulkPaymentResults.push({student:O.name,success:!1,message:x.status==="rejected"?x.reason?.error?.message||"\u0641\u0634\u0644 \u0641\u064A \u0627\u0644\u062F\u0641\u0639":"\u0641\u0634\u0644 \u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"}))}),this.bulkPaymentProgress=Math.round((f+p.length)/e*100),yield new Promise(x=>setTimeout(x,500))}catch(g){console.error("Error processing batch:",g),r+=p.length}}this.isProcessingBulkPayment=!1;let c=`
      <div class="text-start">
        <div class="alert alert-success">
          <h6><i class="fas fa-check-circle me-2"></i>\u062A\u0645\u062A \u0627\u0644\u062F\u0641\u0639\u0627\u062A \u0628\u0646\u062C\u0627\u062D</h6>
          <p class="mb-1"><strong>\u0627\u0644\u0646\u062C\u0627\u062D\u0627\u062A:</strong> ${i}</p>
          <p class="mb-1"><strong>\u0627\u0644\u0641\u0634\u0644:</strong> ${r}</p>
          <p class="mb-0"><strong>\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:</strong> ${e}</p>
        </div>
        
        ${r>0?`
          <div class="alert alert-danger mt-3">
            <h6><i class="fas fa-exclamation-triangle me-2"></i>\u0641\u0634\u0644 \u0641\u064A \u0628\u0639\u0636 \u0627\u0644\u062F\u0641\u0639\u0627\u062A:</h6>
            <div class="mt-2" style="max-height: 200px; overflow-y: auto;">
              ${this.bulkPaymentResults.filter(f=>!f.success).map(f=>`<div class="mb-1">\u2022 ${f.student}: ${f.message}</div>`).join("")}
            </div>
          </div>
        `:""}
      </div>
    `;et.default.fire({title:"\u0646\u062A\u0627\u0626\u062C \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A",html:c,icon:i>0?"success":"error",showCancelButton:!1,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B",didClose:()=>{this.student&&(this.loadPaymentHistory(this.getStudentId()),this.loadStudentPaymentSystems(this.getStudentId())),this.closeBulkPaymentModal()}})})}printBulkPaymentReceipt(t,e){return wt(this,null,function*(){try{let i={receiptNumber:e.invoiceNumber||`BULK-${Date.now().toString().slice(-8)}`,date:new Date().toLocaleDateString("ar-EG"),time:new Date().toLocaleTimeString("ar-EG",{hour:"2-digit",minute:"2-digit"}),studentName:t.name,studentId:t.studentId,className:this.classForBulkPayment?.name||"\u062F\u0641\u0639\u0629 \u062C\u0645\u0627\u0639\u064A\u0629",month:this.bulkPayment.month,amount:this.bulkPayment.amount,paymentMethod:this.bulkPayment.paymentMethod,academicYear:t.academicYear,parentPhone:t.parentPhone,notes:`${this.bulkPayment.notes} - ${t.name}`};yield this.printerService.printProfessionalReceipt(i)}catch(i){console.error("Error printing bulk payment receipt:",i)}})}openClassPaymentsModal(t){this.selectedClassForPayments=t,this.loadClassPayments(t._id||t.id),this.showClassPaymentsModal=!0,window.scrollTo({top:0,behavior:"smooth"})}closeClassPaymentsModal(){this.showClassPaymentsModal=!1,this.selectedClassForPayments=null,this.classPayments=[]}openEditPaymentModal(t){window.scrollTo({top:0,behavior:"smooth"}),this.editingPayment=Oe({},t),this.showEditPaymentModal=!0}closeEditPaymentModal(){this.showEditPaymentModal=!1,this.editingPayment=null}openDeleteConfirmModal(t){window.scrollTo({top:0,behavior:"smooth"}),this.paymentToDelete=t,this.showDeleteConfirmModal=!0}closeDeleteConfirmModal(){this.showDeleteConfirmModal=!1,this.paymentToDelete=null}addPayment(){if(!this.student||!this.newPayment.amount||this.newPayment.amount<=0){et.default.fire("\u062E\u0637\u0623","\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0645\u0628\u0644\u063A \u0635\u062D\u064A\u062D","error");return}if(!this.newPayment.month){et.default.fire("\u062E\u0637\u0623","\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0634\u0647\u0631","error");return}et.default.fire({title:"\u062C\u0627\u0631\u064A \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629...",allowOutsideClick:!1,didOpen:()=>{et.default.showLoading()}}),this.http.post(`${this.apiUrl}/payments`,this.newPayment,{headers:this.getHeaders()}).subscribe({next:t=>{et.default.fire({icon:"success",title:"\u0646\u062C\u0627\u062D",text:"\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629 \u0628\u0646\u062C\u0627\u062D",timer:1500,showConfirmButton:!1}),this.closePaymentModal(),this.loadPaymentHistory(this.getStudentId()),this.loadStudentPaymentSystems(this.getStudentId())},error:t=>{console.error("Error adding payment:",t),et.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629","error")}})}updatePayment(){if(window.scrollTo({top:0,behavior:"smooth"}),!this.editingPayment||!this.editingPayment._id)return;if(!this.editingPayment.amount||this.editingPayment.amount<=0){et.default.fire("\u062E\u0637\u0623","\u064A\u0631\u062C\u0649 \u0625\u062F\u062E\u0627\u0644 \u0645\u0628\u0644\u063A \u0635\u062D\u064A\u062D","error");return}et.default.fire({title:"\u062C\u0627\u0631\u064A \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062F\u0641\u0639\u0629...",allowOutsideClick:!1,didOpen:()=>{et.default.showLoading()}});let t=this.editingPayment._id;this.http.put(`${this.apiUrl}/payments/${t}`,this.editingPayment,{headers:this.getHeaders()}).subscribe({next:e=>{et.default.fire({icon:"success",title:"\u0646\u062C\u0627\u062D",text:"\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062F\u0641\u0639\u0629 \u0628\u0646\u062C\u0627\u062D",timer:1500,showConfirmButton:!1}),this.closeEditPaymentModal(),this.loadPaymentHistory(this.getStudentId()),this.loadStudentPaymentSystems(this.getStudentId())},error:e=>{console.error("Error updating payment:",e),et.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u062F\u0641\u0639\u0629","error")}})}deletePayment(){if(!this.paymentToDelete)return;et.default.fire({title:"\u062C\u0627\u0631\u064A \u062D\u0630\u0641 \u0627\u0644\u062F\u0641\u0639\u0629...",allowOutsideClick:!1,didOpen:()=>{et.default.showLoading()}});let t=this.paymentToDelete._id||this.paymentToDelete.id;this.http.delete(`${this.apiUrl}/payments/${t}`,{headers:this.getHeaders()}).subscribe({next:()=>{et.default.fire({icon:"success",title:"\u0646\u062C\u0627\u062D",text:"\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u062F\u0641\u0639\u0629 \u0628\u0646\u062C\u0627\u062D",timer:1500,showConfirmButton:!1}),this.closeDeleteConfirmModal(),this.loadPaymentHistory(this.getStudentId()),this.loadStudentPaymentSystems(this.getStudentId())},error:e=>{console.error("Error deleting payment:",e),et.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062D\u0630\u0641 \u0627\u0644\u062F\u0641\u0639\u0629","error")}})}payPayment(t){et.default.fire({title:"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062F\u0641\u0639",html:`
        <div class="text-start">
          <p><strong>\u0627\u0644\u0645\u0628\u0644\u063A:</strong> ${t.amount.toLocaleString()} \u062F.\u062C</p>
          <p><strong>\u0627\u0644\u0634\u0647\u0631:</strong> ${t.month}</p>
          ${t.className?`<p><strong>\u0627\u0644\u062D\u0635\u0629:</strong> ${t.className}</p>`:""}
        </div>
      `,icon:"question",showCancelButton:!0,confirmButtonText:"\u062F\u0641\u0639 \u0648\u0637\u0628\u0627\u0639\u0629",cancelButtonText:"\u062F\u0641\u0639 \u0641\u0642\u0637",showDenyButton:!0,denyButtonText:"\u0625\u0644\u063A\u0627\u0621",confirmButtonColor:"#3085d6",denyButtonColor:"#d33",cancelButtonColor:"#6c757d",input:"select",inputOptions:{cash:"\u0646\u0642\u062F\u0627\u064B",bank:"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A",card:"\u0628\u0637\u0627\u0642\u0629 \u0627\u0626\u062A\u0645\u0627\u0646",online:"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"},inputPlaceholder:"\u0627\u062E\u062A\u0631 \u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639",inputValue:"cash"}).then(e=>{e.isConfirmed&&e.value?this.processPaymentWithPrint(t,e.value,!0):e.dismiss===et.default.DismissReason.cancel&&this.processPaymentWithPrint(t,e.value||"cash",!1)})}processPaymentWithPrint(t,e,i){let r={paymentMethod:e,paymentDate:new Date().toISOString(),notes:"\u062A\u0645 \u0627\u0644\u062F\u0641\u0639 \u0645\u0646 \u062E\u0644\u0627\u0644 \u0627\u0644\u0646\u0638\u0627\u0645"};et.default.fire({title:"\u062C\u0627\u0631\u064A \u0627\u0644\u062F\u0641\u0639...",allowOutsideClick:!1,didOpen:()=>{et.default.showLoading()}});let o=t._id||t.id;this.http.put(`${this.apiUrl}/payments/${o}/pay`,r,{headers:this.getHeaders()}).subscribe({next:l=>wt(this,null,function*(){et.default.fire({icon:"success",title:"\u0646\u062C\u0627\u062D",text:"\u062A\u0645 \u062F\u0641\u0639 \u0627\u0644\u062F\u0641\u0639\u0629 \u0628\u0646\u062C\u0627\u062D",timer:1500,showConfirmButton:!1}),this.loadPaymentHistory(this.getStudentId()),this.loadStudentPaymentSystems(this.getStudentId()),i&&l.payment&&(yield this.printPaymentReceipt(l.payment))}),error:l=>{console.error("Error paying payment:",l),et.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062F\u0641\u0639 \u0627\u0644\u062F\u0641\u0639\u0629","error")}})}openAddToLessonsModal(){this.student&&(this.showAddToLessonsModal=!0,this.selectedClasses=[],this.filterSubject="",this.filterLevel="",this.loadAvailableClasses(),window.scrollTo({top:0,behavior:"smooth"}))}closeAddToLessonsModal(){this.showAddToLessonsModal=!1,this.availableClasses=[],this.filteredAvailableClasses=[],this.alreadyEnrolledClasses=[],this.selectedClasses=[],this.selectedClassForRounds=null,this.showRoundSelectionModal=!1}loadAvailableClasses(){this.student&&(this.loadingAvailableClasses=!0,this.http.get(`${this.apiUrl}/classes/available`,{headers:this.getHeaders()}).subscribe({next:t=>{this.availableClasses=t;let e=this.studentClasses.map(i=>i._id||i.id);this.alreadyEnrolledClasses=t.filter(i=>e.includes(i._id||i.id)),this.availableClasses=t.filter(i=>!e.includes(i._id||i.id)),this.filterAvailableClasses(),this.loadingAvailableClasses=!1},error:t=>{console.error("Error loading available classes:",t),et.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u062A\u0627\u062D\u0629","error"),this.loadingAvailableClasses=!1}}))}filterAvailableClasses(){this.filteredAvailableClasses=this.availableClasses.filter(t=>!(this.filterSubject&&t.subject!==this.filterSubject||this.filterLevel&&t.academicYear!==this.filterLevel))}isLevelCompatible(t){return!this.student||!t.academicYear||!t.academicYear||t.academicYear==="NS"||t.academicYear==="\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"?!0:t.academicYear===this.student.academicYear}toggleClassSelection(t){let e=this.selectedClasses.findIndex(i=>{let r=i._id||i.id,o=t._id||t.id;return r===o});e>-1?this.selectedClasses.splice(e,1):this.selectedClasses.push(t)}isClassSelected(t){return this.selectedClasses.some(e=>(e._id||e.id)===t)}calculateMonthlyTotal(){return this.selectedClasses.reduce((t,e)=>t+(e.price||0),0)}checkAndEnrollStudentToSelectedClasses(){if(!this.student||this.selectedClasses.length===0)return;let t=this.selectedClasses.filter(e=>e.paymentSystem==="rounds");t.length>0?(this.selectedClassForRounds=t[0],this.openRoundSelectionModal()):this.enrollStudentToSelectedClasses()}openRoundSelectionModal(){this.selectedClassForRounds&&(this.roundSelection={roundNumber:`RND-${Date.now().toString().slice(-6)}`,sessionCount:this.selectedClassForRounds.roundSettings?.sessionCount||8,sessionPrice:this.selectedClassForRounds.price/(this.selectedClassForRounds.roundSettings?.sessionCount||8),totalAmount:this.selectedClassForRounds.price,startDate:new Date,endDate:new Date(Date.now()+30*24*60*60*1e3),notes:`\u0646\u0638\u0627\u0645 \u062C\u0648\u0644\u0627\u062A \u062A\u0644\u0642\u0627\u0626\u064A \u0644\u0644\u062D\u0635\u0629 ${this.selectedClassForRounds.name}`},this.showRoundSelectionModal=!0,window.scrollTo({top:0,behavior:"smooth"}))}closeRoundSelectionModal(){this.showRoundSelectionModal=!1,this.selectedClassForRounds=null}updateRoundTotalAmount(){this.selectedClassForRounds&&(this.roundSelection.totalAmount=this.roundSelection.sessionCount*this.roundSelection.sessionPrice)}confirmRoundSelection(){if(!this.selectedClassForRounds||!this.roundSelection.sessionCount||this.roundSelection.sessionCount<=0){et.default.fire("\u062E\u0637\u0623","\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u0639\u062F\u062F \u062C\u0644\u0633\u0627\u062A \u0635\u062D\u064A\u062D","error");return}this.closeRoundSelectionModal(),this.enrollStudentToSelectedClasses()}enrollStudentToSelectedClasses(){if(!this.student||this.selectedClasses.length===0)return;let t=this.selectedClasses.map(i=>i._id||i.id),e=this.getStudentId();et.default.fire({title:"\u062A\u0623\u0643\u064A\u062F \u0627\u0644\u062A\u0633\u062C\u064A\u0644",html:`
        <p>\u0647\u0644 \u062A\u0631\u064A\u062F \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u0637\u0627\u0644\u0628 \u0641\u064A ${this.selectedClasses.length} \u062D\u0635\u0629\u061F</p>
        <p><strong>\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:</strong> ${this.calculateMonthlyTotal().toLocaleString()} \u062F.\u062C</p>
        <div class="text-start">
          ${this.selectedClasses.map(i=>`<div class="mb-1">\u2022 ${i.name} - ${i.price.toLocaleString()} \u062F.\u062C - 
              <span class="badge ${i.paymentSystem==="monthly"?"bg-info":"bg-warning"}">
                ${i.paymentSystem==="monthly"?"\u0634\u0647\u0631\u064A":"\u062C\u0648\u0644\u0627\u062A"}
              </span>
            </div>`).join("")}
        </div>
      `,icon:"question",showCancelButton:!0,confirmButtonText:"\u0646\u0639\u0645\u060C \u0633\u062C\u0644 \u0627\u0644\u0622\u0646",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33"}).then(i=>{if(i.isConfirmed){let r=t.filter(o=>o!=null);this.enrollStudentMultiple(e,r)}})}enrollStudentMultiple(t,e){this.isEnrolling=!0;let i=this.selectedClassForRounds?{sessionCount:this.roundSelection.sessionCount,sessionDuration:2,breakBetweenSessions:0}:void 0;this.http.post(`${this.apiUrl}/students/${t}/enroll-multiple`,{classIds:e,roundSettings:i},{headers:this.getHeaders()}).subscribe({next:r=>{et.default.fire({icon:"success",title:"\u062A\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644 \u0628\u0646\u062C\u0627\u062D",html:`
            <p>\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u0637\u0627\u0644\u0628 \u0641\u064A ${r.results?.successful?.length||r.successful?.length||0} \u062D\u0635\u0629 \u0628\u0646\u062C\u0627\u062D</p>
            ${r.summary?.paymentSystemsCreated?`<p class="text-success">\u062A\u0645 \u0625\u0646\u0634\u0627\u0621 ${r.summary.paymentSystemsCreated} \u0646\u0638\u0627\u0645 \u062F\u0641\u0639 \u062A\u0644\u0642\u0627\u0626\u064A\u0627\u064B</p>`:""}
          `,timer:3e3,showConfirmButton:!1}),this.loadStudentClasses(this.route.snapshot.paramMap.get("id")||""),this.loadStudentPaymentSystems(this.route.snapshot.paramMap.get("id")||""),this.closeAddToLessonsModal(),this.isEnrolling=!1},error:r=>{console.error("Error enrolling student:",r),et.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u0637\u0627\u0644\u0628 \u0641\u064A \u0627\u0644\u062D\u0635\u0635","error"),this.isEnrolling=!1}})}payLatePayment(t){et.default.fire({title:"\u062A\u0633\u062F\u064A\u062F \u062F\u0641\u0639\u0629 \u0645\u062A\u0623\u062E\u0631\u0629",html:`
        <div class="text-start">
          <p>\u0627\u0644\u0645\u0628\u0644\u063A: ${t.amount.toLocaleString()} \u062F.\u062C</p>
          ${t.month?`<p>\u0627\u0644\u0634\u0647\u0631: ${t.month}</p>`:""}
          ${t.dueDate?`<p>\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0627\u0633\u062A\u062D\u0642\u0627\u0642: ${new Date(t.dueDate).toLocaleDateString("ar-EG")}</p>`:""}
        </div>
      `,icon:"warning",showCancelButton:!0,confirmButtonText:"\u062A\u0633\u062F\u064A\u062F \u0627\u0644\u0622\u0646",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",input:"select",inputOptions:{cash:"\u0646\u0642\u062F\u0627\u064B",bank:"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A",card:"\u0628\u0637\u0627\u0642\u0629 \u0627\u0626\u062A\u0645\u0627\u0646",online:"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"},inputPlaceholder:"\u0627\u062E\u062A\u0631 \u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"}).then(e=>{if(e.isConfirmed&&e.value){let i={paymentMethod:e.value,paymentDate:new Date().toISOString(),notes:"\u062A\u0645 \u062A\u0633\u062F\u064A\u062F \u062F\u0641\u0639\u0629 \u0645\u062A\u0623\u062E\u0631\u0629"};et.default.fire({title:"\u062C\u0627\u0631\u064A \u0627\u0644\u062A\u0633\u062F\u064A\u062F...",allowOutsideClick:!1,didOpen:()=>{et.default.showLoading()}}),t._id&&this.http.put(`${this.apiUrl}/payments/${t._id}/pay`,i,{headers:this.getHeaders()}).subscribe({next:r=>{et.default.fire({icon:"success",title:"\u0646\u062C\u0627\u062D",text:"\u062A\u0645 \u062A\u0633\u062F\u064A\u062F \u0627\u0644\u062F\u0641\u0639\u0629 \u0627\u0644\u0645\u062A\u0623\u062E\u0631\u0629 \u0628\u0646\u062C\u0627\u062D",timer:1500,showConfirmButton:!1});let o=this.route.snapshot.paramMap.get("id");o&&this.loadStudentPaymentSystems(o)},error:r=>{console.error("Error paying late payment:",r),et.default.fire("\u062E\u0637\u0623","\u0641\u0634\u0644 \u0641\u064A \u062A\u0633\u062F\u064A\u062F \u0627\u0644\u062F\u0641\u0639\u0629 \u0627\u0644\u0645\u062A\u0623\u062E\u0631\u0629","error")}})}})}payRound(t){et.default.fire({title:"\u062F\u0641\u0639 \u0627\u0644\u062C\u0648\u0644\u0629",html:`
        <div class="text-start">
          <p>\u0631\u0642\u0645 \u0627\u0644\u062C\u0648\u0644\u0629: ${t.roundNumber}</p>
          <p>\u0627\u0644\u0645\u0628\u0644\u063A: ${t.totalAmount.toLocaleString()} \u062F.\u062C</p>
          <p>\u0639\u062F\u062F \u0627\u0644\u062C\u0644\u0633\u0627\u062A: ${t.sessionCount}</p>
        </div>
      `,icon:"question",showCancelButton:!0,confirmButtonText:"\u062F\u0641\u0639",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",input:"select",inputOptions:{cash:"\u0646\u0642\u062F\u0627\u064B",bank:"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A",card:"\u0628\u0637\u0627\u0642\u0629 \u0627\u0626\u062A\u0645\u0627\u0646",online:"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"},inputPlaceholder:"\u0627\u062E\u062A\u0631 \u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639",inputValue:"cash",preConfirm:e=>(e||et.default.showValidationMessage("\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),e)}).then(e=>{if(e.isConfirmed&&e.value){let i={paymentMethod:e.value,paymentDate:new Date().toISOString(),notes:`\u062F\u0641\u0639 \u062C\u0648\u0644\u0629 ${t.roundNumber}`};et.default.fire({title:"\u062C\u0627\u0631\u064A \u0627\u0644\u062F\u0641\u0639...",allowOutsideClick:!1,didOpen:()=>{et.default.showLoading()}});let r=t._id||t.id;r&&this.http.put(`${this.apiUrl}/payment-systems/rounds/${r}/pay`,i,{headers:this.getHeaders()}).subscribe({next:o=>{et.default.fire({icon:"success",title:"\u062A\u0645 \u0627\u0644\u062F\u0641\u0639 \u0628\u0646\u062C\u0627\u062D",html:`
                  <div class="text-start">
                    <p>\u062A\u0645 \u062F\u0641\u0639 \u0627\u0644\u062C\u0648\u0644\u0629 ${t.roundNumber} \u0628\u0646\u062C\u0627\u062D</p>
                    <p><strong>\u0627\u0644\u0645\u0628\u0644\u063A:</strong> ${t.totalAmount.toLocaleString()} \u062F.\u062C</p>
                    <p><strong>\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639:</strong> ${this.getPaymentMethodLabel(e.value)}</p>
                    ${o.receiptNumber?`<p><strong>\u0631\u0642\u0645 \u0627\u0644\u0625\u064A\u0635\u0627\u0644:</strong> ${o.receiptNumber}</p>`:""}
                  </div>
                `,timer:3e3,showConfirmButton:!1});let l=this.route.snapshot.paramMap.get("id");l&&(this.loadStudentPaymentSystems(l),this.loadPaymentHistory(l))},error:o=>{console.error("Error paying round:",o);let l="\u0641\u0634\u0644 \u0641\u064A \u062F\u0641\u0639 \u0627\u0644\u062C\u0648\u0644\u0629";o.error?.error?l+=`: ${o.error.error}`:o.message&&(l+=`: ${o.message}`),et.default.fire({icon:"error",title:"\u062E\u0637\u0623",text:l,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"})}})}})}viewRoundDetails(t){let e='<div class="table-responsive"><table class="table table-sm">';e+="<thead><tr><th>#</th><th>\u0627\u0644\u062A\u0627\u0631\u064A\u062E</th><th>\u0627\u0644\u0633\u0639\u0631</th><th>\u0627\u0644\u062D\u0627\u0644\u0629</th></tr></thead><tbody>",(t.sessions||[]).forEach(i=>{e+=`
        <tr>
          <td>${i.sessionNumber}</td>
          <td>${new Date(i.date).toLocaleDateString("ar-EG")}</td>
          <td>${i.price} \u062F.\u062C</td>
          <td><span class="badge ${i.status==="completed"?"bg-success":"bg-warning"}">
            ${i.status==="completed"?"\u0645\u0643\u062A\u0645\u0644\u0629":"\u0645\u0639\u0644\u0642\u0629"}
          </span></td>
        </tr>
      `}),e+="</tbody></table></div>",et.default.fire({title:`\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062C\u0648\u0644\u0629 ${t.roundNumber}`,html:`
        <div class="text-start">
          <p><strong>\u0631\u0642\u0645 \u0627\u0644\u062C\u0648\u0644\u0629:</strong> ${t.roundNumber}</p>
          <p><strong>\u0639\u062F\u062F \u0627\u0644\u062C\u0644\u0633\u0627\u062A:</strong> ${t.sessionCount}</p>
          <p><strong>\u0633\u0639\u0631 \u0627\u0644\u062C\u0644\u0633\u0629:</strong> ${t.sessionPrice.toLocaleString()} \u062F.\u062C</p>
          <p><strong>\u0627\u0644\u0645\u062C\u0645\u0648\u0639 \u0627\u0644\u0643\u0644\u064A:</strong> ${t.totalAmount.toLocaleString()} \u062F.\u062C</p>
          <p><strong>\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0628\u062F\u0621:</strong> ${new Date(t.startDate).toLocaleDateString("ar-EG")}</p>
          <p><strong>\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0627\u0646\u062A\u0647\u0627\u0621:</strong> ${new Date(t.endDate).toLocaleDateString("ar-EG")}</p>
          <p><strong>\u0627\u0644\u062D\u0627\u0644\u0629:</strong> <span class="${t.statusClass}">${t.statusText}</span></p>
          <hr>
          <h6>\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062C\u0644\u0633\u0627\u062A:</h6>
          ${e}
        </div>
      `,icon:"info",showCancelButton:!1,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"})}getPaymentMethodLabel(t){let e=this.paymentMethods.find(i=>i.value===t);return e?e.label:t}getAcademicYearName(t){let e=this.academicYears.find(i=>i.value===t);return e?e.label:t}calculateAge(t){if(!t)return 0;let e=new Date(t),i=new Date,r=i.getFullYear()-e.getFullYear(),o=i.getMonth()-e.getMonth();return(o<0||o===0&&i.getDate()<e.getDate())&&r--,r}getStudentClassesNames(){return this.studentClasses.length===0?"\u0644\u0627 \u062A\u0648\u062C\u062F \u062D\u0635\u0635 \u0645\u0633\u062C\u0644\u0629":this.studentClasses.map(e=>e.name).join("\u060C ")}getTotalPaid(){return this.paymentHistory.filter(t=>t.status==="paid").reduce((t,e)=>t+e.amount,0)}getTotalPending(){return this.paymentHistory.filter(t=>t.status==="pending"||t.status==="late").reduce((t,e)=>t+e.amount,0)}getCurrentMonth(){let t=new Date,e=t.getMonth(),i=t.getFullYear();return`${this.months[e]} ${i}`}hasRoundsClasses(){return this.selectedClasses.some(t=>t.paymentSystem==="rounds")}generateMonthOptions(){let t=[],e=new Date;for(let i=0;i<3;i++){let r=e.getFullYear()+i;for(let o=0;o<12;o++){let l=this.months[o];t.push(`${l} ${r}`)}}return t}getPaymentStatusClass(t){if(t.isLate)return"badge bg-danger";switch(t.status){case"paid":return"badge bg-success";case"pending":return"badge bg-warning";case"late":return"badge bg-danger";default:return"badge bg-secondary"}}getPaymentStatusText(t){if(t.isLate)return"\u0645\u062A\u0623\u062E\u0631";switch(t.status){case"paid":return"\u0645\u062F\u0641\u0648\u0639";case"pending":return"\u0645\u0639\u0644\u0642";case"late":return"\u0645\u062A\u0623\u062E\u0631";default:return"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}}printPaymentReceipt(t){let e={receiptNumber:t.invoiceNumber||`RC-${Date.now().toString().slice(-8)}`,date:new Date().toLocaleDateString("en-US"),time:new Date().toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}),studentName:t.studentName||this.student?.name||"",studentId:t.studentId||this.student?.studentId||"",className:t.className||"\u0639\u0627\u0645",month:t.month,amount:t.amount,paymentMethod:t.paymentMethod,academicYear:this.student?.academicYear,parentPhone:this.student?.parentPhone,notes:t.notes||"\u062F\u0641\u0639\u0629 \u0641\u0631\u062F\u064A\u0629"};this.printerService.printProfessionalReceipt(e).then(i=>{i&&et.default.fire({icon:"success",title:"\u062A\u0645\u062A \u0627\u0644\u0637\u0628\u0627\u0639\u0629",text:"\u062A\u0645 \u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 \u0628\u0646\u062C\u0627\u062D",timer:1500,showConfirmButton:!1})})}printStudentReport(){if(this.student)try{et.default.fire({title:"\u062C\u0627\u0631\u064A \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062A\u0642\u0631\u064A\u0631...",allowOutsideClick:!1,didOpen:()=>{et.default.showLoading()}});let t=this.getTotalPaid(),e={student:this.student,classes:this.studentClasses,payments:this.paymentHistory,totalPaid:t,date:new Date().toLocaleDateString("ar-EG")},i=this.generateReportHTML(e),r=window.open("","_blank","width=800,height=600");r&&(r.document.write(i),r.document.close(),r.focus(),r.print(),r.close()),et.default.fire("\u0646\u062C\u0627\u062D","\u062A\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0628\u0646\u062C\u0627\u062D","success")}catch(t){console.error("Error printing report:",t),et.default.fire("\u062E\u0637\u0623","\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062A\u0642\u0631\u064A\u0631","error")}}generateReportHTML(t){return`
      <!DOCTYPE html>
      <html dir="rtl">
      <head>
        <meta charset="UTF-8">
        <title>\u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u0637\u0627\u0644\u0628</title>
        <style>
          body { font-family: 'Arial', sans-serif; padding: 20px; }
          .report { max-width: 800px; margin: 0 auto; }
          .header { text-align: center; margin-bottom: 30px; }
          .header h1 { color: #333; margin-bottom: 10px; }
          .student-info { background: #f5f5f5; padding: 15px; border-radius: 5px; margin-bottom: 20px; }
          .info-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; }
          .section { margin-bottom: 30px; }
          .section h2 { color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 5px; }
          table { width: 100%; border-collapse: collapse; margin-top: 10px; }
          th, td { padding: 10px; text-align: right; border: 1px solid #ddd; }
          th { background-color: #3498db; color: white; }
          tr:nth-child(even) { background-color: #f9f9f9; }
          .total { font-weight: bold; color: #2ecc71; font-size: 18px; }
          .footer { margin-top: 30px; text-align: center; color: #666; font-size: 12px; }
        </style>
      </head>
      <body>
        <div class="report">
          <div class="header">
            <h1>\u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u0637\u0627\u0644\u0628</h1>
            <p>\u0627\u0644\u062A\u0627\u0631\u064A\u062E: ${t.date}</p>
          </div>
          
          <div class="student-info">
            <div class="info-grid">
              <div><strong>\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628:</strong> ${t.student.name}</div>
              <div><strong>\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628:</strong> ${t.student.studentId}</div>
              <div><strong>\u0627\u0644\u0645\u0633\u062A\u0648\u0649 \u0627\u0644\u062F\u0631\u0627\u0633\u064A:</strong> ${this.getAcademicYearName(t.student.academicYear)}</div>
              <div><strong>\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062A\u0633\u062C\u064A\u0644:</strong> ${new Date(t.student.registrationDate).toLocaleDateString("ar-EG")}</div>
              <div><strong>\u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631:</strong> ${t.student.parentName}</div>
              <div><strong>\u0647\u0627\u062A\u0641 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631:</strong> ${t.student.parentPhone}</div>
            </div>
          </div>
          
          <div class="section">
            <h2>\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u0633\u062C\u0644\u0629</h2>
            <table>
              <thead>
                <tr>
                  <th>\u0627\u0633\u0645 \u0627\u0644\u062D\u0635\u0629</th>
                  <th>\u0627\u0644\u0645\u0627\u062F\u0629</th>
                  <th>\u0627\u0644\u0645\u0639\u0644\u0645</th>
                  <th>\u0627\u0644\u0633\u0639\u0631 \u0627\u0644\u0634\u0647\u0631\u064A</th>
                </tr>
              </thead>
              <tbody>
                ${t.classes.map(e=>`
                  <tr>
                    <td>${e.name}</td>
                    <td>${e.subject}</td>
                    <td>${e.teacher?.name||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}</td>
                    <td>${e.price?e.price.toLocaleString()+" \u062F.\u062C":"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}</td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
          </div>
          
          <div class="section">
            <h2>\u0633\u062C\u0644 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A</h2>
            <table>
              <thead>
                <tr>
                  <th>\u0627\u0644\u062A\u0627\u0631\u064A\u062E</th>
                  <th>\u0627\u0644\u0645\u0628\u0644\u063A</th>
                  <th>\u0627\u0644\u0634\u0647\u0631</th>
                  <th>\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639</th>
                  <th>\u0627\u0644\u062D\u0627\u0644\u0629</th>
                </tr>
              </thead>
              <tbody>
                ${t.payments.map(e=>`
                  <tr>
                    <td>${e.paymentDate?new Date(e.paymentDate).toLocaleDateString("ar-EG"):"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u062F\u0641\u0639"}</td>
                    <td>${e.amount.toLocaleString()} \u062F.\u062C</td>
                    <td>${e.month}</td>
                    <td>${this.getPaymentMethodLabel(e.paymentMethod)}</td>
                    <td>${this.getPaymentStatusText(e)}</td>
                  </tr>
                `).join("")}
              </tbody>
            </table>
            <p class="total">\u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u062F\u0641\u0648\u0639: ${t.totalPaid.toLocaleString()} \u062F.\u062C</p>
          </div>
          
          <div class="footer">
            <p>\u062A\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u062A\u0644\u0642\u0627\u0626\u064A\u0627\u064B \u0645\u0646 \u0646\u0638\u0627\u0645 \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0645\u062F\u0631\u0633\u0629</p>
            <p>\xA9 ${new Date().getFullYear()} \u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0642\u0648\u0642 \u0645\u062D\u0641\u0648\u0638\u0629</p>
          </div>
        </div>
      </body>
      </html>
    `}hasPaidPaymentsSelected(){return this.selectedPaymentsForBulkPay.some(t=>t.status==="paid")}getPaidSelectedPayments(){return this.selectedPaymentsForBulkPay.filter(t=>t.status==="paid")}printSelectedPaymentsReceipt(){return wt(this,null,function*(){let t=this.getPaidSelectedPayments();if(t.length===0){et.default.fire({icon:"warning",title:"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0645\u062F\u0641\u0648\u0639\u0629",text:"\u064A\u0631\u062C\u0649 \u062A\u062D\u062F\u064A\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0645\u062F\u0641\u0648\u0639\u0629 \u0644\u0644\u0637\u0628\u0627\u0639\u0629",confirmButtonText:"\u062D\u0633\u0646\u0627\u064B"});return}let{value:e}=yield et.default.fire({title:"\u062E\u064A\u0627\u0631\u0627\u062A \u0627\u0644\u0637\u0628\u0627\u0639\u0629",html:`
        <div class="text-start">
          <div class="alert alert-info">
            <h6><i class="fas fa-info-circle me-2"></i>\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0637\u0628\u0627\u0639\u0629</h6>
            <p class="mb-1"><strong>\u0639\u062F\u062F \u0627\u0644\u062F\u0641\u0639\u0627\u062A:</strong> ${t.length}</p>
            <p class="mb-1"><strong>\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A:</strong> ${t.reduce((r,o)=>r+o.amount,0).toLocaleString()} \u062F.\u062C</p>
          </div>
          
          <div class="mb-3">
            <label class="form-label"><strong>\u0627\u062E\u062A\u0631 \u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u0637\u0628\u0627\u0639\u0629:</strong></label>
            <select class="form-select" id="receiptOption">
              <option value="single">\u0625\u064A\u0635\u0627\u0644 \u0648\u0627\u062D\u062F \u0644\u062C\u0645\u064A\u0639 \u0627\u0644\u062F\u0641\u0639\u0627\u062A</option>
              <option value="multiple">\u0625\u064A\u0635\u0627\u0644\u0627\u062A \u0645\u0646\u0641\u0635\u0644\u0629 \u0644\u0643\u0644 \u062F\u0641\u0639\u0629</option>
            </select>
          </div>
        </div>
      `,icon:"question",showCancelButton:!0,confirmButtonText:"\u0637\u0628\u0627\u0639\u0629",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",preConfirm:()=>({receiptOption:document.getElementById("receiptOption").value})});if(!e)return;let{receiptOption:i}=e;i==="single"?yield this.printSingleReceiptForMultiplePayments(t,t[0]?.paymentMethod||"cash","\u0637\u0628\u0627\u0639\u0629 \u0625\u064A\u0635\u0627\u0644 \u0645\u0648\u062D\u062F \u0644\u0644\u062F\u0641\u0639\u0627\u062A \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0629"):i==="multiple"&&(yield this.printMultipleReceipts(t))})}refreshData(){return wt(this,null,function*(){this.student&&(this.loadPaymentHistory(this.getStudentId()),this.loadStudentPaymentSystems(this.getStudentId()),yield this.delay(2e3),this.loadPaymentHistory(this.getStudentId()))})}viewBulkPayDetails(t,e){let i=`
      <div class="text-start">
        <div class="table-responsive">
          <table class="table table-sm table-hover">
            <thead class="table-light">
              <tr>
                <th>#</th>
                <th>\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628</th>
                <th>\u0627\u0644\u0634\u0647\u0631</th>
                <th>\u0627\u0644\u0645\u0628\u0644\u063A</th>
                <th>\u0631\u0642\u0645 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629</th>
                <th>\u0627\u0644\u062D\u0627\u0644\u0629</th>
              </tr>
            </thead>
            <tbody>
              ${e.map((r,o)=>`
                <tr class="${r.success?"table-success":"table-danger"}">
                  <td>${o+1}</td>
                  <td>${r.student||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}</td>
                  <td>${r.payment}</td>
                  <td>${t[o]?.amount?.toLocaleString("ar-SA")||"0"} \u062F.\u062C</td>
                  <td>${r.receiptNumber||"\u0628\u062F\u0648\u0646"}</td>
                  <td>
                    <span class="badge ${r.success?"bg-success":"bg-danger"}">
                      ${r.success?"\u0646\u0627\u062C\u062D":"\u0641\u0627\u0634\u0644"}
                    </span>
                  </td>
                </tr>
              `).join("")}
            </tbody>
          </table>
        </div>
      </div>
    `;et.default.fire({title:"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A",html:i,width:"800px",showConfirmButton:!0,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B",showCancelButton:!0,cancelButtonText:"\u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u062A\u0642\u0631\u064A\u0631"}).then(r=>{r.dismiss===et.default.DismissReason.cancel&&this.printBulkPayReport(t,e)})}printBulkPayReport(t,e){console.log("\u0637\u0628\u0627\u0639\u0629 \u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A:",{paidPayments:t,results:e})}getUniqueStudentsCount(){let t=new Set;return this.selectedPaymentsForBulkPay.forEach(e=>{e.student?._id?t.add(e.student._id):e.student&&t.add(e.student)}),t.size}getPaidCount(){return this.selectedPaymentsForBulkPay.filter(t=>t.status==="paid").length}getPendingCount(){return this.selectedPaymentsForBulkPay.filter(t=>t.status!=="paid").length}isAllSelected(){return this.selectedPaymentsForBulkPay.length>0&&this.selectedPaymentsForBulkPay.every(t=>this.isPaymentSelected(t))}toggleAllPayments(){this.isAllSelected()?this.selectedPaymentsForBulkPay=[]:this.selectedPaymentsForBulkPay=[...this.paymentHistory.filter(t=>t.status!=="paid")]}processSingleReceiptPayment(){return wt(this,null,function*(){this.closeBulkPayConfirmation(),yield this.processBulkPayWithSingleReceipt()})}processMultipleReceiptsPayment(){return wt(this,null,function*(){this.closeBulkPayConfirmation(),yield this.processBulkPayWithMultipleReceipts()})}processBulkPayWithSingleReceipt(){return wt(this,null,function*(){this.selectedPaymentsForBulkPay.length!==0&&(this.selectedReceiptOption="single",yield this.processBulkPaySelected())})}processBulkPayWithMultipleReceipts(){return wt(this,null,function*(){this.selectedPaymentsForBulkPay.length!==0&&(this.selectedReceiptOption="multiple",yield this.processBulkPaySelected())})}static \u0275fac=function(e){return new(e||n)(Ne(Kr),Ne(ei),Ne(pn),Ne(xd))};static \u0275cmp=nn({type:n,selectors:[["app-student-details"]],decls:143,vars:57,consts:[[1,"student-details-container"],["class","loading-overlay",4,"ngIf"],["class","modal-overlay",4,"ngIf"],["class","student-header",4,"ngIf"],[1,"tabs-navigation"],[1,"nav","nav-tabs"],[1,"nav-item"],[1,"nav-link",3,"click","ngClass"],[1,"fas","fa-user-circle","me-2"],[1,"fas","fa-book-open","me-2"],[1,"fas","fa-money-bill-wave","me-2"],[1,"fas","fa-calculator","me-2"],[1,"tab-content","mt-4"],[1,"tab-pane","fade",3,"ngClass"],["class","row",4,"ngIf"],[1,"card"],[1,"card-header","d-flex","justify-content-between","align-items-center","bg-primary","text-white"],[1,"mb-0"],[1,"btn","btn-light","me-2",3,"click"],[1,"fas","fa-plus","me-2"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-users","me-2"],[1,"card-body"],["class","text-center py-5",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"bulk-pay-controls","card","mb-4"],[1,"card-header","bg-light"],[1,"fas","fa-check-circle","me-2"],[1,"row","align-items-center"],[1,"col-md-4","mb-3"],[1,"form-label"],[1,"form-select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],["value","all"],[1,"d-flex","gap-2","mt-4"],[1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-check-double","me-2"],[1,"btn","btn-outline-secondary",3,"click"],[1,"fas","fa-times","me-2"],["class","alert alert-success",4,"ngIf"],[1,"row","mb-4"],[1,"col-md-4"],[1,"summary-card","bg-success","text-white"],[1,"summary-content"],[1,"summary-icon"],[1,"fas","fa-check-circle"],[1,"summary-card","bg-warning","text-white"],[1,"fas","fa-clock"],[1,"summary-card","bg-info","text-white"],[1,"fas","fa-list-alt"],[4,"ngIf"],[1,"card-header","bg-primary","text-white"],[1,"mb-5"],[1,"border-bottom","pb-2","mb-3"],[1,"fas","fa-calendar-alt","me-2","text-primary"],["class","alert alert-info",4,"ngIf"],[1,"fas","fa-sync-alt","me-2","text-warning"],["class","alert alert-warning",4,"ngIf"],[1,"loading-overlay"],["role","status",1,"spinner-border","text-primary"],[1,"visually-hidden"],[1,"modal-overlay"],[1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header","bg-primary","text-white"],[1,"modal-title"],[1,"fas","fa-plus-circle","me-2"],["type","button",1,"btn-close","btn-close-white",3,"click"],[1,"modal-body"],[3,"ngSubmit"],[1,"row"],[1,"col-md-6","mb-3"],["type","number","name","amount","min","0","step","100","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","month","required","",1,"form-select",3,"ngModelChange","ngModel"],["name","paymentMethod","required","",1,"form-select",3,"ngModelChange","ngModel"],["type","date","disabled","",1,"form-control",3,"value"],[1,"col-12","mb-3"],["name","notes","rows","3","placeholder","\u0645\u0644\u0627\u062D\u0638\u0627\u062A \u0625\u0636\u0627\u0641\u064A\u0629 \u062D\u0648\u0644 \u0627\u0644\u062F\u0641\u0639\u0629...",1,"form-control",3,"ngModelChange","ngModel"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],[3,"value"],[1,"modal-header","bg-warning","text-white"],[1,"fas","fa-edit","me-2"],[3,"ngSubmit",4,"ngIf"],["type","text","name","month","required","",1,"form-control",3,"ngModelChange","ngModel"],["name","status","required","",1,"form-select",3,"ngModelChange","ngModel"],["value","paid"],["value","pending"],["value","late"],["type","submit",1,"btn","btn-warning"],[1,"modal-dialog"],[1,"modal-header","bg-danger","text-white"],[1,"fas","fa-exclamation-triangle","me-2"],["class","modal-body",4,"ngIf"],["type","button",1,"btn","btn-danger",3,"click"],[1,"text-center"],[1,"fas","fa-trash-alt","fa-3x","text-danger","mb-3"],[1,"mb-3"],[1,"alert","alert-warning"],[1,"mb-1"],[1,"text-danger"],[1,"fas","fa-exclamation-circle","me-1"],[1,"modal-dialog","modal-xl"],[1,"modal-header","bg-success","text-white"],["class","mb-4",4,"ngIf"],["type","button",1,"btn","btn-success",3,"click","disabled"],[1,"mb-4"],[1,"d-flex","justify-content-between","mb-2"],[1,"progress",2,"height","20px"],[1,"progress-bar","progress-bar-striped","progress-bar-animated"],["type","number","min","0","step","100","required","",1,"form-control",3,"ngModelChange","ngModel"],["required","",1,"form-select",3,"ngModelChange","ngModel"],["rows","2","placeholder","\u0645\u0644\u0627\u062D\u0638\u0627\u062A \u062D\u0648\u0644 \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A...",1,"form-control",3,"ngModelChange","ngModel"],[1,"d-flex","flex-wrap","gap-2"],["type","button","class","btn btn-outline-primary",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"text-muted"],[1,"d-flex","justify-content-between","align-items-center"],["type","button",1,"btn","btn-sm","btn-outline-primary","me-2",3,"click"],[1,"fas","fa-check-double","me-1"],["type","button",1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fas","fa-times","me-1"],["type","text","placeholder","\u0627\u0628\u062D\u062B \u0639\u0646 \u0637\u0627\u0644\u0628 \u0628\u0627\u0644\u0627\u0633\u0645 \u0623\u0648 \u0627\u0644\u0631\u0642\u0645...",1,"form-control",3,"ngModelChange","input","ngModel"],["class","alert alert-success mb-3",4,"ngIf"],[1,"table-responsive",2,"max-height","300px","overflow-y","auto"],[1,"table","table-hover","table-sm"],["width","50"],[4,"ngFor","ngForOf"],["type","button",1,"btn","btn-outline-primary",3,"click","ngClass"],[1,"alert","alert-success","mb-3"],[1,"text-end"],["type","checkbox",1,"form-check-input",3,"change","checked"],[1,"fas","fa-money-check","me-2"],["role","status",1,"spinner-border","spinner-border-sm","me-2"],[1,"modal-header","bg-info","text-white"],[1,"fas","fa-file-invoice-dollar","me-2"],[1,"text-center","py-5"],[1,"fas","fa-money-bill-wave","fa-3x","text-muted","mb-3"],[1,"table-responsive"],[1,"table","table-hover"],[1,"table-light"],[1,"text-primary"],[1,"badge",3,"ngClass"],[1,"alert","alert-info","mb-4"],[1,"fas","fa-info-circle","me-2"],[1,"table-responsive","mb-4",2,"max-height","300px"],[1,"table","table-sm"],[1,"btn","btn-secondary","me-3",3,"click"],[1,"badge","bg-warning"],["role","status",1,"spinner-border","text-success"],[1,"mt-3"],["class","alert alert-info mb-4",4,"ngIf"],[1,"col-md-6"],["class","alert alert-success mb-4",4,"ngIf"],[1,"d-flex","flex-wrap","gap-2","mt-2"],["class","badge bg-info",4,"ngFor","ngForOf"],[1,"badge","bg-info"],[1,"alert","alert-success","mb-4"],[1,"mb-0","mt-2"],[1,"fas","fa-book","fa-3x","text-muted","mb-3"],["type","checkbox",1,"form-check-input",3,"change","checked","disabled"],["class","text-danger small",4,"ngIf"],[1,"text-muted","small"],[1,"text-danger","small"],[1,"fas","fa-exclamation-triangle","me-1"],[1,"fas","fa-sync-alt","me-2"],["type","button",1,"btn","btn-warning",3,"click"],[1,"alert","alert-warning","mb-4"],["type","text","name","roundNumber","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","number","name","sessionCount","min","1","max","30","required","",1,"form-control",3,"ngModelChange","change","ngModel"],["type","number","name","sessionPrice","min","0","step","100","required","",1,"form-control",3,"ngModelChange","change","ngModel"],["type","text","readonly","",1,"form-control","bg-light",3,"value"],["type","date","name","startDate","required","",1,"form-control",3,"ngModelChange","ngModel","valueAsDate"],["type","date","name","endDate","required","",1,"form-control",3,"ngModelChange","ngModel","valueAsDate"],["name","notes","rows","3","placeholder","\u0645\u0644\u0627\u062D\u0638\u0627\u062A \u0625\u0636\u0627\u0641\u064A\u0629 \u062D\u0648\u0644 \u0627\u0644\u062C\u0648\u0644\u0629...",1,"form-control",3,"ngModelChange","ngModel"],[1,"student-header"],[1,"d-flex","justify-content-between","align-items-start","mb-4"],[1,"btn","btn-outline-secondary","mb-3",3,"click"],[1,"fas","fa-arrow-right","me-2"],[1,"student-name"],[1,"student-id-badge"],[1,"badge","bg-primary","me-2"],[1,"badge","bg-info","me-2"],[1,"action-buttons"],[1,"btn","btn-success","me-2",3,"click"],[1,"fas","fa-print","me-2"],[1,"btn","btn-primary","me-2",3,"click"],[1,"btn","btn-info",3,"click"],[1,"row","quick-stats","mb-4"],[1,"col-md-3","col-sm-6","mb-3"],[1,"stat-card"],[1,"stat-icon","text-primary"],[1,"fas","fa-book"],[1,"stat-info"],[1,"stat-icon","text-success"],[1,"fas","fa-money-check-alt"],[1,"stat-icon","text-warning"],[1,"stat-icon","text-info"],[1,"fas","fa-calendar-alt"],[1,"col-md-8"],[1,"form-label","text-muted"],[1,"form-control-static"],["class","text-muted",4,"ngIf"],[1,"badge","ms-2",3,"ngClass"],[1,"card","mt-4"],[1,"card-header","bg-info","text-white"],[1,"card-header","bg-success","text-white"],[1,"fas","fa-chart-bar","me-2"],[1,"payment-summary"],[1,"summary-item"],[1,"label"],[1,"value","text-success"],[1,"value","text-warning"],[1,"summary-item","total"],[1,"value"],[1,"card-header","bg-warning","text-white"],[1,"fas","fa-book","me-2"],["class","text-center text-muted",4,"ngIf"],[1,"text-center","text-muted"],[1,"fas","fa-book","fa-2x","mb-2"],[1,"list-group","list-group-flush"],["class","list-group-item d-flex justify-content-between align-items-center",4,"ngFor","ngForOf"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"d-flex","align-items-center"],[1,"badge","bg-primary","rounded-pill","me-2"],["title","\u0639\u0631\u0636 \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u062D\u0635\u0629",1,"btn","btn-sm","btn-outline-info",3,"click"],[1,"fas","fa-eye"],[1,"text-muted","mb-4"],[1,"btn","btn-primary",3,"click"],["class","text-muted small",4,"ngIf"],[1,"badge","bg-success"],["role","group",1,"btn-group","btn-group-sm"],["title","\u0639\u0631\u0636 \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u062D\u0635\u0629",1,"btn","btn-outline-info",3,"click"],[1,"fas","fa-clock","me-1"],[1,"alert","alert-success"],[1,"mb-2"],[1,"d-flex","gap-2"],["title","\u0637\u0628\u0627\u0639\u0629 \u0625\u064A\u0635\u0627\u0644\u0627\u062A \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0629",1,"btn","btn-warning","btn-lg",3,"click","disabled"],["id","paymentsAccordion",1,"accordion","payment-accordion"],["class","accordion-item",4,"ngFor","ngForOf"],[1,"card-header","bg-secondary","text-white"],[1,"d-flex","flex-column","gap-2"],[1,"d-flex","justify-content-between"],[1,"text-success"],[1,"text-warning"],[1,"d-flex","justify-content-between","border-top","pt-2"],["class","d-flex justify-content-between",4,"ngFor","ngForOf"],[1,"accordion-item"],[1,"accordion-header"],["type","button",1,"accordion-button",3,"click"],[1,"d-flex","justify-content-between","align-items-center","w-100"],[1,"d-flex","gap-3"],[1,"fas","fa-check","me-1"],[1,"badge","bg-primary"],[1,"fas","fa-list","me-1"],[1,"accordion-collapse"],[1,"accordion-body"],[3,"table-warning","table-success",4,"ngFor","ngForOf"],["class","btn btn-outline-primary","title","\u062F\u0641\u0639",3,"click",4,"ngIf"],["class","btn btn-outline-success","title","\u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644",3,"click",4,"ngIf"],["title","\u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644",1,"btn","btn-outline-info",3,"click"],[1,"fas","fa-print"],["title","\u062A\u0639\u062F\u064A\u0644",1,"btn","btn-outline-warning",3,"click"],[1,"fas","fa-edit"],["title","\u062D\u0630\u0641",1,"btn","btn-outline-danger",3,"click"],[1,"fas","fa-trash"],["title","\u062F\u0641\u0639",1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-money-check"],["title","\u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644",1,"btn","btn-outline-success",3,"click"],[1,"table-secondary"],["colspan","3",1,"text-end"],["colspan","4"],[1,"alert","alert-info"],[1,"fas","fa-exclamation-circle","me-2"],["class","col-md-6 col-lg-4 mb-4",4,"ngFor","ngForOf"],[1,"col-md-6","col-lg-4","mb-4"],[1,"round-card","card","h-100",3,"ngClass"],[1,"card-header"],[1,"mb-0","d-flex","justify-content-between","align-items-center"],[1,"round-info"],[1,"info-item"],[1,"value","text-primary"],["class","info-item",4,"ngIf"],[1,"card-footer"],[1,"btn","btn-sm","btn-outline-info",3,"click"],[1,"fas","fa-eye","me-1"],["class","btn btn-sm btn-outline-success",3,"click",4,"ngIf"],[1,"btn","btn-sm","btn-outline-success",3,"click"],[1,"fas","fa-money-check","me-1"]],template:function(e,i){e&1&&(s(0,"div",0),j(1,UG,4,0,"div",1)(2,VG,41,10,"div",2)(3,jG,10,1,"div",2)(4,GG,14,1,"div",2)(5,t$,17,5,"div",2)(6,o$,14,3,"div",2)(7,a$,47,6,"div",2)(8,E$,17,5,"div",2)(9,S$,14,1,"div",2)(10,M$,64,18,"div",3),s(11,"nav",4)(12,"ul",5)(13,"li",6)(14,"a",7),I("click",function(){return i.setActiveTab("info")}),b(15,"i",8),u(16,"\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u0637\u0627\u0644\u0628 "),a()(),s(17,"li",6)(18,"a",7),I("click",function(){return i.setActiveTab("classes")}),b(19,"i",9),u(20,"\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u0633\u062C\u0644\u0629 "),a()(),s(21,"li",6)(22,"a",7),I("click",function(){return i.setActiveTab("payments")}),b(23,"i",10),u(24,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A "),a()(),s(25,"li",6)(26,"a",7),I("click",function(){return i.setActiveTab("systems")}),b(27,"i",11),u(28,"\u0623\u0646\u0638\u0645\u0629 \u0627\u0644\u062F\u0641\u0639 "),a()()()(),s(29,"div",12)(30,"div",13),j(31,I$,102,39,"div",14),a(),s(32,"div",13)(33,"div",15)(34,"div",16)(35,"h5",17),b(36,"i",9),u(37,"\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u0633\u062C\u0644\u0629"),a(),s(38,"div")(39,"button",18),I("click",function(){return i.openAddToLessonsModal()}),b(40,"i",19),u(41,"\u0625\u0636\u0627\u0641\u0629 \u062D\u0635\u0635 \u062C\u062F\u064A\u062F\u0629 "),a(),s(42,"button",20),I("click",function(){return i.openBulkPaymentModal()}),b(43,"i",21),u(44,"\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A \u062C\u062F\u064A\u062F "),a()()(),s(45,"div",22),j(46,O$,9,0,"div",23)(47,k$,22,1,"div",24),a()()(),s(48,"div",13)(49,"div",15)(50,"div",16)(51,"h5",17),b(52,"i",10),u(53,"\u0633\u062C\u0644 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A"),a(),s(54,"div")(55,"button",18),I("click",function(){return i.openAddPaymentModal()}),b(56,"i",19),u(57,"\u062F\u0641\u0639\u0629 \u0641\u0631\u062F\u064A\u0629 "),a(),s(58,"button",20),I("click",function(){return i.openBulkPaymentModal()}),b(59,"i",21),u(60,"\u062F\u0641\u0639 \u062C\u0645\u0627\u0639\u064A \u062C\u062F\u064A\u062F "),a()()(),s(61,"div",22)(62,"div",25)(63,"div",26)(64,"h6",17),b(65,"i",27),u(66,"\u062A\u062D\u062F\u064A\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0644\u0644\u062F\u0641\u0639 \u0627\u0644\u062C\u0645\u0627\u0639\u064A"),a()(),s(67,"div",22)(68,"div",28)(69,"div",29)(70,"label",30),u(71,"\u0627\u0644\u062A\u062D\u062F\u064A\u062F \u062D\u0633\u0628 \u0627\u0644\u0634\u0647\u0631:"),a(),s(72,"select",31),ye("ngModelChange",function(o){return Ce(i.selectedMonthForGroupPay,o)||(i.selectedMonthForGroupPay=o),o}),I("change",function(){return i.selectPaymentsByMonth(i.selectedMonthForGroupPay)}),s(73,"option",32),u(74,"\u062C\u0645\u064A\u0639 \u0627\u0644\u0623\u0634\u0647\u0631"),a(),j(75,N$,2,2,"option",33),a()(),s(76,"div",29)(77,"label",30),u(78,"\u0627\u0644\u062A\u062D\u062F\u064A\u062F \u062D\u0633\u0628 \u0627\u0644\u062D\u0635\u0629:"),a(),s(79,"select",31),ye("ngModelChange",function(o){return Ce(i.selectedClassForGroupPay,o)||(i.selectedClassForGroupPay=o),o}),I("change",function(){return i.selectPaymentsByClass(i.selectedClassForGroupPay)}),s(80,"option",34),u(81,"\u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0635\u0635"),a(),j(82,U$,2,2,"option",33),a()(),s(83,"div",29)(84,"div",35)(85,"button",36),I("click",function(){return i.selectAllPendingPayments()}),b(86,"i",37),u(87,"\u062A\u062D\u062F\u064A\u062F \u0643\u0644 \u0627\u0644\u0645\u0639\u0644\u0642 "),a(),s(88,"button",38),I("click",function(){return i.selectedPaymentsForBulkPay=[]}),b(89,"i",39),u(90,"\u0625\u0644\u063A\u0627\u0621 \u0627\u0644\u062A\u062D\u062F\u064A\u062F "),a()()()(),j(91,L$,20,6,"div",40),a()(),s(92,"div",41)(93,"div",42)(94,"div",43)(95,"div",44)(96,"h3"),u(97),ut(98,"number"),a(),s(99,"p"),u(100,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A"),a()(),s(101,"div",45),b(102,"i",46),a()()(),s(103,"div",42)(104,"div",47)(105,"div",44)(106,"h3"),u(107),ut(108,"number"),a(),s(109,"p"),u(110,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u0639\u0644\u0642\u0629"),a()(),s(111,"div",45),b(112,"i",48),a()()(),s(113,"div",42)(114,"div",49)(115,"div",44)(116,"h3"),u(117),a(),s(118,"p"),u(119,"\u0639\u062F\u062F \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062A"),a()(),s(120,"div",45),b(121,"i",50),a()()()(),j(122,B$,13,0,"div",23)(123,$$,37,14,"div",51),a()()(),s(124,"div",13)(125,"div",15)(126,"div",52)(127,"h5",17),b(128,"i",11),u(129,"\u0623\u0646\u0638\u0645\u0629 \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u062A\u0644\u0642\u0627\u0626\u064A\u0629"),a()(),s(130,"div",22)(131,"div",53)(132,"h5",54),b(133,"i",55),u(134,"\u0646\u0638\u0627\u0645 \u0627\u0644\u062F\u0641\u0639 \u0627\u0644\u0634\u0647\u0631\u064A "),a(),j(135,Y$,3,0,"div",56)(136,Z$,22,1,"div",24),a(),s(137,"div")(138,"h5",54),b(139,"i",57),u(140,"\u0646\u0638\u0627\u0645 \u0627\u0644\u062F\u0641\u0639 \u0628\u0627\u0644\u062C\u0648\u0644\u0627\u062A "),a(),j(141,J$,3,0,"div",58)(142,tY,2,1,"div",14),a()()()()()()),e&2&&(d(),w("ngIf",i.loading),d(),w("ngIf",i.showPaymentModal),d(),w("ngIf",i.showEditPaymentModal),d(),w("ngIf",i.showDeleteConfirmModal),d(),w("ngIf",i.showBulkPaymentModal),d(),w("ngIf",i.showClassPaymentsModal),d(),w("ngIf",i.showBulkPayConfirmation),d(),w("ngIf",i.showAddToLessonsModal),d(),w("ngIf",i.showRoundSelectionModal),d(),w("ngIf",i.student),d(4),w("ngClass",Rr(41,Kf,i.activeTab==="info")),d(4),w("ngClass",Rr(43,Kf,i.activeTab==="classes")),d(4),w("ngClass",Rr(45,Kf,i.activeTab==="payments")),d(4),w("ngClass",Rr(47,Kf,i.activeTab==="systems")),d(4),w("ngClass",Rr(49,$1,i.activeTab==="info")),d(),w("ngIf",i.student),d(),w("ngClass",Rr(51,$1,i.activeTab==="classes")),d(14),w("ngIf",i.studentClasses.length===0),d(),w("ngIf",i.studentClasses.length>0),d(),w("ngClass",Rr(53,$1,i.activeTab==="payments")),d(24),ve("ngModel",i.selectedMonthForGroupPay),d(3),w("ngForOf",i.getUniqueMonths()),d(4),ve("ngModel",i.selectedClassForGroupPay),d(3),w("ngForOf",i.studentClasses),d(9),w("ngIf",i.selectedPaymentsForBulkPay.length>0),d(6),H("",pt(98,35,i.getTotalPaid(),"1.0-0")," \u062F.\u062C"),d(10),H("",pt(108,38,i.getTotalPending(),"1.0-0")," \u062F.\u062C"),d(10),B(i.paymentHistory.length),d(5),w("ngIf",i.classPaymentGroups.length===0),d(),w("ngIf",i.classPaymentGroups.length>0),d(),w("ngClass",Rr(55,$1,i.activeTab==="systems")),d(11),w("ngIf",i.studentMonthlyPayments.length===0),d(),w("ngIf",i.studentMonthlyPayments.length>0),d(5),w("ngIf",i.studentRounds.length===0),d(),w("ngIf",i.studentRounds.length>0))},dependencies:[hn,Bo,Nn,An,T0,qr,Un,Ti,Di,Pi,Yn,gr,di,ii,Ai,$i,_r,tu,ti,mr],styles:[".student-details-container[_ngcontent-%COMP%]{padding:2rem;background-color:#f8f9fa;min-height:100vh;direction:rtl}.student-header[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:12px;box-shadow:0 4px 6px #0000000d;margin-bottom:2rem;border-right:5px solid #0d6efd}.student-name[_ngcontent-%COMP%]{font-weight:800;color:#2c3e50;margin-bottom:.5rem}.student-id-badge[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{padding:.6rem 1rem;font-size:.9rem;font-weight:500;border-radius:8px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#0009;backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:1050;overflow-y:auto;padding:1rem}.modal-dialog[_ngcontent-%COMP%]{width:100%;margin:auto}.modal-content[_ngcontent-%COMP%]{border:none;border-radius:15px;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;overflow:hidden;animation:_ngcontent-%COMP%_modalSlideUp .3s ease-out}@keyframes _ngcontent-%COMP%_modalSlideUp{0%{transform:translateY(20px);opacity:0}to{transform:translateY(0);opacity:1}}.form-label[_ngcontent-%COMP%]{font-weight:600;color:#495057;margin-bottom:.5rem}.form-control[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%]{padding:.75rem 1rem;border-radius:10px;border:1px solid #dee2e6;transition:all .2s ease}.form-control[_ngcontent-%COMP%]:focus, .form-select[_ngcontent-%COMP%]:focus{border-color:#0d6efd;box-shadow:0 0 0 4px #0d6efd1a}.table[_ngcontent-%COMP%]{background:#fff;border-radius:10px;overflow:hidden}.table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f1f4f8;color:#555;font-weight:600;text-transform:uppercase;font-size:.85rem;border-bottom:2px solid #dee2e6;padding:1rem}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:1rem;vertical-align:middle}.loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#fffc;display:flex;flex-direction:column;justify-content:center;align-items:center;z-index:9999}.btn[_ngcontent-%COMP%]{padding:.6rem 1.2rem;border-radius:8px;font-weight:600;transition:transform .1s}.btn[_ngcontent-%COMP%]:active{transform:scale(.96)}.active-class-btn[_ngcontent-%COMP%]{border:2px solid #0d6efd!important;background-color:#0d6efd0d}@media (max-width: 768px){.student-header[_ngcontent-%COMP%]{padding:1.5rem}.action-buttons[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}}"]})};$();var q1=class n{static \u0275fac=function(e){return new(e||n)};static \u0275cmp=nn({type:n,selectors:[["app-add-student-to-classes-modal"]],decls:2,vars:0,template:function(e,i){e&1&&(s(0,"p"),u(1,"add-student-to-classes-modal works!"),a())},encapsulation:2})};$();var ol=ya(Na()),Cd=ya(dD());$();var X1=class n{constructor(t,e){this.http=t;this.authService=e}apiUrl=`${Bt.apiUrl}/accounting`||"/api/accounting";getDailyIncome(t){let e=new Qn;return t&&(e=e.set("date",t)),this.http.get(`${this.apiUrl}/daily-income`,{params:e,headers:this.authService.getAuthHeaders()})}getTodayStats(){return this.http.get(`${this.apiUrl}/today-stats`,{headers:this.authService.getAuthHeaders()})}getCurrentBalance(){return this.http.get(`${this.apiUrl}/balance`,{headers:this.authService.getAuthHeaders()})}getQuickFinancialStats(){return this.http.get(`${this.apiUrl}/quick-financial-stats`,{headers:this.authService.getAuthHeaders()})}getTransactions(t){let e=new Qn;return t&&Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/transactions`,{params:e,headers:this.authService.getAuthHeaders()})}addTransaction(t){return this.http.post(`${this.apiUrl}/transactions`,t,{headers:this.authService.getAuthHeaders()})}getWeeklyIncome(){return this.http.get(`${this.apiUrl}/weekly-income`,{headers:this.authService.getAuthHeaders()})}getMonthlyIncome(){return this.http.get(`${this.apiUrl}/monthly-income`,{headers:this.authService.getAuthHeaders()})}getBudgets(t){let e=new Qn;return t&&Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/budgets`,{params:e,headers:this.authService.getAuthHeaders()})}createBudget(t){return this.http.post(`${this.apiUrl}/budgets`,t,{headers:this.authService.getAuthHeaders()})}updateBudget(t,e){return this.http.put(`${this.apiUrl}/budgets/${t}`,e,{headers:this.authService.getAuthHeaders()})}getExpenses(t){let e=new Qn;return t&&Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/expenses`,{params:e,headers:this.authService.getAuthHeaders()})}addExpense(t){return this.http.post(`${this.apiUrl}/expenses`,t,{headers:this.authService.getAuthHeaders()})}getSchoolFees(t){let e=new Qn;return t&&Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/school-fees`,{params:e,headers:this.authService.getAuthHeaders()})}paySchoolFee(t,e){return this.http.put(`${this.apiUrl}/school-fees/${t}/pay`,e,{headers:this.authService.getAuthHeaders()})}getTeacherCommissions(t){let e=new Qn;return t&&Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/teacher-commissions`,{params:e,headers:this.authService.getAuthHeaders()})}payTeacherCommission(t,e){return this.http.post(`${this.apiUrl}/teacher-commissions/${t}/pay`,e,{headers:this.authService.getAuthHeaders()})}calculateTeacherClassCommission(t){let e=new Qn;return Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/teacher-class-commission`,{params:e,headers:this.authService.getAuthHeaders()})}payClassCommission(t){return this.http.post(`${this.apiUrl}/pay-class-commission`,t,{headers:this.authService.getAuthHeaders()})}getFinancialReport(t){let e=new Qn;return t&&Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/reports/financial`,{params:e,headers:this.authService.getAuthHeaders()})}getMonthlyFinancialReport(t){let e=new Qn;return t&&Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/monthly-financial-report`,{params:e,headers:this.authService.getAuthHeaders()})}getInvoices(t){let e=new Qn;return t&&Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/invoices`,{params:e,headers:this.authService.getAuthHeaders()})}getInvoice(t){return this.http.get(`${this.apiUrl}/invoices/${t}`,{headers:this.authService.getAuthHeaders()})}generateInvoice(t,e){return this.http.get(`${this.apiUrl}/invoices/generate/${t}/${e}`,{headers:this.authService.getAuthHeaders()})}getTeacherPayments(t){let e=new Qn;return t&&Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/teacher-payments`,{params:e,headers:this.authService.getAuthHeaders()})}getStaffSalaries(t){let e=new Qn;return t&&Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/staff-salaries`,{params:e,headers:this.authService.getAuthHeaders()})}getRegistrationFeeDetails(t){let e=new Qn;return t&&Object.keys(t).forEach(i=>{t[i]&&(e=e.set(i,t[i]))}),this.http.get(`${this.apiUrl}/registration-fee-details`,{params:e,headers:this.authService.getAuthHeaders()})}exportReport(t,e){let i=new Qn;return e&&Object.keys(e).forEach(r=>{e[r]&&(i=i.set(r,e[r]))}),i=i.set("format",t),this.http.get(`${this.apiUrl}/export-financial-report`,{params:i,headers:this.authService.getAuthHeaders(),responseType:"blob"})}exportFinancialReport(t,e){let i=new Qn;return e&&Object.keys(e).forEach(r=>{e[r]&&(i=i.set(r,e[r]))}),i=i.set("format",t),this.http.get(`${this.apiUrl}/export-financial-report`,{params:i,headers:this.authService.getAuthHeaders(),responseType:"blob"})}getClassPaymentsForMonth(t){return this.http.get(`${this.apiUrl}/class-payments/month/${t}`,{headers:this.authService.getAuthHeaders()})}static \u0275fac=function(e){return new(e||n)(We(pn),We(qn))};static \u0275prov=$e({token:n,factory:n.\u0275fac,providedIn:"root"})};var iY=(n,t,e)=>({"badge-success":n,"badge-warning":t,"badge-danger":e}),rY=(n,t,e,i)=>({"badge-primary":n,"badge-success":t,"badge-info":e,"badge-secondary":i});function oY(n,t){n&1&&(s(0,"div",135),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644... "),a())}function sY(n,t){if(n&1&&(s(0,"div",137)(1,"div",138)(2,"h2"),u(3),a(),s(4,"p"),u(5,"\u0625\u062C\u0645\u0627\u0644\u064A \u0625\u064A\u0631\u0627\u062F\u0627\u062A \u0627\u0644\u064A\u0648\u0645"),a()(),s(6,"div",139)(7,"div",140)(8,"span",141),u(9,"\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u062D\u0635\u0635:"),a(),s(10,"span",142),u(11),s(12,"small"),u(13),a()()(),s(14,"div",140)(15,"span",141),u(16,"\u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644:"),a(),s(17,"span",142),u(18),s(19,"small"),u(20),a()()(),s(21,"div",140)(22,"span",141),u(23,"\u0625\u064A\u0631\u0627\u062F\u0627\u062A \u0623\u062E\u0631\u0649:"),a(),s(24,"span",142),u(25),s(26,"small"),u(27),a()()()()()),n&2){let e=E(2);d(3),B(e.formatCurrency(e.dailyIncome.dailyIncome||0)),d(8),H(" ",e.formatCurrency((e.dailyIncome.breakdown==null||e.dailyIncome.breakdown.payments==null?null:e.dailyIncome.breakdown.payments.amount)||0)," "),d(2),H("(",(e.dailyIncome.breakdown==null||e.dailyIncome.breakdown.payments==null?null:e.dailyIncome.breakdown.payments.count)||0,")"),d(5),H(" ",e.formatCurrency((e.dailyIncome.breakdown==null||e.dailyIncome.breakdown.registrationFees==null?null:e.dailyIncome.breakdown.registrationFees.amount)||0)," "),d(2),H("(",(e.dailyIncome.breakdown==null||e.dailyIncome.breakdown.registrationFees==null?null:e.dailyIncome.breakdown.registrationFees.count)||0,")"),d(5),H(" ",e.formatCurrency((e.dailyIncome.breakdown==null||e.dailyIncome.breakdown.otherIncome==null?null:e.dailyIncome.breakdown.otherIncome.amount)||0)," "),d(2),H("(",(e.dailyIncome.breakdown==null||e.dailyIncome.breakdown.otherIncome==null?null:e.dailyIncome.breakdown.otherIncome.count)||0,")")}}function aY(n,t){n&1&&(s(0,"div",135),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062A... "),a())}function lY(n,t){n&1&&(s(0,"div",143),b(1,"i",144),s(2,"p"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u0639\u0627\u0645\u0644\u0627\u062A \u062D\u0627\u0644\u064A\u0627\u064B"),a()())}function uY(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td")(4,"span",148),u(5),a()(),s(6,"td"),u(7),a(),s(8,"td",149),u(9),a(),s(10,"td"),u(11),a(),s(12,"td"),u(13),a()()),n&2){let e=t.$implicit,i=E(3);d(2),B(i.formatDate(e.date)),d(2),w("ngClass","badge-"+i.getTransactionTypeBadge(e.type)),d(),H(" ",i.getTransactionTypeText(e.type)," "),d(2),B(e.description),d(),w("ngClass",e.type==="income"?"text-success":"text-danger"),d(),H(" ",i.formatCurrency(e.amount)," "),d(2),B(i.getCategoryText(e.category)),d(2),B((e.recordedBy==null?null:e.recordedBy.username)||"\u0646\u0638\u0627\u0645")}}function cY(n,t){if(n&1&&(s(0,"div",145)(1,"table",146)(2,"thead")(3,"tr")(4,"th"),u(5,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E"),a(),s(6,"th"),u(7,"\u0627\u0644\u0646\u0648\u0639"),a(),s(8,"th"),u(9,"\u0627\u0644\u0648\u0635\u0641"),a(),s(10,"th"),u(11,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(12,"th"),u(13,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641"),a(),s(14,"th"),u(15,"\u0627\u0644\u0645\u0633\u062C\u0644"),a()()(),s(16,"tbody"),j(17,uY,14,8,"tr",147),a()()()),n&2){let e=E(2);d(17),w("ngForOf",e.transactions.slice(0,10))}}function dY(n,t){if(n&1){let e=he();s(0,"div",96)(1,"div",97)(2,"div",98)(3,"div",99),b(4,"i",100),a(),s(5,"div",101)(6,"h3"),u(7),a(),s(8,"p"),u(9,"\u0627\u0644\u0631\u0635\u064A\u062F \u0627\u0644\u062D\u0627\u0644\u064A"),a()()(),s(10,"div",102)(11,"div",99),b(12,"i",17),a(),s(13,"div",101)(14,"h3"),u(15),a(),s(16,"p"),u(17,"\u0625\u064A\u0631\u0627\u062F\u0627\u062A \u0627\u0644\u064A\u0648\u0645"),a(),s(18,"small"),u(19),a()()(),s(20,"div",103)(21,"div",99),b(22,"i",18),a(),s(23,"div",101)(24,"h3"),u(25),a(),s(26,"p"),u(27,"\u0645\u0635\u0631\u0648\u0641\u0627\u062A \u0627\u0644\u064A\u0648\u0645"),a(),s(28,"small"),u(29),a()()(),s(30,"div",104)(31,"div",99),b(32,"i",21),a(),s(33,"div",101)(34,"h3"),u(35),a(),s(36,"p"),u(37,"\u0639\u0645\u0648\u0644\u0627\u062A \u0627\u0644\u064A\u0648\u0645"),a(),s(38,"small"),u(39),a()()()(),s(40,"div",105)(41,"div",106)(42,"h3"),b(43,"i",107),u(44," \u0625\u064A\u0631\u0627\u062F\u0627\u062A \u0627\u0644\u064A\u0648\u0645"),a(),s(45,"span",108),u(46),a()(),s(47,"div",109),j(48,oY,3,0,"div",110)(49,sY,28,7,"div",111),a()(),s(50,"div",82)(51,"div",83)(52,"div",112)(53,"div",106)(54,"h4"),b(55,"i",113),u(56," \u0627\u0644\u0625\u062D\u0635\u0627\u0626\u064A\u0627\u062A \u0627\u0644\u0645\u0627\u0644\u064A\u0629 \u0627\u0644\u0633\u0631\u064A\u0639\u0629"),a()(),s(57,"div",109)(58,"div",114)(59,"div",115)(60,"span",116),u(61,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0625\u064A\u0631\u0627\u062F\u0627\u062A:"),a(),s(62,"span",117),u(63),a()(),s(64,"div",115)(65,"span",116),u(66,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u0627\u062A:"),a(),s(67,"span",118),u(68),a()(),s(69,"div",115)(70,"span",116),u(71,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0645\u0639\u0644\u0642\u0629:"),a(),s(72,"span",119),u(73),a()(),s(74,"div",115)(75,"span",116),u(76,"\u0622\u062E\u0631 \u062A\u062D\u062F\u064A\u062B:"),a(),s(77,"span",120),u(78),a()()()()()(),s(79,"div",83)(80,"div",112)(81,"div",106)(82,"h4"),b(83,"i",121),u(84," \u0625\u062C\u0631\u0627\u0621\u0627\u062A \u0633\u0631\u064A\u0639\u0629"),a()(),s(85,"div",109)(86,"div",122)(87,"button",123),I("click",function(){F(e);let r=E();return R(r.openTransactionModal())}),b(88,"i",124),u(89," \u0625\u0636\u0627\u0641\u0629 \u0645\u0639\u0627\u0645\u0644\u0629 "),a(),s(90,"button",125),I("click",function(){F(e);let r=E();return R(r.openExpenseModal())}),b(91,"i",126),u(92," \u0625\u0636\u0627\u0641\u0629 \u0645\u0635\u0631\u0648\u0641 "),a(),s(93,"button",127),I("click",function(){F(e);let r=E();return R(r.openBudgetModal())}),b(94,"i",19),u(95," \u0625\u0646\u0634\u0627\u0621 \u0645\u064A\u0632\u0627\u0646\u064A\u0629 "),a(),s(96,"button",128),I("click",function(){F(e);let r=E();return R(r.openSchoolFeeModal())}),b(97,"i",129),u(98," \u062A\u0633\u062C\u064A\u0644 \u0631\u0633\u0648\u0645 \u062A\u0633\u062C\u064A\u0644 "),a()()()()()(),s(99,"div",112)(100,"div",106)(101,"h4"),b(102,"i",130),u(103," \u0622\u062E\u0631 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062A"),a(),s(104,"button",131),I("click",function(){F(e);let r=E();return R(r.switchTab("transactions"))}),u(105," \u0639\u0631\u0636 \u0627\u0644\u0643\u0644 "),b(106,"i",132),a()(),s(107,"div",109),j(108,aY,3,0,"div",110)(109,lY,4,0,"div",133)(110,cY,18,1,"div",134),a()()()}if(n&2){let e=E();d(7),B(e.formatCurrency(e.currentBalance)),d(8),B(e.formatCurrency((e.todayStats.payments==null?null:e.todayStats.payments.total)||0)),d(4),H("",(e.todayStats.payments==null?null:e.todayStats.payments.count)||0," \u0645\u0639\u0627\u0645\u0644\u0629"),d(6),B(e.formatCurrency((e.todayStats.expenses==null?null:e.todayStats.expenses.total)||0)),d(4),H("",(e.todayStats.expenses==null?null:e.todayStats.expenses.count)||0," \u0645\u0635\u0631\u0648\u0641"),d(6),B(e.formatCurrency((e.todayStats.commissions==null?null:e.todayStats.commissions.total)||0)),d(4),H("",(e.todayStats.commissions==null?null:e.todayStats.commissions.count)||0," \u0639\u0645\u0648\u0644\u0629"),d(7),B(e.dailyIncome.formattedDate||e.getCurrentDateFormatted()),d(2),w("ngIf",e.loading.income),d(),w("ngIf",!e.loading.income),d(14),H(" ",e.formatCurrency(e.quickFinancialStats.totalIncome||0)," "),d(5),H(" ",e.formatCurrency(e.quickFinancialStats.totalExpenses||0)," "),d(5),H(" ",e.quickFinancialStats.pendingPayments||0," "),d(5),H(" ",e.formatDateTime(e.quickFinancialStats.lastUpdated)," "),d(30),w("ngIf",e.loading.transactions),d(),w("ngIf",!e.loading.transactions&&e.transactions.length===0),d(),w("ngIf",!e.loading.transactions&&e.transactions.length>0)}}function fY(n,t){n&1&&(s(0,"div",135),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062A... "),a())}function hY(n,t){if(n&1){let e=he();s(0,"div",143),b(1,"i",169),s(2,"h4"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u0639\u0627\u0645\u0644\u0627\u062A"),a(),s(4,"p"),u(5,"\u0642\u0645 \u0628\u0625\u0636\u0627\u0641\u0629 \u0645\u0639\u0627\u0645\u0644\u0629 \u0645\u0627\u0644\u064A\u0629 \u062C\u062F\u064A\u062F\u0629"),a(),s(6,"button",4),I("click",function(){F(e);let r=E(2);return R(r.openTransactionModal())}),b(7,"i",5),u(8," \u0625\u0636\u0627\u0641\u0629 \u0645\u0639\u0627\u0645\u0644\u0629 "),a()()}}function pY(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td")(4,"span",148),u(5),a()(),s(6,"td"),u(7),a(),s(8,"td",149)(9,"strong"),u(10),a()(),s(11,"td")(12,"span",170),u(13),a()(),s(14,"td"),u(15),a(),s(16,"td")(17,"button",171),b(18,"i",172),a()()()),n&2){let e=t.$implicit,i=E(3);d(2),B(i.formatDate(e.date)),d(2),w("ngClass","badge-"+i.getTransactionTypeBadge(e.type)),d(),H(" ",i.getTransactionTypeText(e.type)," "),d(2),B(e.description),d(),w("ngClass",e.type==="income"?"text-success":"text-danger"),d(2),B(i.formatCurrency(e.amount)),d(3),H(" ",i.getCategoryText(e.category)," "),d(2),B((e.recordedBy==null?null:e.recordedBy.username)||"\u0646\u0638\u0627\u0645")}}function mY(n,t){if(n&1&&(s(0,"table",146)(1,"thead")(2,"tr")(3,"th"),u(4,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E"),a(),s(5,"th"),u(6,"\u0627\u0644\u0646\u0648\u0639"),a(),s(7,"th"),u(8,"\u0627\u0644\u0648\u0635\u0641"),a(),s(9,"th"),u(10,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(11,"th"),u(12,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641"),a(),s(13,"th"),u(14,"\u0627\u0644\u0645\u0633\u062C\u0644"),a(),s(15,"th"),u(16,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(17,"tbody"),j(18,pY,19,8,"tr",147),a()()),n&2){let e=E(2);d(18),w("ngForOf",e.transactions)}}function gY(n,t){if(n&1&&(s(0,"div",173)(1,"div",82)(2,"div",155)(3,"div",174)(4,"h4"),u(5),a(),s(6,"p"),u(7,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0625\u064A\u0631\u0627\u062F\u0627\u062A"),a(),s(8,"small"),u(9),a()()(),s(10,"div",155)(11,"div",175)(12,"h4"),u(13),a(),s(14,"p"),u(15,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u0627\u062A"),a(),s(16,"small"),u(17),a()()(),s(18,"div",155)(19,"div",176)(20,"h4"),u(21),a(),s(22,"p"),u(23,"\u0635\u0627\u0641\u064A \u0627\u0644\u0631\u0628\u062D"),a(),s(24,"small"),u(25),a()()()()()),n&2){let e=E(2);d(5),B(e.formatCurrency(e.calculateTotalIncome())),d(4),H("",e.getTransactionCounts().income," \u0645\u0639\u0627\u0645\u0644\u0629"),d(4),B(e.formatCurrency(e.calculateTotalExpenses())),d(4),H("",e.getTransactionCounts().expense," \u0645\u0639\u0627\u0645\u0644\u0629"),d(2),w("ngClass",e.calculateNetProfit()>=0?"bg-info":"bg-warning"),d(2),B(e.formatCurrency(e.calculateNetProfit())),d(4),H("",e.transactions.length," \u0645\u0639\u0627\u0645\u0644\u0629 \u0625\u062C\u0645\u0627\u0644\u0627\u064B")}}function _Y(n,t){if(n&1){let e=he();s(0,"div",150)(1,"div",112)(2,"div",106)(3,"h3"),b(4,"i",16),u(5," \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062A \u0627\u0644\u0645\u0627\u0644\u064A\u0629"),a(),s(6,"div",151)(7,"button",4),I("click",function(){F(e);let r=E();return R(r.openTransactionModal())}),b(8,"i",5),u(9," \u0625\u0636\u0627\u0641\u0629 \u0645\u0639\u0627\u0645\u0644\u0629 "),a()()(),s(10,"div",109)(11,"div",152)(12,"div",82)(13,"div",153)(14,"label"),u(15,"\u0645\u0646 \u062A\u0627\u0631\u064A\u062E"),a(),s(16,"input",154),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.dateFilter.startDate,r)||(o.dateFilter.startDate=r),R(r)}),a()(),s(17,"div",153)(18,"label"),u(19,"\u0625\u0644\u0649 \u062A\u0627\u0631\u064A\u062E"),a(),s(20,"input",154),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.dateFilter.endDate,r)||(o.dateFilter.endDate=r),R(r)}),a()(),s(21,"div",155)(22,"label"),u(23,"\u0628\u062D\u062B"),a(),s(24,"div",156)(25,"input",157),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.searchTerm,r)||(o.searchTerm=r),R(r)}),a(),s(26,"div",158)(27,"button",159),I("click",function(){F(e);let r=E();return R(r.searchTransactions())}),b(28,"i",160),a(),s(29,"button",161),I("click",function(){F(e);let r=E();return R(r.clearSearch())}),b(30,"i",66),a()()()(),s(31,"div",162)(32,"label"),u(33,"\xA0"),a(),s(34,"div",163)(35,"button",6),I("click",function(){F(e);let r=E();return R(r.applyDateFilter())}),b(36,"i",164),u(37," \u062A\u0637\u0628\u064A\u0642 "),a(),s(38,"button",165),I("click",function(){F(e);let r=E();return R(r.clearDateFilter())}),b(39,"i",66),u(40," \u0645\u0633\u062D "),a()()()()(),s(41,"div",166),j(42,fY,3,0,"div",110)(43,hY,9,0,"div",133)(44,mY,19,1,"table",167),a(),j(45,gY,26,7,"div",168),a()()()}if(n&2){let e=E();d(16),ve("ngModel",e.dateFilter.startDate),d(4),ve("ngModel",e.dateFilter.endDate),d(5),ve("ngModel",e.searchTerm),d(17),w("ngIf",e.loading.transactions),d(),w("ngIf",!e.loading.transactions&&e.transactions.length===0),d(),w("ngIf",!e.loading.transactions&&e.transactions.length>0),d(),w("ngIf",!e.loading.transactions&&e.transactions.length>0)}}function vY(n,t){n&1&&(s(0,"div",135),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u0627\u0644\u062A\u062D\u0645\u064A\u0644... "),a())}function yY(n,t){if(n&1&&(s(0,"div")(1,"div",185)(2,"h2"),u(3),a(),s(4,"p"),u(5,"\u0625\u062C\u0645\u0627\u0644\u064A \u0625\u064A\u0631\u0627\u062F\u0627\u062A \u0627\u0644\u064A\u0648\u0645"),a()()()),n&2){let e=E(2);d(3),B(e.formatCurrency(e.dailyIncome.dailyIncome||0))}}function xY(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td")(6,"div",188),b(7,"div",189),a(),u(8),a(),s(9,"td"),u(10),a()()),n&2){let e=t.$implicit,i=E(2);d(2),B(i.getCategoryText(e.name)),d(2),B(i.formatCurrency(e.amount)),d(3),fr("width",e.percentage,"%"),d(),H(" ",e.percentage.toFixed(1),"% "),d(2),B(e.count)}}function bY(n,t){if(n&1){let e=he();s(0,"div",177)(1,"div",112)(2,"div",106)(3,"h3"),b(4,"i",17),u(5," \u062A\u0642\u0627\u0631\u064A\u0631 \u0627\u0644\u0625\u064A\u0631\u0627\u062F\u0627\u062A"),a()(),s(6,"div",109)(7,"div",178)(8,"div",179)(9,"div",180)(10,"h4"),b(11,"i",107),u(12," \u0625\u064A\u0631\u0627\u062F\u0627\u062A \u0627\u0644\u064A\u0648\u0645"),a(),s(13,"button",181),I("click",function(){F(e);let r=E();return R(r.loadDailyIncome())}),b(14,"i",9),u(15," \u062A\u062D\u062F\u064A\u062B "),a()(),s(16,"div",182),j(17,vY,3,0,"div",110)(18,yY,6,1,"div",183),a()(),s(19,"div",179)(20,"div",180)(21,"h4"),b(22,"i",184),u(23," \u0625\u064A\u0631\u0627\u062F\u0627\u062A \u0627\u0644\u0634\u0647\u0631 \u0627\u0644\u062D\u0627\u0644\u064A"),a()(),s(24,"div",182)(25,"div",185)(26,"h2"),u(27),a(),s(28,"p"),u(29,"\u0625\u064A\u0631\u0627\u062F\u0627\u062A \u0627\u0644\u0634\u0647\u0631 \u0627\u0644\u062D\u0627\u0644\u064A"),a()()()()(),s(30,"div",186)(31,"div",106)(32,"h4"),b(33,"i",19),u(34," \u062A\u0648\u0632\u064A\u0639 \u0627\u0644\u0625\u064A\u0631\u0627\u062F\u0627\u062A \u062D\u0633\u0628 \u0627\u0644\u062A\u0635\u0646\u064A\u0641"),a()(),s(35,"div",109)(36,"div",145)(37,"table",187)(38,"thead")(39,"tr")(40,"th"),u(41,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641"),a(),s(42,"th"),u(43,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(44,"th"),u(45,"\u0627\u0644\u0646\u0633\u0628\u0629"),a(),s(46,"th"),u(47,"\u0639\u062F\u062F \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062A"),a()()(),s(48,"tbody"),j(49,xY,11,6,"tr",147),a()()()()()()()()}if(n&2){let e=E();d(17),w("ngIf",e.loading.income),d(),w("ngIf",!e.loading.income),d(9),B(e.formatCurrency(e.getCurrentMonthData().income)),d(22),w("ngForOf",e.getTopCategories())}}function CY(n,t){n&1&&(s(0,"div",135),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u0627\u062A... "),a())}function EY(n,t){if(n&1){let e=he();s(0,"div",143),b(1,"i",191),s(2,"h4"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u0635\u0631\u0648\u0641\u0627\u062A"),a(),s(4,"p"),u(5,"\u0642\u0645 \u0628\u0625\u0636\u0627\u0641\u0629 \u0645\u0635\u0631\u0648\u0641 \u062C\u062F\u064A\u062F"),a(),s(6,"button",4),I("click",function(){F(e);let r=E(2);return R(r.openExpenseModal())}),b(7,"i",5),u(8," \u0625\u0636\u0627\u0641\u0629 \u0645\u0635\u0631\u0648\u0641 "),a()()}}function wY(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td",192)(6,"strong"),u(7),a()(),s(8,"td")(9,"span",193),u(10),a()(),s(11,"td"),u(12),a(),s(13,"td")(14,"span",148),u(15),a()(),s(16,"td")(17,"button",171),b(18,"i",172),a()()()),n&2){let e=t.$implicit,i=E(3);d(2),B(i.formatDate(e.date)),d(2),B(e.description),d(3),B(i.formatCurrency(e.amount)),d(3),H(" ",i.getCategoryText(e.category)," "),d(2),B(i.getPaymentMethodText(e.paymentMethod)),d(2),w("ngClass","badge-"+i.getStatusBadge(e.status)),d(),H(" ",i.getStatusText(e.status)," ")}}function SY(n,t){if(n&1&&(s(0,"table",146)(1,"thead")(2,"tr")(3,"th"),u(4,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E"),a(),s(5,"th"),u(6,"\u0627\u0644\u0648\u0635\u0641"),a(),s(7,"th"),u(8,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(9,"th"),u(10,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641"),a(),s(11,"th"),u(12,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(13,"th"),u(14,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(15,"th"),u(16,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(17,"tbody"),j(18,wY,19,7,"tr",147),a()()),n&2){let e=E(2);d(18),w("ngForOf",e.expenses)}}function MY(n,t){if(n&1&&(s(0,"div",173)(1,"div",82)(2,"div",83)(3,"div",175)(4,"h4"),u(5),a(),s(6,"p"),u(7,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u0627\u062A"),a(),s(8,"small"),u(9),a()()(),s(10,"div",83)(11,"div",194)(12,"h4"),u(13),a(),s(14,"p"),u(15,"\u0645\u0635\u0631\u0648\u0641\u0627\u062A \u0627\u0644\u0634\u0647\u0631 \u0627\u0644\u062D\u0627\u0644\u064A"),a(),s(16,"small"),u(17),a()()()()()),n&2){let e=E(2);d(5),B(e.formatCurrency(e.calculateTotalExpenses())),d(4),H("",e.expenses.length," \u0645\u0635\u0631\u0648\u0641"),d(4),B(e.formatCurrency(e.getCurrentMonthData().expense)),d(4),H("\u0645\u0646 ",e.getCurrentDateFormatted(),"")}}function AY(n,t){if(n&1){let e=he();s(0,"div",190)(1,"div",112)(2,"div",106)(3,"h3"),b(4,"i",18),u(5," \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u0627\u062A"),a(),s(6,"div",151)(7,"button",4),I("click",function(){F(e);let r=E();return R(r.openExpenseModal())}),b(8,"i",5),u(9," \u0625\u0636\u0627\u0641\u0629 \u0645\u0635\u0631\u0648\u0641 "),a()()(),s(10,"div",109)(11,"div",145),j(12,CY,3,0,"div",110)(13,EY,9,0,"div",133)(14,SY,19,1,"table",167),a(),j(15,MY,18,4,"div",168),a()()()}if(n&2){let e=E();d(12),w("ngIf",e.loading.transactions),d(),w("ngIf",!e.loading.transactions&&e.expenses.length===0),d(),w("ngIf",!e.loading.transactions&&e.expenses.length>0),d(),w("ngIf",!e.loading.transactions&&e.expenses.length>0)}}function TY(n,t){n&1&&(s(0,"div",135),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u064A\u0632\u0627\u0646\u064A\u0627\u062A... "),a())}function DY(n,t){if(n&1){let e=he();s(0,"div",143),b(1,"i",196),s(2,"h4"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u064A\u0632\u0627\u0646\u064A\u0627\u062A"),a(),s(4,"p"),u(5,"\u0642\u0645 \u0628\u0625\u0646\u0634\u0627\u0621 \u0645\u064A\u0632\u0627\u0646\u064A\u0629 \u062C\u062F\u064A\u062F\u0629"),a(),s(6,"button",4),I("click",function(){F(e);let r=E(2);return R(r.openBudgetModal())}),b(7,"i",5),u(8," \u0625\u0646\u0634\u0627\u0621 \u0645\u064A\u0632\u0627\u0646\u064A\u0629 "),a()()}}function PY(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td"),u(6),a(),s(7,"td"),u(8),a(),s(9,"td"),u(10),a(),s(11,"td",149),u(12),a(),s(13,"td")(14,"div",188),b(15,"div",197),a(),u(16),a(),s(17,"td")(18,"span",148),u(19),a()(),s(20,"td")(21,"button",171),b(22,"i",172),a(),s(23,"button",198),b(24,"i",199),a()()()),n&2){let e=t.$implicit,i=E(3);d(2),B(e.title),d(2),B(i.formatCurrency(e.amount)),d(2),B(i.getCategoryText(e.category)),d(2),Gn(" ",i.formatDate(e.startDate)," - ",i.formatDate(e.endDate)," "),d(2),B(i.formatCurrency(e.actualSpending||0)),d(),w("ngClass",i.isOverBudget(e)?"text-danger":"text-success"),d(),H(" ",i.formatCurrency(e.remainingBudget||e.amount)," "),d(3),fr("width",i.getBudgetUtilization(e),"%"),w("ngClass","bg-"+i.getPercentageColor(i.getBudgetUtilization(e))),d(),H(" ",i.formatPercentage(i.getBudgetUtilization(e))," "),d(2),w("ngClass","badge-"+i.getStatusBadge(e.status)),d(),H(" ",i.getStatusText(e.status)," ")}}function IY(n,t){if(n&1&&(s(0,"table",146)(1,"thead")(2,"tr")(3,"th"),u(4,"\u0627\u0644\u0639\u0646\u0648\u0627\u0646"),a(),s(5,"th"),u(6,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(7,"th"),u(8,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641"),a(),s(9,"th"),u(10,"\u0627\u0644\u0641\u062A\u0631\u0629"),a(),s(11,"th"),u(12,"\u0627\u0644\u0635\u0631\u0641 \u0627\u0644\u0641\u0639\u0644\u064A"),a(),s(13,"th"),u(14,"\u0627\u0644\u0645\u062A\u0628\u0642\u064A"),a(),s(15,"th"),u(16,"\u0646\u0633\u0628\u0629 \u0627\u0644\u0627\u0633\u062A\u062E\u062F\u0627\u0645"),a(),s(17,"th"),u(18,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(19,"th"),u(20,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(21,"tbody"),j(22,PY,25,14,"tr",147),a()()),n&2){let e=E(2);d(22),w("ngForOf",e.budgets)}}function OY(n,t){if(n&1){let e=he();s(0,"div",195)(1,"div",112)(2,"div",106)(3,"h3"),b(4,"i",19),u(5," \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0645\u064A\u0632\u0627\u0646\u064A\u0627\u062A"),a(),s(6,"div",151)(7,"button",4),I("click",function(){F(e);let r=E();return R(r.openBudgetModal())}),b(8,"i",5),u(9," \u0625\u0646\u0634\u0627\u0621 \u0645\u064A\u0632\u0627\u0646\u064A\u0629 "),a()()(),s(10,"div",109)(11,"div",145),j(12,TY,3,0,"div",110)(13,DY,9,0,"div",133)(14,IY,23,1,"table",167),a()()()()}if(n&2){let e=E();d(12),w("ngIf",e.loading.transactions),d(),w("ngIf",!e.loading.transactions&&e.budgets.length===0),d(),w("ngIf",!e.loading.transactions&&e.budgets.length>0)}}function FY(n,t){n&1&&(s(0,"div",135),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644... "),a())}function RY(n,t){if(n&1){let e=he();s(0,"div",143),b(1,"i",201),s(2,"h4"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0631\u0633\u0648\u0645 \u062A\u0633\u062C\u064A\u0644"),a(),s(4,"button",4),I("click",function(){F(e);let r=E(2);return R(r.openSchoolFeeModal())}),b(5,"i",5),u(6," \u062A\u0633\u062C\u064A\u0644 \u0631\u0633\u0648\u0645 \u062C\u062F\u064A\u062F\u0629 "),a()()}}function kY(n,t){if(n&1){let e=he();s(0,"button",203),I("click",function(){F(e);let r=E().$implicit,o=E(3);return R(o.paySchoolFee(r))}),b(1,"i",17),a()}}function NY(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td"),u(6),a(),s(7,"td"),u(8),a(),s(9,"td")(10,"span",148),u(11),a()(),s(12,"td"),u(13),a(),s(14,"td"),j(15,kY,2,0,"button",202),s(16,"button",171),b(17,"i",172),a()()()),n&2){let e=t.$implicit,i=E(3);d(2),B((e.student==null?null:e.student.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"),d(2),B(i.formatCurrency(e.amount)),d(2),B(i.formatDate(e.paymentDate)),d(2),B(i.getPaymentMethodText(e.paymentMethod)),d(2),w("ngClass","badge-"+i.getStatusBadge(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(2),B(e.invoiceNumber||"\u063A\u064A\u0631 \u0645\u062A\u0648\u0641\u0631"),d(2),w("ngIf",e.status==="pending")}}function UY(n,t){if(n&1&&(s(0,"table",146)(1,"thead")(2,"tr")(3,"th"),u(4,"\u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(5,"th"),u(6,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(7,"th"),u(8,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639"),a(),s(9,"th"),u(10,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(11,"th"),u(12,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(13,"th"),u(14,"\u0631\u0642\u0645 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629"),a(),s(15,"th"),u(16,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(17,"tbody"),j(18,NY,18,8,"tr",147),a()()),n&2){let e=E(2);d(18),w("ngForOf",e.schoolFees)}}function LY(n,t){if(n&1){let e=he();s(0,"div",200)(1,"div",112)(2,"div",106)(3,"h3"),b(4,"i",20),u(5," \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644"),a(),s(6,"div",151)(7,"button",4),I("click",function(){F(e);let r=E();return R(r.openSchoolFeeModal())}),b(8,"i",5),u(9," \u062A\u0633\u062C\u064A\u0644 \u0631\u0633\u0648\u0645 "),a()()(),s(10,"div",109)(11,"div",145),j(12,FY,3,0,"div",110)(13,RY,7,0,"div",133)(14,UY,19,1,"table",167),a()()()()}if(n&2){let e=E();d(12),w("ngIf",e.loading.transactions),d(),w("ngIf",!e.loading.transactions&&e.schoolFees.length===0),d(),w("ngIf",!e.loading.transactions&&e.schoolFees.length>0)}}function BY(n,t){n&1&&(s(0,"div",135),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0639\u0645\u0648\u0644\u0627\u062A... "),a())}function VY(n,t){n&1&&(s(0,"div",143),b(1,"i",205),s(2,"h4"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0639\u0645\u0648\u0644\u0627\u062A"),a(),s(4,"p"),u(5,"\u0633\u064A\u062A\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0639\u0645\u0648\u0644\u0627\u062A \u062A\u0644\u0642\u0627\u0626\u064A\u0627\u064B \u0639\u0646\u062F \u062F\u0641\u0639 \u0631\u0633\u0648\u0645 \u0627\u0644\u062D\u0635\u0635"),a()())}function HY(n,t){if(n&1){let e=he();s(0,"button",203),I("click",function(){F(e);let r=E().$implicit,o=E(3);return R(o.payTeacherCommission(r))}),b(1,"i",17),a()}}function zY(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td"),u(6),a(),s(7,"td"),u(8),a(),s(9,"td"),u(10),a(),s(11,"td"),u(12),a(),s(13,"td"),u(14),a(),s(15,"td")(16,"span",148),u(17),a()(),s(18,"td"),j(19,HY,2,0,"button",202),s(20,"button",171),b(21,"i",172),a()()()),n&2){let e=t.$implicit,i=E(3);d(2),B((e.teacher==null?null:e.teacher.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"),d(2),B((e.student==null?null:e.student.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"),d(2),B((e.class==null?null:e.class.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"),d(2),B(e.month),d(2),B(i.formatCurrency(e.amount)),d(2),H("",e.percentage,"%"),d(2),B(i.formatDate(e.paymentDate)),d(2),w("ngClass","badge-"+i.getStatusBadge(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(2),w("ngIf",e.status==="pending")}}function jY(n,t){if(n&1&&(s(0,"table",146)(1,"thead")(2,"tr")(3,"th"),u(4,"\u0627\u0644\u0623\u0633\u062A\u0627\u0630"),a(),s(5,"th"),u(6,"\u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(7,"th"),u(8,"\u0627\u0644\u062D\u0635\u0629"),a(),s(9,"th"),u(10,"\u0627\u0644\u0634\u0647\u0631"),a(),s(11,"th"),u(12,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(13,"th"),u(14,"\u0627\u0644\u0646\u0633\u0628\u0629"),a(),s(15,"th"),u(16,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639"),a(),s(17,"th"),u(18,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(19,"th"),u(20,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(21,"tbody"),j(22,zY,22,10,"tr",147),a()()),n&2){let e=E(2);d(22),w("ngForOf",e.teacherCommissions)}}function WY(n,t){if(n&1&&(s(0,"div",204)(1,"div",112)(2,"div",106)(3,"h3"),b(4,"i",21),u(5," \u0639\u0645\u0648\u0644\u0627\u062A \u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629"),a()(),s(6,"div",109)(7,"div",145),j(8,BY,3,0,"div",110)(9,VY,6,0,"div",133)(10,jY,23,1,"table",167),a()()()()),n&2){let e=E();d(8),w("ngIf",e.loading.transactions),d(),w("ngIf",!e.loading.transactions&&e.teacherCommissions.length===0),d(),w("ngIf",!e.loading.transactions&&e.teacherCommissions.length>0)}}function GY(n,t){if(n&1&&(s(0,"option",213),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),H(" ",e.name," ")}}function $Y(n,t){if(n&1&&(s(0,"option",213),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Qi(" ",e.name," - ",e.subject," (",(e.teacher==null?null:e.teacher.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641",") ")}}function YY(n,t){n&1&&(s(0,"div",214),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u062D\u0633\u0627\u0628 \u0627\u0644\u0639\u0645\u0648\u0644\u0629... "),a())}function qY(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td"),u(6),a(),s(7,"td"),u(8),a(),s(9,"td")(10,"span",148),u(11),a()(),s(12,"td"),u(13),a(),s(14,"td",222),u(15),a()()),n&2){let e=t.$implicit,i=E(3);d(2),B(e.student.name),d(2),B(e.student.studentId),d(2),B(e.attendancesCount),d(2),B(e.scheduledSessions),d(2),w("ngClass",e.attendancePercentage>=70?"badge-success":"badge-warning"),d(),H(" ",e.attendancePercentage,"% "),d(2),B(i.formatCurrency(e.monthlyFee)),d(2),B(i.formatCurrency(e.teacherShare))}}function XY(n,t){if(n&1){let e=he();s(0,"div",215)(1,"div",216)(2,"h4"),u(3,"\u0646\u062A\u0627\u0626\u062C \u062D\u0633\u0627\u0628 \u0627\u0644\u0639\u0645\u0648\u0644\u0629"),a(),s(4,"button",217),I("click",function(){F(e);let r=E(2);return R(r.payClassCommission())}),b(5,"i",17),u(6," \u062F\u0641\u0639 \u0627\u0644\u0639\u0645\u0648\u0644\u0629 "),a()(),s(7,"div",218)(8,"div",194)(9,"h4"),u(10),a(),s(11,"p"),u(12,"\u0625\u062C\u0645\u0627\u0644\u064A \u0625\u064A\u0631\u0627\u062F\u0627\u062A \u0627\u0644\u062D\u0635\u0629"),a()(),s(13,"div",219)(14,"h4"),u(15),a(),s(16,"p"),u(17,"\u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 (70%)"),a()(),s(18,"div",220)(19,"h4"),u(20),a(),s(21,"p"),u(22,"\u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628"),a()()(),s(23,"div",186)(24,"div",106)(25,"h5"),u(26,"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0637\u0644\u0627\u0628"),a()(),s(27,"div",109)(28,"div",145)(29,"table",221)(30,"thead")(31,"tr")(32,"th"),u(33,"\u0627\u0633\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(34,"th"),u(35,"\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(36,"th"),u(37,"\u0639\u062F\u062F \u0627\u0644\u062D\u0636\u0648\u0631"),a(),s(38,"th"),u(39,"\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u062C\u062F\u0648\u0644\u0629"),a(),s(40,"th"),u(41,"\u0646\u0633\u0628\u0629 \u0627\u0644\u062D\u0636\u0648\u0631"),a(),s(42,"th"),u(43,"\u0627\u0644\u0631\u0633\u0648\u0645 \u0627\u0644\u0634\u0647\u0631\u064A\u0629"),a(),s(44,"th"),u(45,"\u062D\u0635\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630"),a()()(),s(46,"tbody"),j(47,qY,16,8,"tr",147),a()()()()()()}if(n&2){let e=E(2);d(4),w("disabled",e.classCommissionData.summary.commissionStatus==="paid"),d(6),B(e.formatCurrency(e.classCommissionData.summary.totalClassRevenue)),d(5),B(e.formatCurrency(e.classCommissionData.summary.totalTeacherCommission)),d(5),B(e.classCommissionData.summary.totalStudents),d(27),w("ngForOf",e.classCommissionData.students)}}function ZY(n,t){if(n&1){let e=he();s(0,"div",206)(1,"div",112)(2,"div",106)(3,"h3"),b(4,"i",2),u(5," \u062D\u0633\u0627\u0628 \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u062D\u0635\u0629"),a(),s(6,"div",151)(7,"button",4),I("click",function(){F(e);let r=E();return R(r.openClassCommissionModal())}),b(8,"i",2),u(9," \u062D\u0633\u0627\u0628 \u0639\u0645\u0648\u0644\u0629 \u062C\u062F\u064A\u062F\u0629 "),a()()(),s(10,"div",109)(11,"div",207)(12,"form",46),I("ngSubmit",function(){F(e);let r=E();return R(r.calculateClassCommission())}),s(13,"div",82)(14,"div",155)(15,"div",47)(16,"label"),u(17,"\u0627\u0644\u0623\u0633\u062A\u0627\u0630 *"),a(),s(18,"select",90)(19,"option",91),u(20,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0623\u0633\u062A\u0627\u0630"),a(),j(21,GY,2,2,"option",92),a()()(),s(22,"div",155)(23,"div",47)(24,"label"),u(25,"\u0627\u0644\u062D\u0635\u0629 *"),a(),s(26,"select",93)(27,"option",91),u(28,"\u0627\u062E\u062A\u0631 \u0627\u0644\u062D\u0635\u0629"),a(),j(29,$Y,2,4,"option",92),a()()(),s(30,"div",155)(31,"div",47)(32,"label"),u(33,"\u0627\u0644\u0634\u0647\u0631 *"),a(),b(34,"input",94),a()()(),s(35,"div",82)(36,"div",83)(37,"div",47)(38,"label"),u(39,"\u0627\u0644\u062C\u0648\u0644\u0629 (\u0627\u062E\u062A\u064A\u0627\u0631\u064A)"),a(),b(40,"input",208),a()(),s(41,"div",83)(42,"div",47)(43,"label"),u(44,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(45,"select",95)(46,"option",72),u(47,"\u0646\u0642\u062F\u0627\u064B"),a(),s(48,"option",73),u(49,"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A"),a(),s(50,"option",74),u(51,"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"),a()()()()(),s(52,"div",47)(53,"label"),u(54,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"),a(),b(55,"textarea",209),a(),s(56,"div",210)(57,"button",63),b(58,"i",2),u(59," \u062D\u0633\u0627\u0628 \u0627\u0644\u0639\u0645\u0648\u0644\u0629 "),a(),s(60,"button",65),I("click",function(){F(e);let r=E();return R(r.classCommissionForm.reset())}),b(61,"i",66),u(62," \u0625\u0644\u063A\u0627\u0621 "),a()()()(),j(63,YY,3,0,"div",211)(64,XY,48,5,"div",212),a()()()}if(n&2){let e=E();d(12),w("formGroup",e.classCommissionForm),d(9),w("ngForOf",e.teachersList),d(8),w("ngForOf",e.lessonsList),d(28),w("disabled",e.loading.classCommission),d(6),w("ngIf",e.loading.classCommission),d(),w("ngIf",e.classCommissionData&&!e.loading.classCommission)}}function JY(n,t){n&1&&(s(0,"div",230),b(1,"i",231),s(2,"p",232),u(3,"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u062D\u0635\u0635..."),a()())}function KY(n,t){n&1&&(s(0,"div",234),b(1,"i",235),s(2,"h4",232),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u062D\u0635\u0635 \u0644\u0644\u0634\u0647\u0631 \u0627\u0644\u0645\u062D\u062F\u062F"),a(),s(4,"p"),u(5,"\u0642\u0645 \u0628\u062A\u063A\u064A\u064A\u0631 \u0627\u0644\u0634\u0647\u0631 \u0623\u0648 \u062A\u0623\u0643\u062F \u0645\u0646 \u0648\u062C\u0648\u062F \u062D\u0635\u0635 \u0645\u0633\u062C\u0644\u0629"),a()())}function QY(n,t){if(n&1&&(s(0,"small",243),u(1),a()),n&2){let e=E().$implicit,i=E(4);d(),H(" ",i.formatDate(e.paymentDate)," ")}}function eq(n,t){if(n&1){let e=he();s(0,"button",244),I("click",function(){F(e);let r=E().$implicit,o=E(4);return R(o.payClassPayment(r))}),b(1,"i",17),u(2," \u062F\u0641\u0639 "),a()}}function tq(n,t){n&1&&(s(0,"button",245),b(1,"i",18),a())}function nq(n,t){if(n&1){let e=he();s(0,"tr")(1,"td")(2,"strong"),u(3),a(),b(4,"br"),s(5,"small",236),u(6),a()(),s(7,"td"),u(8),a(),s(9,"td"),u(10),b(11,"br"),s(12,"small",236),u(13),a()(),s(14,"td"),u(15),a(),s(16,"td")(17,"span",237),u(18),a()(),s(19,"td")(20,"span",148),u(21),a()(),s(22,"td",222)(23,"strong"),u(24),a()(),s(25,"td",238)(26,"strong"),u(27),a()(),s(28,"td")(29,"span",148),u(30),a(),j(31,QY,2,1,"small",239),a(),s(32,"td")(33,"button",240),I("click",function(){let r=F(e).$implicit,o=E(4);return R(o.viewClassPaymentDetails(r))}),b(34,"i",172),a(),j(35,eq,3,0,"button",241)(36,tq,2,0,"button",242),a()()}if(n&2){let e=t.$implicit,i=E(4);d(3),B(e.class==null?null:e.class.name),d(3),H("",(e.class==null||e.class.schedule==null?null:e.class.schedule.length)||0," \u062C\u0644\u0633\u0629 \u0623\u0633\u0628\u0648\u0639\u064A\u0627\u064B"),d(2),B(e.class==null?null:e.class.subject),d(2),H(" ",e.teacher==null?null:e.teacher.name,""),d(3),B(e.teacher==null?null:e.teacher.phone),d(2),B(e.month),d(3),B((e.students==null?null:e.students.total)||0),d(2),w("ngClass",(e.students==null?null:e.students.paid)>0?"badge-success":"badge-warning"),d(),H(" ",(e.students==null?null:e.students.paid)||0," "),d(3),B(i.formatCurrency(e.class==null?null:e.class.price)),d(3),B(i.formatCurrency(e.commissionAmount)),d(2),w("ngClass",x0(16,iY,e.status==="paid",e.status==="pending",e.status==="late")),d(),H(" ",i.getStatusText(e.status)," "),d(),w("ngIf",e.paymentDate),d(4),w("ngIf",e.canPay&&(e.students==null?null:e.students.paid)>0),d(),w("ngIf",e.status==="paid")}}function iq(n,t){if(n&1&&(s(0,"table",146)(1,"thead")(2,"tr")(3,"th"),u(4,"\u0627\u0633\u0645 \u0627\u0644\u062D\u0635\u0629"),a(),s(5,"th"),u(6,"\u0627\u0644\u0645\u0627\u062F\u0629"),a(),s(7,"th"),u(8,"\u0627\u0644\u0623\u0633\u062A\u0627\u0630"),a(),s(9,"th"),u(10,"\u0627\u0644\u0634\u0647\u0631"),a(),s(11,"th"),u(12,"\u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628"),a(),s(13,"th"),u(14,"\u0637\u0644\u0627\u0628 \u0645\u062F\u0641\u0648\u0639\u064A\u0646"),a(),s(15,"th"),u(16,"\u0633\u0639\u0631 \u0627\u0644\u062D\u0635\u0629"),a(),s(17,"th"),u(18,"\u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 (70%)"),a(),s(19,"th"),u(20,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(21,"th"),u(22,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(23,"tbody"),j(24,nq,37,20,"tr",147),a()()),n&2){let e=E(3);d(24),w("ngForOf",e.filteredClassPayments)}}function rq(n,t){if(n&1&&(s(0,"div",145),j(1,KY,6,0,"div",233)(2,iq,25,1,"table",167),a()),n&2){let e=E(2);d(),w("ngIf",e.filteredClassPayments.length===0),d(),w("ngIf",e.filteredClassPayments.length>0)}}function oq(n,t){if(n&1&&(s(0,"div",173)(1,"div",82)(2,"div",153)(3,"div",194)(4,"h4"),u(5),a(),s(6,"p"),u(7,"\u0639\u062F\u062F \u0627\u0644\u062D\u0635\u0635"),a()()(),s(8,"div",153)(9,"div",174)(10,"h4"),u(11),a(),s(12,"p"),u(13,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0637\u0644\u0627\u0628"),a()()(),s(14,"div",153)(15,"div",219)(16,"h4"),u(17),a(),s(18,"p"),u(19,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0639\u0645\u0648\u0644\u0627\u062A"),a()()(),s(20,"div",153)(21,"div",176)(22,"h4"),u(23),a(),s(24,"p"),u(25,"\u062D\u0635\u0635 \u062A\u062D\u062A\u0627\u062C \u062F\u0641\u0639"),a()()()()()),n&2){let e=E(2);d(5),B(e.filteredClassPayments.length),d(6),B(e.getTotalStudents()),d(6),B(e.formatCurrency(e.getTotalCommission())),d(4),w("ngClass",e.getPendingPaymentsCount()>0?"bg-danger":"bg-secondary"),d(2),B(e.getPendingPaymentsCount())}}function sq(n,t){if(n&1){let e=he();s(0,"div",223)(1,"div",112)(2,"div",106)(3,"h3"),b(4,"i",22),u(5," \u0625\u062F\u0627\u0631\u0629 \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u062D\u0635\u0635"),a(),s(6,"div",3)(7,"button",224),I("click",function(){F(e);let r=E();return R(r.loadClassPayments())}),b(8,"i",9),a()()(),s(9,"div",109)(10,"div",225)(11,"div",155)(12,"div",47)(13,"label"),u(14,"\u0641\u0644\u062A\u0631\u0629 \u062D\u0633\u0628 \u0627\u0644\u0634\u0647\u0631"),a(),s(15,"input",226),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.selectedPaymentMonth,r)||(o.selectedPaymentMonth=r),R(r)}),I("change",function(){F(e);let r=E();return R(r.onMonthChange())}),a()()(),s(16,"div",227)(17,"div",47)(18,"label"),u(19,"\u0628\u062D\u062B (\u0627\u0633\u0645 \u0627\u0644\u062D\u0635\u0629 \u0623\u0648 \u0627\u0644\u0623\u0633\u062A\u0627\u0630)"),a(),s(20,"div",156)(21,"input",228),ye("ngModelChange",function(r){F(e);let o=E();return Ce(o.searchTerm,r)||(o.searchTerm=r),R(r)}),I("keyup",function(){F(e);let r=E();return R(r.filterClassPayments())}),a(),s(22,"div",158)(23,"button",159),I("click",function(){F(e);let r=E();return R(r.filterClassPayments())}),b(24,"i",160),a(),s(25,"button",161),I("click",function(){F(e);let r=E();return r.searchTerm="",R(r.filterClassPayments())}),b(26,"i",66),a()()()()()(),j(27,JY,4,0,"div",229)(28,rq,3,2,"div",134)(29,oq,26,5,"div",168),a()()()}if(n&2){let e=E();d(15),ve("ngModel",e.selectedPaymentMonth),d(6),ve("ngModel",e.searchTerm),d(6),w("ngIf",e.loading.classPayments),d(),w("ngIf",!e.loading.classPayments),d(),w("ngIf",!e.loading.classPayments&&e.filteredClassPayments.length>0)}}function aq(n,t){n&1&&(s(0,"div",153)(1,"div",47)(2,"label"),u(3,"\u0627\u0644\u0634\u0647\u0631 *"),a(),b(4,"input",94),a()())}function lq(n,t){n&1&&(s(0,"div",153)(1,"div",47)(2,"label"),u(3,"\u0627\u0644\u0633\u0646\u0629 *"),a(),b(4,"input",259),a()())}function uq(n,t){n&1&&(s(0,"div",153)(1,"div",47)(2,"label"),u(3,"\u0645\u0646 \u062A\u0627\u0631\u064A\u062E *"),a(),b(4,"input",84),a()())}function cq(n,t){n&1&&(s(0,"div",153)(1,"div",47)(2,"label"),u(3,"\u0625\u0644\u0649 \u062A\u0627\u0631\u064A\u062E *"),a(),b(4,"input",85),a()())}function dq(n,t){n&1&&(s(0,"div",214),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u062A\u0648\u0644\u064A\u062F \u0627\u0644\u062A\u0642\u0631\u064A\u0631... "),a())}function fq(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td",222),u(6),a(),s(7,"td"),u(8),a(),s(9,"td"),u(10),a()()),n&2){let e=t.$implicit,i=E(3);d(2),B(i.formatDate(e.date)),d(2),B(e.description),d(2),B(i.formatCurrency(e.amount)),d(2),B(i.getCategoryText(e.category)),d(2),B((e.recordedBy==null?null:e.recordedBy.username)||"\u0646\u0638\u0627\u0645")}}function hq(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td",192),u(6),a(),s(7,"td"),u(8),a(),s(9,"td"),u(10),a()()),n&2){let e=t.$implicit,i=E(3);d(2),B(i.formatDate(e.date)),d(2),B(e.description),d(2),B(i.formatCurrency(e.amount)),d(2),B(i.getCategoryText(e.category)),d(2),B((e.recordedBy==null?null:e.recordedBy.username)||"\u0646\u0638\u0627\u0645")}}function pq(n,t){if(n&1&&(s(0,"div",260)(1,"div",261)(2,"div",174)(3,"h4"),u(4),a(),s(5,"p"),u(6,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0625\u064A\u0631\u0627\u062F\u0627\u062A"),a(),s(7,"small"),u(8),a()(),s(9,"div",175)(10,"h4"),u(11),a(),s(12,"p"),u(13,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u0627\u062A"),a(),s(14,"small"),u(15),a()(),s(16,"div",176)(17,"h4"),u(18),a(),s(19,"p"),u(20,"\u0635\u0627\u0641\u064A \u0627\u0644\u0631\u0628\u062D"),a(),s(21,"small"),u(22),a()(),s(23,"div",220)(24,"h4"),u(25),a(),s(26,"p"),u(27,"\u0645\u062A\u0648\u0633\u0637 \u0627\u0644\u0625\u064A\u0631\u0627\u062F\u0627\u062A \u0627\u0644\u064A\u0648\u0645\u064A\u0629"),a(),s(28,"small"),u(29),a()()(),s(30,"div",186)(31,"div",106)(32,"h5"),u(33,"\u062A\u0641\u0635\u064A\u0644 \u0627\u0644\u0625\u064A\u0631\u0627\u062F\u0627\u062A"),a()(),s(34,"div",109)(35,"div",145)(36,"table",221)(37,"thead")(38,"tr")(39,"th"),u(40,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E"),a(),s(41,"th"),u(42,"\u0627\u0644\u0648\u0635\u0641"),a(),s(43,"th"),u(44,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(45,"th"),u(46,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641"),a(),s(47,"th"),u(48,"\u0627\u0644\u0645\u0633\u062C\u0644"),a()()(),s(49,"tbody"),j(50,fq,11,5,"tr",147),a()()()()(),s(51,"div",186)(52,"div",106)(53,"h5"),u(54,"\u062A\u0641\u0635\u064A\u0644 \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u0627\u062A"),a()(),s(55,"div",109)(56,"div",145)(57,"table",221)(58,"thead")(59,"tr")(60,"th"),u(61,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E"),a(),s(62,"th"),u(63,"\u0627\u0644\u0648\u0635\u0641"),a(),s(64,"th"),u(65,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(66,"th"),u(67,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641"),a(),s(68,"th"),u(69,"\u0627\u0644\u0645\u0633\u062C\u0644"),a()()(),s(70,"tbody"),j(71,hq,11,5,"tr",147),a()()()()()()),n&2){let e=E(2);d(4),B(e.formatCurrency(e.monthlyFinancialReport.income.total)),d(4),H("",e.monthlyFinancialReport.summary.incomeTransactions," \u0645\u0639\u0627\u0645\u0644\u0629"),d(3),B(e.formatCurrency(e.monthlyFinancialReport.expenses.total)),d(4),H("",e.monthlyFinancialReport.summary.expenseTransactions," \u0645\u0639\u0627\u0645\u0644\u0629"),d(),w("ngClass",e.monthlyFinancialReport.profit.netProfit>=0?"bg-info":"bg-warning"),d(2),B(e.formatCurrency(e.monthlyFinancialReport.profit.netProfit)),d(4),H("\u0647\u0627\u0645\u0634 \u0627\u0644\u0631\u0628\u062D: ",e.monthlyFinancialReport.profit.profitMargin,"%"),d(3),B(e.formatCurrency(e.monthlyFinancialReport.summary.averageDailyIncome)),d(4),H("\u0645\u062A\u0648\u0633\u0637 \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u0627\u062A: ",e.formatCurrency(e.monthlyFinancialReport.summary.averageDailyExpense),""),d(21),w("ngForOf",e.monthlyFinancialReport.income.details),d(21),w("ngForOf",e.monthlyFinancialReport.expenses.details)}}function mq(n,t){if(n&1){let e=he();s(0,"div",246)(1,"div",112)(2,"div",106)(3,"h3"),b(4,"i",23),u(5," \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u0645\u0627\u0644\u064A \u0627\u0644\u0634\u0647\u0631\u064A"),a(),s(6,"div",151)(7,"button",217),I("click",function(){F(e);let r=E();return R(r.exportFinancialReport("excel"))}),b(8,"i",247),u(9," \u062A\u0635\u062F\u064A\u0631 Excel "),a(),s(10,"button",248),I("click",function(){F(e);let r=E();return R(r.exportFinancialReport("pdf"))}),b(11,"i",249),u(12," \u062A\u0635\u062F\u064A\u0631 PDF "),a()()(),s(13,"div",109)(14,"div",250)(15,"form",46),I("ngSubmit",function(){F(e);let r=E();return R(r.loadFinancialReportData())}),s(16,"div",82)(17,"div",153)(18,"div",47)(19,"label"),u(20,"\u0646\u0648\u0639 \u0627\u0644\u0641\u062A\u0631\u0629 *"),a(),s(21,"select",251),I("change",function(){F(e);let r=E();return R(r.onPeriodTypeChange())}),s(22,"option",252),u(23,"\u0634\u0647\u0631\u064A"),a(),s(24,"option",253),u(25,"\u0645\u062E\u0635\u0635"),a(),s(26,"option",254),u(27,"\u0633\u0646\u0648\u064A"),a()()()(),j(28,aq,5,0,"div",255)(29,lq,5,0,"div",255)(30,uq,5,0,"div",255)(31,cq,5,0,"div",255),s(32,"div",153)(33,"label"),u(34,"\xA0"),a(),s(35,"button",256),b(36,"i",257),u(37," \u062A\u0648\u0644\u064A\u062F \u0627\u0644\u062A\u0642\u0631\u064A\u0631 "),a()()()()(),j(38,dq,3,0,"div",211)(39,pq,72,11,"div",258),a()()()}if(n&2){let e,i,r,o,l=E();d(7),w("disabled",l.loading.export),d(3),w("disabled",l.loading.export),d(5),w("formGroup",l.financialReportForm),d(13),w("ngIf",((e=l.financialReportForm.get("periodType"))==null?null:e.value)==="monthly"),d(),w("ngIf",((i=l.financialReportForm.get("periodType"))==null?null:i.value)==="yearly"),d(),w("ngIf",((r=l.financialReportForm.get("periodType"))==null?null:r.value)==="custom"),d(),w("ngIf",((o=l.financialReportForm.get("periodType"))==null?null:o.value)==="custom"),d(4),w("disabled",l.loading.financialReport),d(3),w("ngIf",l.loading.financialReport),d(),w("ngIf",l.monthlyFinancialReport&&!l.loading.financialReport)}}function gq(n,t){n&1&&(s(0,"div",135),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A... "),a())}function _q(n,t){n&1&&(s(0,"div",143),b(1,"i",263),s(2,"h4"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0631\u0633\u0648\u0645 \u062A\u0633\u062C\u064A\u0644"),a(),s(4,"p"),u(5,"\u0633\u064A\u062A\u0645 \u0639\u0631\u0636 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644 \u0647\u0646\u0627 \u0639\u0646\u062F \u062A\u0633\u062C\u064A\u0644\u0647\u0627"),a()())}function vq(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td"),u(4),a(),s(5,"td"),u(6),a(),s(7,"td"),u(8),a(),s(9,"td")(10,"span",148),u(11),a()(),s(12,"td"),u(13),a(),s(14,"td")(15,"button",264),b(16,"i",25),a()()()),n&2){let e=t.$implicit,i=E(3);d(2),B(i.formatDate(e.paymentDate)),d(2),B((e.student==null?null:e.student.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"),d(2),B(i.formatCurrency(e.amount)),d(2),B(i.getPaymentMethodText(e.paymentMethod)),d(2),w("ngClass","badge-"+i.getStatusBadge(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(2),B(e.invoiceNumber||"\u063A\u064A\u0631 \u0645\u062A\u0648\u0641\u0631")}}function yq(n,t){if(n&1&&(s(0,"table",146)(1,"thead")(2,"tr")(3,"th"),u(4,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639"),a(),s(5,"th"),u(6,"\u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(7,"th"),u(8,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(9,"th"),u(10,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(11,"th"),u(12,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(13,"th"),u(14,"\u0631\u0642\u0645 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629"),a(),s(15,"th"),u(16,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(17,"tbody"),j(18,vq,17,7,"tr",147),a()()),n&2){let e=E(2);d(18),w("ngForOf",e.registrationFeeDetails)}}function xq(n,t){if(n&1&&(s(0,"div",262)(1,"div",112)(2,"div",106)(3,"h3"),b(4,"i",24),u(5," \u062A\u0641\u0627\u0635\u064A\u0644 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644"),a()(),s(6,"div",109)(7,"div",145),j(8,gq,3,0,"div",110)(9,_q,6,0,"div",133)(10,yq,19,1,"table",167),a()()()()),n&2){let e=E();d(8),w("ngIf",e.loading.registrationFees),d(),w("ngIf",!e.loading.registrationFees&&e.registrationFeeDetails.length===0),d(),w("ngIf",!e.loading.registrationFees&&e.registrationFeeDetails.length>0)}}function bq(n,t){n&1&&(s(0,"div",135),b(1,"i",136),u(2," \u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0641\u0648\u0627\u062A\u064A\u0631... "),a())}function Cq(n,t){n&1&&(s(0,"div",143),b(1,"i",266),s(2,"h4"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0641\u0648\u0627\u062A\u064A\u0631"),a(),s(4,"p"),u(5,"\u0633\u064A\u062A\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0641\u0648\u0627\u062A\u064A\u0631 \u062A\u0644\u0642\u0627\u0626\u064A\u0627\u064B \u0639\u0646\u062F \u0625\u062A\u0645\u0627\u0645 \u0627\u0644\u062F\u0641\u0639\u0627\u062A"),a()())}function Eq(n,t){if(n&1&&(s(0,"tr")(1,"td"),u(2),a(),s(3,"td")(4,"span",148),u(5),a()(),s(6,"td"),u(7),a(),s(8,"td"),u(9),a(),s(10,"td"),u(11),a(),s(12,"td")(13,"span",148),u(14),a()(),s(15,"td"),u(16),a(),s(17,"td")(18,"button",264),b(19,"i",172),a(),s(20,"button",267),b(21,"i",11),a()()()),n&2){let e=t.$implicit,i=E(3);d(2),B(e.invoiceNumber),d(2),w("ngClass",DS(9,rY,e.type==="school-fee",e.type==="teacher",e.type==="staff",e.type==="other")),d(),H(" ",e.type==="school-fee"?"\u0631\u0633\u0648\u0645 \u062A\u0633\u062C\u064A\u0644":e.type==="teacher"?"\u0645\u0639\u0644\u0645":e.type==="staff"?"\u0645\u0648\u0638\u0641":"\u0623\u062E\u0631\u0649"," "),d(2),B((e.recipient==null?null:e.recipient.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"),d(2),B(i.formatCurrency(e.totalAmount)),d(2),B(i.formatDate(e.date)),d(2),w("ngClass","badge-"+i.getStatusBadge(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(2),B(i.getPaymentMethodText(e.paymentMethod))}}function wq(n,t){if(n&1&&(s(0,"table",146)(1,"thead")(2,"tr")(3,"th"),u(4,"\u0631\u0642\u0645 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629"),a(),s(5,"th"),u(6,"\u0627\u0644\u0646\u0648\u0639"),a(),s(7,"th"),u(8,"\u0627\u0644\u0645\u0633\u062A\u0644\u0645"),a(),s(9,"th"),u(10,"\u0627\u0644\u0645\u0628\u0644\u063A \u0627\u0644\u0625\u062C\u0645\u0627\u0644\u064A"),a(),s(11,"th"),u(12,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E"),a(),s(13,"th"),u(14,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(15,"th"),u(16,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(17,"th"),u(18,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(19,"tbody"),j(20,Eq,22,14,"tr",147),a()()),n&2){let e=E(2);d(20),w("ngForOf",e.invoices)}}function Sq(n,t){if(n&1&&(s(0,"div",265)(1,"div",112)(2,"div",106)(3,"h3"),b(4,"i",25),u(5," \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u0641\u0648\u0627\u062A\u064A\u0631"),a()(),s(6,"div",109)(7,"div",145),j(8,bq,3,0,"div",110)(9,Cq,6,0,"div",133)(10,wq,21,1,"table",167),a()()()()),n&2){let e=E();d(8),w("ngIf",e.loading.transactions),d(),w("ngIf",!e.loading.transactions&&e.invoices.length===0),d(),w("ngIf",!e.loading.transactions&&e.invoices.length>0)}}function Mq(n,t){if(n&1&&(s(0,"option",213),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),H(" ",e.name," ")}}function Aq(n,t){if(n&1&&(s(0,"option",213),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Qi(" ",e.name," - ",e.subject," (",(e.teacher==null?null:e.teacher.name)||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641",") ")}}var Z1=class n{constructor(t,e,i,r,o){this.accountingService=t;this.authService=e;this.fb=i;this.teacherService=r;this.lessonsService=o;this.today=new Date().toISOString().split("T")[0],this.transactionForm=this.fb.group({type:["income",Tt.required],amount:["",[Tt.required,Tt.min(1)]],description:["",Tt.required],category:["tuition",Tt.required],date:[this.today,Tt.required]}),this.budgetForm=this.fb.group({title:["",Tt.required],amount:["",[Tt.required,Tt.min(1)]],category:["operational",Tt.required],description:[""],startDate:[this.today,Tt.required],endDate:["",Tt.required]}),this.expenseForm=this.fb.group({description:["",Tt.required],amount:["",[Tt.required,Tt.min(1)]],category:["salary",Tt.required],paymentMethod:["cash",Tt.required],receiptNumber:[""]}),this.schoolFeeForm=this.fb.group({studentId:["",Tt.required],amount:[60,[Tt.required,Tt.min(1)]],paymentMethod:["cash",Tt.required]}),this.classCommissionForm=this.fb.group({teacherId:["",Tt.required],classId:["",Tt.required],month:[new Date().toISOString().slice(0,7),Tt.required],round:[""],paymentMethod:["cash",Tt.required],notes:[""]}),this.financialReportForm=this.fb.group({periodType:["monthly"],month:[new Date().toISOString().slice(0,7)],startDate:[""],endDate:[""],year:[new Date().getFullYear()]})}activeTab="dashboard";transactions=[];dailyIncome={};weeklyIncome=[];monthlyIncome={};todayStats={};currentBalance=0;schoolFees=[];teacherCommissions=[];teachersList=[];lessonsList=[];budgets=[];expenses=[];invoices=[];teacherPayments=[];staffSalaries=[];financialReport={};classCommissionData=null;monthlyFinancialReport=null;registrationFeeDetails=[];quickFinancialStats={};classPaymentsData=[];filteredClassPayments=[];selectedPaymentMonth=new Date().toISOString().slice(0,7);transactionForm;budgetForm;expenseForm;schoolFeeForm;classCommissionForm;financialReportForm;dateFilter={startDate:"",endDate:""};searchTerm="";loading={transactions:!1,income:!1,stats:!1,export:!1,classCommission:!1,financialReport:!1,registrationFees:!1,classPayments:!1};today;ngOnInit(){this.loadDashboardData(),this.setupModalListeners(),this.loadQuickFinancialStats(),this.loadTeachers(),this.loadLessons()}setupModalListeners(){setTimeout(()=>{document.addEventListener("click",t=>{document.querySelectorAll("[data-modal]").forEach(i=>{let r=i;t.target===r&&this.closeModal(r)})}),document.addEventListener("keydown",t=>{if(t.key==="Escape"){let e=document.querySelector("[data-modal].show");e&&this.closeModal(e)}})},100)}switchTab(t){this.activeTab=t,this.loadTabData(t)}loadDashboardData(){this.loadDailyIncome(),this.loadTodayStats(),this.loadCurrentBalance(),this.loadTransactions()}loadTabData(t){switch(t){case"dashboard":this.loadDashboardData();break;case"transactions":this.loadTransactions();break;case"income":this.loadDailyIncome();break;case"expenses":this.loadExpenses();break;case"budgets":this.loadBudgets();break;case"school-fees":this.loadSchoolFees();break;case"commissions":this.loadTeacherCommissions();break;case"class-commission":this.loadClassCommissionData();break;case"financial-report":this.loadFinancialReportData();break;case"registration-fees":this.loadRegistrationFeesDetails();break;case"invoices":this.loadInvoices();break;case"class-payments":this.loadClassPayments();break}}loadClassPayments(){this.loading.classPayments=!0;let t=this.selectedPaymentMonth;this.accountingService.getClassPaymentsForMonth(t).subscribe({next:e=>{this.classPaymentsData=e,this.filteredClassPayments=[...e],this.loading.classPayments=!1},error:e=>{console.error("Error loading class payments:",e),this.loading.classPayments=!1,this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u062D\u0635\u0635")}})}filterClassPayments(){let t=this.searchTerm.toLowerCase();if(!t){this.filteredClassPayments=[...this.classPaymentsData];return}this.filteredClassPayments=this.classPaymentsData.filter(e=>e.class?.name?.toLowerCase().includes(t)||e.teacher?.name?.toLowerCase().includes(t)||e.month?.includes(t))}onMonthChange(){this.loadClassPayments()}payClassPayment(t){this.showConfirmDialog("\u062F\u0641\u0639 \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u062D\u0635\u0629",`\u0647\u0644 \u062A\u0631\u064A\u062F \u062F\u0641\u0639 \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 ${t.teacher?.name} \u0644\u0644\u062D\u0635\u0629 ${t.class?.name} \u0644\u0634\u0647\u0631 ${t.month}\u061F`,"\u0646\u0639\u0645\u060C \u062F\u0641\u0639","\u0625\u0644\u063A\u0627\u0621").then(e=>{if(e.isConfirmed){this.loading.classPayments=!0;let i={teacherId:t.teacher?._id,classId:t.class?._id,month:t.month,paymentMethod:"cash"};this.accountingService.payClassCommission(i).subscribe({next:r=>{this.showSuccess("\u062A\u0645 \u062F\u0641\u0639 \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u062D\u0635\u0629 \u0628\u0646\u062C\u0627\u062D"),this.loadClassPayments(),this.loading.classPayments=!1},error:r=>{console.error("Error paying class commission:",r),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062F\u0641\u0639 \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u062D\u0635\u0629"),this.loading.classPayments=!1}})}})}loadDailyIncome(t){this.loading.income=!0,this.accountingService.getDailyIncome(t).subscribe({next:e=>{this.dailyIncome=e,this.loading.income=!1},error:e=>{console.error("Error loading daily income:",e),this.loading.income=!1,this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A \u0627\u0644\u062F\u062E\u0644 \u0627\u0644\u064A\u0648\u0645\u064A")}})}loadTodayStats(){this.loading.stats=!0,this.accountingService.getTodayStats().subscribe({next:t=>{this.todayStats=t,this.loading.stats=!1},error:t=>{console.error("Error loading today stats:",t),this.loading.stats=!1}})}loadCurrentBalance(){this.accountingService.getCurrentBalance().subscribe({next:t=>{this.currentBalance=t.balance||0},error:t=>{console.error("Error loading balance:",t)}})}loadTransactions(){this.loading.transactions=!0;let t={};this.dateFilter.startDate&&(t.startDate=this.dateFilter.startDate),this.dateFilter.endDate&&(t.endDate=this.dateFilter.endDate),this.accountingService.getTransactions(t).subscribe({next:e=>{this.transactions=e,this.loading.transactions=!1},error:e=>{console.error("Error loading transactions:",e),this.loading.transactions=!1,this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062A")}})}loadWeeklyIncome(){this.accountingService.getWeeklyIncome().subscribe({next:t=>{this.weeklyIncome=t.weeklyIncome||[]},error:t=>{console.error("Error loading weekly income:",t)}})}loadMonthlyIncome(){this.accountingService.getMonthlyIncome().subscribe({next:t=>{this.monthlyIncome=t},error:t=>{console.error("Error loading monthly income:",t)}})}loadSchoolFees(){this.accountingService.getSchoolFees().subscribe({next:t=>{this.schoolFees=t},error:t=>{console.error("Error loading school fees:",t),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644")}})}loadTeacherCommissions(){this.accountingService.getTeacherCommissions().subscribe({next:t=>{this.teacherCommissions=t},error:t=>{console.error("Error loading teacher commissions:",t),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0639\u0645\u0648\u0644\u0627\u062A \u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629")}})}loadBudgets(){this.accountingService.getBudgets().subscribe({next:t=>{this.budgets=t},error:t=>{console.error("Error loading budgets:",t),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u064A\u0632\u0627\u0646\u064A\u0627\u062A")}})}loadExpenses(){this.accountingService.getExpenses().subscribe({next:t=>{this.expenses=t},error:t=>{console.error("Error loading expenses:",t),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u0627\u062A")}})}loadInvoices(){this.accountingService.getInvoices().subscribe({next:t=>{this.invoices=t},error:t=>{console.error("Error loading invoices:",t),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u0641\u0648\u0627\u062A\u064A\u0631")}})}loadTeacherPayments(){this.accountingService.getTeacherPayments().subscribe({next:t=>{this.teacherPayments=t},error:t=>{console.error("Error loading teacher payments:",t)}})}loadStaffSalaries(){this.accountingService.getStaffSalaries().subscribe({next:t=>{this.staffSalaries=t},error:t=>{console.error("Error loading staff salaries:",t)}})}loadFinancialReport(){let t={};this.dateFilter.startDate&&(t.startDate=this.dateFilter.startDate),this.dateFilter.endDate&&(t.endDate=this.dateFilter.endDate),this.accountingService.getFinancialReport(t).subscribe({next:e=>{this.financialReport=e},error:e=>{console.error("Error loading financial report:",e),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u0645\u0627\u0644\u064A")}})}loadClassCommissionData(){this.classCommissionForm.reset({month:new Date().toISOString().slice(0,7),paymentMethod:"cash"}),this.classCommissionData=null}calculateClassCommission(){let t=this.classCommissionForm.value;if(!t.teacherId||!t.classId||!t.month){this.showWarning("\u064A\u0631\u062C\u0649 \u0627\u062E\u062A\u064A\u0627\u0631 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 \u0648\u0627\u0644\u062D\u0635\u0629 \u0648\u0627\u0644\u0634\u0647\u0631");return}this.loading.classCommission=!0;let e={teacherId:t.teacherId,classId:t.classId,month:t.month,round:t.round||void 0};this.accountingService.calculateTeacherClassCommission(e).subscribe({next:i=>{this.classCommissionData=i,this.loading.classCommission=!1},error:i=>{console.error("Error calculating commission:",i),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062D\u0633\u0627\u0628 \u0627\u0644\u0639\u0645\u0648\u0644\u0629"),this.loading.classCommission=!1}})}payClassCommission(){if(!this.classCommissionData)return;let t=this.classCommissionForm.value,e={teacherId:t.teacherId,classId:t.classId,month:t.month,round:t.round||null,paymentMethod:t.paymentMethod,notes:t.notes};this.showConfirmDialog("\u062F\u0641\u0639 \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u062D\u0635\u0629",`\u0647\u0644 \u062A\u0631\u064A\u062F \u062F\u0641\u0639 \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 ${this.classCommissionData.teacher.name} \u0644\u0644\u062D\u0635\u0629 ${this.classCommissionData.class.name}\u061F`,"\u0646\u0639\u0645\u060C \u062F\u0641\u0639","\u0625\u0644\u063A\u0627\u0621").then(i=>{i.isConfirmed&&(this.loading.classCommission=!0,this.accountingService.payClassCommission(e).subscribe({next:r=>{this.showSuccess(r.message),this.classCommissionData=null,this.classCommissionForm.reset({month:new Date().toISOString().slice(0,7),paymentMethod:"cash"}),this.loading.classCommission=!1},error:r=>{console.error("Error paying commission:",r),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062F\u0641\u0639 \u0627\u0644\u0639\u0645\u0648\u0644\u0629"),this.loading.classCommission=!1}}))})}loadFinancialReportData(){this.loading.financialReport=!0;let t=this.financialReportForm.value,e={};t.periodType==="monthly"?(e.month=t.month.split("-")[1],e.year=t.month.split("-")[0]):t.periodType==="custom"?(e.startDate=t.startDate,e.endDate=t.endDate):t.periodType==="yearly"&&(e.year=t.year),this.accountingService.getMonthlyFinancialReport(e).subscribe({next:i=>{this.monthlyFinancialReport=i,this.loading.financialReport=!1},error:i=>{console.error("Error loading financial report:",i),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u0645\u0627\u0644\u064A"),this.loading.financialReport=!1}})}loadRegistrationFeesDetails(){this.loading.registrationFees=!0,this.accountingService.getRegistrationFeeDetails().subscribe({next:t=>{this.registrationFeeDetails=t,this.loading.registrationFees=!1},error:t=>{console.error("Error loading registration fees:",t),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u0645\u064A\u0644 \u062A\u0641\u0627\u0635\u064A\u0644 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644"),this.loading.registrationFees=!1}})}loadQuickFinancialStats(){this.accountingService.getQuickFinancialStats().subscribe({next:t=>{this.quickFinancialStats=t},error:t=>{console.error("Error loading quick stats:",t)}})}loadTeachers(){this.teacherService.getTeachers().subscribe({next:t=>{this.teachersList=t},error:t=>{console.error("Error loading teachers:",t)}})}loadLessons(){this.lessonsService.getClasses().subscribe({next:t=>{this.lessonsList=t},error:t=>{console.error("Error loading lessons:",t)}})}exportFinancialReport(t){let e=this.financialReportForm.value;this.loading.export=!0,this.accountingService.exportFinancialReport(t,e).subscribe({next:i=>{let r=window.URL.createObjectURL(i),o=document.createElement("a");o.href=r,o.download=`\u0627\u0644\u062A\u0642\u0631\u064A\u0631-\u0627\u0644\u0645\u0627\u0644\u064A-${new Date().toISOString().split("T")[0]}.${t}`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(r),this.loading.export=!1,this.showSuccess("\u062A\u0645 \u062A\u0635\u062F\u064A\u0631 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0628\u0646\u062C\u0627\u062D")},error:i=>{console.error("Error exporting report:",i),this.loading.export=!1,this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u0635\u062F\u064A\u0631 \u0627\u0644\u062A\u0642\u0631\u064A\u0631")}})}addTransaction(){if(this.transactionForm.invalid){this.showWarning("\u064A\u0631\u062C\u0649 \u0645\u0644\u0621 \u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0642\u0648\u0644 \u0627\u0644\u0645\u0637\u0644\u0648\u0628\u0629");return}let t=this.transactionForm.value;this.showConfirmDialog("\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F\u061F","\u0633\u064A\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0645\u0639\u0627\u0645\u0644\u0629 \u0645\u0627\u0644\u064A\u0629 \u062C\u062F\u064A\u062F\u0629","\u0646\u0639\u0645\u060C \u0623\u0636\u0641","\u0625\u0644\u063A\u0627\u0621").then(e=>{e.isConfirmed&&this.accountingService.addTransaction(t).subscribe({next:i=>{this.showSuccess("\u062A\u0645\u062A \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0629 \u0628\u0646\u062C\u0627\u062D"),this.transactionForm.reset({type:"income",amount:"",description:"",category:"tuition",date:this.today}),this.closeTransactionModal(),this.loadTransactions(),this.loadDashboardData()},error:i=>{console.error("Error adding transaction:",i),this.showError("\u0641\u0634\u0644 \u0641\u064A \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0629")}})})}createBudget(){if(this.budgetForm.invalid){this.showWarning("\u064A\u0631\u062C\u0649 \u0645\u0644\u0621 \u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0642\u0648\u0644 \u0627\u0644\u0645\u0637\u0644\u0648\u0628\u0629");return}let t=this.budgetForm.value;this.accountingService.createBudget(t).subscribe({next:e=>{this.showSuccess("\u062A\u0645 \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0645\u064A\u0632\u0627\u0646\u064A\u0629 \u0628\u0646\u062C\u0627\u062D"),this.budgetForm.reset({title:"",amount:"",category:"operational",description:"",startDate:this.today,endDate:""}),this.closeBudgetModal(),this.loadBudgets()},error:e=>{console.error("Error creating budget:",e),this.showError("\u0641\u0634\u0644 \u0641\u064A \u0625\u0646\u0634\u0627\u0621 \u0627\u0644\u0645\u064A\u0632\u0627\u0646\u064A\u0629")}})}addExpense(){if(this.expenseForm.invalid){this.showWarning("\u064A\u0631\u062C\u0649 \u0645\u0644\u0621 \u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0642\u0648\u0644 \u0627\u0644\u0645\u0637\u0644\u0648\u0628\u0629");return}let t=this.expenseForm.value;this.showConfirmDialog("\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F\u061F","\u0633\u064A\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0645\u0635\u0631\u0648\u0641 \u062C\u062F\u064A\u062F","\u0646\u0639\u0645\u060C \u0623\u0636\u0641","\u0625\u0644\u063A\u0627\u0621").then(e=>{e.isConfirmed&&this.accountingService.addExpense(t).subscribe({next:i=>{this.showSuccess("\u062A\u0645\u062A \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0635\u0631\u0648\u0641 \u0628\u0646\u062C\u0627\u062D"),this.expenseForm.reset({description:"",amount:"",category:"salary",paymentMethod:"cash",receiptNumber:""}),this.closeExpenseModal(),this.loadExpenses(),this.loadDashboardData()},error:i=>{console.error("Error adding expense:",i),this.showError("\u0641\u0634\u0644 \u0641\u064A \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0645\u0635\u0631\u0648\u0641")}})})}addSchoolFee(){if(this.schoolFeeForm.invalid){this.showWarning("\u064A\u0631\u062C\u0649 \u0645\u0644\u0621 \u062C\u0645\u064A\u0639 \u0627\u0644\u062D\u0642\u0648\u0644 \u0627\u0644\u0645\u0637\u0644\u0648\u0628\u0629");return}let t=this.schoolFeeForm.value;this.showConfirmDialog("\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F\u061F","\u0633\u064A\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0631\u0633\u0648\u0645 \u062A\u0633\u062C\u064A\u0644 \u062C\u062F\u064A\u062F\u0629","\u0646\u0639\u0645\u060C \u0623\u0636\u0641","\u0625\u0644\u063A\u0627\u0621").then(e=>{if(e.isConfirmed){let i={type:"registration",amount:t.amount,description:`\u0631\u0633\u0648\u0645 \u062A\u0633\u062C\u064A\u0644 \u0644\u0644\u0637\u0627\u0644\u0628 ${t.studentId}`,category:"registration",date:this.today};this.accountingService.addTransaction(i).subscribe({next:r=>{this.showSuccess("\u062A\u0645\u062A \u0625\u0636\u0627\u0641\u0629 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644 \u0628\u0646\u062C\u0627\u062D"),this.schoolFeeForm.reset({studentId:"",amount:60,paymentMethod:"cash"}),this.closeSchoolFeeModal(),this.loadSchoolFees(),this.loadDashboardData()},error:r=>{console.error("Error adding school fee:",r),this.showError("\u0641\u0634\u0644 \u0641\u064A \u0625\u0636\u0627\u0641\u0629 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644")}})}})}paySchoolFee(t){ol.default.fire({title:"\u062F\u0641\u0639 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644",html:`
        <p>\u0627\u0644\u0637\u0627\u0644\u0628: ${t.student?.name||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"}</p>
        <p>\u0627\u0644\u0645\u0628\u0644\u063A: ${t.amount} \u062F.\u062C</p>
        <div class="form-group">
          <label for="paymentMethod">\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639:</label>
          <select id="paymentMethod" class="form-control">
            <option value="cash">\u0646\u0642\u062F\u0627\u064B</option>
            <option value="bank">\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A</option>
            <option value="online">\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A</option>
          </select>
        </div>
      `,showCancelButton:!0,confirmButtonText:"\u062F\u0641\u0639",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-secondary"},buttonsStyling:!1,preConfirm:()=>({paymentMethod:document.getElementById("paymentMethod").value,paymentDate:new Date().toISOString()})}).then(e=>{e.isConfirmed&&this.accountingService.paySchoolFee(t._id,e.value).subscribe({next:i=>{this.showSuccess("\u062A\u0645 \u062F\u0641\u0639 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644 \u0628\u0646\u062C\u0627\u062D"),this.loadSchoolFees(),this.loadDashboardData()},error:i=>{console.error("Error paying school fee:",i),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062F\u0641\u0639 \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644")}})})}payTeacherCommission(t){ol.default.fire({title:"\u062F\u0641\u0639 \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630",html:`
        <p>\u0627\u0644\u0623\u0633\u062A\u0627\u0630: ${t.teacher?.name||"\u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641"}</p>
        <p>\u0627\u0644\u0645\u0628\u0644\u063A: ${t.amount} \u062F.\u062C</p>
        <p>\u0627\u0644\u0634\u0647\u0631: ${t.month}</p>
        <div class="form-group">
          <label for="paymentMethod">\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639:</label>
          <select id="paymentMethod" class="form-control">
            <option value="cash">\u0646\u0642\u062F\u0627\u064B</option>
            <option value="bank">\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A</option>
            <option value="online">\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A</option>
          </select>
        </div>
      `,showCancelButton:!0,confirmButtonText:"\u062F\u0641\u0639",cancelButtonText:"\u0625\u0644\u063A\u0627\u0621",customClass:{confirmButton:"btn btn-success",cancelButton:"btn btn-secondary"},buttonsStyling:!1,preConfirm:()=>({paymentMethod:document.getElementById("paymentMethod").value,paymentDate:new Date().toISOString()})}).then(e=>{e.isConfirmed&&this.accountingService.payTeacherCommission(t._id,e.value).subscribe({next:i=>{this.showSuccess("\u062A\u0645 \u062F\u0641\u0639 \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 \u0628\u0646\u062C\u0627\u062D"),this.loadTeacherCommissions(),this.loadDashboardData()},error:i=>{console.error("Error paying teacher commission:",i),this.showError("\u0641\u0634\u0644 \u0641\u064A \u062F\u0641\u0639 \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630")}})})}formatDate(t){return t?(0,Cd.default)(t).format("YYYY-MM-DD"):"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}formatDateTime(t){return t?(0,Cd.default)(t).format("YYYY-MM-DD HH:mm"):"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}formatCurrency(t){return t?new Intl.NumberFormat("ar-DZ",{style:"currency",currency:"DZD",minimumFractionDigits:0,maximumFractionDigits:0}).format(t):"0.00 \u062F.\u062C"}getTransactionTypeBadge(t){return t&&{income:"success",expense:"danger",registration:"info",payment:"primary",commission:"warning"}[t]||"secondary"}getTransactionTypeText(t){return t?{income:"\u0625\u064A\u0631\u0627\u062F",expense:"\u0645\u0635\u0631\u0648\u0641",registration:"\u062A\u0633\u062C\u064A\u0644",payment:"\u062F\u0641\u0639\u0629",commission:"\u0639\u0645\u0648\u0644\u0629"}[t]||t:"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}getCategoryText(t){return t?{tuition:"\u0631\u0633\u0648\u0645 \u062F\u0631\u0627\u0633\u064A\u0629",salary:"\u0631\u0648\u0627\u062A\u0628",rent:"\u0625\u064A\u062C\u0627\u0631",utilities:"\u0645\u0631\u0627\u0641\u0642",supplies:"\u0645\u0633\u062A\u0644\u0632\u0645\u0627\u062A",other:"\u0623\u062E\u0631\u0649",registration:"\u0631\u0633\u0648\u0645 \u062A\u0633\u062C\u064A\u0644",operational:"\u062A\u0634\u063A\u064A\u0644\u064A",development:"\u062A\u0637\u0648\u064A\u0631",marketing:"\u062A\u0633\u0648\u064A\u0642",maintenance:"\u0635\u064A\u0627\u0646\u0629",transportation:"\u0645\u0648\u0627\u0635\u0644\u0627\u062A",insurance:"\u062A\u0623\u0645\u064A\u0646"}[t]||t:"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}getPaymentMethodText(t){return t?{cash:"\u0646\u0642\u062F\u0627\u064B",bank:"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A",online:"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A",check:"\u0634\u064A\u0643"}[t]||t:"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}getStatusText(t){return t?{paid:"\u0645\u062F\u0641\u0648\u0639\u0629",pending:"\u0645\u0639\u0644\u0642\u0629",overdue:"\u0645\u062A\u0623\u062E\u0631\u0629",cancelled:"\u0645\u0644\u063A\u0627\u0629",active:"\u0646\u0634\u0637",inactive:"\u063A\u064A\u0631 \u0646\u0634\u0637",completed:"\u0645\u0643\u062A\u0645\u0644"}[t]||t:"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"}getStatusBadge(t){return t&&{paid:"success",pending:"warning",overdue:"danger",cancelled:"secondary",active:"success",inactive:"secondary",completed:"info"}[t]||"secondary"}getCategoryTransactionCount(t){return!this.transactions||!t?0:this.transactions.filter(e=>e.category===t&&e.type==="income").length}getCurrentDateFormatted(){return this.formatDate(this.today)}getCategoryIncome(t){return!this.transactions||!t?0:this.transactions.filter(e=>e.category===t&&e.type==="income").reduce((e,i)=>e+(i.amount||0),0)}getTopCategories(t=5){let e={};return this.transactions.forEach(i=>{if(i.type==="income"){let r=i.category;e[r]||(e[r]=0),e[r]+=i.amount||0}}),Object.entries(e).map(([i,r])=>({name:i,amount:r,count:this.getCategoryTransactionCount(i),percentage:this.calculateTotalIncome()>0?r/this.calculateTotalIncome()*100:0})).sort((i,r)=>r.amount-i.amount).slice(0,t)}applyDateFilter(){(this.dateFilter.startDate||this.dateFilter.endDate)&&(this.loadTransactions(),this.activeTab==="financial-report"&&this.loadFinancialReport())}clearDateFilter(){this.dateFilter={startDate:"",endDate:""},this.loadTransactions(),this.activeTab==="financial-report"&&this.loadFinancialReport()}exportToExcel(){let t={startDate:this.dateFilter.startDate,endDate:this.dateFilter.endDate};this.loading.export=!0,this.accountingService.exportReport("excel",t).subscribe({next:e=>{let i=window.URL.createObjectURL(e),r=document.createElement("a");r.href=i,r.download=`\u0627\u0644\u062A\u0642\u0631\u064A\u0631-\u0627\u0644\u0645\u0627\u0644\u064A-${new Date().toISOString().split("T")[0]}.xlsx`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(i),this.loading.export=!1,this.showSuccess("\u062A\u0645 \u062A\u0635\u062F\u064A\u0631 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0628\u0646\u062C\u0627\u062D")},error:e=>{console.error("Error exporting report:",e),this.loading.export=!1,this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u0635\u062F\u064A\u0631 \u0627\u0644\u062A\u0642\u0631\u064A\u0631")}})}exportToPDF(){let t={startDate:this.dateFilter.startDate,endDate:this.dateFilter.endDate};this.loading.export=!0,this.accountingService.exportReport("pdf",t).subscribe({next:e=>{let i=window.URL.createObjectURL(e),r=document.createElement("a");r.href=i,r.download=`\u0627\u0644\u062A\u0642\u0631\u064A\u0631-\u0627\u0644\u0645\u0627\u0644\u064A-${new Date().toISOString().split("T")[0]}.pdf`,document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(i),this.loading.export=!1,this.showSuccess("\u062A\u0645 \u062A\u0635\u062F\u064A\u0631 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0628\u0646\u062C\u0627\u062D")},error:e=>{console.error("Error exporting report:",e),this.loading.export=!1,this.showError("\u0641\u0634\u0644 \u0641\u064A \u062A\u0635\u062F\u064A\u0631 \u0627\u0644\u062A\u0642\u0631\u064A\u0631")}})}openModal(t){let e=document.querySelector(`[data-modal="${t}"]`);e&&(e.classList.add("show"),document.body.style.overflow="hidden",document.body.style.paddingRight="15px",setTimeout(()=>{let i=e.querySelector("input, select, textarea");i&&i.focus()},100))}closeModal(t){t.classList.remove("show"),document.body.style.overflow="auto",document.body.style.paddingRight=""}openTransactionModal(){this.openModal("transaction-modal")}closeTransactionModal(){let t=document.querySelector('[data-modal="transaction-modal"]');t&&this.closeModal(t)}openExpenseModal(){this.openModal("expense-modal")}closeExpenseModal(){let t=document.querySelector('[data-modal="expense-modal"]');t&&this.closeModal(t)}openBudgetModal(){this.openModal("budget-modal")}closeBudgetModal(){let t=document.querySelector('[data-modal="budget-modal"]');t&&this.closeModal(t)}openSchoolFeeModal(){this.openModal("school-fee-modal")}closeSchoolFeeModal(){let t=document.querySelector('[data-modal="school-fee-modal"]');t&&this.closeModal(t)}openClassCommissionModal(){this.openModal("class-commission-modal")}closeClassCommissionModal(){let t=document.querySelector('[data-modal="class-commission-modal"]');t&&this.closeModal(t)}showSuccess(t){ol.default.fire({title:"\u0646\u062C\u0627\u062D!",text:t,icon:"success",confirmButtonText:"\u062D\u0633\u0646\u0627\u064B",confirmButtonColor:"#28a745",timer:2e3,timerProgressBar:!0})}showError(t){ol.default.fire({title:"\u062E\u0637\u0623!",text:t,icon:"error",confirmButtonText:"\u062D\u0633\u0646\u0627\u064B",confirmButtonColor:"#dc3545"})}showWarning(t){ol.default.fire({title:"\u062A\u0646\u0628\u064A\u0647!",text:t,icon:"warning",confirmButtonText:"\u062D\u0633\u0646\u0627\u064B",confirmButtonColor:"#ffc107"})}showConfirmDialog(t,e,i,r){return ol.default.fire({title:t,text:e,icon:"question",showCancelButton:!0,confirmButtonText:i,cancelButtonText:r,confirmButtonColor:"#28a745",cancelButtonColor:"#6c757d",reverseButtons:!0,focusCancel:!0})}validateForm(t){return t.invalid?(Object.keys(t.controls).forEach(e=>{let i=t.get(e);i?.invalid&&i.markAsTouched()}),!1):!0}searchTransactions(){if(this.searchTerm.trim()===""){this.loadTransactions();return}this.loading.transactions=!0;let t={search:this.searchTerm,startDate:this.dateFilter.startDate,endDate:this.dateFilter.endDate};this.accountingService.getTransactions(t).subscribe({next:e=>{this.transactions=e,this.loading.transactions=!1},error:e=>{console.error("Error searching transactions:",e),this.loading.transactions=!1,this.showError("\u0641\u0634\u0644 \u0641\u064A \u0627\u0644\u0628\u062D\u062B")}})}clearSearch(){this.searchTerm="",this.loadTransactions()}calculateTotalIncome(){return this.transactions.filter(t=>t.type==="income").reduce((t,e)=>t+(e.amount||0),0)}calculateTotalExpenses(){return this.transactions.filter(t=>t.type==="expense").reduce((t,e)=>t+(e.amount||0),0)}calculateNetProfit(){return this.calculateTotalIncome()-this.calculateTotalExpenses()}refreshData(){this.loadTabData(this.activeTab),this.showSuccess("\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A \u0628\u0646\u062C\u0627\u062D")}printReport(){window.print()}getMonthlyTrend(){let t={};return this.transactions.forEach(e=>{let i=(0,Cd.default)(e.date).format("YYYY-MM");t[i]||(t[i]={income:0,expense:0}),e.type==="income"?t[i].income+=e.amount||0:e.type==="expense"&&(t[i].expense+=e.amount||0)}),Object.entries(t).map(([e,i])=>({month:e,income:i.income,expense:i.expense,profit:i.income-i.expense})).sort((e,i)=>e.month.localeCompare(i.month))}getTransactionCounts(){return{income:this.transactions.filter(t=>t.type==="income").length,expense:this.transactions.filter(t=>t.type==="expense").length}}getCurrentMonthData(){let t=(0,Cd.default)().format("YYYY-MM"),e=this.transactions.filter(i=>(0,Cd.default)(i.date).format("YYYY-MM")===t);return{income:e.filter(i=>i.type==="income").reduce((i,r)=>i+(r.amount||0),0),expense:e.filter(i=>i.type==="expense").reduce((i,r)=>i+(r.amount||0),0)}}getBudgetUtilization(t){return!t.amount||t.amount===0?0:(t.actualSpending||0)/t.amount*100}isOverBudget(t){return(t.actualSpending||0)>t.amount}formatPercentage(t){return`${t.toFixed(1)}%`}getPercentageColor(t){return t<70?"success":t<90?"warning":"danger"}onPeriodTypeChange(){let t=this.financialReportForm.get("periodType")?.value;t==="monthly"?(this.financialReportForm.get("month")?.setValidators([Tt.required]),this.financialReportForm.get("startDate")?.clearValidators(),this.financialReportForm.get("endDate")?.clearValidators(),this.financialReportForm.get("year")?.clearValidators()):t==="custom"?(this.financialReportForm.get("startDate")?.setValidators([Tt.required]),this.financialReportForm.get("endDate")?.setValidators([Tt.required]),this.financialReportForm.get("month")?.clearValidators(),this.financialReportForm.get("year")?.clearValidators()):t==="yearly"&&(this.financialReportForm.get("year")?.setValidators([Tt.required]),this.financialReportForm.get("month")?.clearValidators(),this.financialReportForm.get("startDate")?.clearValidators(),this.financialReportForm.get("endDate")?.clearValidators()),this.financialReportForm.get("month")?.updateValueAndValidity(),this.financialReportForm.get("startDate")?.updateValueAndValidity(),this.financialReportForm.get("endDate")?.updateValueAndValidity(),this.financialReportForm.get("year")?.updateValueAndValidity()}viewClassPaymentDetails(t){let e=`
      <div class="text-right">
        <h5>\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062D\u0635\u0629: ${t.class?.name}</h5>
        <hr>
        <p><strong>\u0627\u0644\u0623\u0633\u062A\u0627\u0630:</strong> ${t.teacher?.name}</p>
        <p><strong>\u0627\u0644\u0634\u0647\u0631:</strong> ${t.month}</p>
        <p><strong>\u0633\u0639\u0631 \u0627\u0644\u062D\u0635\u0629:</strong> ${this.formatCurrency(t.class?.price)}</p>
        <p><strong>\u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u0623\u0633\u062A\u0627\u0630 (70%):</strong> ${this.formatCurrency(t.commissionAmount)}</p>
        <p><strong>\u0639\u062F\u062F \u0627\u0644\u0637\u0644\u0627\u0628:</strong> ${t.students?.total}</p>
        <p><strong>\u0637\u0644\u0627\u0628 \u0645\u062F\u0641\u0648\u0639\u064A\u0646:</strong> ${t.students?.paid}</p>
        <hr>
        <h6>\u0642\u0627\u0626\u0645\u0629 \u0627\u0644\u0637\u0644\u0627\u0628:</h6>
    `;t.students?.list&&t.students.list.length>0?(e+='<ul class="list-group">',t.students.list.forEach(i=>{let r=i.hasPaid?"\u0645\u062F\u0641\u0648\u0639":"\u063A\u064A\u0631 \u0645\u062F\u0641\u0648\u0639",o=i.hasPaid?"badge-success":"badge-danger";e+=`
          <li class="list-group-item d-flex justify-content-between align-items-center">
            ${i.studentName}
            <span class="badge ${o}">${r}</span>
          </li>
        `}),e+="</ul>"):e+='<p class="text-muted">\u0644\u0627 \u064A\u0648\u062C\u062F \u0637\u0644\u0627\u0628 \u0645\u0633\u062C\u0644\u064A\u0646</p>',e+="</div>",ol.default.fire({title:"\u062A\u0641\u0627\u0635\u064A\u0644 \u062F\u0641\u0639 \u0627\u0644\u062D\u0635\u0629",html:e,width:"600px",showCloseButton:!0,confirmButtonText:"\u062D\u0633\u0646\u0627\u064B",confirmButtonColor:"#28a745"})}getTotalStudents(){return this.filteredClassPayments.reduce((t,e)=>t+(e.students?.total||0),0)}getTotalCommission(){return this.filteredClassPayments.reduce((t,e)=>t+(e.commissionAmount||0),0)}getPendingPaymentsCount(){return this.filteredClassPayments.filter(t=>t.status==="pending"&&t.students?.paid>0).length}static \u0275fac=function(e){return new(e||n)(Ne(X1),Ne(qn),Ne(Lc),Ne(rl),Ne(il))};static \u0275cmp=nn({type:n,selectors:[["app-accounting"]],decls:327,vars:48,consts:[[1,"accounting-container"],[1,"header-section"],[1,"fas","fa-calculator"],[1,"header-actions"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-plus"],[1,"btn","btn-success",3,"click"],[1,"fas","fa-minus"],[1,"btn","btn-info",3,"click"],[1,"fas","fa-sync-alt"],[1,"btn","btn-warning",3,"click"],[1,"fas","fa-print"],[1,"tabs-navigation"],[1,"tabs-nav"],[1,"tab-btn",3,"click"],[1,"fas","fa-tachometer-alt"],[1,"fas","fa-exchange-alt"],[1,"fas","fa-money-bill-wave"],[1,"fas","fa-receipt"],[1,"fas","fa-chart-pie"],[1,"fas","fa-user-graduate"],[1,"fas","fa-chalkboard-teacher"],[1,"fas","fa-money-check-alt"],[1,"fas","fa-file-invoice-dollar"],[1,"fas","fa-id-card"],[1,"fas","fa-file-invoice"],[1,"tab-content"],["class","dashboard-tab",4,"ngIf"],["class","transactions-tab",4,"ngIf"],["class","income-tab",4,"ngIf"],["class","expenses-tab",4,"ngIf"],["class","budgets-tab",4,"ngIf"],["class","school-fees-tab",4,"ngIf"],["class","commissions-tab",4,"ngIf"],["class","class-commission-tab",4,"ngIf"],["class","class-payments-tab",4,"ngIf"],["class","financial-report-tab",4,"ngIf"],["class","registration-fees-tab",4,"ngIf"],["class","invoices-tab",4,"ngIf"],["data-modal","transaction-modal",1,"transaction-modal"],[1,"transaction-modal-dialog"],[1,"transaction-modal-content"],[1,"transaction-modal-header"],[1,"transaction-modal-title"],["type","button",1,"close",3,"click"],[1,"transaction-modal-body"],[3,"ngSubmit","formGroup"],[1,"form-group"],["formControlName","type","required","",1,"form-control"],["value","income"],["value","expense"],["value","registration"],["type","number","formControlName","amount","min","1","required","","placeholder","\u0623\u062F\u062E\u0644 \u0627\u0644\u0645\u0628\u0644\u063A",1,"form-control"],["type","text","formControlName","description","required","","placeholder","\u0623\u062F\u062E\u0644 \u0648\u0635\u0641 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0629",1,"form-control"],["formControlName","category","required","",1,"form-control"],["value","tuition"],["value","salary"],["value","rent"],["value","utilities"],["value","supplies"],["value","other"],["type","date","formControlName","date","required","",1,"form-control"],[1,"transaction-modal-footer"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"fas","fa-check"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-times"],["data-modal","expense-modal",1,"transaction-modal"],["type","text","formControlName","description","required","","placeholder","\u0648\u0635\u0641 \u0627\u0644\u0645\u0635\u0631\u0648\u0641",1,"form-control"],["value","maintenance"],["value","marketing"],["formControlName","paymentMethod","required","",1,"form-control"],["value","cash"],["value","bank"],["value","online"],["type","text","formControlName","receiptNumber","placeholder","\u0631\u0642\u0645 \u0627\u0644\u0625\u064A\u0635\u0627\u0644",1,"form-control"],["data-modal","budget-modal",1,"transaction-modal"],["type","text","formControlName","title","required","","placeholder","\u0623\u062F\u062E\u0644 \u0639\u0646\u0648\u0627\u0646 \u0627\u0644\u0645\u064A\u0632\u0627\u0646\u064A\u0629",1,"form-control"],["value","operational"],["value","salaries"],["value","development"],["formControlName","description","rows","2","placeholder","\u0648\u0635\u0641 \u0627\u0644\u0645\u064A\u0632\u0627\u0646\u064A\u0629",1,"form-control"],[1,"row"],[1,"col-md-6"],["type","date","formControlName","startDate","required","",1,"form-control"],["type","date","formControlName","endDate","required","",1,"form-control"],["data-modal","school-fee-modal",1,"transaction-modal"],["type","text","formControlName","studentId","required","","placeholder","\u0623\u062F\u062E\u0644 \u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628",1,"form-control"],["type","number","formControlName","amount","min","1","required","","value","60",1,"form-control"],["data-modal","class-commission-modal",1,"transaction-modal"],["formControlName","teacherId","required","",1,"form-control"],["value",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","classId","required","",1,"form-control"],["type","month","formControlName","month","required","",1,"form-control"],["formControlName","paymentMethod",1,"form-control"],[1,"dashboard-tab"],[1,"quick-stats"],[1,"stat-card","bg-success"],[1,"stat-icon"],[1,"fas","fa-wallet"],[1,"stat-content"],[1,"stat-card","bg-info"],[1,"stat-card","bg-danger"],[1,"stat-card","bg-warning"],[1,"card","mb-4"],[1,"card-header"],[1,"fas","fa-calendar-day"],[1,"date-badge"],[1,"card-body"],["class","loading-spinner",4,"ngIf"],["class","daily-income-content",4,"ngIf"],[1,"card"],[1,"fas","fa-chart-line"],[1,"financial-stats"],[1,"stat-item"],[1,"stat-label"],[1,"stat-value","text-success"],[1,"stat-value","text-danger"],[1,"stat-value","text-warning"],[1,"stat-value"],[1,"fas","fa-bolt"],[1,"quick-actions"],[1,"btn","btn-outline-primary","btn-block","mb-2",3,"click"],[1,"fas","fa-plus-circle"],[1,"btn","btn-outline-success","btn-block","mb-2",3,"click"],[1,"fas","fa-minus-circle"],[1,"btn","btn-outline-info","btn-block","mb-2",3,"click"],[1,"btn","btn-outline-warning","btn-block",3,"click"],[1,"fas","fa-user-plus"],[1,"fas","fa-history"],[1,"btn","btn-sm","btn-outline-secondary",3,"click"],[1,"fas","fa-arrow-left"],["class","empty-state",4,"ngIf"],["class","table-responsive",4,"ngIf"],[1,"loading-spinner"],[1,"fas","fa-spinner","fa-spin"],[1,"daily-income-content"],[1,"total-income"],[1,"income-breakdown"],[1,"breakdown-item"],[1,"breakdown-label"],[1,"breakdown-value"],[1,"empty-state"],[1,"fas","fa-exchange-alt","fa-2x"],[1,"table-responsive"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[1,"badge",3,"ngClass"],[3,"ngClass"],[1,"transactions-tab"],[1,"header-controls"],[1,"filters-section"],[1,"col-md-3"],["type","date",1,"form-control",3,"ngModelChange","ngModel"],[1,"col-md-4"],[1,"input-group"],["type","text","placeholder","\u0628\u062D\u062B \u0641\u064A \u0627\u0644\u0648\u0635\u0641 \u0623\u0648 \u0627\u0644\u0645\u0628\u0644\u063A...",1,"form-control",3,"ngModelChange","ngModel"],[1,"input-group-append"],[1,"btn","btn-outline-primary",3,"click"],[1,"fas","fa-search"],[1,"btn","btn-outline-secondary",3,"click"],[1,"col-md-2"],[1,"btn-group","d-flex"],[1,"fas","fa-filter"],[1,"btn","btn-secondary",3,"click"],[1,"table-responsive","mt-3"],["class","table table-hover",4,"ngIf"],["class","summary-section mt-4",4,"ngIf"],[1,"fas","fa-exchange-alt","fa-3x"],[1,"category-badge"],["title","\u0639\u0631\u0636 \u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644",1,"btn","btn-sm","btn-info"],[1,"fas","fa-eye"],[1,"summary-section","mt-4"],[1,"summary-card","bg-success"],[1,"summary-card","bg-danger"],[1,"summary-card",3,"ngClass"],[1,"income-tab"],[1,"income-reports"],[1,"report-card"],[1,"report-header"],[1,"btn","btn-sm","btn-outline-primary",3,"click"],[1,"report-body"],[4,"ngIf"],[1,"fas","fa-calendar-alt"],[1,"income-total"],[1,"card","mt-4"],[1,"table"],[1,"progress"],[1,"progress-bar"],[1,"expenses-tab"],[1,"fas","fa-receipt","fa-3x"],[1,"text-danger"],[1,"badge","badge-secondary"],[1,"summary-card","bg-info"],[1,"budgets-tab"],[1,"fas","fa-chart-pie","fa-3x"],[1,"progress-bar",3,"ngClass"],["title","\u062A\u0639\u062F\u064A\u0644",1,"btn","btn-sm","btn-warning"],[1,"fas","fa-edit"],[1,"school-fees-tab"],[1,"fas","fa-user-graduate","fa-3x"],["class","btn btn-sm btn-success","title","\u062F\u0641\u0639",3,"click",4,"ngIf"],["title","\u062F\u0641\u0639",1,"btn","btn-sm","btn-success",3,"click"],[1,"commissions-tab"],[1,"fas","fa-chalkboard-teacher","fa-3x"],[1,"class-commission-tab"],[1,"commission-calculator"],["type","text","formControlName","round","placeholder","\u0645\u062B\u0627\u0644: \u0627\u0644\u062C\u0648\u0644\u0629 \u0627\u0644\u0623\u0648\u0644\u0649",1,"form-control"],["formControlName","notes","rows","2",1,"form-control"],[1,"form-actions"],["class","loading-spinner mt-4",4,"ngIf"],["class","commission-results mt-4",4,"ngIf"],[3,"value"],[1,"loading-spinner","mt-4"],[1,"commission-results","mt-4"],[1,"results-header"],[1,"btn","btn-success",3,"click","disabled"],[1,"results-summary"],[1,"summary-card","bg-warning"],[1,"summary-card","bg-secondary"],[1,"table","table-sm"],[1,"text-success"],[1,"class-payments-tab"],["title","\u062A\u062D\u062F\u064A\u062B",1,"btn","btn-info",3,"click"],[1,"row","mb-4"],["type","month",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"col-md-8"],["type","text","placeholder","\u0628\u062D\u062B \u0641\u064A \u0627\u0633\u0645 \u0627\u0644\u062D\u0635\u0629 \u0623\u0648 \u0627\u0644\u0623\u0633\u062A\u0627\u0630...",1,"form-control",3,"ngModelChange","keyup","ngModel"],["class","loading-spinner text-center py-5",4,"ngIf"],[1,"loading-spinner","text-center","py-5"],[1,"fas","fa-spinner","fa-spin","fa-3x"],[1,"mt-3"],["class","empty-state text-center py-5",4,"ngIf"],[1,"empty-state","text-center","py-5"],[1,"fas","fa-money-check-alt","fa-3x","text-muted"],[1,"text-muted"],[1,"badge","badge-info"],[1,"text-warning"],["class","d-block",4,"ngIf"],["title","\u0639\u0631\u0636 \u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644",1,"btn","btn-sm","btn-info","mb-1",3,"click"],["class","btn btn-sm btn-success mb-1","title","\u062F\u0641\u0639 \u0627\u0644\u0639\u0645\u0648\u0644\u0629",3,"click",4,"ngIf"],["class","btn btn-sm btn-secondary mb-1","title","\u0639\u0631\u0636 \u0627\u0644\u0625\u064A\u0635\u0627\u0644",4,"ngIf"],[1,"d-block"],["title","\u062F\u0641\u0639 \u0627\u0644\u0639\u0645\u0648\u0644\u0629",1,"btn","btn-sm","btn-success","mb-1",3,"click"],["title","\u0639\u0631\u0636 \u0627\u0644\u0625\u064A\u0635\u0627\u0644",1,"btn","btn-sm","btn-secondary","mb-1"],[1,"financial-report-tab"],[1,"fas","fa-file-excel"],[1,"btn","btn-danger",3,"click","disabled"],[1,"fas","fa-file-pdf"],[1,"report-filters"],["formControlName","periodType",1,"form-control",3,"change"],["value","monthly"],["value","custom"],["value","yearly"],["class","col-md-3",4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-block",3,"disabled"],[1,"fas","fa-chart-bar"],["class","report-results mt-4",4,"ngIf"],["type","number","formControlName","year","min","2020","max","2030","required","",1,"form-control"],[1,"report-results","mt-4"],[1,"summary-cards"],[1,"registration-fees-tab"],[1,"fas","fa-id-card","fa-3x"],["title","\u0639\u0631\u0636 \u0627\u0644\u0641\u0627\u062A\u0648\u0631\u0629",1,"btn","btn-sm","btn-info"],[1,"invoices-tab"],[1,"fas","fa-file-invoice","fa-3x"],["title","\u0637\u0628\u0627\u0639\u0629",1,"btn","btn-sm","btn-warning"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"div",1)(2,"h1"),b(3,"i",2),u(4," \u0627\u0644\u0646\u0638\u0627\u0645 \u0627\u0644\u0645\u062D\u0627\u0633\u0628\u064A"),a(),s(5,"div",3)(6,"button",4),I("click",function(){return i.openTransactionModal()}),b(7,"i",5),u(8," \u0625\u0636\u0627\u0641\u0629 \u0645\u0639\u0627\u0645\u0644\u0629 "),a(),s(9,"button",6),I("click",function(){return i.openExpenseModal()}),b(10,"i",7),u(11," \u0625\u0636\u0627\u0641\u0629 \u0645\u0635\u0631\u0648\u0641 "),a(),s(12,"button",8),I("click",function(){return i.refreshData()}),b(13,"i",9),u(14," \u062A\u062D\u062F\u064A\u062B "),a(),s(15,"button",10),I("click",function(){return i.printReport()}),b(16,"i",11),u(17," \u0637\u0628\u0627\u0639\u0629 "),a()()(),s(18,"div",12)(19,"nav",13)(20,"button",14),I("click",function(){return i.switchTab("dashboard")}),b(21,"i",15),u(22," \u0644\u0648\u062D\u0629 \u0627\u0644\u062A\u062D\u0643\u0645 "),a(),s(23,"button",14),I("click",function(){return i.switchTab("transactions")}),b(24,"i",16),u(25," \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0627\u062A "),a(),s(26,"button",14),I("click",function(){return i.switchTab("income")}),b(27,"i",17),u(28," \u0627\u0644\u0625\u064A\u0631\u0627\u062F\u0627\u062A "),a(),s(29,"button",14),I("click",function(){return i.switchTab("expenses")}),b(30,"i",18),u(31," \u0627\u0644\u0645\u0635\u0631\u0648\u0641\u0627\u062A "),a(),s(32,"button",14),I("click",function(){return i.switchTab("budgets")}),b(33,"i",19),u(34," \u0627\u0644\u0645\u064A\u0632\u0627\u0646\u064A\u0627\u062A "),a(),s(35,"button",14),I("click",function(){return i.switchTab("school-fees")}),b(36,"i",20),u(37," \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644 "),a(),s(38,"button",14),I("click",function(){return i.switchTab("commissions")}),b(39,"i",21),u(40," \u0639\u0645\u0648\u0644\u0627\u062A \u0627\u0644\u0623\u0633\u0627\u062A\u0630\u0629 "),a(),s(41,"button",14),I("click",function(){return i.switchTab("class-commission")}),b(42,"i",2),u(43," \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u062D\u0635\u0629 "),a(),s(44,"button",14),I("click",function(){return i.switchTab("class-payments")}),b(45,"i",22),u(46," \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u062D\u0635\u0635 "),a(),s(47,"button",14),I("click",function(){return i.switchTab("financial-report")}),b(48,"i",23),u(49," \u0627\u0644\u062A\u0642\u0631\u064A\u0631 \u0627\u0644\u0645\u0627\u0644\u064A "),a(),s(50,"button",14),I("click",function(){return i.switchTab("registration-fees")}),b(51,"i",24),u(52," \u0631\u0633\u0648\u0645 \u0627\u0644\u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062A\u0641\u0635\u064A\u0644\u064A\u0629 "),a(),s(53,"button",14),I("click",function(){return i.switchTab("invoices")}),b(54,"i",25),u(55," \u0627\u0644\u0641\u0648\u0627\u062A\u064A\u0631 "),a()()(),s(56,"div",26),j(57,dY,111,17,"div",27)(58,_Y,46,7,"div",28)(59,bY,50,4,"div",29)(60,AY,16,4,"div",30)(61,OY,15,3,"div",31)(62,LY,15,3,"div",32)(63,WY,11,3,"div",33)(64,ZY,65,6,"div",34)(65,sq,30,5,"div",35)(66,mq,40,10,"div",36)(67,xq,11,3,"div",37)(68,Sq,11,3,"div",38),a(),s(69,"div",39)(70,"div",40)(71,"div",41)(72,"div",42)(73,"h5",43),b(74,"i",16),u(75," \u0625\u0636\u0627\u0641\u0629 \u0645\u0639\u0627\u0645\u0644\u0629 \u0645\u0627\u0644\u064A\u0629 "),a(),s(76,"button",44),I("click",function(){return i.closeTransactionModal()}),s(77,"span"),u(78,"\xD7"),a()()(),s(79,"div",45)(80,"form",46),I("ngSubmit",function(){return i.addTransaction()}),s(81,"div",47)(82,"label"),u(83,"\u0646\u0648\u0639 \u0627\u0644\u0645\u0639\u0627\u0645\u0644\u0629 *"),a(),s(84,"select",48)(85,"option",49),u(86,"\u0625\u064A\u0631\u0627\u062F"),a(),s(87,"option",50),u(88,"\u0645\u0635\u0631\u0648\u0641"),a(),s(89,"option",51),u(90,"\u0631\u0633\u0648\u0645 \u062A\u0633\u062C\u064A\u0644"),a()()(),s(91,"div",47)(92,"label"),u(93,"\u0627\u0644\u0645\u0628\u0644\u063A *"),a(),b(94,"input",52),a(),s(95,"div",47)(96,"label"),u(97,"\u0627\u0644\u0648\u0635\u0641 *"),a(),b(98,"input",53),a(),s(99,"div",47)(100,"label"),u(101,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641 *"),a(),s(102,"select",54)(103,"option",55),u(104,"\u0631\u0633\u0648\u0645 \u062F\u0631\u0627\u0633\u064A\u0629"),a(),s(105,"option",56),u(106,"\u0631\u0648\u0627\u062A\u0628"),a(),s(107,"option",57),u(108,"\u0625\u064A\u062C\u0627\u0631"),a(),s(109,"option",58),u(110,"\u0645\u0631\u0627\u0641\u0642"),a(),s(111,"option",59),u(112,"\u0645\u0633\u062A\u0644\u0632\u0645\u0627\u062A"),a(),s(113,"option",51),u(114,"\u0631\u0633\u0648\u0645 \u062A\u0633\u062C\u064A\u0644"),a(),s(115,"option",60),u(116,"\u0623\u062E\u0631\u0649"),a()()(),s(117,"div",47)(118,"label"),u(119,"\u0627\u0644\u062A\u0627\u0631\u064A\u062E *"),a(),b(120,"input",61),a(),s(121,"div",62)(122,"button",63),b(123,"i",64),u(124," \u062D\u0641\u0638 "),a(),s(125,"button",65),I("click",function(){return i.closeTransactionModal()}),b(126,"i",66),u(127," \u0625\u0644\u063A\u0627\u0621 "),a()()()()()()(),s(128,"div",67)(129,"div",40)(130,"div",41)(131,"div",42)(132,"h5",43),b(133,"i",18),u(134," \u0625\u0636\u0627\u0641\u0629 \u0645\u0635\u0631\u0648\u0641 "),a(),s(135,"button",44),I("click",function(){return i.closeExpenseModal()}),s(136,"span"),u(137,"\xD7"),a()()(),s(138,"div",45)(139,"form",46),I("ngSubmit",function(){return i.addExpense()}),s(140,"div",47)(141,"label"),u(142,"\u0627\u0644\u0648\u0635\u0641 *"),a(),b(143,"input",68),a(),s(144,"div",47)(145,"label"),u(146,"\u0627\u0644\u0645\u0628\u0644\u063A *"),a(),b(147,"input",52),a(),s(148,"div",47)(149,"label"),u(150,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641 *"),a(),s(151,"select",54)(152,"option",56),u(153,"\u0631\u0648\u0627\u062A\u0628"),a(),s(154,"option",57),u(155,"\u0625\u064A\u062C\u0627\u0631"),a(),s(156,"option",58),u(157,"\u0645\u0631\u0627\u0641\u0642"),a(),s(158,"option",59),u(159,"\u0645\u0633\u062A\u0644\u0632\u0645\u0627\u062A"),a(),s(160,"option",69),u(161,"\u0635\u064A\u0627\u0646\u0629"),a(),s(162,"option",70),u(163,"\u062A\u0633\u0648\u064A\u0642"),a(),s(164,"option",60),u(165,"\u0623\u062E\u0631\u0649"),a()()(),s(166,"div",47)(167,"label"),u(168,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639 *"),a(),s(169,"select",71)(170,"option",72),u(171,"\u0646\u0642\u062F\u0627\u064B"),a(),s(172,"option",73),u(173,"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A"),a(),s(174,"option",74),u(175,"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"),a()()(),s(176,"div",47)(177,"label"),u(178,"\u0631\u0642\u0645 \u0627\u0644\u0625\u064A\u0635\u0627\u0644 (\u0627\u062E\u062A\u064A\u0627\u0631\u064A)"),a(),b(179,"input",75),a(),s(180,"div",62)(181,"button",63),b(182,"i",64),u(183," \u062D\u0641\u0638 "),a(),s(184,"button",65),I("click",function(){return i.closeExpenseModal()}),b(185,"i",66),u(186," \u0625\u0644\u063A\u0627\u0621 "),a()()()()()()(),s(187,"div",76)(188,"div",40)(189,"div",41)(190,"div",42)(191,"h5",43),b(192,"i",19),u(193," \u0625\u0646\u0634\u0627\u0621 \u0645\u064A\u0632\u0627\u0646\u064A\u0629 "),a(),s(194,"button",44),I("click",function(){return i.closeBudgetModal()}),s(195,"span"),u(196,"\xD7"),a()()(),s(197,"div",45)(198,"form",46),I("ngSubmit",function(){return i.createBudget()}),s(199,"div",47)(200,"label"),u(201,"\u0639\u0646\u0648\u0627\u0646 \u0627\u0644\u0645\u064A\u0632\u0627\u0646\u064A\u0629 *"),a(),b(202,"input",77),a(),s(203,"div",47)(204,"label"),u(205,"\u0627\u0644\u0645\u0628\u0644\u063A *"),a(),b(206,"input",52),a(),s(207,"div",47)(208,"label"),u(209,"\u0627\u0644\u062A\u0635\u0646\u064A\u0641 *"),a(),s(210,"select",54)(211,"option",78),u(212,"\u062A\u0634\u063A\u064A\u0644\u064A"),a(),s(213,"option",79),u(214,"\u0631\u0648\u0627\u062A\u0628"),a(),s(215,"option",80),u(216,"\u062A\u0637\u0648\u064A\u0631"),a(),s(217,"option",70),u(218,"\u062A\u0633\u0648\u064A\u0642"),a(),s(219,"option",60),u(220,"\u0623\u062E\u0631\u0649"),a()()(),s(221,"div",47)(222,"label"),u(223,"\u0627\u0644\u0648\u0635\u0641 (\u0627\u062E\u062A\u064A\u0627\u0631\u064A)"),a(),b(224,"textarea",81),a(),s(225,"div",82)(226,"div",83)(227,"div",47)(228,"label"),u(229,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0628\u062F\u0621 *"),a(),b(230,"input",84),a()(),s(231,"div",83)(232,"div",47)(233,"label"),u(234,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u0627\u0646\u062A\u0647\u0627\u0621 *"),a(),b(235,"input",85),a()()(),s(236,"div",62)(237,"button",63),b(238,"i",64),u(239," \u0625\u0646\u0634\u0627\u0621 "),a(),s(240,"button",65),I("click",function(){return i.closeBudgetModal()}),b(241,"i",66),u(242," \u0625\u0644\u063A\u0627\u0621 "),a()()()()()()(),s(243,"div",86)(244,"div",40)(245,"div",41)(246,"div",42)(247,"h5",43),b(248,"i",20),u(249," \u062A\u0633\u062C\u064A\u0644 \u0631\u0633\u0648\u0645 \u062A\u0633\u062C\u064A\u0644 "),a(),s(250,"button",44),I("click",function(){return i.closeSchoolFeeModal()}),s(251,"span"),u(252,"\xD7"),a()()(),s(253,"div",45)(254,"form",46),I("ngSubmit",function(){return i.addSchoolFee()}),s(255,"div",47)(256,"label"),u(257,"\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628 *"),a(),b(258,"input",87),a(),s(259,"div",47)(260,"label"),u(261,"\u0627\u0644\u0645\u0628\u0644\u063A *"),a(),b(262,"input",88),a(),s(263,"div",47)(264,"label"),u(265,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639 *"),a(),s(266,"select",71)(267,"option",72),u(268,"\u0646\u0642\u062F\u0627\u064B"),a(),s(269,"option",73),u(270,"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A"),a(),s(271,"option",74),u(272,"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"),a()()(),s(273,"div",62)(274,"button",63),b(275,"i",64),u(276," \u062A\u0633\u062C\u064A\u0644 "),a(),s(277,"button",65),I("click",function(){return i.closeSchoolFeeModal()}),b(278,"i",66),u(279," \u0625\u0644\u063A\u0627\u0621 "),a()()()()()()(),s(280,"div",89)(281,"div",40)(282,"div",41)(283,"div",42)(284,"h5",43),b(285,"i",2),u(286," \u062D\u0633\u0627\u0628 \u0639\u0645\u0648\u0644\u0629 \u0627\u0644\u062D\u0635\u0629 "),a(),s(287,"button",44),I("click",function(){return i.closeClassCommissionModal()}),s(288,"span"),u(289,"\xD7"),a()()(),s(290,"div",45)(291,"form",46),I("ngSubmit",function(){return i.calculateClassCommission()}),s(292,"div",47)(293,"label"),u(294,"\u0627\u0644\u0623\u0633\u062A\u0627\u0630 *"),a(),s(295,"select",90)(296,"option",91),u(297,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0623\u0633\u062A\u0627\u0630"),a(),j(298,Mq,2,2,"option",92),a()(),s(299,"div",47)(300,"label"),u(301,"\u0627\u0644\u062D\u0635\u0629 *"),a(),s(302,"select",93)(303,"option",91),u(304,"\u0627\u062E\u062A\u0631 \u0627\u0644\u062D\u0635\u0629"),a(),j(305,Aq,2,4,"option",92),a()(),s(306,"div",47)(307,"label"),u(308,"\u0627\u0644\u0634\u0647\u0631 *"),a(),b(309,"input",94),a(),s(310,"div",47)(311,"label"),u(312,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(313,"select",95)(314,"option",72),u(315,"\u0646\u0642\u062F\u0627\u064B"),a(),s(316,"option",73),u(317,"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A"),a(),s(318,"option",74),u(319,"\u062F\u0641\u0639 \u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"),a()()(),s(320,"div",62)(321,"button",63),b(322,"i",2),u(323," \u062D\u0633\u0627\u0628 "),a(),s(324,"button",65),I("click",function(){return i.closeClassCommissionModal()}),b(325,"i",66),u(326," \u0625\u0644\u063A\u0627\u0621 "),a()()()()()()()()),e&2&&(d(20),Ie("active",i.activeTab==="dashboard"),d(3),Ie("active",i.activeTab==="transactions"),d(3),Ie("active",i.activeTab==="income"),d(3),Ie("active",i.activeTab==="expenses"),d(3),Ie("active",i.activeTab==="budgets"),d(3),Ie("active",i.activeTab==="school-fees"),d(3),Ie("active",i.activeTab==="commissions"),d(3),Ie("active",i.activeTab==="class-commission"),d(3),Ie("active",i.activeTab==="class-payments"),d(3),Ie("active",i.activeTab==="financial-report"),d(3),Ie("active",i.activeTab==="registration-fees"),d(3),Ie("active",i.activeTab==="invoices"),d(4),w("ngIf",i.activeTab==="dashboard"),d(),w("ngIf",i.activeTab==="transactions"),d(),w("ngIf",i.activeTab==="income"),d(),w("ngIf",i.activeTab==="expenses"),d(),w("ngIf",i.activeTab==="budgets"),d(),w("ngIf",i.activeTab==="school-fees"),d(),w("ngIf",i.activeTab==="commissions"),d(),w("ngIf",i.activeTab==="class-commission"),d(),w("ngIf",i.activeTab==="class-payments"),d(),w("ngIf",i.activeTab==="financial-report"),d(),w("ngIf",i.activeTab==="registration-fees"),d(),w("ngIf",i.activeTab==="invoices"),d(12),w("formGroup",i.transactionForm),d(42),w("disabled",i.transactionForm.invalid||i.loading.transactions),d(17),w("formGroup",i.expenseForm),d(42),w("disabled",i.expenseForm.invalid||i.loading.transactions),d(17),w("formGroup",i.budgetForm),d(39),w("disabled",i.budgetForm.invalid||i.loading.transactions),d(17),w("formGroup",i.schoolFeeForm),d(20),w("disabled",i.schoolFeeForm.invalid||i.loading.transactions),d(17),w("formGroup",i.classCommissionForm),d(7),w("ngForOf",i.teachersList),d(7),w("ngForOf",i.lessonsList),d(16),w("disabled",i.classCommissionForm.invalid||i.loading.classCommission))},dependencies:[Un,Ti,Di,Pi,Yn,gr,di,ii,Ai,$i,_r,tu,ti,hn,Bo,Nn,An,Bc,Ql,eu],encapsulation:2})};$();var Tq=["rfidInput"],Dq=()=>["/home/live-class"],Pq=n=>({classId:n});function Iq(n,t){if(n&1&&(s(0,"span",77),u(1),a()),n&2){let e=t.$implicit;d(),H(" ",e.name," ")}}function Oq(n,t){if(n&1&&(s(0,"div",75)(1,"h5"),u(2,"\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u0633\u062C\u0644\u0629:"),a(),s(3,"div",43),j(4,Iq,2,1,"span",76),a()()),n&2){let e=E(2);d(4),w("ngForOf",e.scannedStudent.classes)}}function Fq(n,t){if(n&1){let e=he();s(0,"div",55)(1,"div",56)(2,"div",57)(3,"h3"),b(4,"i",58),u(5," \u0637\u0627\u0644\u0628 \u0645\u0643\u062A\u0634\u0641"),a(),s(6,"button",59),I("click",function(){F(e);let r=E();return R(r.scannedStudent=null)}),b(7,"i",60),a()(),s(8,"div",61)(9,"div",62)(10,"div",63),b(11,"i",64),a(),s(12,"div",65)(13,"h4"),u(14),a(),s(15,"p"),b(16,"i",12),u(17),a(),s(18,"p"),b(19,"i",66),u(20),a(),s(21,"p"),b(22,"i",67),u(23),a()()(),s(24,"div",68)(25,"button",69),I("click",function(){F(e);let r=E();return R(r.goToStudentDetails(r.scannedStudent.student._id))}),b(26,"i",70),u(27," \u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644 "),a(),s(28,"button",71),I("click",function(){F(e);let r=E();return R(r.payForClass(r.scannedStudent.student._id))}),b(29,"i",19),u(30," \u062F\u0641\u0639 \u062D\u0635\u0629 "),a(),s(31,"button",72),b(32,"i",73),u(33," \u062A\u0633\u062C\u064A\u0644 \u062D\u0636\u0648\u0631 "),a()(),j(34,Oq,5,1,"div",74),a()()()}if(n&2){let e=E();d(14),B(e.scannedStudent.student.name),d(3),H(" ",e.scannedStudent.student.studentId,""),d(3),H(" ",e.scannedStudent.student.academicYear,""),d(3),H(" ",e.scannedStudent.student.parentPhone,""),d(11),w("ngIf",e.scannedStudent.classes==null?null:e.scannedStudent.classes.length)}}function Rq(n,t){if(n&1){let e=he();s(0,"button",90),I("click",function(){F(e);let r=E().$implicit,o=E();return R(o.scheduleClass(r))}),b(1,"i",91),u(2," \u062C\u062F\u0648\u0644\u0629 "),a()}}function kq(n,t){if(n&1&&(s(0,"div",78)(1,"div",79)(2,"h4"),u(3),a(),s(4,"p",80)(5,"span"),b(6,"i",81),u(7),a(),s(8,"span"),b(9,"i",82),u(10),a(),s(11,"span"),b(12,"i",31),u(13),a(),s(14,"span"),b(15,"i",83),u(16),a()(),s(17,"div",84),b(18,"i",85),u(19),a()(),s(20,"div",86),j(21,Rq,3,0,"button",87),s(22,"button",88),b(23,"i",89),u(24," \u0639\u0631\u0636 "),a()()()),n&2){let e=t.$implicit;d(3),B(e.name),d(4),H(" ",e.subject,""),d(3),H(" ",e.teacher==null?null:e.teacher.name,""),d(3),H(" ",e.time,""),d(3),H(" ",e.classroom==null?null:e.classroom.name,""),d(3),H(" ",e.studentsCount," \u0637\u0627\u0644\u0628 "),d(2),w("ngIf",!e.isScheduled),d(),w("routerLink",Ll(9,Dq))("queryParams",Rr(10,Pq,e._id))}}function Nq(n,t){n&1&&(s(0,"div",92),b(1,"i",93),s(2,"p"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u062D\u0635\u0635 \u0645\u0642\u0631\u0631\u0629 \u0627\u0644\u064A\u0648\u0645"),a()())}function Uq(n,t){if(n&1){let e=he();s(0,"div",94)(1,"div",95),b(2,"i",64),a(),s(3,"div",96)(4,"h4"),u(5),a(),s(6,"p",97),u(7),a(),s(8,"div",98)(9,"span",99),b(10,"i",19),u(11),ut(12,"currency"),a(),s(13,"span",100),b(14,"i",93),u(15),a()()(),s(16,"div",101)(17,"button",102),I("click",function(){let r=F(e).$implicit,o=E();return R(o.payForClass(r._id))}),b(18,"i",25),u(19," \u062F\u0641\u0639 "),a(),s(20,"button",103),I("click",function(){let r=F(e).$implicit,o=E();return R(o.sendPaymentReminder(r))}),b(21,"i",51),u(22," \u062A\u0630\u0643\u064A\u0631 "),a()()()}if(n&2){let e=t.$implicit;d(5),B(e.name),d(2),B(e.studentId),d(4),H(" \u0645\u062A\u0623\u062E\u0631: ",pt(12,4,e.amountDue,"DZD ")," "),d(4),H(" ",e.monthsLate," \u0623\u0634\u0647\u0631 ")}}function Lq(n,t){n&1&&(s(0,"div",92),b(1,"i",34),s(2,"p"),u(3,"\u0644\u0627 \u064A\u0648\u062C\u062F \u0637\u0644\u0627\u0628 \u0645\u062A\u0623\u062E\u0631\u064A\u0646 \u0641\u064A \u0627\u0644\u062F\u0641\u0639"),a()())}function Bq(n,t){if(n&1&&(s(0,"div",104)(1,"div",105),b(2,"i",14),a(),s(3,"div",106)(4,"p"),u(5),a(),s(6,"small"),u(7),ut(8,"date"),a()()()),n&2){let e=t.$implicit;Ie("success",e.type==="success")("error",e.type==="error")("warning",e.type==="warning"),d(2),Ie("fa-check-circle",e.type==="success")("fa-exclamation-circle",e.type==="error")("fa-exclamation-triangle",e.type==="warning"),d(3),B(e.message),d(2),B(pt(8,14,e.timestamp,"shortTime"))}}function Vq(n,t){n&1&&(s(0,"div",92),b(1,"i",107),s(2,"p"),u(3,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0625\u0634\u0639\u0627\u0631\u0627\u062A \u062C\u062F\u064A\u062F\u0629"),a()())}var J1=class n{constructor(t,e){this.http=t;this.router=e;this.todayDateString=this.today.toISOString().split("T")[0]}rfidBuffer="";rfidTimer=null;isRFIDInputActive=!1;rfidInputValue="";rfidStatus="Waiting for card...";apiUrl=Bt.apiUrl;dailyStats={income:0,expenses:0,profit:0,totalClasses:0};todayClasses=[];lateStudents=[];currentStudents={present:0,absent:0,late:[]};scannedStudent=null;isScanning=!1;scanInterval;today=new Date;todayDateString;notifications=[];rfidInput;ngOnInit(){this.loadDashboardData(),this.startRFIDScanning()}ngOnDestroy(){this.stopRFIDScanning(),this.cleanupRFIDListeners()}cleanupRFIDListeners(){this.rfidTimer&&clearTimeout(this.rfidTimer)}cacheExpiry=5*60*1e3;lastCacheTime=0;loadDashboardData(){let t=localStorage.getItem("token");this.http.get(`${Bt.apiUrl}/dashboard/daily-stats`).pipe(gi(e=>(console.error("Error loading dashboard stats:",e),this.showNotification("error","\u0641\u0634\u0644 \u062A\u062D\u0645\u064A\u0644 \u0628\u064A\u0627\u0646\u0627\u062A Dashboard"),bt({success:!1,dailyStats:this.dailyStats,currentStudents:this.currentStudents})))).subscribe({next:e=>{e.success&&(this.dailyStats=e.dailyStats,this.currentStudents=e.currentStudents)}}),this.loadTodayClasses(),this.loadLateStudents(),this.loadNotifications()}sendPaymentReminder(t){this.http.post(`${Bt.apiUrl}/students/${t._id}/send-reminder`,{message:`\u0639\u0632\u064A\u0632\u064A \u0648\u0644\u064A \u0623\u0645\u0631 \u0627\u0644\u0637\u0627\u0644\u0628 ${t.name}: \u0644\u062F\u064A\u0643 \u062F\u0641\u0639\u0627\u062A \u0645\u062A\u0623\u062E\u0631\u0629 \u0628\u0642\u064A\u0645\u0629 ${t.amountDue} \u062F\u062C. \u064A\u0631\u062C\u0649 \u0627\u0644\u062A\u0648\u0627\u0635\u0644 \u0645\u0639 \u0627\u0644\u0625\u062F\u0627\u0631\u0629.`}).subscribe({next:()=>{this.showNotification("success","\u062A\u0645 \u0625\u0631\u0633\u0627\u0644 \u062A\u0630\u0643\u064A\u0631 \u0627\u0644\u062F\u0641\u0639 \u0644\u0644\u0637\u0627\u0644\u0628")},error:e=>{console.error("Error sending reminder:",e),this.showNotification("error","\u0641\u0634\u0644 \u0625\u0631\u0633\u0627\u0644 \u0627\u0644\u062A\u0630\u0643\u064A\u0631")}})}loadDailyStats(){this.http.get(`${Bt.apiUrl}/accounting/daily-income`).subscribe({next:t=>{t.success&&(this.dailyStats.income=t.dailyIncome||0)},error:t=>{console.error("Error loading daily income:",t)}}),this.http.get(`${Bt.apiUrl}/accounting/today-expenses`).subscribe({next:t=>{this.dailyStats.expenses=t.total||0,this.dailyStats.profit=this.dailyStats.income-this.dailyStats.expenses},error:t=>{console.error("Error loading today expenses:",t)}}),this.http.get(`${Bt.apiUrl}/live-classes/today-count`).subscribe({next:t=>{this.dailyStats.totalClasses=t.count||0},error:t=>{console.error("Error loading today classes count:",t)}})}loadTodayClasses(){this.http.get(`${Bt.apiUrl}/live-classes/today`).subscribe({next:t=>{this.todayClasses=t,t.forEach(e=>{e.isScheduled||this.scheduleClass(e)})},error:t=>{console.error("Error loading today classes:",t)}})}loadLateStudents(){this.http.get(`${Bt.apiUrl}/students/late-payments`).subscribe({next:t=>{this.lateStudents=t},error:t=>{console.error("Error loading late students:",t)}})}loadCurrentStudents(){this.http.get(`${Bt.apiUrl}/attendance/today-stats`).subscribe({next:t=>{this.currentStudents=t},error:t=>{console.error("Error loading current students:",t)}})}loadNotifications(){this.http.get(`${Bt.apiUrl}/notifications`).subscribe({next:t=>{this.notifications=t},error:t=>{console.error("Error loading notifications:",t)}})}scheduleClass(t){this.http.post(`${Bt.apiUrl}/live-classes/schedule`,t).subscribe({next:e=>{console.log("Class scheduled:",e),this.showNotification("success","\u062A\u0645 \u062C\u062F\u0648\u0644\u0629 \u0627\u0644\u062D\u0635\u0629 \u0628\u0646\u062C\u0627\u062D")},error:e=>{console.error("Error scheduling class:",e),this.showNotification("error","\u0641\u0634\u0644 \u062C\u062F\u0648\u0644\u0629 \u0627\u0644\u062D\u0635\u0629")}})}startRFIDScanning(){this.isScanning=!0,this.rfidStatus="Waiting for card...",this.isRFIDInputActive=!0,setTimeout(()=>{this.rfidInput&&this.rfidInput.nativeElement.focus()},100)}stopRFIDScanning(){this.isScanning=!1,this.isRFIDInputActive=!1,this.rfidBuffer="",this.rfidInputValue="",this.rfidStatus="Scanning stopped",this.rfidTimer&&clearTimeout(this.rfidTimer)}handleKeyDown(t){if(!(!this.isRFIDInputActive||!this.isScanning)&&!(t.target.tagName==="INPUT"||t.target.tagName==="TEXTAREA")){if(this.rfidTimer&&clearTimeout(this.rfidTimer),t.key==="Enter"){t.preventDefault(),this.processRFIDInput();return}t.key.length===1&&!t.ctrlKey&&!t.altKey&&!t.metaKey&&(this.rfidBuffer+=t.key,this.rfidStatus="Reading...",this.rfidInputValue=this.rfidBuffer),this.rfidTimer=setTimeout(()=>{this.resetRFIDBuffer()},100)}}processRFIDInput(){if(this.rfidBuffer.length===0)return;let t=this.rfidBuffer;console.log("RFID UID:",t),this.rfidInputValue=t,this.rfidStatus="Card read successfully \u2714",this.processRFIDCard(t),setTimeout(()=>{this.resetRFIDBuffer()},2e3)}resetRFIDBuffer(){this.rfidBuffer="",this.rfidInputValue="",this.rfidStatus="Waiting for card...",this.rfidTimer&&(clearTimeout(this.rfidTimer),this.rfidTimer=null)}focusRFIDField(){this.isRFIDInputActive=!0,this.rfidStatus="Ready for scanning..."}blurRFIDField(){this.isScanning&&setTimeout(()=>{this.rfidInput&&this.rfidInput.nativeElement.focus()},50)}isProcessingRFID=!1;processRFIDCard(t){this.isProcessingRFID||(this.isProcessingRFID=!0,this.http.get(`${this.apiUrl}/cards/uid/${t}`).subscribe({next:e=>{e.student?(this.scannedStudent=e,this.showStudentCard(e),this.recordAttendance(e.student._id)):this.showUnknownCard(t),this.isProcessingRFID=!1},error:e=>{console.error("Error processing RFID card:",e),this.showNotification("error","\u062E\u0637\u0623 \u0641\u064A \u0645\u0639\u0627\u0644\u062C\u0629 \u0627\u0644\u0628\u0637\u0627\u0642\u0629"),this.rfidStatus="Error processing card",this.isProcessingRFID=!1}}))}showStudentCard(t){this.showNotification("success",`\u062A\u0645 \u0627\u0643\u062A\u0634\u0627\u0641 \u0627\u0644\u0637\u0627\u0644\u0628: ${t.student.name}`),this.rfidStatus=`Student detected: ${t.student.name}`,setTimeout(()=>{this.scannedStudent?.student?._id===t.student._id&&(this.scannedStudent=null)},1e4)}showUnknownCard(t){this.showNotification("warning",`\u0628\u0637\u0627\u0642\u0629 \u063A\u064A\u0631 \u0645\u0639\u0631\u0648\u0641\u0629: ${t}`),this.rfidStatus=`Unknown card: ${t}`}recordAttendance(t){let e={studentId:t,status:"present",timestamp:new Date};this.http.post(`${Bt.apiUrl}/attendance/record`,e).subscribe({next:i=>{console.log("Attendance recorded:",i)},error:i=>{console.error("Error recording attendance:",i)}})}simulateRFIDScan(){let t="RFID-"+Math.random().toString(36).substr(2,9);console.log("Simulating RFID scan:",t),this.processRFIDCard(t)}startSimulatedScan(){this.stopRFIDScanning(),this.isScanning=!0,this.rfidStatus="Simulation mode active",this.scanInterval=setInterval(()=>{this.simulateRFIDScan()},5e3)}goToStudentDetails(t){this.router.navigate(["/home/students-management",t])}payForClass(t,e){this.router.navigate(["/home/payments-management"],{queryParams:{studentId:t,classId:e}})}showNotification(t,e){let i={id:Date.now(),type:t,message:e,timestamp:new Date};this.notifications.unshift(i),setTimeout(()=>{this.notifications=this.notifications.filter(r=>r.id!==i.id)},5e3)}refreshData(){this.loadDashboardData(),this.showNotification("success","\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A")}exportDailyReport(){this.http.get(`/${Bt.apiUrl}/accounting/export-daily-report`,{responseType:"blob"}).subscribe({next:t=>{let e=window.URL.createObjectURL(t),i=document.createElement("a");i.href=e,i.download=`daily-report-${this.todayDateString}.xlsx`,i.click(),window.URL.revokeObjectURL(e)},error:t=>{console.error("Error exporting report:",t),this.showNotification("error","\u0641\u0634\u0644 \u062A\u0635\u062F\u064A\u0631 \u0627\u0644\u062A\u0642\u0631\u064A\u0631")}})}clearRFIDData(){this.resetRFIDBuffer(),this.scannedStudent=null,this.rfidStatus="Data cleared. Waiting for card..."}static \u0275fac=function(e){return new(e||n)(Ne(pn),Ne(ei))};static \u0275cmp=nn({type:n,selectors:[["app-dashboard"]],viewQuery:function(e,i){if(e&1&&mc(Tq,5),e&2){let r;Nl(r=Ul())&&(i.rfidInput=r.first)}},hostBindings:function(e,i){e&1&&I("keydown",function(o){return i.handleKeyDown(o)},!1,om)},decls:115,vars:33,consts:[[1,"dashboard-container"],[1,"dashboard-header"],[1,"fas","fa-tachometer-alt"],[1,"header-actions"],[1,"btn","btn-refresh",3,"click"],[1,"fas","fa-sync-alt"],[1,"btn","btn-export",3,"click"],[1,"fas","fa-file-export"],[1,"date-display"],[1,"fas","fa-calendar-day"],[1,"rfid-status"],[1,"rfid-indicator"],[1,"fas","fa-id-card"],[1,"btn","btn-rfid",3,"click"],[1,"fas"],["class","student-card-overlay",4,"ngIf"],[1,"stats-grid"],[1,"stat-card","income"],[1,"stat-icon"],[1,"fas","fa-money-bill-wave"],[1,"stat-content"],[1,"stat-amount"],[1,"stat-change","positive"],[1,"fas","fa-arrow-up"],[1,"stat-card","expenses"],[1,"fas","fa-credit-card"],[1,"stat-change","negative"],[1,"fas","fa-arrow-down"],[1,"stat-card","classes"],[1,"fas","fa-chalkboard-teacher"],[1,"stat-change"],[1,"fas","fa-clock"],[1,"stat-card","present"],[1,"fas","fa-user-check"],[1,"fas","fa-check-circle"],[1,"stat-card","absent"],[1,"fas","fa-user-times"],[1,"fas","fa-times-circle"],[1,"main-grid"],[1,"section-card"],[1,"section-header"],[1,"fas","fa-calendar-alt"],[1,"badge"],[1,"classes-list"],["class","class-item",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"fas","fa-exclamation-triangle"],[1,"badge","badge-warning"],[1,"late-students-list"],["class","late-student-item",4,"ngFor","ngForOf"],[1,"notifications-section"],[1,"fas","fa-bell"],[1,"badge","badge-info"],[1,"notifications-list"],["class","notification-item",3,"success","error","warning",4,"ngFor","ngForOf"],[1,"student-card-overlay"],[1,"student-card"],[1,"card-header"],[1,"fas","fa-user-graduate"],[1,"btn-close",3,"click"],[1,"fas","fa-times"],[1,"card-body"],[1,"student-info"],[1,"student-avatar"],[1,"fas","fa-user-circle"],[1,"student-details"],[1,"fas","fa-graduation-cap"],[1,"fas","fa-phone"],[1,"student-actions"],[1,"btn","btn-details",3,"click"],[1,"fas","fa-info-circle"],[1,"btn","btn-payment",3,"click"],[1,"btn","btn-attendance"],[1,"fas","fa-clipboard-check"],["class","student-classes",4,"ngIf"],[1,"student-classes"],["class","class-tag",4,"ngFor","ngForOf"],[1,"class-tag"],[1,"class-item"],[1,"class-info"],[1,"class-meta"],[1,"fas","fa-book"],[1,"fas","fa-user-tie"],[1,"fas","fa-door-open"],[1,"class-students"],[1,"fas","fa-users"],[1,"class-actions"],["class","btn btn-schedule",3,"click",4,"ngIf"],[1,"btn","btn-view",3,"routerLink","queryParams"],[1,"fas","fa-eye"],[1,"btn","btn-schedule",3,"click"],[1,"fas","fa-calendar-plus"],[1,"empty-state"],[1,"fas","fa-calendar-times"],[1,"late-student-item"],[1,"student-avatar-small"],[1,"student-details-small"],[1,"student-id"],[1,"late-info"],[1,"amount-due"],[1,"months-late"],[1,"student-actions-small"],[1,"btn","btn-pay-now",3,"click"],[1,"btn","btn-notify",3,"click"],[1,"notification-item"],[1,"notification-icon"],[1,"notification-content"],[1,"fas","fa-bell-slash"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"div",1)(2,"h1"),b(3,"i",2),u(4," \u0644\u0648\u062D\u0629 \u0627\u0644\u062A\u062D\u0643\u0645"),a(),s(5,"div",3)(6,"button",4),I("click",function(){return i.refreshData()}),b(7,"i",5),u(8," \u062A\u062D\u062F\u064A\u062B "),a(),s(9,"button",6),I("click",function(){return i.exportDailyReport()}),b(10,"i",7),u(11," \u062A\u0635\u062F\u064A\u0631 \u0627\u0644\u062A\u0642\u0631\u064A\u0631 "),a(),s(12,"div",8),b(13,"i",9),u(14),ut(15,"date"),a()()(),s(16,"div",10)(17,"div",11),b(18,"i",12),s(19,"span"),u(20),a()(),s(21,"button",13),I("click",function(){return i.isScanning?i.stopRFIDScanning():i.startRFIDScanning()}),b(22,"i",14),u(23),a()(),j(24,Fq,35,5,"div",15),s(25,"div",16)(26,"div",17)(27,"div",18),b(28,"i",19),a(),s(29,"div",20)(30,"h3"),u(31,"\u062F\u062E\u0644 \u0627\u0644\u064A\u0648\u0645"),a(),s(32,"div",21),u(33),ut(34,"currency"),a(),s(35,"div",22),b(36,"i",23),u(37," \u0625\u064A\u0631\u0627\u062F\u0627\u062A "),a()()(),s(38,"div",24)(39,"div",18),b(40,"i",25),a(),s(41,"div",20)(42,"h3"),u(43,"\u0645\u0635\u0631\u0648\u0641\u0627\u062A \u0627\u0644\u064A\u0648\u0645"),a(),s(44,"div",21),u(45),ut(46,"currency"),a(),s(47,"div",26),b(48,"i",27),u(49," \u0645\u0635\u0627\u0631\u064A\u0641 "),a()()(),s(50,"div",28)(51,"div",18),b(52,"i",29),a(),s(53,"div",20)(54,"h3"),u(55,"\u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u064A\u0648\u0645"),a(),s(56,"div",21),u(57),a(),s(58,"div",30),b(59,"i",31),u(60," \u062D\u0635\u0635 "),a()()(),s(61,"div",32)(62,"div",18),b(63,"i",33),a(),s(64,"div",20)(65,"h3"),u(66,"\u0627\u0644\u062D\u0627\u0636\u0631\u064A\u0646"),a(),s(67,"div",21),u(68),a(),s(69,"div",22),b(70,"i",34),u(71," \u062D\u0627\u0636\u0631 "),a()()(),s(72,"div",35)(73,"div",18),b(74,"i",36),a(),s(75,"div",20)(76,"h3"),u(77,"\u0627\u0644\u063A\u0627\u0626\u0628\u064A\u0646"),a(),s(78,"div",21),u(79),a(),s(80,"div",26),b(81,"i",37),u(82," \u063A\u0627\u0626\u0628 "),a()()()(),s(83,"div",38)(84,"div",39)(85,"div",40)(86,"h2"),b(87,"i",41),u(88," \u0627\u0644\u062D\u0635\u0635 \u0627\u0644\u0645\u0642\u0631\u0631\u0629 \u0627\u0644\u064A\u0648\u0645"),a(),s(89,"span",42),u(90),a()(),s(91,"div",43),j(92,kq,25,12,"div",44)(93,Nq,4,0,"div",45),a()(),s(94,"div",39)(95,"div",40)(96,"h2"),b(97,"i",46),u(98," \u0627\u0644\u0637\u0644\u0627\u0628 \u0627\u0644\u0645\u062A\u0623\u062E\u0631\u064A\u0646 \u0641\u064A \u0627\u0644\u062F\u0641\u0639"),a(),s(99,"span",47),u(100),a()(),s(101,"div",48),j(102,Uq,23,7,"div",49)(103,Lq,4,0,"div",45),a()()(),s(104,"div",50)(105,"div",39)(106,"div",40)(107,"h2"),b(108,"i",51),u(109," \u0627\u0644\u0625\u0634\u0639\u0627\u0631\u0627\u062A \u0648\u0627\u0644\u062A\u0646\u0628\u064A\u0647\u0627\u062A"),a(),s(110,"span",52),u(111),a()(),s(112,"div",53),j(113,Bq,9,17,"div",54)(114,Vq,4,0,"div",45),a()()()()),e&2&&(d(14),H(" ",pt(15,24,i.today,"fullDate")," "),d(2),Ie("scanning",i.isScanning),d(4),H("RFID ",i.isScanning?"\u062C\u0627\u0631\u064D \u0627\u0644\u0645\u0633\u062D...":"\u0645\u062A\u0648\u0642\u0641",""),d(2),Ie("fa-stop",i.isScanning)("fa-play",!i.isScanning),d(),H(" ",i.isScanning?"\u0625\u064A\u0642\u0627\u0641 \u0627\u0644\u0645\u0633\u062D":"\u0628\u062F\u0621 \u0627\u0644\u0645\u0633\u062D"," "),d(),w("ngIf",i.scannedStudent),d(9),B(pt(34,27,i.dailyStats.income,"DZD ")),d(12),B(pt(46,30,i.dailyStats.expenses,"DZD ")),d(12),B(i.dailyStats.totalClasses),d(11),B(i.currentStudents.present),d(11),B(i.currentStudents.absent),d(11),B(i.todayClasses.length),d(2),w("ngForOf",i.todayClasses),d(),w("ngIf",i.todayClasses.length===0),d(7),B(i.lateStudents.length),d(2),w("ngForOf",i.lateStudents),d(),w("ngIf",i.lateStudents.length===0),d(8),B(i.notifications.length),d(2),w("ngForOf",i.notifications),d(),w("ngIf",i.notifications.length===0))},dependencies:[hn,Nn,An,D0,qr,Un],styles:[".dashboard-container[_ngcontent-%COMP%]{direction:rtl;font-family:Cairo,Segoe UI,sans-serif;background:#f4f6fb;min-height:100vh;padding:20px;color:#1f2937}h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%]{margin:0}.dashboard-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4f46e5,#6366f1);color:#fff;padding:20px 24px;border-radius:18px;display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:14px;box-shadow:0 20px 40px #00000026}.dashboard-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:22px;display:flex;gap:10px;align-items:center}.header-actions[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.date-display[_ngcontent-%COMP%]{background:#ffffff26;padding:8px 14px;border-radius:999px;font-size:13px}.btn[_ngcontent-%COMP%]{padding:10px 16px;border-radius:12px;border:none;cursor:pointer;font-family:inherit;display:flex;gap:6px;align-items:center;transition:.25s ease;font-size:14px}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.btn-refresh[_ngcontent-%COMP%]{background:#22c55e;color:#fff}.btn-export[_ngcontent-%COMP%]{background:#0ea5e9;color:#fff}.btn-rfid[_ngcontent-%COMP%]{background:#111827;color:#fff}.btn-details[_ngcontent-%COMP%]{background:#eef2ff;color:#4338ca}.btn-payment[_ngcontent-%COMP%]{background:#ecfeff;color:#0369a1}.btn-attendance[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.rfid-status[_ngcontent-%COMP%]{margin:18px 0;background:#fff;padding:16px 20px;border-radius:16px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 10px 30px #00000014}.rfid-status.scanning[_ngcontent-%COMP%]{border-right:5px solid #22c55e}.rfid-indicator[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;font-weight:600}.student-card-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0f172a8c;display:flex;align-items:center;justify-content:center;z-index:9999}.student-card[_ngcontent-%COMP%]{background:#fff;width:100%;max-width:520px;border-radius:18px;overflow:hidden;animation:_ngcontent-%COMP%_scaleIn .25s ease}@keyframes _ngcontent-%COMP%_scaleIn{0%{transform:scale(.95);opacity:0}to{transform:scale(1);opacity:1}}.card-header[_ngcontent-%COMP%]{padding:16px 20px;background:#f9fafb;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center}.btn-close[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b;border-radius:10px;width:34px;height:34px}.card-body[_ngcontent-%COMP%]{padding:20px}.student-info[_ngcontent-%COMP%]{display:flex;gap:14px;align-items:center}.student-avatar[_ngcontent-%COMP%]{font-size:48px;color:#6366f1}.student-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:13px;color:#4b5563}.student-actions[_ngcontent-%COMP%]{margin-top:16px;display:flex;gap:8px}.student-classes[_ngcontent-%COMP%]{margin-top:16px}.class-tag[_ngcontent-%COMP%]{background:#eef2ff;color:#4338ca;padding:4px 10px;border-radius:999px;font-size:12px;margin:4px;display:inline-block}.stats-grid[_ngcontent-%COMP%]{margin:24px 0;display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:18px}.stat-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;padding:18px;display:flex;gap:14px;box-shadow:0 10px 30px #00000014}.stat-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:14px;display:flex;align-items:center;justify-content:center;color:#fff}.income[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#22c55e}.expenses[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#ef4444}.classes[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#6366f1}.present[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#10b981}.absent[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:#f97316}.stat-amount[_ngcontent-%COMP%]{font-size:22px;font-weight:700}.main-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr;gap:20px}@media (max-width: 992px){.main-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}}.section-card[_ngcontent-%COMP%]{background:#fff;border-radius:18px;padding:18px;box-shadow:0 10px 30px #00000014}.section-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:14px}.badge[_ngcontent-%COMP%]{background:#eef2ff;color:#4338ca;padding:4px 10px;border-radius:999px;font-size:12px}.class-item[_ngcontent-%COMP%]{padding:14px;border-radius:14px;background:#f9fafb;margin-bottom:10px;display:flex;justify-content:space-between;gap:10px}.class-meta[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;margin-left:10px}.late-student-item[_ngcontent-%COMP%]{display:flex;gap:10px;padding:12px;border-radius:14px;background:#fff7ed;margin-bottom:10px}.notification-item[_ngcontent-%COMP%]{display:flex;gap:12px;padding:12px;border-radius:14px;margin-bottom:10px;background:#f9fafb}.notification-item.success[_ngcontent-%COMP%]{border-right:4px solid #22c55e}.notification-item.error[_ngcontent-%COMP%]{border-right:4px solid #ef4444}.notification-item.warning[_ngcontent-%COMP%]{border-right:4px solid #f59e0b}.empty-state[_ngcontent-%COMP%]{text-align:center;color:#6b7280;padding:30px}"]})};$();var Hq=()=>[];function zq(n,t){n&1&&(s(0,"div",7),b(1,"div",8),s(2,"p"),u(3,"\u062C\u0627\u0631\u064A \u062A\u062D\u0645\u064A\u0644 \u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u062D\u0635\u0629..."),a()())}function jq(n,t){if(n&1){let e=he();s(0,"div",9)(1,"div",10),b(2,"i",11),a(),s(3,"h3"),u(4,"\u0627\u0644\u062D\u0635\u0629 \u063A\u064A\u0631 \u0645\u0648\u062C\u0648\u062F\u0629"),a(),s(5,"p"),u(6,"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u0639\u062B\u0648\u0631 \u0639\u0644\u0649 \u0627\u0644\u062D\u0635\u0629 \u0627\u0644\u0645\u0637\u0644\u0648\u0628\u0629"),a(),s(7,"button",12),I("click",function(){F(e);let r=E();return R(r.goBack())}),u(8," \u0627\u0644\u0639\u0648\u062F\u0629 \u0644\u0644\u062D\u0635\u0635 "),a()()}}function Wq(n,t){if(n&1&&(s(0,"div",54),b(1,"i",55),u(2),a()),n&2){let e=E(4);d(2),H(" ",e.lesson.teacher.phone," ")}}function Gq(n,t){if(n&1&&(s(0,"div",54),b(1,"i",56),u(2),a()),n&2){let e=E(4);d(2),H(" ",e.lesson.teacher.email," ")}}function $q(n,t){if(n&1&&(s(0,"div",48)(1,"div",49),b(2,"i",50),a(),s(3,"div",51)(4,"h4"),u(5),a(),s(6,"div",52),j(7,Wq,3,1,"div",53)(8,Gq,3,1,"div",53),a()()()),n&2){let e=E(3);d(5),B(e.lesson.teacher.name),d(2),w("ngIf",e.lesson.teacher.phone),d(),w("ngIf",e.lesson.teacher.email)}}function Yq(n,t){n&1&&(s(0,"div",57)(1,"p"),u(2,"\u0644\u0645 \u064A\u062A\u0645 \u062A\u0639\u064A\u064A\u0646 \u0645\u062F\u0631\u0633 \u0644\u0647\u0630\u0647 \u0627\u0644\u062D\u0635\u0629"),a()())}function qq(n,t){if(n&1&&(s(0,"div",58),u(1),a()),n&2){let e=E(3);d(),H(" ",e.lesson.description," ")}}function Xq(n,t){n&1&&(s(0,"div",59)(1,"p"),u(2,"\u0644\u0627 \u064A\u0648\u062C\u062F \u0648\u0635\u0641 \u0644\u0647\u0630\u0647 \u0627\u0644\u062D\u0635\u0629"),a()())}function Zq(n,t){if(n&1&&(s(0,"span",75),u(1),a()),n&2){let e=E().$implicit,i=E(5);d(),H(" - ",i.formatPrice(e.payment.amount)," ")}}function Jq(n,t){if(n&1&&(s(0,"div",71)(1,"span",72),u(2),a(),s(3,"span",73),u(4),j(5,Zq,2,1,"span",74),a()()),n&2){let e=t.$implicit,i=E(5);d(2),B(e.student.name),d(),Kn(i.getStatusBadgeClass(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(),w("ngIf",e.payment)}}function Kq(n,t){if(n&1&&(s(0,"div",62)(1,"div",63)(2,"h4"),u(3),a(),s(4,"span",64),u(5),a()(),s(6,"div",65)(7,"div",66)(8,"span",31),u(9,"\u0645\u062F\u0641\u0648\u0639"),a(),s(10,"span",30),u(11),a()(),s(12,"div",67)(13,"span",31),u(14,"\u0645\u0639\u0644\u0642"),a(),s(15,"span",30),u(16),a()(),s(17,"div",68)(18,"span",31),u(19,"\u0645\u062A\u0623\u062E\u0631"),a(),s(20,"span",30),u(21),a()()(),s(22,"div",69),j(23,Jq,6,5,"div",70),a()()),n&2){let e=t.$implicit,i=E(4);d(3),B(e.month),d(2),B(i.formatPrice(e.totalAmount)),d(6),B(i.formatPrice(e.paidAmount)),d(5),B(i.formatPrice(e.pendingAmount)),d(5),B(i.formatPrice(e.lateAmount)),d(2),w("ngForOf",e.students)}}function Qq(n,t){if(n&1&&(s(0,"div",60),j(1,Kq,24,6,"div",61),a()),n&2){let e=E(3);d(),w("ngForOf",e.monthlySummaries)}}function eX(n,t){n&1&&(s(0,"div",76)(1,"p"),u(2,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0645\u0633\u062C\u0644\u0629"),a()())}function tX(n,t){if(n&1&&(s(0,"div",36)(1,"div",37)(2,"div",38)(3,"div",39)(4,"h3"),u(5,"\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u0645\u062F\u0631\u0633"),a()(),s(6,"div",40),j(7,$q,9,3,"div",41)(8,Yq,3,0,"div",42),a()(),s(9,"div",38)(10,"div",39)(11,"h3"),u(12,"\u0627\u0644\u0648\u0635\u0641"),a()(),s(13,"div",40),j(14,qq,2,1,"div",43)(15,Xq,3,0,"div",44),a()(),s(16,"div",45)(17,"div",39)(18,"h3"),u(19,"\u0645\u0644\u062E\u0635 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0627\u0644\u0634\u0647\u0631\u064A\u0629"),a()(),s(20,"div",40),j(21,Qq,2,1,"div",46)(22,eX,3,0,"div",47),a()()()()),n&2){let e=E(2);d(7),w("ngIf",e.lesson.teacher),d(),w("ngIf",!e.lesson.teacher),d(6),w("ngIf",e.lesson.description),d(),w("ngIf",!e.lesson.description),d(6),w("ngIf",e.monthlySummaries.length>0),d(),w("ngIf",e.monthlySummaries.length===0)}}function nX(n,t){if(n&1){let e=he();s(0,"div",81)(1,"div",82),b(2,"i",83),a(),s(3,"h3"),u(4,"\u0644\u0627 \u064A\u0648\u062C\u062F \u0637\u0644\u0627\u0628"),a(),s(5,"p"),u(6,"\u0644\u0645 \u064A\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0623\u064A \u0637\u0644\u0627\u0628 \u0641\u064A \u0647\u0630\u0647 \u0627\u0644\u062D\u0635\u0629 \u0628\u0639\u062F"),a(),s(7,"button",12),I("click",function(){F(e);let r=E(3);return R(r.openAddStudentModal())}),b(8,"i",25),u(9," \u0625\u0636\u0627\u0641\u0629 \u0637\u0627\u0644\u0628 "),a()()}}function iX(n,t){if(n&1&&(s(0,"div",107)(1,"span",108),u(2),a(),s(3,"span",73),u(4),s(5,"span",75),u(6),a()()()),n&2){let e=t.$implicit,i=E(5);d(2),B(e.month),d(),Kn(i.getStatusBadgeClass(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(2),B(i.formatPrice(e.amount))}}function rX(n,t){n&1&&(s(0,"div",109),u(1," \u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A "),a())}function oX(n,t){if(n&1){let e=he();s(0,"div",86)(1,"div",87)(2,"div",88),b(3,"i",89),a(),s(4,"div",90)(5,"h4"),u(6),a(),s(7,"p",91),u(8),a()(),s(9,"div",92)(10,"button",93),I("click",function(){let r=F(e).$implicit,o=E(4);return R(o.openStudentDetailsModal(r))}),b(11,"i",94),a(),s(12,"button",95),I("click",function(r){let o=F(e).$implicit;return E(4).removeStudent(o._id),R(r.stopPropagation())}),b(13,"i",96),a()()(),s(14,"div",97)(15,"div",98)(16,"span",99),u(17,"\u0627\u0644\u0633\u0646\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629:"),a(),s(18,"span",100),u(19),a()(),s(20,"div",98)(21,"span",99),u(22,"\u0647\u0627\u062A\u0641 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631:"),a(),s(23,"span",100),u(24),a()(),s(25,"div",98)(26,"span",99),u(27,"\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A:"),a(),s(28,"span",100),u(29),a()()(),s(30,"div",101)(31,"div",102)(32,"h5"),u(33,"\u0622\u062E\u0631 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A"),a(),s(34,"button",103),I("click",function(){let r=F(e).$implicit,o=E(4);return R(o.openMakePaymentModal(r))}),u(35," \u062A\u0633\u062C\u064A\u0644 \u062F\u0641\u0639\u0629 "),a()(),s(36,"div",104),j(37,iX,7,5,"div",105)(38,rX,2,0,"div",106),a()()()}if(n&2){let e=t.$implicit,i=E(4);d(6),B(e.name),d(2),H("\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628: ",e.studentId,""),d(11),B(e.academicYear),d(5),B(e.parentPhone),d(5),B(e.parentEmail),d(8),w("ngForOf",i.getStudentPayments(e._id).slice(0,2)),d(),w("ngIf",i.getStudentPayments(e._id).length===0)}}function sX(n,t){if(n&1&&(s(0,"div",84),j(1,oX,39,7,"div",85),a()),n&2){let e=E(3);d(),w("ngForOf",e.paginatedStudents)}}function aX(n,t){if(n&1){let e=he();s(0,"button",117),I("click",function(){let r=F(e).$implicit,o=E(4);return R(o.goToPage(r))}),u(1),a()}if(n&2){let e=t.$implicit,i=E(4);Ie("active",e===i.currentPage),d(),H(" ",e," ")}}function lX(n,t){if(n&1){let e=he();s(0,"div",110)(1,"button",111),I("click",function(){F(e);let r=E(3);return R(r.prevPage())}),b(2,"i",112),a(),s(3,"div",113),j(4,aX,2,3,"button",114),a(),s(5,"button",111),I("click",function(){F(e);let r=E(3);return R(r.nextPage())}),b(6,"i",115),a(),s(7,"div",116),u(8),a()()}if(n&2){let e=E(3);d(),w("disabled",e.currentPage===1),d(3),w("ngForOf",e.getPages()),d(),w("disabled",e.currentPage===e.totalPages),d(3),Qi(" \u0639\u0631\u0636 ",(e.currentPage-1)*e.itemsPerPage+1,"-",e.Math.min(e.currentPage*e.itemsPerPage,e.lesson.students.length)," \u0645\u0646 ",e.lesson.students.length," ")}}function uX(n,t){if(n&1&&(s(0,"div",36)(1,"div",77),j(2,nX,10,0,"div",78)(3,sX,2,1,"div",79)(4,lX,9,6,"div",80),a()()),n&2){let e=E(2);d(2),w("ngIf",e.lesson.students.length===0),d(),w("ngIf",e.lesson.students.length>0),d(),w("ngIf",e.lesson.students.length>0&&e.totalPages>1)}}function cX(n,t){if(n&1&&(s(0,"div",135)(1,"div",136)(2,"div",30),u(3),ut(4,"currency"),a(),s(5,"div",31),u(6,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0645\u0628\u0644\u063A"),a()(),s(7,"div",136)(8,"div",30),u(9),ut(10,"currency"),a(),s(11,"div",31),u(12,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639"),a()(),s(13,"div",136)(14,"div",30),u(15),ut(16,"currency"),a(),s(17,"div",31),u(18,"\u0627\u0644\u0645\u0639\u0644\u0642"),a()(),s(19,"div",136)(20,"div",30),u(21),a(),s(22,"div",31),u(23,"\u0646\u0633\u0628\u0629 \u0627\u0644\u062F\u0641\u0639"),a()()()),n&2){let e=E(4);d(3),B(pt(4,4,e.getMonthTotalAmount(),"\u062F.\u062C ")),d(6),B(pt(10,7,e.getMonthPaidAmount(),"\u062F.\u062C ")),d(6),B(pt(16,10,e.getMonthPendingAmount(),"\u062F.\u062C ")),d(6),H("",e.getMonthPaidPercentage(),"%")}}function dX(n,t){if(n&1&&(s(0,"span",75),u(1),ut(2,"currency"),a()),n&2){let e,i=E().$implicit,r=E(5);d(),H(" ",pt(2,1,(e=r.getStudentPayment(i._id))==null?null:e.amount,"\u062F.\u062C ")," ")}}function fX(n,t){if(n&1){let e=he();s(0,"button",146),I("click",function(){F(e);let r=E().$implicit,o=E(5);return R(o.openMakePaymentModal(r))}),b(1,"i",27),a()}}function hX(n,t){if(n&1){let e=he();s(0,"div",139)(1,"div",90)(2,"div",140),u(3),a(),s(4,"div",97)(5,"h5"),u(6),a(),s(7,"p",91),u(8),a()()(),s(9,"div",73)(10,"span",141),u(11),a(),j(12,dX,3,4,"span",74),a(),s(13,"div",142),j(14,fX,2,0,"button",143),s(15,"button",144),I("click",function(){let r=F(e).$implicit,o=E(5);return R(o.openStudentPaymentHistory(r))}),b(16,"i",145),a()()()}if(n&2){let e=t.$implicit,i=E(5);Ie("paid",i.getStudentPaymentStatus(e._id)==="paid")("pending",i.getStudentPaymentStatus(e._id)==="pending")("late",i.getStudentPaymentStatus(e._id)==="late")("not-paid",i.getStudentPaymentStatus(e._id)==="not-paid"),d(3),H(" ",e.name.charAt(0)," "),d(3),B(e.name),d(2),B(e.studentId),d(2),Kn(i.getStatusBadgeClass(i.getStudentPaymentStatus(e._id))),d(),H(" ",i.getStatusText(i.getStudentPaymentStatus(e._id))," "),d(),w("ngIf",i.getStudentPayment(e._id)),d(2),w("ngIf",i.getStudentPaymentStatus(e._id)!=="paid")}}function pX(n,t){if(n&1&&(s(0,"div",137)(1,"h4"),u(2),ut(3,"date"),a(),s(4,"div",84),j(5,hX,17,16,"div",138),a()()),n&2){let e=E(4);d(2),H("\u062D\u0627\u0644\u0629 \u062F\u0641\u0639 \u0627\u0644\u0637\u0644\u0627\u0628 \u0644\u0644\u0634\u0647\u0631 ",pt(3,2,e.selectedMonth,"MMMM yyyy"),""),d(3),w("ngForOf",(e.lesson==null?null:e.lesson.students)||Ll(5,Hq))}}function mX(n,t){n&1&&(s(0,"p"),u(1,"\u0644\u0645 \u064A\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0623\u064A \u062F\u0641\u0639\u0627\u062A \u0644\u0647\u0630\u0627 \u0627\u0644\u0634\u0647\u0631"),a())}function gX(n,t){n&1&&(s(0,"p"),u(1,"\u0644\u0645 \u064A\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0623\u064A \u062F\u0641\u0639\u0627\u062A \u0644\u0647\u0630\u0647 \u0627\u0644\u062D\u0635\u0629"),a())}function _X(n,t){if(n&1){let e=he();s(0,"div",147)(1,"div",82),b(2,"i",27),a(),s(3,"h3"),u(4,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A"),a(),j(5,mX,2,0,"p",148)(6,gX,2,0,"p",148),s(7,"button",12),I("click",function(){F(e);let r=E(4);return R(r.openMakePaymentModal())}),b(8,"i",25),u(9," \u062A\u0633\u062C\u064A\u0644 \u062F\u0641\u0639\u0629 \u062C\u062F\u064A\u062F\u0629 "),a()()}if(n&2){let e=E(4);d(5),w("ngIf",e.selectedMonth),d(),w("ngIf",!e.selectedMonth)}}function vX(n,t){if(n&1){let e=he();s(0,"button",162),I("click",function(){F(e);let r=E().$implicit,o=E(5);return R(o.markPaymentAsPaid(r._id))}),b(1,"i",163),a()}}function yX(n,t){if(n&1){let e=he();s(0,"tr")(1,"td")(2,"div",152)(3,"div",72),u(4),a(),s(5,"div",91),u(6),a()()(),s(7,"td")(8,"div",153),u(9),s(10,"span",154),u(11),a()()(),s(12,"td",155),u(13),a(),s(14,"td"),u(15),a(),s(16,"td"),u(17),a(),s(18,"td")(19,"span",141),u(20),a()(),s(21,"td",156)(22,"div",157),j(23,vX,2,0,"button",158),s(24,"button",159),I("click",function(){let r=F(e).$implicit,o=E(5);return R(o.openStudentDetailsModal(r.student))}),b(25,"i",94),a(),s(26,"button",160),I("click",function(){let r=F(e).$implicit,o=E(5);return R(o.printReceipt(r))}),b(27,"i",161),a()()()()}if(n&2){let e=t.$implicit,i=E(5);d(4),B(e.student.name),d(2),B(e.student.studentId),d(3),H(" ",i.formatMonth(e.month)," "),d(2),B(i.getYearFromMonth(e.month)),d(2),B(i.formatPrice(e.amount)),d(2),B(e.paymentMethod||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(2),B(i.formatDate(e.paymentDate)),d(2),Kn(i.getStatusBadgeClass(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(3),w("ngIf",e.status!=="paid")}}function xX(n,t){if(n&1){let e=he();s(0,"button",117),I("click",function(){let r=F(e).$implicit,o=E(6);return R(o.goToPage(r))}),u(1),a()}if(n&2){let e=t.$implicit,i=E(6);Ie("active",e===i.currentPage),d(),H(" ",e," ")}}function bX(n,t){if(n&1){let e=he();s(0,"div",110)(1,"button",111),I("click",function(){F(e);let r=E(5);return R(r.prevPage())}),b(2,"i",112),a(),s(3,"div",113),j(4,xX,2,3,"button",114),a(),s(5,"button",111),I("click",function(){F(e);let r=E(5);return R(r.nextPage())}),b(6,"i",115),a()()}if(n&2){let e=E(5);d(),w("disabled",e.currentPage===1),d(3),w("ngForOf",e.getPages()),d(),w("disabled",e.currentPage===e.totalPages)}}function CX(n,t){if(n&1&&(s(0,"div",149)(1,"table",150)(2,"thead")(3,"tr")(4,"th"),u(5,"\u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(6,"th"),u(7,"\u0627\u0644\u0634\u0647\u0631"),a(),s(8,"th"),u(9,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(10,"th"),u(11,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(12,"th"),u(13,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639"),a(),s(14,"th"),u(15,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(16,"th"),u(17,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(18,"tbody"),j(19,yX,28,11,"tr",151),a()(),j(20,bX,7,3,"div",80),a()),n&2){let e=E(4);d(19),w("ngForOf",e.paginatedPayments),d(),w("ngIf",e.totalPages>1)}}function EX(n,t){if(n&1){let e=he();s(0,"div",36)(1,"div",121)(2,"div",122)(3,"h4"),u(4,"\u0641\u0644\u062A\u0631\u0629 \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u062D\u0633\u0628 \u0627\u0644\u0634\u0647\u0631"),a()(),s(5,"div",123)(6,"div",124)(7,"label",125),u(8,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0634\u0647\u0631:"),a(),s(9,"input",126),ye("ngModelChange",function(r){F(e);let o=E(3);return Ce(o.selectedMonth,r)||(o.selectedMonth=r),R(r)}),I("ngModelChange",function(){F(e);let r=E(3);return R(r.onMonthFilterChange())}),a()(),s(10,"div",127)(11,"button",128),I("click",function(){F(e);let r=E(3);return R(r.selectMonth("current"))}),u(12," \u0627\u0644\u0634\u0647\u0631 \u0627\u0644\u062D\u0627\u0644\u064A "),a(),s(13,"button",128),I("click",function(){F(e);let r=E(3);return R(r.selectMonth("previous"))}),u(14," \u0627\u0644\u0634\u0647\u0631 \u0627\u0644\u0645\u0627\u0636\u064A "),a(),s(15,"button",128),I("click",function(){F(e);let r=E(3);return R(r.selectMonth("next"))}),u(16," \u0627\u0644\u0634\u0647\u0631 \u0627\u0644\u0642\u0627\u062F\u0645 "),a(),s(17,"button",128),I("click",function(){F(e);let r=E(3);return R(r.selectMonth("all"))}),u(18," \u0639\u0631\u0636 \u0627\u0644\u0643\u0644 "),a()()(),j(19,cX,24,13,"div",129),a(),s(20,"div",118)(21,"button",12),I("click",function(){F(e);let r=E(3);return R(r.openMakePaymentModal())}),b(22,"i",25),u(23," \u062A\u0633\u062C\u064A\u0644 \u062F\u0641\u0639\u0629 \u062C\u062F\u064A\u062F\u0629 "),a(),s(24,"div",130)(25,"span",131)(26,"span",132),u(27,"\u0627\u0644\u0645\u062C\u0645\u0648\u0639:"),a(),s(28,"span",133),u(29),ut(30,"currency"),a()(),s(31,"span",131)(32,"span",132),u(33,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639:"),a(),s(34,"span",133),u(35),ut(36,"currency"),a()()()(),j(37,pX,6,6,"div",134)(38,_X,10,2,"div",119)(39,CX,21,2,"div",120),a()}if(n&2){let e=E(3);d(9),ve("ngModel",e.selectedMonth),d(2),Ie("active",e.selectedMonth===e.getCurrentMonth()),d(2),Ie("active",e.selectedMonth===e.getPreviousMonth()),d(2),Ie("active",e.selectedMonth===e.getNextMonth()),d(2),Ie("active",e.selectedMonth===""),d(2),w("ngIf",e.selectedMonth),d(10),B(pt(30,15,e.getFilteredPaymentsTotal(),"\u062F.\u062C ")),d(6),B(pt(36,18,e.getFilteredPaidTotal(),"\u062F.\u062C ")),d(2),w("ngIf",e.selectedMonth),d(),w("ngIf",e.filteredPayments.length===0),d(),w("ngIf",e.filteredPayments.length>0)}}function wX(n,t){n&1&&(s(0,"div",147)(1,"div",82),b(2,"i",27),a(),s(3,"h3"),u(4,"\u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A"),a(),s(5,"p"),u(6,"\u0644\u0645 \u064A\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0623\u064A \u062F\u0641\u0639\u0627\u062A \u0644\u0647\u0630\u0647 \u0627\u0644\u062D\u0635\u0629"),a()())}function SX(n,t){if(n&1){let e=he();s(0,"button",162),I("click",function(){F(e);let r=E().$implicit,o=E(4);return R(o.markPaymentAsPaid(r._id))}),b(1,"i",163),a()}}function MX(n,t){if(n&1){let e=he();s(0,"tr")(1,"td")(2,"div",152)(3,"div",72),u(4),a(),s(5,"div",91),u(6),a()()(),s(7,"td"),u(8),a(),s(9,"td",155),u(10),a(),s(11,"td"),u(12),a(),s(13,"td"),u(14),a(),s(15,"td")(16,"span",141),u(17),a()(),s(18,"td",156)(19,"div",157),j(20,SX,2,0,"button",158),s(21,"button",159),I("click",function(){let r=F(e).$implicit,o=E(4);return R(o.openStudentDetailsModal(r.student))}),b(22,"i",94),a()()()()}if(n&2){let e=t.$implicit,i=E(4);d(4),B(e.student.name),d(2),B(e.student.studentId),d(2),B(e.month),d(2),B(i.formatPrice(e.amount)),d(2),B(e.paymentMethod||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(2),B(i.formatDate(e.paymentDate)),d(2),Kn(i.getStatusBadgeClass(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(3),w("ngIf",e.status!=="paid")}}function AX(n,t){if(n&1){let e=he();s(0,"button",117),I("click",function(){let r=F(e).$implicit,o=E(5);return R(o.goToPage(r))}),u(1),a()}if(n&2){let e=t.$implicit,i=E(5);Ie("active",e===i.currentPage),d(),H(" ",e," ")}}function TX(n,t){if(n&1){let e=he();s(0,"div",110)(1,"button",111),I("click",function(){F(e);let r=E(4);return R(r.prevPage())}),b(2,"i",112),a(),s(3,"div",113),j(4,AX,2,3,"button",114),a(),s(5,"button",111),I("click",function(){F(e);let r=E(4);return R(r.nextPage())}),b(6,"i",115),a()()}if(n&2){let e=E(4);d(),w("disabled",e.currentPage===1),d(3),w("ngForOf",e.getPages()),d(),w("disabled",e.currentPage===e.totalPages)}}function DX(n,t){if(n&1&&(s(0,"div",149)(1,"table",150)(2,"thead")(3,"tr")(4,"th"),u(5,"\u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(6,"th"),u(7,"\u0627\u0644\u0634\u0647\u0631"),a(),s(8,"th"),u(9,"\u0627\u0644\u0645\u0628\u0644\u063A"),a(),s(10,"th"),u(11,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(12,"th"),u(13,"\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639"),a(),s(14,"th"),u(15,"\u0627\u0644\u062D\u0627\u0644\u0629"),a(),s(16,"th"),u(17,"\u0627\u0644\u0625\u062C\u0631\u0627\u0621\u0627\u062A"),a()()(),s(18,"tbody"),j(19,MX,23,10,"tr",151),a()(),j(20,TX,7,3,"div",80),a()),n&2){let e=E(3);d(19),w("ngForOf",e.paginatedPayments),d(),w("ngIf",e.totalPages>1)}}function PX(n,t){if(n&1){let e=he();s(0,"div",36),j(1,EX,40,21,"div",35),s(2,"div",118)(3,"button",12),I("click",function(){F(e);let r=E(2);return R(r.openMakePaymentModal())}),b(4,"i",25),u(5," \u062A\u0633\u062C\u064A\u0644 \u062F\u0641\u0639\u0629 \u062C\u062F\u064A\u062F\u0629 "),a()(),j(6,wX,7,0,"div",119)(7,DX,21,2,"div",120),a()}if(n&2){let e=E(2);d(),w("ngIf",e.activeTab==="payments"),d(5),w("ngIf",e.payments.length===0),d(),w("ngIf",e.payments.length>0)}}function IX(n,t){n&1&&(s(0,"div",167)(1,"div",82),b(2,"i",168),a(),s(3,"h3"),u(4,"\u0644\u0627 \u064A\u0648\u062C\u062F \u062C\u062F\u0648\u0644"),a(),s(5,"p"),u(6,"\u0644\u0645 \u064A\u062A\u0645 \u062A\u0639\u064A\u064A\u0646 \u062C\u062F\u0648\u0644 \u0632\u0645\u0646\u064A \u0644\u0647\u0630\u0647 \u0627\u0644\u062D\u0635\u0629"),a()())}function OX(n,t){if(n&1&&(s(0,"div",98),b(1,"i",177),s(2,"span"),u(3),a()()),n&2){let e=E().$implicit;d(3),H("\u0627\u0644\u0642\u0627\u0639\u0629: ",e.classroom.name,"")}}function FX(n,t){if(n&1&&(s(0,"div",171)(1,"div",172)(2,"h4"),u(3),a(),s(4,"span",173),u(5),a()(),s(6,"div",174)(7,"div",98),b(8,"i",175),s(9,"span"),u(10),a()(),j(11,OX,4,1,"div",176),a()()),n&2){let e=t.$implicit;d(3),B(e.day),d(2),B(e.time),d(5),H("\u0627\u0644\u0648\u0642\u062A: ",e.time,""),d(),w("ngIf",e.classroom==null?null:e.classroom.name)}}function RX(n,t){if(n&1&&(s(0,"div",169),j(1,FX,12,4,"div",170),a()),n&2){let e=E(3);d(),w("ngForOf",e.lesson.schedule)}}function kX(n,t){if(n&1&&(s(0,"div",36)(1,"div",164),j(2,IX,7,0,"div",165)(3,RX,2,1,"div",166),a()()),n&2){let e=E(2);d(2),w("ngIf",e.lesson.schedule.length===0),d(),w("ngIf",e.lesson.schedule.length>0)}}function NX(n,t){if(n&1){let e=he();s(0,"div",13)(1,"div",14)(2,"div",15)(3,"h1",16),u(4),a(),s(5,"div",17)(6,"span",18),b(7,"i",19),u(8),a(),s(9,"span",18),b(10,"i",20),u(11),a(),s(12,"span",18),b(13,"i",21),u(14),a(),s(15,"span",22),b(16,"i",23),u(17),a()()(),s(18,"div",24)(19,"button",12),I("click",function(){F(e);let r=E();return R(r.openAddStudentModal())}),b(20,"i",25),u(21," \u0625\u0636\u0627\u0641\u0629 \u0637\u0627\u0644\u0628 "),a(),s(22,"button",26),I("click",function(){F(e);let r=E();return R(r.openMakePaymentModal())}),b(23,"i",27),u(24," \u062A\u0633\u062C\u064A\u0644 \u062F\u0641\u0639\u0629 "),a()()(),s(25,"div",28)(26,"div",29)(27,"div",30),u(28),a(),s(29,"div",31),u(30,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0637\u0644\u0627\u0628"),a()(),s(31,"div",29)(32,"div",30),u(33),a(),s(34,"div",31),u(35,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0625\u064A\u0631\u0627\u062F\u0627\u062A"),a()(),s(36,"div",29)(37,"div",30),u(38),a(),s(39,"div",31),u(40,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639"),a()(),s(41,"div",29)(42,"div",30),u(43),a(),s(44,"div",31),u(45,"\u0627\u0644\u0645\u0639\u0644\u0642"),a()()(),s(46,"div",32)(47,"div",33)(48,"button",34),I("click",function(){F(e);let r=E();return R(r.setActiveTab("overview"))}),u(49," \u0646\u0638\u0631\u0629 \u0639\u0627\u0645\u0629 "),a(),s(50,"button",34),I("click",function(){F(e);let r=E();return R(r.setActiveTab("students"))}),u(51),a(),s(52,"button",34),I("click",function(){F(e);let r=E();return R(r.setActiveTab("payments"))}),u(53," \u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A "),a(),s(54,"button",34),I("click",function(){F(e);let r=E();return R(r.setActiveTab("schedule"))}),u(55," \u0627\u0644\u062C\u062F\u0648\u0644 "),a()()(),j(56,tX,23,6,"div",35)(57,uX,5,3,"div",35)(58,PX,8,3,"div",35)(59,kX,4,2,"div",35),a()}if(n&2){let e=E();d(4),B(e.lesson.name),d(4),H(" ",e.lesson.subject," "),d(3),H(" ",e.lesson.academicYear," "),d(3),H(" ",e.formatPrice(e.lesson.price)," "),d(),Ie("monthly",e.lesson.paymentSystem==="monthly")("rounds",e.lesson.paymentSystem==="rounds"),d(2),H(" ",e.getPaymentSystemText(e.lesson.paymentSystem)," "),d(11),B(e.statistics.totalStudents),d(5),B(e.formatPrice(e.statistics.totalRevenue)),d(5),B(e.formatPrice(e.statistics.paidRevenue)),d(5),B(e.formatPrice(e.statistics.pendingRevenue)),d(5),Ie("active",e.activeTab==="overview"),d(2),Ie("active",e.activeTab==="students"),d(),H(" \u0627\u0644\u0637\u0644\u0627\u0628 (",e.lesson.students.length,") "),d(),Ie("active",e.activeTab==="payments"),d(2),Ie("active",e.activeTab==="schedule"),d(2),w("ngIf",e.activeTab==="overview"),d(),w("ngIf",e.activeTab==="students"),d(),w("ngIf",e.activeTab==="payments"),d(),w("ngIf",e.activeTab==="schedule")}}function UX(n,t){if(n&1&&(s(0,"option",196),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Qi(" ",e.name," - ",e.studentId," (",e.academicYear,") ")}}function LX(n,t){if(n&1&&(s(0,"div",197)(1,"h4"),u(2,"\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u0637\u0627\u0644\u0628 \u0627\u0644\u0645\u062D\u062F\u062F:"),a(),s(3,"div",97)(4,"p")(5,"strong"),u(6,"\u0627\u0644\u0627\u0633\u0645:"),a(),u(7),a(),s(8,"p")(9,"strong"),u(10,"\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628:"),a(),u(11),a(),s(12,"p")(13,"strong"),u(14,"\u0627\u0644\u0633\u0646\u0629 \u0627\u0644\u062F\u0631\u0627\u0633\u064A\u0629:"),a(),u(15),a(),s(16,"p")(17,"strong"),u(18,"\u0647\u0627\u062A\u0641 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631:"),a(),u(19),a()()()),n&2){let e,i,r,o,l=E(2);d(7),H(" ",(e=l.getSelectedStudentInfo())==null?null:e.name,""),d(4),H(" ",(i=l.getSelectedStudentInfo())==null?null:i.studentId,""),d(4),H(" ",(r=l.getSelectedStudentInfo())==null?null:r.academicYear,""),d(4),H(" ",(o=l.getSelectedStudentInfo())==null?null:o.parentPhone,"")}}function BX(n,t){n&1&&(s(0,"div",198)(1,"p"),u(2,"\u0644\u0627 \u064A\u0648\u062C\u062F \u0637\u0644\u0627\u0628 \u0645\u062A\u0627\u062D\u064A\u0646 \u0644\u0644\u0625\u0636\u0627\u0641\u0629"),a()())}function VX(n,t){n&1&&b(0,"span",199)}function HX(n,t){if(n&1){let e=he();s(0,"div",178)(1,"div",179)(2,"div",180)(3,"h2"),u(4,"\u0625\u0636\u0627\u0641\u0629 \u0637\u0627\u0644\u0628 \u0644\u0644\u062D\u0635\u0629"),a(),s(5,"button",181),I("click",function(){F(e);let r=E();return R(r.closeAddStudentModal())}),b(6,"i",182),a()(),s(7,"div",183)(8,"form",184),I("submit",function(r){return F(e),E().enrollStudent(),R(r.preventDefault())}),s(9,"div",185)(10,"label",186),u(11,"\u0627\u062E\u062A\u0631 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(12,"select",187)(13,"option",188),u(14,"\u0627\u062E\u062A\u0631 \u0637\u0627\u0644\u0628..."),a(),j(15,UX,2,4,"option",189),a()(),j(16,LX,20,4,"div",190)(17,BX,3,0,"div",191),s(18,"div",192)(19,"button",193),I("click",function(){F(e);let r=E();return R(r.closeAddStudentModal())}),u(20," \u0625\u0644\u063A\u0627\u0621 "),a(),s(21,"button",194),j(22,VX,1,0,"span",195),u(23," \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0637\u0627\u0644\u0628 "),a()()()()()()}if(n&2){let e=E();d(8),w("formGroup",e.addStudentForm),d(7),w("ngForOf",e.availableStudents),d(),w("ngIf",e.getSelectedStudentInfo()),d(),w("ngIf",e.availableStudents.length===0),d(4),w("disabled",e.addStudentForm.invalid||e.availableStudents.length===0||e.loading),d(),w("ngIf",e.loading)}}function zX(n,t){if(n&1&&(s(0,"option",196),u(1),a()),n&2){let e=t.$implicit;w("value",e._id),d(),Gn(" ",e.name," - ",e.studentId," ")}}function jX(n,t){if(n&1&&(s(0,"span"),u(1),a()),n&2){let e=t.$implicit,i=E(3);d(),Gn(" ",e.month," (",i.getStatusText(e.status),") ")}}function WX(n,t){if(n&1&&(s(0,"div",197)(1,"h4"),u(2,"\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u0637\u0627\u0644\u0628:"),a(),s(3,"div",97)(4,"p")(5,"strong"),u(6,"\u0627\u0644\u0627\u0633\u0645:"),a(),u(7),a(),s(8,"p")(9,"strong"),u(10,"\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628:"),a(),u(11),a(),s(12,"p")(13,"strong"),u(14,"\u0622\u062E\u0631 \u0645\u062F\u0641\u0648\u0639\u0627\u062A:"),a(),j(15,jX,2,2,"span",151),a()()()),n&2){let e=E(2);d(7),H(" ",e.selectedStudent.name,""),d(4),H(" ",e.selectedStudent.studentId,""),d(4),w("ngForOf",e.getStudentPayments(e.selectedStudent._id).slice(0,3))}}function GX(n,t){n&1&&b(0,"span",199)}function $X(n,t){if(n&1){let e=he();s(0,"div",178)(1,"div",179)(2,"div",180)(3,"h2"),u(4,"\u062A\u0633\u062C\u064A\u0644 \u062F\u0641\u0639\u0629 \u062C\u062F\u064A\u062F\u0629"),a(),s(5,"button",181),I("click",function(){F(e);let r=E();return R(r.closeMakePaymentModal())}),b(6,"i",182),a()(),s(7,"div",183)(8,"form",184),I("submit",function(r){return F(e),E().processPayment(),R(r.preventDefault())}),s(9,"div",200)(10,"div",185)(11,"label",201),u(12,"\u0627\u0644\u0637\u0627\u0644\u0628 *"),a(),s(13,"select",202)(14,"option",188),u(15,"\u0627\u062E\u062A\u0631 \u0637\u0627\u0644\u0628..."),a(),j(16,zX,2,3,"option",189),a()(),s(17,"div",185)(18,"label",203),u(19,"\u0627\u0644\u0634\u0647\u0631 *"),a(),b(20,"input",204),a(),s(21,"div",185)(22,"label",205),u(23,"\u0627\u0644\u0645\u0628\u0644\u063A (\u062F.\u062C) *"),a(),b(24,"input",206),a(),s(25,"div",185)(26,"label",207),u(27,"\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639"),a(),s(28,"select",208)(29,"option",209),u(30,"\u0646\u0642\u062F\u0627\u064B"),a(),s(31,"option",210),u(32,"\u0634\u064A\u0643"),a(),s(33,"option",211),u(34,"\u062A\u062D\u0648\u064A\u0644 \u0628\u0646\u0643\u064A"),a(),s(35,"option",212),u(36,"\u0628\u0637\u0627\u0642\u0629"),a()()(),s(37,"div",213)(38,"label",214),u(39,"\u0645\u0644\u0627\u062D\u0638\u0627\u062A"),a(),b(40,"textarea",215),a()(),j(41,WX,16,3,"div",190),s(42,"div",192)(43,"button",193),I("click",function(){F(e);let r=E();return R(r.closeMakePaymentModal())}),u(44," \u0625\u0644\u063A\u0627\u0621 "),a(),s(45,"button",194),j(46,GX,1,0,"span",195),u(47," \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629 "),a()()()()()()}if(n&2){let e=E();d(8),w("formGroup",e.paymentForm),d(8),w("ngForOf",e.lesson==null?null:e.lesson.students),d(25),w("ngIf",e.selectedStudent),d(4),w("disabled",e.paymentForm.invalid||e.loading),d(),w("ngIf",e.loading)}}function YX(n,t){if(n&1&&(s(0,"div",229)(1,"div",230)(2,"span",108),u(3),a(),s(4,"span",73),u(5),a()(),s(6,"div",231)(7,"span",75),u(8),a(),s(9,"span",232),u(10),a(),s(11,"span",233),u(12),a()()()),n&2){let e=t.$implicit,i=E(3);d(3),B(e.month),d(),Kn(i.getStatusBadgeClass(e.status)),d(),H(" ",i.getStatusText(e.status)," "),d(3),B(i.formatPrice(e.amount)),d(2),B(e.paymentMethod||"\u063A\u064A\u0631 \u0645\u062D\u062F\u062F"),d(2),B(i.formatDate(e.paymentDate))}}function qX(n,t){n&1&&(s(0,"div",109),u(1," \u0644\u0627 \u062A\u0648\u062C\u062F \u0645\u062F\u0641\u0648\u0639\u0627\u062A "),a())}function XX(n,t){if(n&1){let e=he();s(0,"div",183)(1,"div",217)(2,"div",218),b(3,"i",89),a(),s(4,"div",219)(5,"h3"),u(6),a(),s(7,"p",91),u(8),a(),s(9,"div",220)(10,"span",18),b(11,"i",20),u(12),a(),s(13,"span",18),b(14,"i",221),u(15),a()()()(),s(16,"div",222)(17,"div",223)(18,"h4"),u(19,"\u0645\u0639\u0644\u0648\u0645\u0627\u062A \u0627\u0644\u0627\u062A\u0635\u0627\u0644"),a(),s(20,"div",224)(21,"div",225),b(22,"i",55),s(23,"div")(24,"div",99),u(25,"\u0647\u0627\u062A\u0641 \u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631"),a(),s(26,"div",100),u(27),a()()(),s(28,"div",225),b(29,"i",56),s(30,"div")(31,"div",99),u(32,"\u0627\u0644\u0628\u0631\u064A\u062F \u0627\u0644\u0625\u0644\u0643\u062A\u0631\u0648\u0646\u064A"),a(),s(33,"div",100),u(34),a()()()()(),s(35,"div",223)(36,"h4"),u(37,"\u0627\u0644\u0645\u062F\u0641\u0648\u0639\u0627\u062A \u0641\u064A \u0647\u0630\u0647 \u0627\u0644\u062D\u0635\u0629"),a(),s(38,"div",226),j(39,YX,13,7,"div",227)(40,qX,2,0,"div",106),a()()(),s(41,"div",192)(42,"button",193),I("click",function(){F(e);let r=E(2);return R(r.closeStudentDetailsModal())}),u(43," \u0625\u063A\u0644\u0627\u0642 "),a(),s(44,"button",228),I("click",function(){F(e);let r=E(2);return R(r.navigateToStudentDetails(r.selectedStudent._id))}),u(45," \u0639\u0631\u0636 \u0627\u0644\u0645\u0644\u0641 \u0627\u0644\u0643\u0627\u0645\u0644 "),a()()()}if(n&2){let e=E(2);d(6),B(e.selectedStudent.name),d(2),H("\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628: ",e.selectedStudent.studentId,""),d(4),H(" ",e.selectedStudent.academicYear," "),d(3),H(" ",e.selectedStudent.status," "),d(12),B(e.selectedStudent.parentPhone),d(7),B(e.selectedStudent.parentEmail),d(5),w("ngForOf",e.getStudentPayments(e.selectedStudent._id)),d(),w("ngIf",e.getStudentPayments(e.selectedStudent._id).length===0)}}function ZX(n,t){if(n&1){let e=he();s(0,"div",178)(1,"div",179)(2,"div",180)(3,"h2"),u(4,"\u062A\u0641\u0627\u0635\u064A\u0644 \u0627\u0644\u0637\u0627\u0644\u0628"),a(),s(5,"button",181),I("click",function(){F(e);let r=E();return R(r.closeStudentDetailsModal())}),b(6,"i",182),a()(),j(7,XX,46,8,"div",216),a()()}if(n&2){let e=E();d(7),w("ngIf",e.selectedStudent)}}var Qf=class n{route=Pe(Kr);router=Pe(ei);http=Pe(pn);fb=Pe(Lc);lessonId;lesson=null;loading=!0;activeTab="overview";selectedMonth="";filteredPayments=[];showAddStudentModal=!1;showMakePaymentModal=!1;showStudentDetailsModal=!1;showPaymentHistoryModal=!1;showPrintReceiptModal=!1;payments=[];monthlySummaries=[];availableStudents=[];selectedStudent;selectedPaymentForHistory;selectedPaymentForReceipt;paymentForm;addStudentForm;currentPage=1;itemsPerPage=10;statistics={totalStudents:0,totalRevenue:0,paidRevenue:0,pendingRevenue:0,attendanceRate:0};quickMonths=[{value:"current",label:"\u0627\u0644\u0634\u0647\u0631 \u0627\u0644\u062D\u0627\u0644\u064A"},{value:"previous",label:"\u0627\u0644\u0634\u0647\u0631 \u0627\u0644\u0645\u0627\u0636\u064A"},{value:"next",label:"\u0627\u0644\u0634\u0647\u0631 \u0627\u0644\u0642\u0627\u062F\u0645"},{value:"all",label:"\u0639\u0631\u0636 \u0627\u0644\u0643\u0644"}];constructor(){this.paymentForm=this.fb.group({studentId:["",Tt.required],amount:["",[Tt.required,Tt.min(1)]],month:[new Date().toISOString().slice(0,7),Tt.required],paymentMethod:["cash",Tt.required],notes:[""]}),this.addStudentForm=this.fb.group({studentId:["",Tt.required]})}ngOnInit(){this.route.params.subscribe(t=>{this.lessonId=t.lessonId,this.lessonId?this.loadLessonDetails():(this.loading=!1,this.router.navigate(["/home/lesson-management"]))}),this.route.queryParams.subscribe(t=>{t.tab&&(this.activeTab=t.tab),t.month&&(this.selectedMonth=t.month)}),this.selectedMonth||(this.selectedMonth=this.getCurrentMonth())}loadLessonDetails(){this.loading=!0,this.http.get(`${_i.apiUrl}/classes/${this.lessonId}`).subscribe({next:t=>{if(!t){this.handleLessonNotFound();return}this.lesson=this.initializeLesson(t),this.statistics.totalStudents=this.lesson.students.length,this.loadPayments()},error:t=>{console.error("Error loading lesson details:",t),this.handleLessonNotFound()}})}initializeLesson(t){return{_id:t._id||"",name:t.name||"",subject:t.subject||"",description:t.description||"",academicYear:t.academicYear||"",price:t.price||0,paymentSystem:t.paymentSystem||"monthly",teacher:t.teacher||void 0,schedule:t.schedule||[],students:t.students||[],createdAt:t.createdAt?new Date(t.createdAt):new Date}}handleLessonNotFound(){this.lesson=null,this.loading=!1}loadPayments(){this.http.get(`${_i.apiUrl}/payments/class/${this.lessonId}`).subscribe({next:t=>{this.payments=t.payments||[],this.applyMonthFilter(),this.calculateStatistics(),this.generateMonthlySummaries(),this.loadAvailableStudents(),this.loading=!1},error:t=>{console.error("Error loading payments:",t),this.payments=[],this.filteredPayments=[],this.loading=!1}})}loadAvailableStudents(){this.http.get(`${_i.apiUrl}/students`).subscribe({next:t=>{if(this.lesson){let e=new Set(this.lesson.students.map(i=>i._id));this.availableStudents=t.filter(i=>!e.has(i._id))}},error:t=>{console.error("Error loading available students:",t),this.availableStudents=[]}})}applyMonthFilter(){if(!this.selectedMonth||this.selectedMonth==="all")this.filteredPayments=[...this.payments];else{let t=this.selectedMonth;this.selectedMonth==="current"?t=this.getCurrentMonth():this.selectedMonth==="previous"?t=this.getPreviousMonth():this.selectedMonth==="next"&&(t=this.getNextMonth()),this.filteredPayments=this.payments.filter(e=>e.month.startsWith(t))}this.currentPage=1}onMonthFilterChange(){this.applyMonthFilter(),this.updateUrlWithMonthFilter()}selectMonth(t){this.selectedMonth=t,this.applyMonthFilter(),this.updateUrlWithMonthFilter()}getCurrentMonth(){let t=new Date;return`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}`}getPreviousMonth(){let t=new Date;return t.setMonth(t.getMonth()-1),`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}`}getNextMonth(){let t=new Date;return t.setMonth(t.getMonth()+1),`${t.getFullYear()}-${(t.getMonth()+1).toString().padStart(2,"0")}`}updateUrlWithMonthFilter(){this.router.navigate([],{relativeTo:this.route,queryParams:{tab:this.activeTab,month:this.selectedMonth||null},queryParamsHandling:"merge"})}getMonthTotalAmount(){return this.filteredPayments.reduce((t,e)=>t+e.amount,0)}getMonthPaidAmount(){return this.filteredPayments.filter(t=>t.status==="paid").reduce((t,e)=>t+e.amount,0)}getMonthPendingAmount(){return this.filteredPayments.filter(t=>t.status!=="paid").reduce((t,e)=>t+e.amount,0)}getMonthPaidPercentage(){let t=this.getMonthTotalAmount(),e=this.getMonthPaidAmount();return t>0?Math.round(e/t*100):0}getStudentPaymentStatus(t){if(!this.lesson)return"not-enrolled";let e=this.getStudentPayment(t);return e?e.status:"not-paid"}getStudentPayment(t){if(!this.selectedMonth||this.selectedMonth==="all")return this.payments.filter(r=>r.student._id===t).sort((r,o)=>new Date(o.month).getTime()-new Date(r.month).getTime())[0];let e=this.selectedMonth;return this.selectedMonth==="current"?e=this.getCurrentMonth():this.selectedMonth==="previous"?e=this.getPreviousMonth():this.selectedMonth==="next"&&(e=this.getNextMonth()),this.payments.find(i=>i.student._id===t&&i.month.startsWith(e))}getStudentPaymentHistory(t){return this.payments.filter(e=>e.student._id===t).sort((e,i)=>new Date(i.month).getTime()-new Date(e.month).getTime())}openStudentPaymentHistory(t){this.selectedStudent=t,this.showPaymentHistoryModal=!0}closePaymentHistoryModal(){this.showPaymentHistoryModal=!1,this.selectedStudent=void 0}openMakePaymentModal(t){if(this.selectedStudent=t,this.showMakePaymentModal=!0,t){let e=this.selectedMonth==="current"?this.getCurrentMonth():this.selectedMonth;this.paymentForm.patchValue({studentId:t._id,amount:this.lesson?.price||0,month:e||new Date().toISOString().slice(0,7)})}else this.paymentForm.patchValue({studentId:"",amount:this.lesson?.price||0,month:this.selectedMonth==="current"?this.getCurrentMonth():this.selectedMonth||new Date().toISOString().slice(0,7)})}closeMakePaymentModal(){this.showMakePaymentModal=!1,this.selectedStudent=void 0}processPayment(){if(this.paymentForm.invalid||!this.lesson)return;let t=St(Oe({},this.paymentForm.value),{classId:this.lessonId,status:"paid"});this.loading=!0,this.http.post(`${_i.apiUrl}/payments`,t).subscribe({next:e=>{this.loadPayments(),this.showMakePaymentModal=!1,this.paymentForm.reset({month:this.selectedMonth==="current"?this.getCurrentMonth():this.selectedMonth||new Date().toISOString().slice(0,7),paymentMethod:"cash",amount:this.lesson?.price||0}),this.successMessage=e.message||"\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629 \u0628\u0646\u062C\u0627\u062D",setTimeout(()=>{this.successMessage=""},3e3)},error:e=>{console.error("Error processing payment:",e),this.loading=!1,this.errorMessage=e.error?.error||"\u0641\u0634\u0644 \u0641\u064A \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062F\u0641\u0639\u0629",setTimeout(()=>{this.errorMessage=""},3e3)}})}markPaymentAsPaid(t){this.loading=!0,this.http.put(`${_i.apiUrl}/payments/${t}/pay`,{paymentMethod:"cash",paymentDate:new Date().toISOString()}).subscribe({next:e=>{this.loadPayments(),this.successMessage="\u062A\u0645 \u062A\u062D\u062F\u064A\u062B \u062D\u0627\u0644\u0629 \u0627\u0644\u062F\u0641\u0639\u0629 \u0625\u0644\u0649 \u0645\u062F\u0641\u0648\u0639\u0629",setTimeout(()=>{this.successMessage=""},3e3)},error:e=>{console.error("Error marking payment as paid:",e),this.loading=!1,this.errorMessage=e.error?.error||"\u0641\u0634\u0644 \u0641\u064A \u062A\u062D\u062F\u064A\u062B \u062D\u0627\u0644\u0629 \u0627\u0644\u062F\u0641\u0639\u0629",setTimeout(()=>{this.errorMessage=""},3e3)}})}openAddStudentModal(){this.showAddStudentModal=!0,this.addStudentForm.reset()}closeAddStudentModal(){this.showAddStudentModal=!1}enrollStudent(){let t=this.addStudentForm.get("studentId")?.value;!t||!this.lesson||(this.loading=!0,this.http.post(`${_i.apiUrl}/classes/${this.lessonId}/enroll/${t}`,{}).subscribe({next:e=>{this.loadLessonDetails(),this.showAddStudentModal=!1,this.successMessage=e.message||"\u062A\u0645 \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0637\u0627\u0644\u0628 \u0628\u0646\u062C\u0627\u062D",setTimeout(()=>{this.successMessage=""},3e3)},error:e=>{console.error("Error enrolling student:",e),this.loading=!1,this.errorMessage=e.error?.error||"\u0641\u0634\u0644 \u0641\u064A \u0625\u0636\u0627\u0641\u0629 \u0627\u0644\u0637\u0627\u0644\u0628",setTimeout(()=>{this.errorMessage=""},3e3)}}))}removeStudent(t){this.lesson&&confirm("\u0647\u0644 \u0623\u0646\u062A \u0645\u062A\u0623\u0643\u062F \u0645\u0646 \u0625\u0632\u0627\u0644\u0629 \u0627\u0644\u0637\u0627\u0644\u0628 \u0645\u0646 \u0647\u0630\u0647 \u0627\u0644\u062D\u0635\u0629\u061F")&&(this.loading=!0,this.http.delete(`${_i.apiUrl}/classes/${this.lessonId}/unenroll/${t}`).subscribe({next:e=>{this.loadLessonDetails(),this.successMessage=e.message||"\u062A\u0645 \u0625\u0632\u0627\u0644\u0629 \u0627\u0644\u0637\u0627\u0644\u0628 \u0628\u0646\u062C\u0627\u062D",setTimeout(()=>{this.successMessage=""},3e3)},error:e=>{console.error("Error removing student:",e),this.loading=!1,this.errorMessage=e.error?.error||"\u0641\u0634\u0644 \u0641\u064A \u0625\u0632\u0627\u0644\u0629 \u0627\u0644\u0637\u0627\u0644\u0628",setTimeout(()=>{this.errorMessage=""},3e3)}}))}calculateStatistics(){this.statistics.totalRevenue=this.payments.reduce((t,e)=>t+e.amount,0),this.statistics.paidRevenue=this.payments.filter(t=>t.status==="paid").reduce((t,e)=>t+e.amount,0),this.statistics.pendingRevenue=this.payments.filter(t=>t.status==="pending"||t.status==="late").reduce((t,e)=>t+e.amount,0)}generateMonthlySummaries(){if(!this.lesson)return;let t=this.lesson.students,e=new Map;this.payments.forEach(i=>{let r=i.month.slice(0,7);e.has(r)||e.set(r,[]),e.get(r).push(i)}),this.monthlySummaries=Array.from(e.entries()).map(([i,r])=>{let o=r.filter(g=>g.status==="paid").reduce((g,m)=>g+m.amount,0),l=r.filter(g=>g.status==="pending").reduce((g,m)=>g+m.amount,0),c=r.filter(g=>g.status==="late").reduce((g,m)=>g+m.amount,0),f=r.reduce((g,m)=>g+m.amount,0),p=t.map(g=>{let m=r.find(x=>x.student._id===g._id);return{student:g,payment:m,status:m?m.status:"not-enrolled"}});return{month:i,totalAmount:f,paidAmount:o,pendingAmount:l,lateAmount:c,students:p}}),this.monthlySummaries.sort((i,r)=>r.month.localeCompare(i.month))}formatPrice(t){return new Intl.NumberFormat("ar-DZ").format(t)+" \u062F.\u062C"}formatDate(t){return t?new Date(t).toLocaleDateString("ar-EG"):"\u0644\u0645 \u064A\u062A\u0645 \u0627\u0644\u062F\u0641\u0639"}formatMonth(t){let[e,i]=t.split("-");return["\u064A\u0646\u0627\u064A\u0631","\u0641\u0628\u0631\u0627\u064A\u0631","\u0645\u0627\u0631\u0633","\u0623\u0628\u0631\u064A\u0644","\u0645\u0627\u064A\u0648","\u064A\u0648\u0646\u064A\u0648","\u064A\u0648\u0644\u064A\u0648","\u0623\u063A\u0633\u0637\u0633","\u0633\u0628\u062A\u0645\u0628\u0631","\u0623\u0643\u062A\u0648\u0628\u0631","\u0646\u0648\u0641\u0645\u0628\u0631","\u062F\u064A\u0633\u0645\u0628\u0631"][parseInt(i)-1]}getYearFromMonth(t){let[e]=t.split("-");return e}getStatusBadgeClass(t){switch(t){case"paid":return"badge-paid";case"pending":return"badge-pending";case"late":return"badge-late";case"not-paid":return"badge-default";case"not-enrolled":return"badge-default";default:return"badge-default"}}getStatusText(t){switch(t){case"paid":return"\u0645\u062F\u0641\u0648\u0639";case"pending":return"\u0645\u0639\u0644\u0642";case"late":return"\u0645\u062A\u0623\u062E\u0631";case"not-paid":return"\u063A\u064A\u0631 \u0645\u062F\u0641\u0648\u0639";case"not-enrolled":return"\u063A\u064A\u0631 \u0645\u0633\u062C\u0644";default:return t}}getPaymentSystemText(t){return t==="monthly"?"\u0634\u0647\u0631\u064A":"\u062C\u0648\u0644\u0627\u062A"}getSelectedStudentInfo(){let t=this.addStudentForm.get("studentId")?.value;return this.availableStudents.find(e=>e._id===t)}openPrintReceiptModal(t){this.selectedPaymentForReceipt=t,this.showPrintReceiptModal=!0}closePrintReceiptModal(){this.showPrintReceiptModal=!1,this.selectedPaymentForReceipt=void 0}printReceipt(t){let e=`
      <div style="font-family: Arial, sans-serif; padding: 20px; max-width: 400px;">
        <h2 style="text-align: center; color: #1971c2;">\u0625\u064A\u0635\u0627\u0644 \u062F\u0641\u0639</h2>
        <hr>
        <div style="margin-bottom: 20px;">
          <p><strong>\u0627\u0644\u062D\u0635\u0629:</strong> ${this.lesson?.name}</p>
          <p><strong>\u0627\u0644\u0637\u0627\u0644\u0628:</strong> ${t.student.name}</p>
          <p><strong>\u0631\u0642\u0645 \u0627\u0644\u0637\u0627\u0644\u0628:</strong> ${t.student.studentId}</p>
          <p><strong>\u0627\u0644\u0634\u0647\u0631:</strong> ${this.formatMonth(t.month)} ${this.getYearFromMonth(t.month)}</p>
          <p><strong>\u0627\u0644\u0645\u0628\u0644\u063A:</strong> ${this.formatPrice(t.amount)}</p>
          <p><strong>\u0637\u0631\u064A\u0642\u0629 \u0627\u0644\u062F\u0641\u0639:</strong> ${t.paymentMethod}</p>
          <p><strong>\u062A\u0627\u0631\u064A\u062E \u0627\u0644\u062F\u0641\u0639:</strong> ${this.formatDate(t.paymentDate||new Date)}</p>
        </div>
        <hr>
        <p style="text-align: center; color: #666; font-size: 12px;">
          \u0634\u0643\u0631\u0627\u064B \u0644\u0627\u0633\u062A\u062E\u062F\u0627\u0645\u0643\u0645 \u0646\u0638\u0627\u0645 \u0625\u062F\u0627\u0631\u0629 \u0627\u0644\u062D\u0635\u0635
        </p>
      </div>
    `,i=window.open("","_blank");i&&(i.document.write(`
        <html>
          <head>
            <title>\u0625\u064A\u0635\u0627\u0644 \u062F\u0641\u0639</title>
            <style>
              @media print {
                body { margin: 0; padding: 0; }
              }
            </style>
          </head>
          <body>
            ${e}
            <script>
              window.onload = function() {
                window.print();
                setTimeout(function() {
                  window.close();
                }, 500);
              };
            <\/script>
          </body>
        </html>
      `),i.document.close())}get paginatedStudents(){if(!this.lesson)return[];let t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage;return this.lesson.students.slice(t,e)}get paginatedPayments(){let t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage;return this.filteredPayments.slice(t,e)}get totalPages(){return this.activeTab==="students"?this.lesson?Math.ceil(this.lesson.students.length/this.itemsPerPage):0:Math.ceil(this.filteredPayments.length/this.itemsPerPage)}getPages(){let t=this.totalPages;return t>0?Array.from({length:t},(e,i)=>i+1):[]}goToPage(t){this.currentPage=t}prevPage(){this.currentPage>1&&this.currentPage--}nextPage(){this.currentPage<this.totalPages&&this.currentPage++}getFilteredPaymentsTotal(){return this.filteredPayments.reduce((t,e)=>t+e.amount,0)}getFilteredPaidTotal(){return this.filteredPayments.filter(t=>t.status==="paid").reduce((t,e)=>t+e.amount,0)}setActiveTab(t){this.activeTab=t,this.currentPage=1,this.router.navigate([],{relativeTo:this.route,queryParams:{tab:t,month:this.selectedMonth||null},queryParamsHandling:"merge"})}openStudentDetailsModal(t){this.selectedStudent=t,this.showStudentDetailsModal=!0}closeStudentDetailsModal(){this.showStudentDetailsModal=!1,this.selectedStudent=void 0}navigateToStudentDetails(t){this.router.navigate(["/home/students-management",t])}goBack(){this.router.navigate(["/home/lesson-management"])}errorMessage="";successMessage="";static \u0275fac=function(e){return new(e||n)};static \u0275cmp=nn({type:n,selectors:[["app-lesson-detail"]],decls:10,vars:6,consts:[[1,"lesson-detail-container"],[1,"btn","btn-back",3,"click"],[1,"icon-arrow-right"],["class","loading-state",4,"ngIf"],["class","not-found",4,"ngIf"],["class","lesson-content",4,"ngIf"],["class","modal-overlay",4,"ngIf"],[1,"loading-state"],[1,"spinner"],[1,"not-found"],[1,"not-found-icon"],[1,"icon-error"],[1,"btn","btn-primary",3,"click"],[1,"lesson-content"],[1,"lesson-header"],[1,"lesson-title-section"],[1,"lesson-title"],[1,"lesson-meta"],[1,"meta-item"],[1,"icon-subject"],[1,"icon-year"],[1,"icon-price"],[1,"meta-item","payment-system"],[1,"icon-payment"],[1,"lesson-actions"],[1,"icon-add"],[1,"btn","btn-outline",3,"click"],[1,"icon-money"],[1,"lesson-stats"],[1,"stat-item"],[1,"stat-value"],[1,"stat-label"],[1,"tabs-container"],[1,"tabs"],[1,"tab",3,"click"],["class","tab-content",4,"ngIf"],[1,"tab-content"],[1,"overview-grid"],[1,"card"],[1,"card-header"],[1,"card-body"],["class","teacher-info",4,"ngIf"],["class","no-teacher",4,"ngIf"],["class","lesson-description",4,"ngIf"],["class","no-description",4,"ngIf"],[1,"card","full-width"],["class","monthly-summaries",4,"ngIf"],["class","no-summaries",4,"ngIf"],[1,"teacher-info"],[1,"teacher-avatar"],[1,"icon-teacher"],[1,"teacher-details"],[1,"teacher-contact"],["class","contact-item",4,"ngIf"],[1,"contact-item"],[1,"icon-phone"],[1,"icon-email"],[1,"no-teacher"],[1,"lesson-description"],[1,"no-description"],[1,"monthly-summaries"],["class","month-summary",4,"ngFor","ngForOf"],[1,"month-summary"],[1,"month-header"],[1,"total-amount"],[1,"month-stats"],[1,"stat-badge","paid"],[1,"stat-badge","pending"],[1,"stat-badge","late"],[1,"students-list"],["class","student-payment-item",4,"ngFor","ngForOf"],[1,"student-payment-item"],[1,"student-name"],[1,"payment-status"],["class","payment-amount",4,"ngIf"],[1,"payment-amount"],[1,"no-summaries"],[1,"students-list-container"],["class","empty-students",4,"ngIf"],["class","students-grid",4,"ngIf"],["class","pagination",4,"ngIf"],[1,"empty-students"],[1,"empty-icon"],[1,"icon-students"],[1,"students-grid"],["class","student-card",4,"ngFor","ngForOf"],[1,"student-card"],[1,"student-header"],[1,"student-avatar"],[1,"icon-student"],[1,"student-info"],[1,"student-id"],[1,"student-actions"],["title","\u0639\u0631\u0636 \u0627\u0644\u062A\u0641\u0627\u0635\u064A\u0644",1,"btn-icon","btn-view",3,"click"],[1,"icon-view"],["title","\u0625\u0632\u0627\u0644\u0629 \u0627\u0644\u0637\u0627\u0644\u0628",1,"btn-icon","btn-danger",3,"click"],[1,"icon-delete"],[1,"student-details"],[1,"detail-row"],[1,"detail-label"],[1,"detail-value"],[1,"student-payments"],[1,"payments-header"],[1,"btn-link",3,"click"],[1,"payments-list"],["class","payment-item",4,"ngFor","ngForOf"],["class","no-payments",4,"ngIf"],[1,"payment-item"],[1,"payment-month"],[1,"no-payments"],[1,"pagination"],[1,"pagination-btn",3,"click","disabled"],[1,"icon-chevron-right"],[1,"page-numbers"],["class","page-number",3,"active","click",4,"ngFor","ngForOf"],[1,"icon-chevron-left"],[1,"pagination-info"],[1,"page-number",3,"click"],[1,"payments-header-actions"],["class","empty-payments",4,"ngIf"],["class","payments-table-container",4,"ngIf"],[1,"month-filter-section"],[1,"month-filter-header"],[1,"month-filter-controls"],[1,"month-selector"],["for","selectedMonth"],["type","month","id","selectedMonth",1,"form-input",3,"ngModelChange","ngModel"],[1,"quick-month-buttons"],[1,"btn-month",3,"click"],["class","month-statistics",4,"ngIf"],[1,"payment-summary"],[1,"summary-item"],[1,"summary-label"],[1,"summary-value"],["class","students-payment-grid",4,"ngIf"],[1,"month-statistics"],[1,"month-stat-item"],[1,"students-payment-grid"],["class","student-payment-card",3,"paid","pending","late","not-paid",4,"ngFor","ngForOf"],[1,"student-payment-card"],[1,"student-avatar-small"],[1,"status-badge"],[1,"payment-actions"],["class","btn-icon btn-pay",3,"click",4,"ngIf"],[1,"btn-icon","btn-view",3,"click"],[1,"icon-history"],[1,"btn-icon","btn-pay",3,"click"],[1,"empty-payments"],[4,"ngIf"],[1,"payments-table-container"],[1,"payments-table"],[4,"ngFor","ngForOf"],[1,"student-cell"],[1,"month-cell"],[1,"month-year"],[1,"amount-cell"],[1,"actions-cell"],[1,"action-buttons"],["class","btn-icon btn-success","title","\u062A\u0633\u062F\u064A\u062F \u0627\u0644\u062F\u0641\u0639\u0629",3,"click",4,"ngIf"],["title","\u0639\u0631\u0636 \u0627\u0644\u0637\u0627\u0644\u0628",1,"btn-icon","btn-view",3,"click"],["title","\u0637\u0628\u0627\u0639\u0629 \u0627\u0644\u0625\u064A\u0635\u0627\u0644",1,"btn-icon","btn-print",3,"click"],[1,"icon-print"],["title","\u062A\u0633\u062F\u064A\u062F \u0627\u0644\u062F\u0641\u0639\u0629",1,"btn-icon","btn-success",3,"click"],[1,"icon-check"],[1,"schedule-container"],["class","empty-schedule",4,"ngIf"],["class","schedule-grid",4,"ngIf"],[1,"empty-schedule"],[1,"icon-calendar"],[1,"schedule-grid"],["class","session-card",4,"ngFor","ngForOf"],[1,"session-card"],[1,"session-header"],[1,"session-time"],[1,"session-details"],[1,"icon-time"],["class","detail-row",4,"ngIf"],[1,"icon-location"],[1,"modal-overlay"],[1,"modal"],[1,"modal-header"],[1,"btn-icon","btn-close",3,"click"],[1,"icon-close"],[1,"modal-body"],[3,"submit","formGroup"],[1,"form-group"],["for","studentSelect"],["id","studentSelect","formControlName","studentId",1,"form-select"],["value",""],[3,"value",4,"ngFor","ngForOf"],["class","selected-student-info",4,"ngIf"],["class","no-students",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary",3,"disabled"],["class","spinner-small",4,"ngIf"],[3,"value"],[1,"selected-student-info"],[1,"no-students"],[1,"spinner-small"],[1,"form-grid"],["for","paymentStudent"],["id","paymentStudent","formControlName","studentId",1,"form-select"],["for","paymentMonth"],["type","month","id","paymentMonth","formControlName","month","required","",1,"form-input"],["for","paymentAmount"],["type","number","id","paymentAmount","formControlName","amount","min","1","required","",1,"form-input"],["for","paymentMethod"],["id","paymentMethod","formControlName","paymentMethod",1,"form-select"],["value","cash"],["value","check"],["value","transfer"],["value","card"],[1,"form-group","full-width"],["for","paymentNotes"],["id","paymentNotes","formControlName","notes","rows","3",1,"form-textarea"],["class","modal-body",4,"ngIf"],[1,"student-profile"],[1,"student-avatar-large"],[1,"student-info-large"],[1,"student-meta"],[1,"icon-status"],[1,"student-details-section"],[1,"detail-card"],[1,"detail-list"],[1,"detail-item"],[1,"payments-list-detailed"],["class","payment-item-detailed",4,"ngFor","ngForOf"],["type","button",1,"btn","btn-primary",3,"click"],[1,"payment-item-detailed"],[1,"payment-header"],[1,"payment-details"],[1,"payment-method"],[1,"payment-date"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"button",1),I("click",function(){return i.goBack()}),b(2,"i",2),u(3," \u0627\u0644\u0639\u0648\u062F\u0629 \u0644\u0644\u062D\u0635\u0635 "),a(),j(4,zq,4,0,"div",3)(5,jq,9,0,"div",4)(6,NX,60,26,"div",5),a(),j(7,HX,24,6,"div",6)(8,$X,48,5,"div",6)(9,ZX,8,1,"div",6)),e&2&&(d(4),w("ngIf",i.loading),d(),w("ngIf",!i.loading&&!i.lesson),d(),w("ngIf",!i.loading&&i.lesson),d(),w("ngIf",i.showAddStudentModal),d(),w("ngIf",i.showMakePaymentModal),d(),w("ngIf",i.showStudentDetailsModal))},dependencies:[hn,Nn,An,D0,qr,qs,B0,Un,Ti,Di,Pi,Yn,gr,di,ii,Ai,$i,_r,ti,Bc,Ql,eu],styles:['@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:300;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:400;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:500;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:600;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscQyyS4J0.woff2) format("woff2");unicode-range:U+0600-06FF,U+0750-077F,U+0870-088E,U+0890-0891,U+0897-08E1,U+08E3-08FF,U+200C-200E,U+2010-2011,U+204F,U+2E41,U+FB50-FDFF,U+FE70-FE74,U+FE76-FEFC,U+102E0-102FB,U+10E60-10E7E,U+10EC2-10EC4,U+10EFC-10EFF,U+1EE00-1EE03,U+1EE05-1EE1F,U+1EE21-1EE22,U+1EE24,U+1EE27,U+1EE29-1EE32,U+1EE34-1EE37,U+1EE39,U+1EE3B,U+1EE42,U+1EE47,U+1EE49,U+1EE4B,U+1EE4D-1EE4F,U+1EE51-1EE52,U+1EE54,U+1EE57,U+1EE59,U+1EE5B,U+1EE5D,U+1EE5F,U+1EE61-1EE62,U+1EE64,U+1EE67-1EE6A,U+1EE6C-1EE72,U+1EE74-1EE77,U+1EE79-1EE7C,U+1EE7E,U+1EE80-1EE89,U+1EE8B-1EE9B,U+1EEA1-1EEA3,U+1EEA5-1EEA9,U+1EEAB-1EEBB,U+1EEF0-1EEF1}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscSCyS4J0.woff2) format("woff2");unicode-range:U+0100-02BA,U+02BD-02C5,U+02C7-02CC,U+02CE-02D7,U+02DD-02FF,U+0304,U+0308,U+0329,U+1D00-1DBF,U+1E00-1E9F,U+1EF2-1EFF,U+2020,U+20A0-20AB,U+20AD-20C0,U+2113,U+2C60-2C7F,U+A720-A7FF}@font-face{font-family:Cairo;font-style:normal;font-weight:700;font-display:swap;src:url(https://fonts.gstatic.com/s/cairo/v31/SLXVc1nY6HkvangtZmpQdkhzfH5lkSscRiyS.woff2) format("woff2");unicode-range:U+0000-00FF,U+0131,U+0152-0153,U+02BB-02BC,U+02C6,U+02DA,U+02DC,U+0304,U+0308,U+0329,U+2000-206F,U+20AC,U+2122,U+2191,U+2193,U+2212,U+2215,U+FEFF,U+FFFD}.lesson-detail-container[_ngcontent-%COMP%]{font-family:Cairo,sans-serif;background:#f8fafc;min-height:100vh;padding:30px;animation:_ngcontent-%COMP%_fadeIn .5s ease-out}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.btn-back[_ngcontent-%COMP%]{background:transparent;border:none;color:#64748b;font-size:1rem;font-weight:500;cursor:pointer;display:inline-flex;align-items:center;gap:8px;padding:10px 0;margin-bottom:20px;transition:color .3s ease}.btn-back[_ngcontent-%COMP%]:hover{color:#4361ee}.btn-back[_ngcontent-%COMP%]   .icon-arrow-right[_ngcontent-%COMP%]{transform:rotate(180deg);font-size:1.1rem}.loading-state[_ngcontent-%COMP%]{text-align:center;padding:80px 20px}.loading-state[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:60px;height:60px;border:4px solid rgba(67,97,238,.1);border-top-color:#4361ee;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin:0 auto 20px}.loading-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#64748b;font-size:1.1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.not-found[_ngcontent-%COMP%]{text-align:center;padding:80px 20px;max-width:400px;margin:0 auto}.not-found[_ngcontent-%COMP%]   .not-found-icon[_ngcontent-%COMP%]{width:80px;height:80px;background:#ef44441a;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px}.not-found[_ngcontent-%COMP%]   .not-found-icon[_ngcontent-%COMP%]   .icon-error[_ngcontent-%COMP%]{font-size:2.5rem;color:#ef4444}.not-found[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;color:#1e293b;margin-bottom:10px}.not-found[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#64748b;margin-bottom:25px}.lesson-header[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:30px;margin-bottom:25px;box-shadow:0 4px 20px #0000000d;border:1px solid #f1f5f9;display:flex;justify-content:space-between;align-items:flex-start;flex-wrap:wrap;gap:20px}.lesson-header[_ngcontent-%COMP%]   .lesson-title-section[_ngcontent-%COMP%]{flex:1;min-width:300px}.lesson-header[_ngcontent-%COMP%]   .lesson-title-section[_ngcontent-%COMP%]   .lesson-title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#1e293b;margin-bottom:15px}.lesson-header[_ngcontent-%COMP%]   .lesson-title-section[_ngcontent-%COMP%]   .lesson-meta[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px}.lesson-header[_ngcontent-%COMP%]   .lesson-title-section[_ngcontent-%COMP%]   .lesson-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#64748b;font-size:.95rem;background:#f8fafc;padding:8px 16px;border-radius:12px;border:1px solid #e2e8f0}.lesson-header[_ngcontent-%COMP%]   .lesson-title-section[_ngcontent-%COMP%]   .lesson-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.lesson-header[_ngcontent-%COMP%]   .lesson-title-section[_ngcontent-%COMP%]   .lesson-meta[_ngcontent-%COMP%]   .meta-item.payment-system.monthly[_ngcontent-%COMP%]{background:#8b5cf61a;color:#8b5cf6;border-color:#8b5cf633}.lesson-header[_ngcontent-%COMP%]   .lesson-title-section[_ngcontent-%COMP%]   .lesson-meta[_ngcontent-%COMP%]   .meta-item.payment-system.rounds[_ngcontent-%COMP%]{background:#f59e0b1a;color:#f59e0b;border-color:#f59e0b33}.lesson-header[_ngcontent-%COMP%]   .lesson-actions[_ngcontent-%COMP%]{display:flex;gap:12px;flex-shrink:0}.lesson-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-bottom:30px}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:25px;text-align:center;border:2px solid transparent;transition:all .3s ease;box-shadow:0 4px 15px #0000000d}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 25px #0000001a}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:nth-child(1){border-color:#10b981}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:nth-child(1):hover{border-color:#059669}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:nth-child(2){border-color:#3b82f6}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:nth-child(2):hover{border-color:#2563eb}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:nth-child(3){border-color:#8b5cf6}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:nth-child(3):hover{border-color:#7c3aed}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:nth-child(4){border-color:#f59e0b}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]:nth-child(4):hover{border-color:#d97706}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:#1e293b;margin-bottom:8px;line-height:1}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#64748b;font-size:.95rem;font-weight:500}.tabs-container[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:0;margin-bottom:30px;box-shadow:0 4px 20px #0000000d;border:1px solid #f1f5f9;overflow:hidden}.tabs-container[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]{display:flex;border-bottom:2px solid #f1f5f9;overflow-x:auto}.tabs-container[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{padding:18px 30px;background:transparent;border:none;color:#64748b;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease;white-space:nowrap;position:relative;border-bottom:3px solid transparent}.tabs-container[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]:hover{color:#4361ee;background:#4361ee0d}.tabs-container[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]   .tab.active[_ngcontent-%COMP%]{color:#4361ee;border-bottom-color:#4361ee;background:#4361ee0d}.tab-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.overview-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:25px}.overview-grid[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 4px 15px #0000000d;border:1px solid #f1f5f9}.overview-grid[_ngcontent-%COMP%]   .card.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.overview-grid[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]{padding:20px 25px;border-bottom:1px solid #f1f5f9;background:#f8fafc}.overview-grid[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.2rem;color:#1e293b}.overview-grid[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .card-body[_ngcontent-%COMP%]{padding:25px}.teacher-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px}.teacher-info[_ngcontent-%COMP%]   .teacher-avatar[_ngcontent-%COMP%]{width:70px;height:70px;background:linear-gradient(135deg,#4361ee,#3a0ca3);border-radius:50%;display:flex;align-items:center;justify-content:center}.teacher-info[_ngcontent-%COMP%]   .teacher-avatar[_ngcontent-%COMP%]   .icon-teacher[_ngcontent-%COMP%]{color:#fff;font-size:2rem}.teacher-info[_ngcontent-%COMP%]   .teacher-details[_ngcontent-%COMP%]{flex:1}.teacher-info[_ngcontent-%COMP%]   .teacher-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 10px;color:#1e293b;font-size:1.2rem}.teacher-info[_ngcontent-%COMP%]   .teacher-details[_ngcontent-%COMP%]   .teacher-contact[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.teacher-info[_ngcontent-%COMP%]   .teacher-details[_ngcontent-%COMP%]   .teacher-contact[_ngcontent-%COMP%]   .contact-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#64748b;font-size:.9rem}.teacher-info[_ngcontent-%COMP%]   .teacher-details[_ngcontent-%COMP%]   .teacher-contact[_ngcontent-%COMP%]   .contact-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#4361ee}.no-teacher[_ngcontent-%COMP%], .no-description[_ngcontent-%COMP%], .no-summaries[_ngcontent-%COMP%]{text-align:center;padding:30px 20px;color:#94a3b8}.monthly-summaries[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]{background:#f8fafc;border-radius:12px;padding:20px;border:1px solid #e2e8f0}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .month-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding-bottom:15px;border-bottom:1px solid #e2e8f0}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .month-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#1e293b;font-size:1.1rem}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .month-header[_ngcontent-%COMP%]   .total-amount[_ngcontent-%COMP%]{font-weight:700;color:#4361ee;font-size:1.2rem}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .month-stats[_ngcontent-%COMP%]{display:flex;gap:12px;margin-bottom:15px}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .month-stats[_ngcontent-%COMP%]   .stat-badge[_ngcontent-%COMP%]{flex:1;padding:10px;border-radius:8px;text-align:center}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .month-stats[_ngcontent-%COMP%]   .stat-badge.paid[_ngcontent-%COMP%]{background:#10b9811a;border:1px solid rgba(16,185,129,.2)}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .month-stats[_ngcontent-%COMP%]   .stat-badge.pending[_ngcontent-%COMP%]{background:#f59e0b1a;border:1px solid rgba(245,158,11,.2)}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .month-stats[_ngcontent-%COMP%]   .stat-badge.late[_ngcontent-%COMP%]{background:#ef44441a;border:1px solid rgba(239,68,68,.2)}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .month-stats[_ngcontent-%COMP%]   .stat-badge[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{display:block;font-size:.8rem;color:#64748b;margin-bottom:4px}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .month-stats[_ngcontent-%COMP%]   .stat-badge[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{display:block;font-weight:600;font-size:.95rem}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .students-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .students-list[_ngcontent-%COMP%]   .student-payment-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:#fff;border-radius:8px;border:1px solid #e2e8f0}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .students-list[_ngcontent-%COMP%]   .student-payment-item[_ngcontent-%COMP%]   .student-name[_ngcontent-%COMP%]{font-weight:500;color:#475569}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .students-list[_ngcontent-%COMP%]   .student-payment-item[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]{font-size:.85rem;padding:4px 10px;border-radius:12px;font-weight:500}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .students-list[_ngcontent-%COMP%]   .student-payment-item[_ngcontent-%COMP%]   .payment-status.paid[_ngcontent-%COMP%]{background:#10b9811a;color:#10b981}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .students-list[_ngcontent-%COMP%]   .student-payment-item[_ngcontent-%COMP%]   .payment-status.pending[_ngcontent-%COMP%]{background:#f59e0b1a;color:#f59e0b}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .students-list[_ngcontent-%COMP%]   .student-payment-item[_ngcontent-%COMP%]   .payment-status.late[_ngcontent-%COMP%]{background:#ef44441a;color:#ef4444}.monthly-summaries[_ngcontent-%COMP%]   .month-summary[_ngcontent-%COMP%]   .students-list[_ngcontent-%COMP%]   .student-payment-item[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]   .payment-amount[_ngcontent-%COMP%]{margin-right:8px}.empty-students[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;background:#fff;border-radius:16px;box-shadow:0 4px 15px #0000000d}.empty-students[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{width:80px;height:80px;background:#4361ee1a;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px}.empty-students[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   .icon-students[_ngcontent-%COMP%]{font-size:2.5rem;color:#4361ee}.empty-students[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;color:#1e293b;margin-bottom:10px}.empty-students[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#64748b;margin-bottom:25px;max-width:400px;margin-left:auto;margin-right:auto}.students-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(350px,1fr));gap:20px;margin-bottom:30px}.student-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:20px;box-shadow:0 4px 15px #0000000d;border:1px solid #f1f5f9;transition:all .3s ease}.student-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 25px #0000001a;border-color:#4361ee}.student-card[_ngcontent-%COMP%]   .student-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px;margin-bottom:15px;padding-bottom:15px;border-bottom:1px solid #f1f5f9}.student-card[_ngcontent-%COMP%]   .student-header[_ngcontent-%COMP%]   .student-avatar[_ngcontent-%COMP%]{width:50px;height:50px;background:linear-gradient(135deg,#4361ee,#3a0ca3);border-radius:50%;display:flex;align-items:center;justify-content:center}.student-card[_ngcontent-%COMP%]   .student-header[_ngcontent-%COMP%]   .student-avatar[_ngcontent-%COMP%]   .icon-student[_ngcontent-%COMP%]{color:#fff;font-size:1.5rem}.student-card[_ngcontent-%COMP%]   .student-header[_ngcontent-%COMP%]   .student-info[_ngcontent-%COMP%]{flex:1}.student-card[_ngcontent-%COMP%]   .student-header[_ngcontent-%COMP%]   .student-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 5px;color:#1e293b;font-size:1.1rem}.student-card[_ngcontent-%COMP%]   .student-header[_ngcontent-%COMP%]   .student-info[_ngcontent-%COMP%]   .student-id[_ngcontent-%COMP%]{color:#94a3b8;font-size:.85rem;margin:0}.student-card[_ngcontent-%COMP%]   .student-header[_ngcontent-%COMP%]   .student-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.student-card[_ngcontent-%COMP%]   .student-details[_ngcontent-%COMP%]{margin-bottom:15px}.student-card[_ngcontent-%COMP%]   .student-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid #f1f5f9}.student-card[_ngcontent-%COMP%]   .student-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.student-card[_ngcontent-%COMP%]   .student-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{color:#64748b;font-size:.9rem}.student-card[_ngcontent-%COMP%]   .student-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{color:#1e293b;font-weight:500;font-size:.9rem}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:10px}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-header[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0;color:#475569;font-size:.95rem}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-header[_ngcontent-%COMP%]   .btn-link[_ngcontent-%COMP%]{background:transparent;border:none;color:#4361ee;font-size:.85rem;cursor:pointer;padding:4px 8px;border-radius:6px;transition:background-color .3s ease}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-header[_ngcontent-%COMP%]   .btn-link[_ngcontent-%COMP%]:hover{background:#4361ee1a}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-list[_ngcontent-%COMP%]   .payment-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:8px 12px;background:#f8fafc;border-radius:8px;margin-bottom:8px}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-list[_ngcontent-%COMP%]   .payment-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-list[_ngcontent-%COMP%]   .payment-item[_ngcontent-%COMP%]   .payment-month[_ngcontent-%COMP%]{color:#475569;font-size:.9rem}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-list[_ngcontent-%COMP%]   .payment-item[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]{font-size:.85rem;padding:4px 10px;border-radius:12px;font-weight:500}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-list[_ngcontent-%COMP%]   .payment-item[_ngcontent-%COMP%]   .payment-status.paid[_ngcontent-%COMP%]{background:#10b9811a;color:#10b981}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-list[_ngcontent-%COMP%]   .payment-item[_ngcontent-%COMP%]   .payment-status.pending[_ngcontent-%COMP%]{background:#f59e0b1a;color:#f59e0b}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-list[_ngcontent-%COMP%]   .payment-item[_ngcontent-%COMP%]   .payment-status.late[_ngcontent-%COMP%]{background:#ef44441a;color:#ef4444}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-list[_ngcontent-%COMP%]   .payment-item[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]   .payment-amount[_ngcontent-%COMP%]{margin-right:8px}.student-card[_ngcontent-%COMP%]   .student-payments[_ngcontent-%COMP%]   .payments-list[_ngcontent-%COMP%]   .no-payments[_ngcontent-%COMP%]{text-align:center;color:#94a3b8;font-size:.9rem;padding:10px;background:#f8fafc;border-radius:8px}.month-filter-section[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:25px;margin-bottom:25px;box-shadow:0 4px 15px #0000000d;border:1px solid #f1f5f9}.month-filter-section[_ngcontent-%COMP%]   .month-filter-header[_ngcontent-%COMP%]{margin-bottom:20px}.month-filter-section[_ngcontent-%COMP%]   .month-filter-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#1e293b;font-size:1.2rem}.month-filter-section[_ngcontent-%COMP%]   .month-filter-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:20px}.month-filter-section[_ngcontent-%COMP%]   .month-filter-controls[_ngcontent-%COMP%]   .month-selector[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.month-filter-section[_ngcontent-%COMP%]   .month-filter-controls[_ngcontent-%COMP%]   .month-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#475569;font-weight:500;white-space:nowrap}.month-filter-section[_ngcontent-%COMP%]   .month-filter-controls[_ngcontent-%COMP%]   .month-selector[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:200px}.month-filter-section[_ngcontent-%COMP%]   .month-filter-controls[_ngcontent-%COMP%]   .quick-month-buttons[_ngcontent-%COMP%]{display:flex;gap:10px;flex-wrap:wrap}.month-filter-section[_ngcontent-%COMP%]   .month-filter-controls[_ngcontent-%COMP%]   .quick-month-buttons[_ngcontent-%COMP%]   .btn-month[_ngcontent-%COMP%]{padding:8px 16px;background:#f8fafc;border:2px solid #e2e8f0;border-radius:12px;color:#64748b;font-size:.9rem;font-weight:500;cursor:pointer;transition:all .3s ease}.month-filter-section[_ngcontent-%COMP%]   .month-filter-controls[_ngcontent-%COMP%]   .quick-month-buttons[_ngcontent-%COMP%]   .btn-month[_ngcontent-%COMP%]:hover{border-color:#4361ee;color:#4361ee}.month-filter-section[_ngcontent-%COMP%]   .month-filter-controls[_ngcontent-%COMP%]   .quick-month-buttons[_ngcontent-%COMP%]   .btn-month.active[_ngcontent-%COMP%]{background:#4361ee;border-color:#4361ee;color:#fff}.month-filter-section[_ngcontent-%COMP%]   .month-statistics[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:15px;margin-top:25px;padding-top:25px;border-top:1px solid #f1f5f9}.month-filter-section[_ngcontent-%COMP%]   .month-statistics[_ngcontent-%COMP%]   .month-stat-item[_ngcontent-%COMP%]{background:#f8fafc;border-radius:12px;padding:15px;text-align:center;border:2px solid transparent}.month-filter-section[_ngcontent-%COMP%]   .month-statistics[_ngcontent-%COMP%]   .month-stat-item[_ngcontent-%COMP%]:nth-child(1){border-color:#10b981}.month-filter-section[_ngcontent-%COMP%]   .month-statistics[_ngcontent-%COMP%]   .month-stat-item[_ngcontent-%COMP%]:nth-child(2){border-color:#3b82f6}.month-filter-section[_ngcontent-%COMP%]   .month-statistics[_ngcontent-%COMP%]   .month-stat-item[_ngcontent-%COMP%]:nth-child(3){border-color:#f59e0b}.month-filter-section[_ngcontent-%COMP%]   .month-statistics[_ngcontent-%COMP%]   .month-stat-item[_ngcontent-%COMP%]:nth-child(4){border-color:#8b5cf6}.month-filter-section[_ngcontent-%COMP%]   .month-statistics[_ngcontent-%COMP%]   .month-stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#1e293b;margin-bottom:5px}.month-filter-section[_ngcontent-%COMP%]   .month-statistics[_ngcontent-%COMP%]   .month-stat-item[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{color:#64748b;font-size:.9rem;font-weight:500}.payments-header-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:25px;padding:20px;background:#fff;border-radius:16px;box-shadow:0 4px 15px #0000000d;border:1px solid #f1f5f9}.payments-header-actions[_ngcontent-%COMP%]   .payment-summary[_ngcontent-%COMP%]{display:flex;gap:25px}.payments-header-actions[_ngcontent-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.payments-header-actions[_ngcontent-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-label[_ngcontent-%COMP%]{color:#64748b;font-size:.95rem}.payments-header-actions[_ngcontent-%COMP%]   .payment-summary[_ngcontent-%COMP%]   .summary-item[_ngcontent-%COMP%]   .summary-value[_ngcontent-%COMP%]{font-weight:700;color:#1e293b;font-size:1.1rem}.students-payment-grid[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:25px;margin-bottom:25px;box-shadow:0 4px 15px #0000000d;border:1px solid #f1f5f9}.students-payment-grid[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 20px;color:#1e293b;font-size:1.2rem}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:15px}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]{background:#f8fafc;border-radius:12px;padding:15px;border:2px solid #e2e8f0;transition:all .3s ease;display:flex;justify-content:space-between;align-items:center}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card.paid[_ngcontent-%COMP%]{border-color:#10b981}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card.pending[_ngcontent-%COMP%]{border-color:#f59e0b}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card.late[_ngcontent-%COMP%]{border-color:#ef4444}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card.not-paid[_ngcontent-%COMP%]{border-color:#94a3b8}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #0000001a}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .student-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .student-info[_ngcontent-%COMP%]   .student-avatar-small[_ngcontent-%COMP%]{width:40px;height:40px;background:linear-gradient(135deg,#4361ee,#3a0ca3);border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:1rem}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .student-info[_ngcontent-%COMP%]   .student-details[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{margin:0 0 4px;color:#1e293b;font-size:1rem}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .student-info[_ngcontent-%COMP%]   .student-details[_ngcontent-%COMP%]   .student-id[_ngcontent-%COMP%]{margin:0;color:#94a3b8;font-size:.8rem}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:4px}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:12px;font-size:.8rem;font-weight:500}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]   .status-badge.paid[_ngcontent-%COMP%]{background:#10b9811a;color:#10b981}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]   .status-badge.pending[_ngcontent-%COMP%]{background:#f59e0b1a;color:#f59e0b}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]   .status-badge.late[_ngcontent-%COMP%]{background:#ef44441a;color:#ef4444}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]   .status-badge.not-paid[_ngcontent-%COMP%]{background:#94a3b81a;color:#64748b}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-status[_ngcontent-%COMP%]   .payment-amount[_ngcontent-%COMP%]{font-size:.85rem;font-weight:500;color:#1e293b}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-actions[_ngcontent-%COMP%]{display:flex;gap:8px}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-actions[_ngcontent-%COMP%]   .btn-pay[_ngcontent-%COMP%]{color:#10b981}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-actions[_ngcontent-%COMP%]   .btn-pay[_ngcontent-%COMP%]:hover{background:#10b9811a}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-actions[_ngcontent-%COMP%]   .btn-view[_ngcontent-%COMP%]{color:#4361ee}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]   .student-payment-card[_ngcontent-%COMP%]   .payment-actions[_ngcontent-%COMP%]   .btn-view[_ngcontent-%COMP%]:hover{background:#4361ee1a}.empty-payments[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;background:#fff;border-radius:16px;box-shadow:0 4px 15px #0000000d}.empty-payments[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{width:80px;height:80px;background:#f59e0b1a;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px}.empty-payments[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   .icon-money[_ngcontent-%COMP%]{font-size:2.5rem;color:#f59e0b}.empty-payments[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;color:#1e293b;margin-bottom:10px}.empty-payments[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#64748b;margin-bottom:25px;max-width:400px;margin-left:auto;margin-right:auto}.payments-table-container[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:0;overflow:hidden;box-shadow:0 4px 15px #0000000d;border:1px solid #f1f5f9}.payments-table-container[_ngcontent-%COMP%]   .payments-table[_ngcontent-%COMP%]{width:100%;border-collapse:separate;border-spacing:0}.payments-table-container[_ngcontent-%COMP%]   .payments-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8fafc,#f1f5f9)}.payments-table-container[_ngcontent-%COMP%]   .payments-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:18px 16px;text-align:right;font-weight:600;color:#475569;font-size:.95rem;border-bottom:2px solid #e2e8f0;white-space:nowrap}.payments-table-container[_ngcontent-%COMP%]   .payments-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #f1f5f9;transition:background-color .3s ease}.payments-table-container[_ngcontent-%COMP%]   .payments-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#4361ee08}.payments-table-container[_ngcontent-%COMP%]   .payments-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:16px;color:#475569;font-size:.95rem;border-bottom:1px solid #f1f5f9}.student-cell[_ngcontent-%COMP%]   .student-name[_ngcontent-%COMP%]{font-weight:600;color:#1e293b;margin-bottom:4px}.student-cell[_ngcontent-%COMP%]   .student-id[_ngcontent-%COMP%]{font-size:.85rem;color:#94a3b8}.month-cell[_ngcontent-%COMP%]   .month-year[_ngcontent-%COMP%]{display:block;font-size:.85rem;color:#94a3b8;margin-top:4px}.amount-cell[_ngcontent-%COMP%]{font-weight:700;color:#10b981}.status-badge[_ngcontent-%COMP%]{display:inline-block;padding:6px 12px;border-radius:12px;font-size:.85rem;font-weight:500}.status-badge.paid[_ngcontent-%COMP%]{background:#10b9811a;color:#10b981}.status-badge.pending[_ngcontent-%COMP%]{background:#f59e0b1a;color:#f59e0b}.status-badge.late[_ngcontent-%COMP%]{background:#ef44441a;color:#ef4444}.actions-cell[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:8px}.schedule-container[_ngcontent-%COMP%]   .empty-schedule[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;background:#fff;border-radius:16px;box-shadow:0 4px 15px #0000000d}.schedule-container[_ngcontent-%COMP%]   .empty-schedule[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]{width:80px;height:80px;background:#8b5cf61a;border-radius:50%;display:flex;align-items:center;justify-content:center;margin:0 auto 20px}.schedule-container[_ngcontent-%COMP%]   .empty-schedule[_ngcontent-%COMP%]   .empty-icon[_ngcontent-%COMP%]   .icon-calendar[_ngcontent-%COMP%]{font-size:2.5rem;color:#8b5cf6}.schedule-container[_ngcontent-%COMP%]   .empty-schedule[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;color:#1e293b;margin-bottom:10px}.schedule-container[_ngcontent-%COMP%]   .empty-schedule[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#64748b;margin-bottom:25px}.schedule-container[_ngcontent-%COMP%]   .schedule-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(300px,1fr));gap:20px}.schedule-container[_ngcontent-%COMP%]   .schedule-grid[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:20px;box-shadow:0 4px 15px #0000000d;border:1px solid #f1f5f9;transition:all .3s ease}.schedule-container[_ngcontent-%COMP%]   .schedule-grid[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 8px 25px #0000001a;border-color:#4361ee}.schedule-container[_ngcontent-%COMP%]   .schedule-grid[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:15px;padding-bottom:15px;border-bottom:1px solid #f1f5f9}.schedule-container[_ngcontent-%COMP%]   .schedule-grid[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;color:#1e293b;font-size:1.1rem}.schedule-container[_ngcontent-%COMP%]   .schedule-grid[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-header[_ngcontent-%COMP%]   .session-time[_ngcontent-%COMP%]{font-weight:700;color:#4361ee;font-size:1.1rem}.schedule-container[_ngcontent-%COMP%]   .schedule-grid[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:8px 0;color:#64748b}.schedule-container[_ngcontent-%COMP%]   .schedule-grid[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]:last-child{padding-bottom:0}.schedule-container[_ngcontent-%COMP%]   .schedule-grid[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%]   .session-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#4361ee}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000b3;backdrop-filter:blur(5px);display:flex;align-items:center;justify-content:center;z-index:2000;padding:20px;animation:_ngcontent-%COMP%_fadeIn .3s ease-out}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:24px;width:100%;max-width:600px;max-height:90vh;overflow-y:auto;box-shadow:0 25px 50px -12px #00000040;animation:_ngcontent-%COMP%_modalSlideIn .3s cubic-bezier(.34,1.56,.64,1)}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]{padding:25px 30px;border-bottom:1px solid #f1f5f9;display:flex;justify-content:space-between;align-items:center;position:sticky;top:0;background:#fff;border-radius:24px 24px 0 0;z-index:1}.modal[_ngcontent-%COMP%]   .modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;color:#1e293b}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:30px}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .selected-student-info[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .student-details-section[_ngcontent-%COMP%]{background:#f8fafc;border-radius:12px;padding:20px;margin:20px 0;border:1px solid #e2e8f0}:is(.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .selected-student-info[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .student-details-section[_ngcontent-%COMP%])   h4[_ngcontent-%COMP%]{margin:0 0 15px;color:#1e293b;font-size:1.1rem}:is(.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .selected-student-info[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]   .student-details-section[_ngcontent-%COMP%])   .student-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:8px 0;color:#475569}.modal[_ngcontent-%COMP%]   .modal-footer[_ngcontent-%COMP%]{padding:20px 30px;border-top:1px solid #f1f5f9;display:flex;justify-content:flex-end;gap:15px;position:sticky;bottom:0;background:#fff;border-radius:0 0 24px 24px}@keyframes _ngcontent-%COMP%_modalSlideIn{0%{opacity:0;transform:translateY(30px) scale(.95)}to{opacity:1;transform:translateY(0) scale(1)}}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:20px}.form-grid[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;color:#475569;font-weight:500;font-size:.95rem}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:2px solid #e2e8f0;border-radius:12px;font-size:.95rem;font-family:Cairo,sans-serif;color:#1e293b;transition:all .3s ease;background:#fff}[_ngcontent-%COMP%]:is(.form-input,.form-select,.form-textarea):focus{outline:none;border-color:#4361ee;box-shadow:0 0 0 3px #4361ee1a}.form-textarea[_ngcontent-%COMP%]{resize:vertical;min-height:80px}.student-profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-bottom:30px;padding-bottom:30px;border-bottom:1px solid #f1f5f9}.student-profile[_ngcontent-%COMP%]   .student-avatar-large[_ngcontent-%COMP%]{width:80px;height:80px;background:linear-gradient(135deg,#4361ee,#3a0ca3);border-radius:50%;display:flex;align-items:center;justify-content:center}.student-profile[_ngcontent-%COMP%]   .student-avatar-large[_ngcontent-%COMP%]   .icon-student[_ngcontent-%COMP%]{color:#fff;font-size:2.5rem}.student-profile[_ngcontent-%COMP%]   .student-info-large[_ngcontent-%COMP%]{flex:1}.student-profile[_ngcontent-%COMP%]   .student-info-large[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 10px;color:#1e293b;font-size:1.5rem}.student-profile[_ngcontent-%COMP%]   .student-info-large[_ngcontent-%COMP%]   .student-id[_ngcontent-%COMP%]{color:#94a3b8;font-size:1rem;margin:0 0 15px}.student-profile[_ngcontent-%COMP%]   .student-info-large[_ngcontent-%COMP%]   .student-meta[_ngcontent-%COMP%]{display:flex;gap:20px}.student-profile[_ngcontent-%COMP%]   .student-info-large[_ngcontent-%COMP%]   .student-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;color:#64748b;font-size:.9rem;background:#f8fafc;padding:8px 16px;border-radius:12px;border:1px solid #e2e8f0}.student-details-section[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:20px}.detail-card[_ngcontent-%COMP%]{background:#f8fafc;border-radius:12px;padding:20px;border:1px solid #e2e8f0}.detail-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 15px;color:#1e293b;font-size:1.1rem}:is(.detail-list[_ngcontent-%COMP%], .payments-list-detailed[_ngcontent-%COMP%])   .detail-item[_ngcontent-%COMP%], :is(.detail-list[_ngcontent-%COMP%], .payments-list-detailed[_ngcontent-%COMP%])   .payment-item-detailed[_ngcontent-%COMP%]{padding:12px 0;border-bottom:1px solid #e2e8f0}[_ngcontent-%COMP%]:is(:is(.detail-list,.payments-list-detailed) .detail-item,:is(.detail-list,.payments-list-detailed) .payment-item-detailed):last-child{border-bottom:none;padding-bottom:0}.detail-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:15px}.detail-item[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#4361ee;font-size:1.2rem;flex-shrink:0}.detail-item[_ngcontent-%COMP%]   .detail-label[_ngcontent-%COMP%]{display:block;color:#64748b;font-size:.9rem;margin-bottom:4px}.detail-item[_ngcontent-%COMP%]   .detail-value[_ngcontent-%COMP%]{display:block;color:#1e293b;font-weight:500;font-size:1rem}.payment-item-detailed[_ngcontent-%COMP%]   .payment-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.payment-item-detailed[_ngcontent-%COMP%]   .payment-header[_ngcontent-%COMP%]   .payment-month[_ngcontent-%COMP%]{font-weight:600;color:#1e293b}.payment-item-detailed[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:.9rem;color:#64748b}.payment-item-detailed[_ngcontent-%COMP%]   .payment-details[_ngcontent-%COMP%]   .payment-amount[_ngcontent-%COMP%]{font-weight:600;color:#10b981}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:15px;padding:25px;margin:0 auto;background:#fff;border-radius:16px;box-shadow:0 4px 15px #0000000d;border:1px solid #f1f5f9}.pagination[_ngcontent-%COMP%]   .pagination-btn[_ngcontent-%COMP%]{width:40px;height:40px;border:2px solid #e2e8f0;border-radius:10px;background:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .3s ease;color:#64748b}.pagination[_ngcontent-%COMP%]   .pagination-btn[_ngcontent-%COMP%]:hover:not(:disabled){border-color:#4361ee;color:#4361ee;transform:translateY(-2px)}.pagination[_ngcontent-%COMP%]   .pagination-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.pagination[_ngcontent-%COMP%]   .pagination-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.pagination[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]{display:flex;gap:5px}.pagination[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]{min-width:40px;height:40px;border:2px solid #e2e8f0;border-radius:10px;background:#fff;color:#64748b;font-weight:500;cursor:pointer;transition:all .3s ease}.pagination[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number[_ngcontent-%COMP%]:hover{border-color:#4361ee;color:#4361ee}.pagination[_ngcontent-%COMP%]   .page-numbers[_ngcontent-%COMP%]   .page-number.active[_ngcontent-%COMP%]{background:#4361ee;border-color:#4361ee;color:#fff}.pagination[_ngcontent-%COMP%]   .pagination-info[_ngcontent-%COMP%]{color:#64748b;font-size:.9rem;margin-right:auto}.btn[_ngcontent-%COMP%]{padding:12px 24px;border:none;border-radius:12px;font-size:.95rem;font-weight:600;cursor:pointer;transition:all .3s cubic-bezier(.4,0,.2,1);display:inline-flex;align-items:center;justify-content:center;gap:8px;font-family:Cairo,sans-serif}.btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none!important}.btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.1rem}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#4361ee,#3a0ca3);color:#fff;box-shadow:0 4px 15px #4361ee4d}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 20px #4361ee66}.btn-primary[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.btn-secondary[_ngcontent-%COMP%]{background:#fff;color:#64748b;border:2px solid #e2e8f0}.btn-secondary[_ngcontent-%COMP%]:hover:not(:disabled){border-color:#4361ee;color:#4361ee}.btn-outline[_ngcontent-%COMP%]{background:transparent;border:2px solid #4361ee;color:#4361ee}.btn-outline[_ngcontent-%COMP%]:hover{background:#4361ee1a}.btn-icon[_ngcontent-%COMP%]{width:40px;height:40px;padding:0;border-radius:10px;display:flex;align-items:center;justify-content:center;background:transparent;border:none;cursor:pointer;transition:all .3s ease}.btn-icon[_ngcontent-%COMP%]:hover{background:#0000000d}.btn-view[_ngcontent-%COMP%]{color:#4361ee}.btn-view[_ngcontent-%COMP%]:hover{background:#4361ee1a}.btn-danger[_ngcontent-%COMP%]{color:#ef4444}.btn-danger[_ngcontent-%COMP%]:hover{background:#ef44441a}.btn-success[_ngcontent-%COMP%]{color:#10b981}.btn-success[_ngcontent-%COMP%]:hover{background:#10b9811a}.btn-close[_ngcontent-%COMP%]{font-size:1.2rem;color:#64748b}.btn-close[_ngcontent-%COMP%]:hover{color:#ef4444}.spinner-small[_ngcontent-%COMP%]{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;display:inline-block;margin-left:8px}@media (max-width: 768px){.lesson-detail-container[_ngcontent-%COMP%]{padding:20px}.lesson-header[_ngcontent-%COMP%]{flex-direction:column;padding:20px}.lesson-header[_ngcontent-%COMP%]   .lesson-title[_ngcontent-%COMP%]{font-size:1.7rem}.lesson-header[_ngcontent-%COMP%]   .lesson-meta[_ngcontent-%COMP%]{flex-direction:column;gap:10px}.lesson-header[_ngcontent-%COMP%]   .lesson-actions[_ngcontent-%COMP%]{width:100%;justify-content:center}.lesson-stats[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr);gap:15px}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]{padding:20px}.lesson-stats[_ngcontent-%COMP%]   .stat-item[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-size:1.5rem}.tabs-container[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{padding:15px 20px;font-size:.9rem}.overview-grid[_ngcontent-%COMP%], .students-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.month-filter-controls[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch!important}.month-selector[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start!important}.month-selector[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:100%!important}.payments-header-actions[_ngcontent-%COMP%]{flex-direction:column;gap:20px;text-align:center}.payments-header-actions[_ngcontent-%COMP%]   .payment-summary[_ngcontent-%COMP%]{justify-content:center}.students-payment-grid[_ngcontent-%COMP%]   .students-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.pagination[_ngcontent-%COMP%]{flex-wrap:wrap;gap:10px}.pagination[_ngcontent-%COMP%]   .pagination-info[_ngcontent-%COMP%]{margin-right:0;width:100%;text-align:center;order:3;margin-top:10px}.modal[_ngcontent-%COMP%]{margin:20px}.modal[_ngcontent-%COMP%]   .modal-body[_ngcontent-%COMP%]{padding:20px}}@media (max-width: 480px){.lesson-stats[_ngcontent-%COMP%]{grid-template-columns:1fr}.tabs-container[_ngcontent-%COMP%]   .tabs[_ngcontent-%COMP%]   .tab[_ngcontent-%COMP%]{padding:12px 15px;font-size:.85rem}.month-statistics[_ngcontent-%COMP%]{grid-template-columns:1fr!important}.student-card[_ngcontent-%COMP%]   .student-header[_ngcontent-%COMP%]{flex-direction:column;text-align:center}.modal-footer[_ngcontent-%COMP%]{flex-direction:column}.modal-footer[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{width:100%}}@media (prefers-color-scheme: dark){.lesson-detail-container[_ngcontent-%COMP%]{background:#0f172a}.lesson-header[_ngcontent-%COMP%], .tabs-container[_ngcontent-%COMP%], .card[_ngcontent-%COMP%], .students-grid[_ngcontent-%COMP%]   .student-card[_ngcontent-%COMP%], .month-filter-section[_ngcontent-%COMP%], .payments-header-actions[_ngcontent-%COMP%], .students-payment-grid[_ngcontent-%COMP%], .payments-table-container[_ngcontent-%COMP%], .schedule-container[_ngcontent-%COMP%]   .empty-schedule[_ngcontent-%COMP%], .schedule-grid[_ngcontent-%COMP%]   .session-card[_ngcontent-%COMP%], .modal[_ngcontent-%COMP%], .pagination[_ngcontent-%COMP%]{background:#1e293b;border-color:#334155;color:#e2e8f0}.lesson-title[_ngcontent-%COMP%], .stat-value[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], .card-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .student-name[_ngcontent-%COMP%], .payment-month[_ngcontent-%COMP%], .summary-value[_ngcontent-%COMP%]{color:#f1f5f9}.stat-label[_ngcontent-%COMP%], .lesson-meta[_ngcontent-%COMP%]   .meta-item[_ngcontent-%COMP%], .detail-label[_ngcontent-%COMP%], .student-id[_ngcontent-%COMP%], .detail-value[_ngcontent-%COMP%], .payment-method[_ngcontent-%COMP%], .pagination-info[_ngcontent-%COMP%]{color:#cbd5e1}.form-input[_ngcontent-%COMP%], .form-select[_ngcontent-%COMP%], .form-textarea[_ngcontent-%COMP%]{background:#334155;border-color:#475569;color:#f1f5f9}.month-summary[_ngcontent-%COMP%], .payment-item[_ngcontent-%COMP%], .student-payment-card[_ngcontent-%COMP%], .detail-card[_ngcontent-%COMP%]{background:#334155;border-color:#475569}.month-stats[_ngcontent-%COMP%]   .stat-badge[_ngcontent-%COMP%], .status-badge[_ngcontent-%COMP%]{opacity:.9}.btn-outline[_ngcontent-%COMP%]{border-color:#6366f1;color:#6366f1}.btn-icon[_ngcontent-%COMP%]:hover{background:#ffffff1a}}']})};$();function JX(n,t){n&1&&(s(0,"div",18),b(1,"div",19),s(2,"p"),u(3,"\u062C\u0627\u0631\u064A \u0627\u0644\u0645\u0633\u062D..."),a()())}function KX(n,t){if(n&1&&(s(0,"div",33)(1,"div",34),b(2,"i",35),u(3),a(),s(4,"div",36),u(5),a(),s(6,"div",37)(7,"span"),u(8),a()()()),n&2){let e=t.$implicit;d(3),H(" ",e.startTime," "),d(2),H(" ",e.subject," "),d(2),Kn(e.status==="ongoing"?"status-active":"status-scheduled"),d(),H(" ",e.status==="ongoing"?"\u062C\u0627\u0631\u064A\u0629":"\u0645\u062C\u062F\u0648\u0644\u0629"," ")}}function QX(n,t){if(n&1&&(s(0,"div",29)(1,"h4"),b(2,"i",30),u(3," \u062D\u0635\u0635 \u0627\u0644\u064A\u0648\u0645:"),a(),s(4,"div",31),j(5,KX,9,5,"div",32),a()()),n&2){let e=E(2);d(5),w("ngForOf",e.todayClasses)}}function eZ(n,t){if(n&1&&(s(0,"div",20)(1,"div",21)(2,"div",22),b(3,"i",23),a(),s(4,"div",24)(5,"h3"),u(6),a(),s(7,"p"),b(8,"i",25),u(9),a(),s(10,"p"),b(11,"i",26),u(12),a(),s(13,"p"),b(14,"i",27),u(15),a()()(),j(16,QX,6,1,"div",28),a()),n&2){let e=E();d(6),B(e.currentStudent.fullName||e.currentStudent.registrationNumber),d(3),H(" ",e.currentStudent.registrationNumber,""),d(3),H(" \u062A\u062E\u0635\u0635: ",e.currentStudent.specialtyChoice==="automation"?"\u0627\u0644\u0622\u0644\u064A\u0629":"\u0627\u0644\u0628\u062A\u0631\u0648\u0644",""),d(3),H(" \u0633\u0646\u0629 \u0627\u0644\u0628\u0627\u0643: ",e.currentStudent.bacYear,""),d(),w("ngIf",e.todayClasses.length>0)}}function tZ(n,t){if(n&1&&(s(0,"p"),u(1),a()),n&2){let e=E(2);d(),B(e.attendanceResult.data)}}function nZ(n,t){n&1&&(s(0,"p",42),b(1,"i",43),u(2," \u062A\u0645 \u0625\u0631\u0633\u0627\u0644 \u0631\u0633\u0627\u0644\u0629 \u0644\u0648\u0644\u064A \u0627\u0644\u0623\u0645\u0631 "),a())}function iZ(n,t){if(n&1&&(s(0,"div",38)(1,"div",39),b(2,"i"),a(),s(3,"h3"),u(4),a(),j(5,tZ,2,1,"p",40)(6,nZ,3,0,"p",41),a()),n&2){let e=E();Ie("success",e.attendanceResult.success)("error",!e.attendanceResult.success),d(2),Kn(e.attendanceResult.success?"fas fa-check-circle":"fas fa-times-circle"),d(2),B(e.attendanceResult.message),d(),w("ngIf",e.attendanceResult.data),d(),w("ngIf",e.attendanceResult.smsSent)}}function rZ(n,t){if(n&1&&(s(0,"div",48)(1,"div",49),u(2),ut(3,"date"),a(),s(4,"div",50),u(5),a(),s(6,"div",51),u(7),a(),s(8,"div",52)(9,"span",53),u(10,"\u062D\u0627\u0636\u0631"),a()()()),n&2){let e=t.$implicit;d(2),H(" ",pt(3,3,e.timestamp,"HH:mm")," "),d(3),H(" ",e.studentName," "),d(2),H(" ",e.className," ")}}function oZ(n,t){if(n&1&&(s(0,"div",44)(1,"h3"),b(2,"i",45),u(3," \u0622\u062E\u0631 \u0627\u0644\u062D\u0636\u0648\u0631"),a(),s(4,"div",46),j(5,rZ,11,6,"div",47),a()()),n&2){let e=E();d(5),w("ngForOf",e.recentAttendance)}}var eh=class n{constructor(t){this.http=t}isScanning=!1;scannedRFID="";currentStudent=null;attendanceResult=null;totalStudents=0;attendanceToday=0;attendanceRate=0;todayClasses=[];recentAttendance=[];ngOnInit(){this.loadStatistics(),this.loadTodayClasses(),this.loadRecentAttendance()}startRFIDScan(){this.isScanning=!0,this.currentStudent=null,this.attendanceResult=null,setTimeout(()=>{let t="RFID-"+Math.random().toString(36).substr(2,9).toUpperCase();this.scannedRFID=t,this.checkRFID(t)},1500)}checkRFID(t){this.http.get("http://localhost:5000/api/students/all").subscribe({next:e=>{let i=e.find(r=>r.registrationNumber===t||r._id===t||t.endsWith(r.registrationNumber.substring(r.registrationNumber.length-4)));i?(this.currentStudent=i,this.recordAttendance(i)):(this.attendanceResult={success:!1,message:"\u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u063A\u064A\u0631 \u0645\u0633\u062C\u0644\u0629 \u0641\u064A \u0627\u0644\u0646\u0638\u0627\u0645"},this.isScanning=!1)},error:e=>{console.error("Error fetching students:",e),this.attendanceResult={success:!1,message:"\u062E\u0637\u0623 \u0641\u064A \u0627\u0644\u0627\u062A\u0635\u0627\u0644 \u0628\u0627\u0644\u0646\u0638\u0627\u0645"},this.isScanning=!1}})}recordAttendance(t){let e={studentId:t._id,studentName:t.fullName||t.registrationNumber,registrationNumber:t.registrationNumber,parentPhone:t.parentPhone||t.phone,timestamp:new Date().toISOString(),date:new Date().toISOString().split("T")[0],time:new Date().toLocaleTimeString(),method:"rfid"};this.http.post("http://localhost:5000/api/attendance/record",e).subscribe({next:i=>{this.isScanning=!1,this.sendSMSToParent(t,i),this.attendanceResult={success:!0,message:`\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u062D\u0636\u0648\u0631 ${t.fullName||t.registrationNumber}`,smsSent:!0},this.attendanceToday++,this.attendanceRate=Math.round(this.attendanceToday/this.totalStudents*100),this.recentAttendance.unshift({studentName:t.fullName||t.registrationNumber,className:i.className||"\u062D\u0635\u0635 \u0627\u0644\u064A\u0648\u0645",timestamp:new Date}),this.recentAttendance.length>5&&this.recentAttendance.pop(),setTimeout(()=>{this.currentStudent=null,this.attendanceResult=null},5e3)},error:i=>{console.error("Error recording attendance:",i),this.attendanceResult={success:!1,message:"\u062E\u0637\u0623 \u0641\u064A \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062D\u0636\u0648\u0631"},this.isScanning=!1}})}sendSMSToParent(t,e){let i={to:t.parentPhone||t.phone,message:`\u062A\u0645 \u062A\u0633\u062C\u064A\u0644 \u062D\u0636\u0648\u0631 ${t.fullName||t.registrationNumber} \u0641\u064A \u0627\u0644\u0645\u062F\u0631\u0633\u0629 \u0628\u062A\u0627\u0631\u064A\u062E ${new Date().toLocaleDateString("ar-SA")} \u0627\u0644\u0633\u0627\u0639\u0629 ${new Date().toLocaleTimeString("ar-SA",{hour:"2-digit",minute:"2-digit"})}`};this.http.post("http://localhost:5000/api/sms/send",i).subscribe({next:()=>console.log("SMS sent successfully"),error:r=>console.error("Error sending SMS:",r)})}loadStatistics(){this.http.get("http://localhost:5000/api/students/all").subscribe({next:t=>{this.totalStudents=t.length,this.attendanceToday=Math.floor(Math.random()*(this.totalStudents/2))+10,this.attendanceRate=Math.round(this.attendanceToday/this.totalStudents*100)},error:t=>{console.error("Error loading statistics:",t)}})}loadTodayClasses(){let t=new Date().toISOString().split("T")[0];this.todayClasses=[{id:1,subject:"\u0631\u064A\u0627\u0636\u064A\u0627\u062A",startTime:"08:00",endTime:"09:30",status:"ongoing",teacher:"\u0623. \u0623\u062D\u0645\u062F"},{id:2,subject:"\u0641\u064A\u0632\u064A\u0627\u0621",startTime:"10:00",endTime:"11:30",status:"scheduled",teacher:"\u0623. \u0645\u062D\u0645\u062F"},{id:3,subject:"\u0644\u063A\u0629 \u0639\u0631\u0628\u064A\u0629",startTime:"12:00",endTime:"13:30",status:"scheduled",teacher:"\u0623. \u0639\u0644\u064A"}]}loadRecentAttendance(){this.recentAttendance=[{studentName:"\u0645\u062D\u0645\u062F \u0623\u062D\u0645\u062F",className:"\u0631\u064A\u0627\u0636\u064A\u0627\u062A",timestamp:new Date(Date.now()-3e5)},{studentName:"\u0633\u0627\u0631\u0629 \u062E\u0627\u0644\u062F",className:"\u0631\u064A\u0627\u0636\u064A\u0627\u062A",timestamp:new Date(Date.now()-6e5)},{studentName:"\u0639\u0645\u0631 \u0633\u0639\u064A\u062F",className:"\u0631\u064A\u0627\u0636\u064A\u0627\u062A",timestamp:new Date(Date.now()-9e5)}]}static \u0275fac=function(e){return new(e||n)(Ne(pn))};static \u0275cmp=nn({type:n,selectors:[["app-student-attendance"]],decls:44,vars:9,consts:[[1,"attendance-interface"],[1,"header"],[1,"fas","fa-id-card"],[1,"subtitle"],[1,"scanner-section"],[1,"scanner-box",3,"click"],[1,"scanner-icon"],["class","scanning-animation",4,"ngIf"],["class","student-info",4,"ngIf"],["class","attendance-result",3,"success","error",4,"ngIf"],[1,"statistics"],[1,"stat-item"],[1,"stat-icon"],[1,"fas","fa-users"],[1,"stat-info"],[1,"fas","fa-user-check"],[1,"fas","fa-chart-line"],["class","recent-attendance",4,"ngIf"],[1,"scanning-animation"],[1,"pulse"],[1,"student-info"],[1,"student-card"],[1,"student-avatar"],[1,"fas","fa-user-graduate"],[1,"student-details"],[1,"fas","fa-id-badge"],[1,"fas","fa-book"],[1,"fas","fa-calendar"],["class","today-classes",4,"ngIf"],[1,"today-classes"],[1,"fas","fa-calendar-day"],[1,"classes-list"],["class","class-item",4,"ngFor","ngForOf"],[1,"class-item"],[1,"class-time"],[1,"far","fa-clock"],[1,"class-subject"],[1,"class-status"],[1,"attendance-result"],[1,"result-icon"],[4,"ngIf"],["class","sms-info",4,"ngIf"],[1,"sms-info"],[1,"fas","fa-sms"],[1,"recent-attendance"],[1,"fas","fa-history"],[1,"attendance-list"],["class","attendance-record",4,"ngFor","ngForOf"],[1,"attendance-record"],[1,"record-time"],[1,"record-student"],[1,"record-class"],[1,"record-status"],[1,"status-present"]],template:function(e,i){e&1&&(s(0,"div",0)(1,"div",1)(2,"h1"),b(3,"i",2),u(4," \u0646\u0638\u0627\u0645 \u062A\u0633\u062C\u064A\u0644 \u0627\u0644\u062D\u0636\u0648\u0631"),a(),s(5,"p",3),u(6,"\u0636\u0639 \u0628\u0637\u0627\u0642\u0629 RFID \u0627\u0644\u062E\u0627\u0635\u0629 \u0628\u0643 \u0644\u0644\u0645\u0633\u062D"),a()(),s(7,"div",4)(8,"div",5),I("click",function(){return i.startRFIDScan()}),s(9,"div",6),b(10,"i",2),a(),s(11,"h3"),u(12,"\u0627\u0644\u0645\u0633\u062D \u0627\u0644\u0636\u0648\u0626\u064A \u0644\u0644\u0628\u0637\u0627\u0642\u0629"),a(),s(13,"p"),u(14,"\u0627\u0646\u0642\u0631 \u0647\u0646\u0627 \u0623\u0648 \u0636\u0639 \u0627\u0644\u0628\u0637\u0627\u0642\u0629 \u0628\u0627\u0644\u0642\u0631\u0628 \u0645\u0646 \u0627\u0644\u0642\u0627\u0631\u0626"),a(),j(15,JX,4,0,"div",7),a(),j(16,eZ,17,5,"div",8)(17,iZ,7,9,"div",9),s(18,"div",10)(19,"div",11)(20,"div",12),b(21,"i",13),a(),s(22,"div",14)(23,"h4"),u(24),a(),s(25,"p"),u(26,"\u0625\u062C\u0645\u0627\u0644\u064A \u0627\u0644\u0637\u0644\u0627\u0628"),a()()(),s(27,"div",11)(28,"div",12),b(29,"i",15),a(),s(30,"div",14)(31,"h4"),u(32),a(),s(33,"p"),u(34,"\u062D\u0636\u0648\u0631 \u0627\u0644\u064A\u0648\u0645"),a()()(),s(35,"div",11)(36,"div",12),b(37,"i",16),a(),s(38,"div",14)(39,"h4"),u(40),a(),s(41,"p"),u(42,"\u0646\u0633\u0628\u0629 \u0627\u0644\u062D\u0636\u0648\u0631"),a()()()()(),j(43,oZ,6,1,"div",17),a()),e&2&&(d(8),Ie("scanning",i.isScanning),d(7),w("ngIf",i.isScanning),d(),w("ngIf",i.currentStudent),d(),w("ngIf",i.attendanceResult),d(7),B(i.totalStudents),d(8),B(i.attendanceToday),d(8),H("",i.attendanceRate,"%"),d(3),w("ngIf",i.recentAttendance.length>0))},dependencies:[hn,Nn,An,qr,Un],styles:[".attendance-interface[_ngcontent-%COMP%]{padding:20px;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;direction:rtl;background:linear-gradient(135deg,#f5f7fa,#c3cfe2);min-height:100vh}.header[_ngcontent-%COMP%]{text-align:center;margin-bottom:30px;padding:20px;background:#fff;border-radius:10px;box-shadow:0 4px 6px #0000001a}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#2c3e50;font-size:2.5rem;margin-bottom:10px}.header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#7f8c8d;font-size:1.2rem}.scanner-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:30px}.scanner-box[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:40px;text-align:center;cursor:pointer;transition:all .3s ease;box-shadow:0 6px 12px #0000001a;border:3px dashed #3498db;position:relative}.scanner-box[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 12px 20px #00000026;border-color:#2980b9}.scanner-box.scanning[_ngcontent-%COMP%]{border-color:#2ecc71;animation:_ngcontent-%COMP%_pulse 2s infinite}@keyframes _ngcontent-%COMP%_pulse{0%{box-shadow:0 0 #2ecc7166}70%{box-shadow:0 0 0 20px #2ecc7100}to{box-shadow:0 0 #2ecc7100}}.scanner-icon[_ngcontent-%COMP%]{font-size:4rem;color:#3498db;margin-bottom:20px}.scanner-box[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:10px}.scanner-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;margin-bottom:20px}.scanning-animation[_ngcontent-%COMP%]{margin-top:20px}.pulse[_ngcontent-%COMP%]{width:60px;height:60px;background:#2ecc71;border-radius:50%;margin:0 auto 10px;animation:_ngcontent-%COMP%_scanning 1.5s infinite}@keyframes _ngcontent-%COMP%_scanning{0%{transform:scale(.8);opacity:.7}50%{transform:scale(1.2);opacity:1}to{transform:scale(.8);opacity:.7}}.student-info[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:25px;box-shadow:0 4px 6px #0000001a}.student-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-bottom:25px;padding-bottom:20px;border-bottom:1px solid #ecf0f1}.student-avatar[_ngcontent-%COMP%]{width:80px;height:80px;background:#3498db;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:2.5rem;color:#fff}.student-details[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:10px}.student-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#34495e;margin-bottom:5px;display:flex;align-items:center;gap:8px}.today-classes[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:15px;display:flex;align-items:center;gap:10px}.classes-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.class-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 15px;background:#f8f9fa;border-radius:8px;border-right:4px solid #3498db}.class-time[_ngcontent-%COMP%]{color:#e74c3c;font-weight:700}.class-subject[_ngcontent-%COMP%]{color:#2c3e50;font-weight:500}.status-active[_ngcontent-%COMP%]{background:#2ecc71;color:#fff;padding:4px 12px;border-radius:20px;font-size:.85rem}.status-scheduled[_ngcontent-%COMP%]{background:#f39c12;color:#fff;padding:4px 12px;border-radius:20px;font-size:.85rem}.attendance-result[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:30px;text-align:center;box-shadow:0 4px 6px #0000001a}.attendance-result.success[_ngcontent-%COMP%]{border-top:5px solid #2ecc71}.attendance-result.error[_ngcontent-%COMP%]{border-top:5px solid #e74c3c}.result-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:20px}.attendance-result.success[_ngcontent-%COMP%]   .result-icon[_ngcontent-%COMP%]{color:#2ecc71}.attendance-result.error[_ngcontent-%COMP%]   .result-icon[_ngcontent-%COMP%]{color:#e74c3c}.attendance-result[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:15px}.sms-info[_ngcontent-%COMP%]{color:#27ae60;display:flex;align-items:center;justify-content:center;gap:10px;margin-top:15px}.statistics[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:20px;margin-top:20px}.stat-item[_ngcontent-%COMP%]{background:#fff;border-radius:10px;padding:20px;display:flex;align-items:center;gap:15px;box-shadow:0 4px 6px #0000001a;transition:transform .3s ease}.stat-item[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.stat-icon[_ngcontent-%COMP%]{width:60px;height:60px;background:#3498db;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.8rem;color:#fff}.stat-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{color:#2c3e50;font-size:2rem;margin-bottom:5px}.stat-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d}.recent-attendance[_ngcontent-%COMP%]{background:#fff;border-radius:15px;padding:25px;margin-top:30px;box-shadow:0 4px 6px #0000001a}.recent-attendance[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:20px;display:flex;align-items:center;gap:10px}.attendance-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px}.attendance-record[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr 2fr 1fr;gap:15px;padding:12px 15px;background:#f8f9fa;border-radius:8px;align-items:center}.record-time[_ngcontent-%COMP%]{color:#e74c3c;font-weight:700}.record-student[_ngcontent-%COMP%]{color:#2c3e50;font-weight:500}.record-class[_ngcontent-%COMP%]{color:#34495e}.status-present[_ngcontent-%COMP%]{background:#2ecc71;color:#fff;padding:4px 12px;border-radius:20px;font-size:.85rem}@media (max-width: 768px){.attendance-interface[_ngcontent-%COMP%]{padding:10px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem}.scanner-box[_ngcontent-%COMP%]{padding:20px}.scanner-icon[_ngcontent-%COMP%]{font-size:3rem}.statistics[_ngcontent-%COMP%]{grid-template-columns:1fr}.attendance-record[_ngcontent-%COMP%]{grid-template-columns:1fr 1fr;gap:10px}}"]})};var fD=[{path:"",redirectTo:"/login",pathMatch:"full"},{path:"login",component:Fg},{path:"accounting",component:Z1},{path:"home",component:Og,children:[{path:"lesson-management",component:Rg},{path:"dashboard",component:J1},{path:"live-class",component:z1},{path:"students-management",component:kg},{path:"students-management/:id",component:Y1},{path:"add-student-to-classes-modal/:id",component:q1},{path:"teachers-management",component:G1},{path:"rooms-management",component:L1},{path:"payments-management",component:V1},{path:"cards-management",component:H1},{path:"lesson-detail/:lessonId",component:Qf},{path:"lesson/:lessonId",component:Qf},{path:"attendance",component:eh},{path:"scan",component:eh},{path:"",redirectTo:"lesson-management",pathMatch:"full"}]}];var hD={providers:[jx(fD),Bm()]};$();var K1=class n{title="adminApp";onWindowClick(t){}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=nn({type:n,selectors:[["app-root"]],hostBindings:function(e,i){e&1&&I("click",function(o){return i.onWindowClick(o)},!1,as)},decls:1,vars:0,template:function(e,i){e&1&&b(0,"router-outlet")},dependencies:[hn,qs,Yl],encapsulation:2})};cx(K1,hD).catch(n=>console.error(n));
